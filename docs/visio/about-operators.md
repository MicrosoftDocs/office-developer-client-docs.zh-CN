---
title: 关于运算符
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: overview
f1_keywords:
- Vis_DSS.chm82251824
localization_priority: Normal
ms.assetid: 43128ea2-c0d9-c45f-31e6-768a80ae59b2
description: 您可以在公式中使用运算符来执行算术运算（加、减、乘等）或逻辑比较（大于、小于、等于等）。还可以使用括号括起表达式，以控制公式的求值顺序。使用运算符可以组合（连接）字符串。
ms.openlocfilehash: 4f095df73f9bd1d6a876d975d262c9217c696fb9
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/28/2019
ms.locfileid: "33406127"
---
# <a name="about-operators"></a>关于运算符

您可以在公式中使用运算符来执行算术运算（加、减、乘等）或逻辑比较（大于、小于、等于等）。还可以使用括号括起表达式，以控制公式的求值顺序。使用运算符可以组合（连接）字符串。
  
Microsoft Visio在操作或函数需要特定类型的数据时自动尝试转换数据类型。 例如，乘法运算符需要数值参数，而 &（字符串连接）运算符需要字符串参数。 如果参数不能被转换为所需的数据类型，会提供一个默认值。 这种情况下各类型的默认值分别为：对数值而言是零，对布尔值而言是 FALSE，对字符串而言是 ""，等等。
  
下表举例说明了表达式及其结果。
  
|**Expression**|**结果**|**说明**|
|:-----|:-----|:-----|
| 2 \* 5 &amp; " cents"  <br/> | "10 cents"  <br/> | 字符串连接 (运算符需要) 参数，因此 2 5 的数字结果会自动转换为字符串 &amp; \* "10"。  <br/> |
| 5 \* "2"  <br/> | 10    <br/> | 乘 \* (运算符) 数值参数，因此字符串"2"将自动转换为等效的数字 2。  <br/> |
| 5 \* 个"动物"  <br/> | 0  <br/> | 乘 (运算符) 数值参数，因此，由于字符串"不"不能转换为数字，因此将零用作其 \* 等效数字。  <br/> |
   
## <a name="arithmetic-operators"></a>算术运算符

算术运算符对数字执行运算。加号 (+) 和减号 (-) 运算符可以作为单目运算符单独构成数字的符号。百分号运算符 (%) 也是一个单目运算符，它标识数字是一个百分比。
  
|**Operator**|**Action**|**示例**|**结果**|
|:-----|:-----|:-----|:-----|
| +  <br/> | 单目加  <br/> | +37  <br/> | 37  <br/> |
| -  <br/> | 单目减  <br/> | -37  <br/> | -37  <br/> |
| %  <br/> | 单目百分比  <br/> | 37%  <br/> | .37  <br/> |
| ^  <br/> | Exponentiation  <br/> | 5 ^ 2  <br/> | 25  <br/> |
| \*  <br/> | 乘  <br/> | 5 \* 2  <br/> | 10    <br/> |
| /  <br/> | 部门  <br/> | 5 / 2  <br/> | 2.5  <br/> |
| +  <br/> | 添加项  <br/> | 5 + 2  <br/> | 7   <br/> |
| -  <br/> | 减  <br/> | 5 - 2  <br/> | 3  <br/> |
   
## <a name="comparison-operators"></a>比较运算符

比较关系运算符用来建立逻辑表达式。逻辑表达式的结果为 TRUE 或 FALSE。
  
|**Operator**|**替代方法**|**Action**|**示例**|**结果**|
|:-----|:-----|:-----|:-----|:-----|
| \>  <br/> | _GT_  <br/> | 大于  <br/> | 5 \> 2  <br/> | TRUE  <br/> |
| \<  <br/> | _LT_  <br/> | 小于  <br/> | 5 \< 2  <br/> | FALSE  <br/> |
| \>=  <br/> | _GE_  <br/> | 大于或等于  <br/> | 5 \> = 2  <br/> | TRUE  <br/> |
| \<=  <br/> | _LE_  <br/> | 小于或等于  <br/> | 5 \< = 2  <br/> | FALSE  <br/> |
| =  <br/> | _EQ_  <br/> | 等于  <br/> | 5 = 2  <br/> | FALSE  <br/> |
| \<\>  <br/> | _NE_  <br/> | 不等于  <br/> | 5 \< \> 2  <br/> | TRUE  <br/> |
   
符号比较运算符 (、 等 \>) \< 是大多数比较的最佳选择。 替代运算符 (_GT、LT_ 等) 对 15 位精度进行精确比较，Visio内部存储值。
  
用替代运算符比较舍入后的或计算出的值时，在所有实际情况下计算结果都应为 TRUE 的表达式可能会返回 FALSE。
  
用比较运算符比较文本字符串时，字符串首先被转换成数值。不能转换的文本字符串返回 0 值。因此，比较结果会发生变化，并可能得出意外结果。要执行标准的字符串比较，请使用 STRSAME 或 STRSAMEEX 函数。
  
## <a name="order-of-evaluation"></a>求值顺序

当一个公式包含多个表达式时，按照运算执行的顺序对这些表达式求值。下表显示了 Visio 中运算符的求值顺序。
  
|**Order**|**Action**|**Operator**|
|:-----|:-----|:-----|
|First  <br/> |正数  <br/> |+（单目）  <br/> |
||Negative  <br/> |-（单目）  <br/> |
||Percent  <br/> |%（单目）  <br/> |
|秒  <br/> |Exponentiation  <br/> |^  <br/> |
|第三节  <br/> |乘  <br/> |\*  <br/> |
||部门  <br/> |/  <br/> |
|第四  <br/> |Addition  <br/> |+  <br/> |
||减  <br/> |-  <br/> |
|第五  <br/> |字符串连接  <br/> |&amp;  <br/> |
|第六  <br/> |大于  <br/> |\> 或 GT  <br/> |
||大于或等于  <br/> |\>= 或 GE  <br/> |
||小于  <br/> |\< 或 LT  <br/> |
||小于或等于  <br/> |\<= 或 LE  <br/> |
|第七个  <br/> |等于  <br/> |= 或 EQ  <br/> |
||不等于  <br/> |\<\> 或 NE  <br/> |
   
您可以使用括号将表达式括起来以改变求值顺序。Visio 首先从左至右对括号内的表达式求值。例如：
  
4 + 5 \* 6 = 4 + 30 = 34
  
 (4 + 5) \* 6 = 9 \* 6 = 54
  
如果括号中的表达式是嵌套的，则最先计算最里层括号内的表达式。
  
## <a name="ampersand-operator"></a>& 运算符

& 运算符返回一个新的字符串。您可以用 & 运算符创建复合词或短语。语法如下：
  
"string1" &amp; "string2"
  
 **示例**
  
&amp;"dog""house"返回"doghouse"
  

