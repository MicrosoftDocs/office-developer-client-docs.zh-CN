---
title: xlfRegister（窗体 1）
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
f1_keywords:
- xlfRegister
keywords:
- xlfregister 函数 [excel 2007]
localization_priority: Normal
ms.assetid: c730124c-1886-4a0f-8f06-79763025537d
description: 适用于： Excel 2013 | Office 2013 | Visual Studio
ms.openlocfilehash: 3cd2e5072c8602fe301028e69592220a8345c211
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/23/2019
ms.locfileid: "32303862"
---
# <a name="xlfregister-form-1"></a><span data-ttu-id="e96fa-104">xlfRegister（窗体 1）</span><span class="sxs-lookup"><span data-stu-id="e96fa-104">xlfRegister (Form 1)</span></span>

<span data-ttu-id="e96fa-105">**适用于** Excel 2013 | Office 2013 | Visual Studio</span><span class="sxs-lookup"><span data-stu-id="e96fa-105">**Applies to**: Excel 2013 | Office 2013 | Visual Studio</span></span> 
  
<span data-ttu-id="e96fa-106">可从 DLL 或 XLL 命令调用, 该命令本身已由 Microsoft Excel 调用。</span><span class="sxs-lookup"><span data-stu-id="e96fa-106">Can be called from a DLL or XLL command that has itself been called by Microsoft Excel.</span></span> <span data-ttu-id="e96fa-107">这相当于从 Excel XLM 宏表调用**REGISTER** 。</span><span class="sxs-lookup"><span data-stu-id="e96fa-107">This is equal to calling **REGISTER** from an Excel XLM macro sheet.</span></span> 
  
<span data-ttu-id="e96fa-108">可以在两种形式中调用**xlfRegister** :</span><span class="sxs-lookup"><span data-stu-id="e96fa-108">**xlfRegister** can be called in two forms:</span></span> 
  
- <span data-ttu-id="e96fa-109">xlfRegister (窗体 1): 注册单个命令或函数。</span><span class="sxs-lookup"><span data-stu-id="e96fa-109">xlfRegister (Form 1): Registers a single command or function.</span></span>
    
- <span data-ttu-id="e96fa-110">[xlfRegister (窗体 2)](xlfregister-form-2.md): 加载并激活 XLL。</span><span class="sxs-lookup"><span data-stu-id="e96fa-110">[xlfRegister (Form 2)](xlfregister-form-2.md): Loads and activates an XLL.</span></span>
    
<span data-ttu-id="e96fa-111">在 Form 1 中调用, 此函数使 DLL 函数或命令可供 Excel 使用, 并将其使用计数设置为 1, 并返回其注册 ID, 该 ID 可用于稍后使用[xlUDF](xludf.md)或**xlfCall**函数调用函数。</span><span class="sxs-lookup"><span data-stu-id="e96fa-111">Called in Form 1, this function makes a DLL function or command available to Excel, sets its use count to 1, and returns its registration ID, which can be used to call the function later by using the [xlUDF](xludf.md) or the **xlfCall** function.</span></span> <span data-ttu-id="e96fa-112">注册 ID 还用于使用[xlfUnregister (窗体 1)](xlfunregister-form-1.md)注销函数。</span><span class="sxs-lookup"><span data-stu-id="e96fa-112">The registration ID is also used to unregister the function using [xlfUnregister (Form 1)](xlfunregister-form-1.md).</span></span> <span data-ttu-id="e96fa-113">如果该函数已注册, 则再次调用**xlfRegister**会增加其使用次数。</span><span class="sxs-lookup"><span data-stu-id="e96fa-113">If the function has been registered, calling **xlfRegister** again increments its use count.</span></span> 
  
<span data-ttu-id="e96fa-114">这种形式的函数还定义了一个隐藏名称, 该名称是函数文本参数_pxFunctionText_, 其计算结果为函数或命令的注册 ID。</span><span class="sxs-lookup"><span data-stu-id="e96fa-114">This form of the function also defines a hidden name which is the function text argument,  _pxFunctionText_, and which evaluates to the registration ID of the function or command.</span></span> <span data-ttu-id="e96fa-115">在注销函数时, 请使用[xlfSetName](xlfsetname.md)删除此名称。</span><span class="sxs-lookup"><span data-stu-id="e96fa-115">When you unregister the function, delete this name using the [xlfSetName](xlfsetname.md).</span></span> <span data-ttu-id="e96fa-116">有关详细信息，请参阅 [Excel XLL 开发中的已知问题](known-issues-in-excel-xll-development.md)。</span><span class="sxs-lookup"><span data-stu-id="e96fa-116">For more information, see [Known Issues in Excel XLL Development](known-issues-in-excel-xll-development.md).</span></span>
  
```cs
Excel12(xlfRegister, LPXLOPER12 pxRes, int iCount,
    LPXLOPER12 pxModuleText,   LPXLOPER12 pxProcedure,
    LPXLOPER12 pxTypeText,     LPXLOPER12 pxFunctionText,
    LPXLOPER12 pxArgumentText, LPXLOPER12 pxMacroType,
    LPXLOPER12 pxCategory,     LPXLOPER12 pxShortcutText,
    LPXLOPER12 pxHelpTopic,    LPXLOPER12 pxFunctionHelp,
    LPXLOPER12 pxArgumentHelp1, LPXLOPER12 pxArgumentHelp2,
        ...);
```

## <a name="parameters"></a><span data-ttu-id="e96fa-117">参数</span><span class="sxs-lookup"><span data-stu-id="e96fa-117">Parameters</span></span>

<span data-ttu-id="e96fa-118">_pxModuleText_(**xltypeStr**)</span><span class="sxs-lookup"><span data-stu-id="e96fa-118">_pxModuleText_ (**xltypeStr**)</span></span>
  
<span data-ttu-id="e96fa-119">包含函数的 DLL 的名称。</span><span class="sxs-lookup"><span data-stu-id="e96fa-119">The name of the DLL that contains the function.</span></span> <span data-ttu-id="e96fa-120">如果注册的函数也在当前正在执行的 DLL 中, 则可以通过调用 XLL 函数[xlGetName](xlgetname.md)来获取此功能。</span><span class="sxs-lookup"><span data-stu-id="e96fa-120">This can be obtained by calling the XLL-only function [xlGetName](xlgetname.md) if the function registered is also within the currently executing DLL.</span></span> 
  
<span data-ttu-id="e96fa-121">_pxProcedure_(**xltypeStr**或**xltypeNum**)</span><span class="sxs-lookup"><span data-stu-id="e96fa-121">_pxProcedure_ (**xltypeStr** or **xltypeNum**)</span></span>
  
<span data-ttu-id="e96fa-122">如果为字符串, 则为要调用的函数的名称, 因为它出现在 DLL 代码中。</span><span class="sxs-lookup"><span data-stu-id="e96fa-122">If a string, the name of the function to call as it appears in the DLL code.</span></span> <span data-ttu-id="e96fa-123">如果为数字, 则为要调用的函数的序号导出编号。</span><span class="sxs-lookup"><span data-stu-id="e96fa-123">If a number, the ordinal export number of the function to call.</span></span> <span data-ttu-id="e96fa-124">为清楚起见, 请始终使用字符串形式。</span><span class="sxs-lookup"><span data-stu-id="e96fa-124">For clarity, always use the string form.</span></span>
  
<span data-ttu-id="e96fa-125">_pxTypeText_(**xltypeStr**)</span><span class="sxs-lookup"><span data-stu-id="e96fa-125">_pxTypeText_ (**xltypeStr**)</span></span>
  
<span data-ttu-id="e96fa-126">一个可选字符串, 指定函数的参数类型和函数的返回值的类型。</span><span class="sxs-lookup"><span data-stu-id="e96fa-126">An optional string that specifies the types of arguments to the function and the type of the return value of the function.</span></span> <span data-ttu-id="e96fa-127">有关更多信息，请参见“注释”部分。</span><span class="sxs-lookup"><span data-stu-id="e96fa-127">For more information, see the Remarks section.</span></span> <span data-ttu-id="e96fa-128">对于包含[xlAutoRegister 函数](xlautoregister-xlautoregister12.md)或**xlAutoRegister12**的独立 DLL (XLL), 可以省略此参数。</span><span class="sxs-lookup"><span data-stu-id="e96fa-128">This argument can be omitted for a stand-alone DLL (XLL) that includes an [xlAutoRegister function](xlautoregister-xlautoregister12.md) or **xlAutoRegister12**.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="e96fa-129">**xlAutoRegister12**仅在 Excel 2007 中受支持。</span><span class="sxs-lookup"><span data-stu-id="e96fa-129">**xlAutoRegister12** is only supported in Excel 2007.</span></span> 
  
<span data-ttu-id="e96fa-130">如果在使用此参数时调用**xlfRegister** , 则 Excel 将调用**xlAutoRegister**或**xlAutoRegister12**(如果存在) 在指定的 DLL 中, 这样就可以通过提供此信息正确地注册该函数。</span><span class="sxs-lookup"><span data-stu-id="e96fa-130">If **xlfRegister** is called with this argument missing, Excel calls **xlAutoRegister** or **xlAutoRegister12**, if either exists in the specified DLL, which should then correctly register the function by providing this information.</span></span>
  
<span data-ttu-id="e96fa-131">_pxFunctionText_(**xltypeStr**)</span><span class="sxs-lookup"><span data-stu-id="e96fa-131">_pxFunctionText_ (**xltypeStr**)</span></span>
  
<span data-ttu-id="e96fa-132">将在函数向导中显示的函数名称。</span><span class="sxs-lookup"><span data-stu-id="e96fa-132">The function name as it will appear in the Function Wizard.</span></span> <span data-ttu-id="e96fa-133">此参数是可选的;如果省略该函数, 则函数在函数向导中不可用, 并且只能使用来自 XLM 宏表中的函数注册 ID 的**CALL**函数调用该函数。</span><span class="sxs-lookup"><span data-stu-id="e96fa-133">This argument is optional; if it is omitted, the function is not available in the Function Wizard, and can only be called using the **CALL** function using the functions registration ID from an XLM macro sheet.</span></span> <span data-ttu-id="e96fa-134">因此, 对于普通工作表使用, 应根据需要处理此参数。</span><span class="sxs-lookup"><span data-stu-id="e96fa-134">Therefore, for ordinary worksheet use, you should handle this argument as required.</span></span> 
  
<span data-ttu-id="e96fa-135">_pxArgumentText_(**xltypeStr**)</span><span class="sxs-lookup"><span data-stu-id="e96fa-135">_pxArgumentText_ (**xltypeStr**)</span></span>
  
<span data-ttu-id="e96fa-136">一个可选的文本字符串, 用于描述函数的参数。</span><span class="sxs-lookup"><span data-stu-id="e96fa-136">An optional text string that describes the arguments to the function.</span></span> <span data-ttu-id="e96fa-137">用户将在 "函数向导" 中看到此功能。</span><span class="sxs-lookup"><span data-stu-id="e96fa-137">The user sees this in the Function Wizard.</span></span> <span data-ttu-id="e96fa-138">如果省略该方法, 则 Excel 将从_pxTypeText_构造基本说明。</span><span class="sxs-lookup"><span data-stu-id="e96fa-138">If it is omitted, Excel constructs basic descriptions from  _pxTypeText_.</span></span>
  
<span data-ttu-id="e96fa-139">_pxMacroType_(**xltypeNum**或**xltypeInt**)</span><span class="sxs-lookup"><span data-stu-id="e96fa-139">_pxMacroType_ (**xltypeNum** or **xltypeInt**)</span></span>
  
<span data-ttu-id="e96fa-140">一个指示 XLL 入口点的类型的可选参数。</span><span class="sxs-lookup"><span data-stu-id="e96fa-140">An optional argument that indicates the type of XLL entry point.</span></span> <span data-ttu-id="e96fa-141">如果省略, 则默认值为1。</span><span class="sxs-lookup"><span data-stu-id="e96fa-141">The default value, if it is omitted, is 1.</span></span>
  
|||||
|:-----|:-----|:-----|:-----|
| <span data-ttu-id="e96fa-142">_pxMacroType 值_</span><span class="sxs-lookup"><span data-stu-id="e96fa-142">_pxMacroType value_</span></span> <br/> |<span data-ttu-id="e96fa-143">0</span><span class="sxs-lookup"><span data-stu-id="e96fa-143">0</span></span>  <br/> |<span data-ttu-id="e96fa-144">1</span><span class="sxs-lookup"><span data-stu-id="e96fa-144">1</span></span>  <br/> |<span data-ttu-id="e96fa-145">双面</span><span class="sxs-lookup"><span data-stu-id="e96fa-145">2</span></span>  <br/> |
|<span data-ttu-id="e96fa-146">可从工作表中调用</span><span class="sxs-lookup"><span data-stu-id="e96fa-146">Can be called from a worksheet</span></span>  <br/> |<span data-ttu-id="e96fa-147">是</span><span class="sxs-lookup"><span data-stu-id="e96fa-147">Yes</span></span>  <br/> |<span data-ttu-id="e96fa-148">是</span><span class="sxs-lookup"><span data-stu-id="e96fa-148">Yes</span></span>  <br/> |<span data-ttu-id="e96fa-149">否</span><span class="sxs-lookup"><span data-stu-id="e96fa-149">No</span></span>  <br/> |
|<span data-ttu-id="e96fa-150">可从宏表中调用</span><span class="sxs-lookup"><span data-stu-id="e96fa-150">Can be called from a macro sheet</span></span>  <br/> |<span data-ttu-id="e96fa-151">是</span><span class="sxs-lookup"><span data-stu-id="e96fa-151">Yes</span></span>  <br/> |<span data-ttu-id="e96fa-152">是</span><span class="sxs-lookup"><span data-stu-id="e96fa-152">Yes</span></span>  <br/> |<span data-ttu-id="e96fa-153">是</span><span class="sxs-lookup"><span data-stu-id="e96fa-153">Yes</span></span>  <br/> |
|<span data-ttu-id="e96fa-154">可从定义的名称定义中调用</span><span class="sxs-lookup"><span data-stu-id="e96fa-154">Can be called from a defined name definition</span></span>  <br/> |<span data-ttu-id="e96fa-155">是</span><span class="sxs-lookup"><span data-stu-id="e96fa-155">Yes</span></span>  <br/> |<span data-ttu-id="e96fa-156">是</span><span class="sxs-lookup"><span data-stu-id="e96fa-156">Yes</span></span>  <br/> |<span data-ttu-id="e96fa-157">是</span><span class="sxs-lookup"><span data-stu-id="e96fa-157">Yes</span></span>  <br/> |
|<span data-ttu-id="e96fa-158">可从条件格式表达式中调用</span><span class="sxs-lookup"><span data-stu-id="e96fa-158">Can be called from a conditional format expression</span></span>  <br/> |<span data-ttu-id="e96fa-159">是</span><span class="sxs-lookup"><span data-stu-id="e96fa-159">Yes</span></span>  <br/> |<span data-ttu-id="e96fa-160">是</span><span class="sxs-lookup"><span data-stu-id="e96fa-160">Yes</span></span>  <br/> |<span data-ttu-id="e96fa-161">否</span><span class="sxs-lookup"><span data-stu-id="e96fa-161">No</span></span>  <br/> |
|<span data-ttu-id="e96fa-162">在工作表函数的函数向导中列出</span><span class="sxs-lookup"><span data-stu-id="e96fa-162">Listed in the Function Wizard for worksheet functions</span></span>  <br/> |<span data-ttu-id="e96fa-163">否</span><span class="sxs-lookup"><span data-stu-id="e96fa-163">No</span></span>  <br/> |<span data-ttu-id="e96fa-164">是</span><span class="sxs-lookup"><span data-stu-id="e96fa-164">Yes</span></span>  <br/> |<span data-ttu-id="e96fa-165">否</span><span class="sxs-lookup"><span data-stu-id="e96fa-165">No</span></span>  <br/> |
|<span data-ttu-id="e96fa-166">"函数向导" 中列出的宏表函数</span><span class="sxs-lookup"><span data-stu-id="e96fa-166">Listed in the Function Wizard for macro sheet functions</span></span>  <br/> |<span data-ttu-id="e96fa-167">否</span><span class="sxs-lookup"><span data-stu-id="e96fa-167">No</span></span>  <br/> |<span data-ttu-id="e96fa-168">是</span><span class="sxs-lookup"><span data-stu-id="e96fa-168">Yes</span></span>  <br/> |<span data-ttu-id="e96fa-169">是</span><span class="sxs-lookup"><span data-stu-id="e96fa-169">Yes</span></span>  <br/> |
   
<span data-ttu-id="e96fa-170">在实践中, 您应使用1作为工作表函数, 1 用于要从工作表中调用**#** 的宏表等效函数 (注册为类型), 并2表示命令。</span><span class="sxs-lookup"><span data-stu-id="e96fa-170">In practice, you should use 1 for worksheet functions, 1 for macro sheet equivalent functions (registered as type **#**) that you want to call from the worksheet, and 2 for commands.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="e96fa-171">XLL 命令是隐藏的, 并且不会显示在运行宏的对话框中, 尽管它们的名称可以在需要有效命令名称的任何位置输入。</span><span class="sxs-lookup"><span data-stu-id="e96fa-171">XLL commands are hidden and not displayed in dialog boxes for running macros, although their names can be entered anywhere a valid command name is required.</span></span> 
  
<span data-ttu-id="e96fa-172">_pxCategory_(**xltypeStr**或**xltypeNum**)</span><span class="sxs-lookup"><span data-stu-id="e96fa-172">_pxCategory_ (**xltypeStr** or **xltypeNum**)</span></span>
  
<span data-ttu-id="e96fa-173">一个可选参数, 可用于指定新函数或命令所属的类别。</span><span class="sxs-lookup"><span data-stu-id="e96fa-173">An optional argument that enables you to specify which category that the new function or command should belong to.</span></span> <span data-ttu-id="e96fa-174">函数向导按类型 (类别) 划分函数。</span><span class="sxs-lookup"><span data-stu-id="e96fa-174">The Function Wizard divides functions by type (category).</span></span> <span data-ttu-id="e96fa-175">您可以指定类别名称或顺序编号, 其中的数字是类别在函数向导中显示的位置。</span><span class="sxs-lookup"><span data-stu-id="e96fa-175">You can specify a category name or a sequential number, where the number is the position in which the category appears in the Function Wizard.</span></span> <span data-ttu-id="e96fa-176">有关详细信息, 请参阅 "Category Names" 一节。</span><span class="sxs-lookup"><span data-stu-id="e96fa-176">For more information, see the "Category Names" section.</span></span> <span data-ttu-id="e96fa-177">如果省略该方法, 则假定为用户定义的类别。</span><span class="sxs-lookup"><span data-stu-id="e96fa-177">If it is omitted, the User Defined category is assumed.</span></span>
  
<span data-ttu-id="e96fa-178">_pxShortcutText_(**xltypeStr**)</span><span class="sxs-lookup"><span data-stu-id="e96fa-178">_pxShortcutText_ (**xltypeStr**)</span></span>
  
<span data-ttu-id="e96fa-179">一个字符的、区分大小写的字符串, 用于指定分配给此命令的控制键。</span><span class="sxs-lookup"><span data-stu-id="e96fa-179">A one-character, case-sensitive string that specifies the control key assigned to this command.</span></span> <span data-ttu-id="e96fa-180">例如, "A" 分配此命令来控制 + SHIFT + A。</span><span class="sxs-lookup"><span data-stu-id="e96fa-180">For example, "A" assigns this command to CONTROL+SHIFT+A.</span></span> <span data-ttu-id="e96fa-181">此参数是可选的, 仅用于命令。</span><span class="sxs-lookup"><span data-stu-id="e96fa-181">This argument is optional and is used for commands only.</span></span>
  
<span data-ttu-id="e96fa-182">_pxHelpTopic_(**xltypeStr**)</span><span class="sxs-lookup"><span data-stu-id="e96fa-182">_pxHelpTopic_ (**xltypeStr**)</span></span>
  
<span data-ttu-id="e96fa-183">一个可选的对帮助文件 (.chm 或 .hlp) 的引用, 当用户单击 "帮助" 按钮 (显示您的自定义函数时) 时显示。</span><span class="sxs-lookup"><span data-stu-id="e96fa-183">An optional reference to the Help file (.chm or .hlp) to display when the user clicks the Help button (when your custom function is displayed).</span></span> <span data-ttu-id="e96fa-184">可以是格式`filepath!HelpContextID` , 也`https://address/path_to_file_in_site!0`可以是。</span><span class="sxs-lookup"><span data-stu-id="e96fa-184">Can be in the form  `filepath!HelpContextID` or  `https://address/path_to_file_in_site!0`.</span></span> <span data-ttu-id="e96fa-185">"!" 前后的两个部分都是必需的。</span><span class="sxs-lookup"><span data-stu-id="e96fa-185">Both parts before and after the "!" are required.</span></span>  <span data-ttu-id="e96fa-186">值*id*为不能包含单引号, Excel 将由 Excel 转换为4个字节的无符号整数 (以十进制格式表示)。</span><span class="sxs-lookup"><span data-stu-id="e96fa-186">*HelpContextID*  must not contain single quotes, and will be converted by Excel to an unsigned integer 4 bytes long, in decimal form.</span></span> <span data-ttu-id="e96fa-187">使用 URL 表单时, Excel 仅打开引用的帮助文件。</span><span class="sxs-lookup"><span data-stu-id="e96fa-187">When using the URL form, Excel opens only the referenced help file.</span></span> 
  
<span data-ttu-id="e96fa-188">_pxFunctionHelp_(**xltypeStr**)</span><span class="sxs-lookup"><span data-stu-id="e96fa-188">_pxFunctionHelp_ (**xltypeStr**)</span></span>
  
<span data-ttu-id="e96fa-189">在 "函数向导" 中选择自定义函数时描述该函数的可选字符串。</span><span class="sxs-lookup"><span data-stu-id="e96fa-189">An optional string that describes your custom function when it is selected in the Function Wizard.</span></span>
  
<span data-ttu-id="e96fa-190">_pxArgumentHelp1_(**xltypeStr**)</span><span class="sxs-lookup"><span data-stu-id="e96fa-190">_pxArgumentHelp1_ (**xltypeStr**)</span></span>
  
<span data-ttu-id="e96fa-191">可选。</span><span class="sxs-lookup"><span data-stu-id="e96fa-191">Optional.</span></span> <span data-ttu-id="e96fa-192">在函数向导中选择函数时, 描述函数的自定义参数的第一个字符串。</span><span class="sxs-lookup"><span data-stu-id="e96fa-192">The first of the strings that describe the custom arguments of the function when the function is selected in the Function Wizard.</span></span> <span data-ttu-id="e96fa-193">在 Excel 2003 和早期版本中, **xlfRegister**最多可以获取30个参数, 以便您可以仅为函数参数的前20个函数参数提供此帮助。</span><span class="sxs-lookup"><span data-stu-id="e96fa-193">In Excel 2003 and earlier, **xlfRegister** can take, at most, 30 arguments so that you can provide this help for the first 20 of your function arguments only.</span></span> <span data-ttu-id="e96fa-194">从 Excel 2007 开始, **xlfRegister**最长可占用255个参数, 以便您可以为最长为245函数参数提供此帮助。</span><span class="sxs-lookup"><span data-stu-id="e96fa-194">Starting in Excel 2007, **xlfRegister** can take up to 255 arguments so that you can provide this help for up to 245 function parameters.</span></span> 
  
## <a name="property-valuereturn-value"></a><span data-ttu-id="e96fa-195">属性值/返回值</span><span class="sxs-lookup"><span data-stu-id="e96fa-195">Property value/Return value</span></span>

<span data-ttu-id="e96fa-196">如果注册成功, 此函数将返回函数的 register ID (**xltypeNum**), 它可用于对 DLL 中的**xlUDF**和**xlfUnregister**的调用, 或者在 XLM 宏表中**调用**和**注销**。</span><span class="sxs-lookup"><span data-stu-id="e96fa-196">If registration was successful, this function returns the register ID of the function (**xltypeNum**), which can be used in calls to **xlUDF** and **xlfUnregister** in a DLL, or with **CALL** and **UNREGISTER** in an XLM macro sheet.</span></span> <span data-ttu-id="e96fa-197">否则, 它将返回一个 #VALUE!</span><span class="sxs-lookup"><span data-stu-id="e96fa-197">Otherwise, it returns a #VALUE!</span></span> <span data-ttu-id="e96fa-198">误差.</span><span class="sxs-lookup"><span data-stu-id="e96fa-198">error.</span></span> 
  
## <a name="remarks"></a><span data-ttu-id="e96fa-199">注解</span><span class="sxs-lookup"><span data-stu-id="e96fa-199">Remarks</span></span>

### <a name="data-types"></a><span data-ttu-id="e96fa-200">数据类型</span><span class="sxs-lookup"><span data-stu-id="e96fa-200">Data types</span></span>

<span data-ttu-id="e96fa-201">_pxTypeText_参数指定返回值的数据类型, 以及 DLL 函数或代码资源的所有参数的数据类型。</span><span class="sxs-lookup"><span data-stu-id="e96fa-201">The  _pxTypeText_ argument specifies the data type of the return value and the data types of all arguments to the DLL function or code resource.</span></span> <span data-ttu-id="e96fa-202">_pxTypeText_的第一个字符指定返回值的数据类型。</span><span class="sxs-lookup"><span data-stu-id="e96fa-202">The first character of  _pxTypeText_ specifies the data type of the return value.</span></span> <span data-ttu-id="e96fa-203">其余字符指示所有参数的数据类型。</span><span class="sxs-lookup"><span data-stu-id="e96fa-203">The remaining characters indicate the data types of all the arguments.</span></span> <span data-ttu-id="e96fa-204">例如, 返回浮点数并采用整数和浮点数作为参数的 DLL 函数对_pxTypeText_参数需要 "BIB"。</span><span class="sxs-lookup"><span data-stu-id="e96fa-204">For example, a DLL function that returns a floating-point number and takes an integer and a floating-point number as arguments would require "BIB" for the  _pxTypeText_ argument.</span></span> 
  
<span data-ttu-id="e96fa-205">Excel 用于与 xll 交换数据的数据类型和结构在以下两个表中汇总。</span><span class="sxs-lookup"><span data-stu-id="e96fa-205">The data types and structures used by Excel to exchange data with XLLs are summarized in the following two tables.</span></span>
  
<span data-ttu-id="e96fa-206">第一个表列出了在所有版本的 Excel 中支持的类型。</span><span class="sxs-lookup"><span data-stu-id="e96fa-206">The first table lists the types supported in all versions of Excel.</span></span>
  
|<span data-ttu-id="e96fa-207">**数据类型**</span><span class="sxs-lookup"><span data-stu-id="e96fa-207">**Data type**</span></span>|<span data-ttu-id="e96fa-208">**按值传递**</span><span class="sxs-lookup"><span data-stu-id="e96fa-208">**Pass by value**</span></span>|<span data-ttu-id="e96fa-209">**按引用传递（指针）**</span><span class="sxs-lookup"><span data-stu-id="e96fa-209">**Pass by ref (pointer)**</span></span>|<span data-ttu-id="e96fa-210">**Comments**</span><span class="sxs-lookup"><span data-stu-id="e96fa-210">**Comments**</span></span>|
|:-----|:-----|:-----|:-----|
|<span data-ttu-id="e96fa-211">Boolean</span><span class="sxs-lookup"><span data-stu-id="e96fa-211">Boolean</span></span>  <br/> |<span data-ttu-id="e96fa-212">A</span><span class="sxs-lookup"><span data-stu-id="e96fa-212">A</span></span>  <br/> |<span data-ttu-id="e96fa-213">L</span><span class="sxs-lookup"><span data-stu-id="e96fa-213">L</span></span>  <br/> |<span data-ttu-id="e96fa-214">short [int] (0 = false 或 1 = true)</span><span class="sxs-lookup"><span data-stu-id="e96fa-214">short [int] (0=false or 1=true)</span></span>  <br/> |
|<span data-ttu-id="e96fa-215">double</span><span class="sxs-lookup"><span data-stu-id="e96fa-215">double</span></span>  <br/> |<span data-ttu-id="e96fa-216">B</span><span class="sxs-lookup"><span data-stu-id="e96fa-216">B</span></span>  <br/> |<span data-ttu-id="e96fa-217">E</span><span class="sxs-lookup"><span data-stu-id="e96fa-217">E</span></span>  <br/> ||
|<span data-ttu-id="e96fa-218">char \*</span><span class="sxs-lookup"><span data-stu-id="e96fa-218">char \*</span></span>  <br/> ||<span data-ttu-id="e96fa-219">C、F</span><span class="sxs-lookup"><span data-stu-id="e96fa-219">C, F</span></span>  <br/> |<span data-ttu-id="e96fa-220">以 null 结尾的 ASCII 字节字符串</span><span class="sxs-lookup"><span data-stu-id="e96fa-220">Null-terminated ASCII byte string</span></span>  <br/> |
|<span data-ttu-id="e96fa-221">unsigned char \*</span><span class="sxs-lookup"><span data-stu-id="e96fa-221">unsigned char \*</span></span>  <br/> ||<span data-ttu-id="e96fa-222">D、G</span><span class="sxs-lookup"><span data-stu-id="e96fa-222">D, G</span></span>  <br/> |<span data-ttu-id="e96fa-223">计数的 ASCII 字节字符串</span><span class="sxs-lookup"><span data-stu-id="e96fa-223">Counted ASCII byte string</span></span>  <br/> |
|<span data-ttu-id="e96fa-224">unsigned short [int]</span><span class="sxs-lookup"><span data-stu-id="e96fa-224">unsigned short [int]</span></span>  <br/> |<span data-ttu-id="e96fa-225">H</span><span class="sxs-lookup"><span data-stu-id="e96fa-225">H</span></span>  <br/> ||<span data-ttu-id="e96fa-226">16位字</span><span class="sxs-lookup"><span data-stu-id="e96fa-226">16-bit WORD</span></span>  <br/> |
|<span data-ttu-id="e96fa-227">[signed] short [int]</span><span class="sxs-lookup"><span data-stu-id="e96fa-227">[signed] short [int]</span></span>  <br/> |<span data-ttu-id="e96fa-228">I</span><span class="sxs-lookup"><span data-stu-id="e96fa-228">I</span></span>  <br/> |<span data-ttu-id="e96fa-229">M</span><span class="sxs-lookup"><span data-stu-id="e96fa-229">M</span></span>  <br/> |<span data-ttu-id="e96fa-230">16位带符号整数</span><span class="sxs-lookup"><span data-stu-id="e96fa-230">16-bit signed integer</span></span>  <br/> |
|<span data-ttu-id="e96fa-231">[signed long] int</span><span class="sxs-lookup"><span data-stu-id="e96fa-231">[signed long] int</span></span>  <br/> |<span data-ttu-id="e96fa-232">J</span><span class="sxs-lookup"><span data-stu-id="e96fa-232">J</span></span>  <br/> |<span data-ttu-id="e96fa-233">N</span><span class="sxs-lookup"><span data-stu-id="e96fa-233">N</span></span>  <br/> |<span data-ttu-id="e96fa-234">32位带符号整数</span><span class="sxs-lookup"><span data-stu-id="e96fa-234">32-bit signed integer</span></span>  <br/> |
|<span data-ttu-id="e96fa-235">FP</span><span class="sxs-lookup"><span data-stu-id="e96fa-235">FP</span></span>  <br/> ||<span data-ttu-id="e96fa-236">K</span><span class="sxs-lookup"><span data-stu-id="e96fa-236">K</span></span>  <br/> |<span data-ttu-id="e96fa-237">浮点数组结构</span><span class="sxs-lookup"><span data-stu-id="e96fa-237">Floating-point array structure</span></span>  <br/> |
|<span data-ttu-id="e96fa-238">Array</span><span class="sxs-lookup"><span data-stu-id="e96fa-238">Array</span></span>  <br/> ||<span data-ttu-id="e96fa-239">O</span><span class="sxs-lookup"><span data-stu-id="e96fa-239">O</span></span>  <br/> |<span data-ttu-id="e96fa-240">传递了三个参数:</span><span class="sxs-lookup"><span data-stu-id="e96fa-240">Three arguments are passed:</span></span><br/><span data-ttu-id="e96fa-241">-无符号短 int\*</span><span class="sxs-lookup"><span data-stu-id="e96fa-241">- unsigned short int \*</span></span><br/><span data-ttu-id="e96fa-242">-无符号短 int\*</span><span class="sxs-lookup"><span data-stu-id="e96fa-242">- unsigned short int \*</span></span><br/><span data-ttu-id="e96fa-243">-double []</span><span class="sxs-lookup"><span data-stu-id="e96fa-243">- double []</span></span>  <br/> |
|<span data-ttu-id="e96fa-244">XLOPER</span><span class="sxs-lookup"><span data-stu-id="e96fa-244">XLOPER</span></span>  <br/> ||<span data-ttu-id="e96fa-245">P</span><span class="sxs-lookup"><span data-stu-id="e96fa-245">P</span></span>  <br/> |<span data-ttu-id="e96fa-246">变量类型工作表值和数组</span><span class="sxs-lookup"><span data-stu-id="e96fa-246">Variable-type worksheet values and arrays</span></span>  <br/> |
|||<span data-ttu-id="e96fa-247">R</span><span class="sxs-lookup"><span data-stu-id="e96fa-247">R</span></span>  <br/> |<span data-ttu-id="e96fa-248">值、数组和范围引用</span><span class="sxs-lookup"><span data-stu-id="e96fa-248">Values, arrays, and range references</span></span>  <br/> |
   
<span data-ttu-id="e96fa-249">在 Excel 2007 中, 引入了以下数据类型来支持更大的网格和长 Unicode 字符串。</span><span class="sxs-lookup"><span data-stu-id="e96fa-249">In Excel 2007 the following data types were introduced to support the larger grids and long Unicode strings.</span></span>
  
|<span data-ttu-id="e96fa-250">**数据类型**</span><span class="sxs-lookup"><span data-stu-id="e96fa-250">**Data type**</span></span>|<span data-ttu-id="e96fa-251">**按值传递**</span><span class="sxs-lookup"><span data-stu-id="e96fa-251">**Pass by value**</span></span>|<span data-ttu-id="e96fa-252">**按引用传递（指针）**</span><span class="sxs-lookup"><span data-stu-id="e96fa-252">**Pass by ref (pointer)**</span></span>|<span data-ttu-id="e96fa-253">**Comments**</span><span class="sxs-lookup"><span data-stu-id="e96fa-253">**Comments**</span></span>|
|:-----|:-----|:-----|:-----|
|<span data-ttu-id="e96fa-254">无符号短\*</span><span class="sxs-lookup"><span data-stu-id="e96fa-254">unsigned short \*</span></span>  <br/> ||<span data-ttu-id="e96fa-255">C%、F%</span><span class="sxs-lookup"><span data-stu-id="e96fa-255">C%, F%</span></span>  <br/> |<span data-ttu-id="e96fa-256">以 Null 结尾的 Unicode 宽字符字符串</span><span class="sxs-lookup"><span data-stu-id="e96fa-256">Null-terminated Unicode wide-character string</span></span>  <br/> |
|<span data-ttu-id="e96fa-257">无符号短\*</span><span class="sxs-lookup"><span data-stu-id="e96fa-257">unsigned short \*</span></span>  <br/> ||<span data-ttu-id="e96fa-258">D%、G%</span><span class="sxs-lookup"><span data-stu-id="e96fa-258">D%, G%</span></span>  <br/> |<span data-ttu-id="e96fa-259">计数的 Unicode 宽字符字符串</span><span class="sxs-lookup"><span data-stu-id="e96fa-259">Counted Unicode wide-character string</span></span>  <br/> |
|<span data-ttu-id="e96fa-260">FP12</span><span class="sxs-lookup"><span data-stu-id="e96fa-260">FP12</span></span>  <br/> ||<span data-ttu-id="e96fa-261">K%</span><span class="sxs-lookup"><span data-stu-id="e96fa-261">K%</span></span>  <br/> |<span data-ttu-id="e96fa-262">较大的网格浮点数组结构</span><span class="sxs-lookup"><span data-stu-id="e96fa-262">Larger grid floating-point array structure</span></span>  <br/> |
|<span data-ttu-id="e96fa-263">数组</span><span class="sxs-lookup"><span data-stu-id="e96fa-263">Array</span></span>  <br/> ||<span data-ttu-id="e96fa-264">O%</span><span class="sxs-lookup"><span data-stu-id="e96fa-264">O%</span></span>  <br/> |<span data-ttu-id="e96fa-265">传递了三个参数:</span><span class="sxs-lookup"><span data-stu-id="e96fa-265">Three arguments are passed:</span></span><br/><span data-ttu-id="e96fa-266">-有符号\*整数/RW\*</span><span class="sxs-lookup"><span data-stu-id="e96fa-266">- signed int \* / RW \*</span></span><br/><span data-ttu-id="e96fa-267">-已签名\*的 int/COL\*</span><span class="sxs-lookup"><span data-stu-id="e96fa-267">- signed int \* / COL \*</span></span><br/><span data-ttu-id="e96fa-268">-double []</span><span class="sxs-lookup"><span data-stu-id="e96fa-268">- double []</span></span>  <br/> |
|<span data-ttu-id="e96fa-269">XLOPER12</span><span class="sxs-lookup"><span data-stu-id="e96fa-269">XLOPER12</span></span>  <br/> ||<span data-ttu-id="e96fa-270">Q</span><span class="sxs-lookup"><span data-stu-id="e96fa-270">Q</span></span>  <br/> |<span data-ttu-id="e96fa-271">变量类型工作表值和数组</span><span class="sxs-lookup"><span data-stu-id="e96fa-271">Variable-type worksheet values and arrays</span></span>  <br/> |
|||<span data-ttu-id="e96fa-272">U</span><span class="sxs-lookup"><span data-stu-id="e96fa-272">U</span></span>  <br/> |<span data-ttu-id="e96fa-273">值、数组和范围引用</span><span class="sxs-lookup"><span data-stu-id="e96fa-273">Values, arrays, and range references</span></span>  <br/> |
   
<span data-ttu-id="e96fa-274">从 Excel 2010 开始, 引入了以下数据类型:</span><span class="sxs-lookup"><span data-stu-id="e96fa-274">Starting in Excel 2010 the following data types were introduced:</span></span>
  
|<span data-ttu-id="e96fa-275">**数据类型**</span><span class="sxs-lookup"><span data-stu-id="e96fa-275">**Data Type**</span></span>|<span data-ttu-id="e96fa-276">**按值传递**</span><span class="sxs-lookup"><span data-stu-id="e96fa-276">**Pass by value**</span></span>|<span data-ttu-id="e96fa-277">**按引用传递（指针）**</span><span class="sxs-lookup"><span data-stu-id="e96fa-277">**Pass by ref (pointer)**</span></span>|<span data-ttu-id="e96fa-278">**Comments**</span><span class="sxs-lookup"><span data-stu-id="e96fa-278">**Comments**</span></span>|
|:-----|:-----|:-----|:-----|
|<span data-ttu-id="e96fa-279">XLOPER12</span><span class="sxs-lookup"><span data-stu-id="e96fa-279">XLOPER12</span></span>  <br/> ||<span data-ttu-id="e96fa-280">X</span><span class="sxs-lookup"><span data-stu-id="e96fa-280">X</span></span>  <br/> |<span data-ttu-id="e96fa-281">异步句柄用于跟踪 Excel 和 XLL 的挂起的异步函数调用。类型字符串中的参数类型是否存在也将该函数指定为异步。有关异步函数的详细信息, 请参阅[异步用户定义函数](asynchronous-user-defined-functions.md)。</span><span class="sxs-lookup"><span data-stu-id="e96fa-281">The asynchronous handle is used to track a pending asynchronous function call by Excel and the XLL.The existence of the parameter type in the type string also designates the function as asynchronous.For more information about asynchronous functions, see [Asynchronous User-Defined Functions](asynchronous-user-defined-functions.md).</span></span>  <br/> |
   
<span data-ttu-id="e96fa-282">下列字符串类型用于就地修改的参数：**F**、**F%**、**G** 和 **G%**。</span><span class="sxs-lookup"><span data-stu-id="e96fa-282">The string types **F**, **F%**, **G**, and **G%** are used for arguments that are modified-in-place.</span></span> 
  
<span data-ttu-id="e96fa-283">使用上表中显示的数据类型时, 请注意以下事项:</span><span class="sxs-lookup"><span data-stu-id="e96fa-283">When working with the data types displayed in the previous table, be aware of the following:</span></span>
  
- <span data-ttu-id="e96fa-284">C 语言声明假定编译器使用8字节双精度、2字节短整数, 默认情况下为4字节长整数。</span><span class="sxs-lookup"><span data-stu-id="e96fa-284">The C-language declarations assume that your compiler uses 8-byte doubles, 2-byte short integers, and 4-byte long integers by default.</span></span>
    
- <span data-ttu-id="e96fa-285">dll 和代码资源中的所有函数都是使用 **__stdcall**调用约定调用的。</span><span class="sxs-lookup"><span data-stu-id="e96fa-285">All functions in DLLs and code resources are called using the **__stdcall** calling convention.</span></span> 
    
- <span data-ttu-id="e96fa-286">任何按引用返回数据类型的函数, 即, 返回指向某项的指针的任何函数都可以安全地返回 null 指针。</span><span class="sxs-lookup"><span data-stu-id="e96fa-286">Any function that returns a data type by reference, that is, that returns a pointer to something, can safely return a null pointer.</span></span> <span data-ttu-id="e96fa-287">Excel 将 null 指针解释为 #NUM!</span><span class="sxs-lookup"><span data-stu-id="e96fa-287">Excel interprets a null pointer as a #NUM!</span></span> <span data-ttu-id="e96fa-288">误差.</span><span class="sxs-lookup"><span data-stu-id="e96fa-288">error.</span></span>
    
## <a name="additional-data-type-information"></a><span data-ttu-id="e96fa-289">其他数据类型信息</span><span class="sxs-lookup"><span data-stu-id="e96fa-289">Additional data type information</span></span>

<span data-ttu-id="e96fa-290">本节包含有关**E**、 **f**、 **f%**、 **g**、 **g%**、 **K**、 **O**、 **P**、 **Q**、 **R**和**U**数据类型的详细信息, 以及有关 pxTypeText 的其他信息。 __ 参数。</span><span class="sxs-lookup"><span data-stu-id="e96fa-290">This section contains detailed information about the **E**, **F**, **F%**, **G**, **G%**, **K**, **O**, **P**, **Q**, **R**, and **U** data types, and other information about the _pxTypeText_ argument.</span></span> 
  
### <a name="e-data-type"></a><span data-ttu-id="e96fa-291">E 数据类型</span><span class="sxs-lookup"><span data-stu-id="e96fa-291">E data type</span></span>

<span data-ttu-id="e96fa-292">Excel 期望使用 E 数据类型的 DLL 将指针传递到堆栈上的浮点数。</span><span class="sxs-lookup"><span data-stu-id="e96fa-292">Excel expects a DLL using the E data type to pass pointers to floating-point numbers on the stack.</span></span> <span data-ttu-id="e96fa-293">这可能会导致某些语言 (例如, Borland c + +) 出现问题, 预计在协处理器仿真程序堆栈上传递数字。</span><span class="sxs-lookup"><span data-stu-id="e96fa-293">This can cause problems with some languages (for example, Borland C++) that expect the number to be passed on the coprocessor emulator stack.</span></span> <span data-ttu-id="e96fa-294">解决方法是将指针传递给协处理器堆栈上的数字。</span><span class="sxs-lookup"><span data-stu-id="e96fa-294">The workaround is to pass a pointer to the number on the coprocessor stack.</span></span> <span data-ttu-id="e96fa-295">下面的示例演示如何从 Borland c + + 返回一个双精度型。</span><span class="sxs-lookup"><span data-stu-id="e96fa-295">The following example shows how to return a double from Borland C++.</span></span>
  
```cpp
typedef double * lpDbl;
extern "C" lpDbl __stdcall AddDbl(double D1,
    double D2, WORD npDbl)
{
    lpDbl Result;
    Result = (lpDbl)MK_FP(_SS, npDbl);
    *Result = D1 + D2;
    return (Result);
}
```

### <a name="f-f-g-and-g-data-types"></a><span data-ttu-id="e96fa-296">f、f%、g 和 G% 数据类型</span><span class="sxs-lookup"><span data-stu-id="e96fa-296">F, F%, G, and G% data types</span></span>

<span data-ttu-id="e96fa-297">使用**f**、 **f%**、 **g**和**g%** 的数据类型, 函数可以修改由 Excel 分配的字符串缓冲区。</span><span class="sxs-lookup"><span data-stu-id="e96fa-297">With the **F**, **F%**, **G**, and **G%** data types, a function can modify a string buffer that is allocated by Excel.</span></span> <span data-ttu-id="e96fa-298">如果返回值类型代码是这两种类型之一, Excel 将忽略函数返回的值。</span><span class="sxs-lookup"><span data-stu-id="e96fa-298">If the return value type code is one of these types, Excel ignores the value returned by the function.</span></span> <span data-ttu-id="e96fa-299">相反, Excel 会在函数参数列表中搜索第一个相应的数据类型 (**F**、 **f%**、 **g**或**g%**), 然后将分配的字符串缓冲区的当前内容作为返回值。</span><span class="sxs-lookup"><span data-stu-id="e96fa-299">Instead, Excel searches the list of function arguments for the first corresponding data type (**F**, **F%**, **G**, or **G%**) and then takes the current contents of the allocated string buffer as the return value.</span></span> <span data-ttu-id="e96fa-300">excel 的所有版本都会为**f**和**g** ASCII 字符串分配256个字节, 并为**f%** 和**g%** unicode 字符串分配在 excel 2007 65536 字节的开头, 足以满足 unicode 字符。</span><span class="sxs-lookup"><span data-stu-id="e96fa-300">All versions of Excel allocate 256 bytes for **F** and **G** ASCII strings, and starting in Excel 2007 65,536 bytes are allocated, enough for 32,768 Unicode characters, for **F%** and **G%** Unicode strings.</span></span> <span data-ttu-id="e96fa-301">请注意, 缓冲区必须包含 count 字符 (类型**g**和**G%**) 或 null 终止字符 (类型**F**和**F%**), 以使实际的最大字符串长度为255和32767。</span><span class="sxs-lookup"><span data-stu-id="e96fa-301">Remember that the buffers must include a count character (types **G** and **G%**) or a null-termination character (types **F** and **F%**), so that the actual maximum string lengths are 255 and 32,767.</span></span> <span data-ttu-id="e96fa-302">Unicode 字符串, 因此类型**F%** 和**G%** 参数仅适用于 Excel 中的 C API。</span><span class="sxs-lookup"><span data-stu-id="e96fa-302">Unicode strings, and therefore type **F%** and **G%** arguments, are available only through the C API in Excel.</span></span> 
  
### <a name="k-and-k-data-types"></a><span data-ttu-id="e96fa-303">k% 和 k% 的数据类型</span><span class="sxs-lookup"><span data-stu-id="e96fa-303">K and K% data types</span></span>

<span data-ttu-id="e96fa-304">**k**和**K%** 数据类型分别使用指向可变大小的 FP 和 FP12 结构的指针。</span><span class="sxs-lookup"><span data-stu-id="e96fa-304">The **K** and **K%** data types use pointers to the variable-sized FP and FP12 structures respectively.</span></span> <span data-ttu-id="e96fa-305">这些结构是在 XLLCALL 中定义的。水平.</span><span class="sxs-lookup"><span data-stu-id="e96fa-305">These structures are defined in XLLCALL.H.</span></span> <span data-ttu-id="e96fa-306">仅支持在 Excel 2007 中启动 FP12 结构, 因此 type **K%** 参数。</span><span class="sxs-lookup"><span data-stu-id="e96fa-306">FP12 structures, and therefore type **K%** arguments, are only supported starting in Excel 2007.</span></span> 
  
### <a name="o-and-o-data-types"></a><span data-ttu-id="e96fa-307">o 和 o% 的数据类型</span><span class="sxs-lookup"><span data-stu-id="e96fa-307">O and O% data types</span></span>

<span data-ttu-id="e96fa-308">**o**和**o%** 的数据类型仅可用于参数, 而不能返回值, 但可以返回的值是将**o**或**o%** type 参数就地修改。</span><span class="sxs-lookup"><span data-stu-id="e96fa-308">The **O** and **O%** data types can only be used for arguments, not return values, although values can be returned my modifying an **O** or **O%** type argument in place.</span></span> <span data-ttu-id="e96fa-309">每个都传递三个项: 指向数组中的行数的指针、指向数组中的列数的指针以及指向二维浮点数数组的指针。</span><span class="sxs-lookup"><span data-stu-id="e96fa-309">Each passes three items: a pointer to the number of rows in an array, a pointer to the number of columns in an array, and a pointer to a two-dimensional array of floating-point numbers.</span></span> 
  
<span data-ttu-id="e96fa-310">若要修改由 O 或 o% 的数据类型传递的数组, 可以使用 ">O" 或 ">O%" 作为_pxTypeText_参数。</span><span class="sxs-lookup"><span data-stu-id="e96fa-310">To modify an array passed by the O or O% data type in place, you could use ">O" or ">O%" as the  _pxTypeText_ argument.</span></span> <span data-ttu-id="e96fa-311">有关修改数组的详细信息, 请参阅本主题中的 "就地修改: 函数声明为 Void" 一节。</span><span class="sxs-lookup"><span data-stu-id="e96fa-311">For more information about modifying an array, see the "Modifying in Place: Functions Declared as Void" section in this topic.</span></span> 
  
<span data-ttu-id="e96fa-312">**O**数据类型是为与 Fortran dll 的直接兼容性创建的, 后者通过引用传递参数。</span><span class="sxs-lookup"><span data-stu-id="e96fa-312">The **O** data type was created for direct compatibility with Fortran DLLs, which pass arguments by reference.</span></span> 
  
<span data-ttu-id="e96fa-313">**O%** 支持在 excel 2007 中启动, 并适应 excel 支持的更大行数。</span><span class="sxs-lookup"><span data-stu-id="e96fa-313">The **O%** is supported starting in Excel 2007, and accommodates the larger number of rows that Excel supports.</span></span> 
  
### <a name="p-and-q-data-types"></a><span data-ttu-id="e96fa-314">P 和 Q 数据类型</span><span class="sxs-lookup"><span data-stu-id="e96fa-314">P and Q data types</span></span>

<span data-ttu-id="e96fa-315">如果将 DLL 函数参数注册为采用类型**P** XLOPERs 或 type **Q** XLOPER12s, Excel 在准备这些参数时, 会将单个单元格引用转换为简单值和数组多单元格引用。</span><span class="sxs-lookup"><span data-stu-id="e96fa-315">When DLL function arguments are registered as taking type **P** XLOPERs or type **Q** XLOPER12s, Excel converts single-cell references to simple values and multi-cell references to arrays when preparing these arguments.</span></span> <span data-ttu-id="e96fa-316">换言之, **P**和**Q**类型始终会作为以下类型之一到达您的函数: **xltypeNum**、 **xltypeStr**、 **xltypeBool**、 **xltypeErr**、 **xltypeMulti**、 **xltypeMissing**或**xltypeNil**, 而不是**xltypeRef**或**xltypeSRef** , 因为它们总是取消引用。</span><span class="sxs-lookup"><span data-stu-id="e96fa-316">In other words, **P** and **Q** types will always arrive in your function as one of these types: **xltypeNum**, **xltypeStr**, **xltypeBool**, **xltypeErr**, **xltypeMulti**, **xltypeMissing**, or **xltypeNil**, but not **xltypeRef** or **xltypeSRef** because these are always dereferenced.</span></span> <span data-ttu-id="e96fa-317">仅支持在 Excel 2007 中启动**XLOPER12**s, 并因此键入**Q**参数。</span><span class="sxs-lookup"><span data-stu-id="e96fa-317">**XLOPER12**s, and therefore type **Q** arguments, are only supported starting in Excel 2007.</span></span> 
  
<span data-ttu-id="e96fa-318">如果将**xltypeMissing**或**xltypeNil**类型用于返回值, 则 Excel 会将它们解释为数值零。</span><span class="sxs-lookup"><span data-stu-id="e96fa-318">If types **xltypeMissing** or **xltypeNil** are used for return values, they are interpreted by Excel as numeric zero.</span></span> <span data-ttu-id="e96fa-319">当调用方省略参数时, 将传递**xltypeMissing** 。</span><span class="sxs-lookup"><span data-stu-id="e96fa-319">**xltypeMissing** is passed when the caller omits an argument.</span></span> <span data-ttu-id="e96fa-320">当调用方传递对空单元格的引用时, 将传递**xltypeNil** 。</span><span class="sxs-lookup"><span data-stu-id="e96fa-320">**xltypeNil** is passed when the caller passes a reference to an empty cell.</span></span> <span data-ttu-id="e96fa-321">当单元格区域转换为作为**P**或**Q**类型传递的**xltypeMulti**时, 该区域中的任何空白单元格都将转换为**xltypeNil**数组元素。</span><span class="sxs-lookup"><span data-stu-id="e96fa-321">When a range of cells is converted to an **xltypeMulti** to be passed as type **P** or **Q**, any blank cells within the range are converted to **xltypeNil** array elements.</span></span> <span data-ttu-id="e96fa-322">文本数组中缺少的元素类似于作为**xltypeNil**元素传递。</span><span class="sxs-lookup"><span data-stu-id="e96fa-322">Missing elements in a literal array are similarly passed as **xltypeNil** elements.</span></span> 
  
### <a name="volatile-functions-and-recalculation"></a><span data-ttu-id="e96fa-323">可变函数和重新计算</span><span class="sxs-lookup"><span data-stu-id="e96fa-323">Volatile functions and recalculation</span></span>

<span data-ttu-id="e96fa-324">在工作表上, 您可以使 DLL 函数或代码资源变得可变, 以便在每次重新计算工作表时进行重新计算。</span><span class="sxs-lookup"><span data-stu-id="e96fa-324">On a worksheet, you can make a DLL function or code resource volatile, so that it recalculates every time the worksheet recalculates.</span></span> <span data-ttu-id="e96fa-325">若要执行此操作, 请在_pxTypeText_参数中的最后一个参数代码后面添加感叹号 (!)。</span><span class="sxs-lookup"><span data-stu-id="e96fa-325">To do this, add an exclamation mark (!) after the last argument code in the  _pxTypeText_ argument.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="e96fa-326">默认情况下, 采用类型为**R** XLOPERs 或 type **U** XLOPER12s 的函数以及注册为宏表等效项的**#** 函数 (类型; 请参阅下一部分) 在 Excel 中处理为可变的。</span><span class="sxs-lookup"><span data-stu-id="e96fa-326">By default, functions that take type **R** XLOPERs or type **U** XLOPER12s and that are registered as macro sheet equivalents (type **#**; see next section) are handled as volatile in Excel.</span></span> 
  
### <a name="functions-declared-as-void"></a><span data-ttu-id="e96fa-327">声明为 void 的函数</span><span class="sxs-lookup"><span data-stu-id="e96fa-327">Functions declared as void</span></span>

<span data-ttu-id="e96fa-328">在两种情况下, 会调用将函数声明为返回 void 的情况。</span><span class="sxs-lookup"><span data-stu-id="e96fa-328">There are two cases that call for declaring a function as returning void.</span></span> <span data-ttu-id="e96fa-329">在这两种情况下, 函数都通过其他方式返回其结果。</span><span class="sxs-lookup"><span data-stu-id="e96fa-329">In both cases, the function returns its result by other means.</span></span>
  
#### <a name="modifying-in-place"></a><span data-ttu-id="e96fa-330">就地修改</span><span class="sxs-lookup"><span data-stu-id="e96fa-330">Modifying in place</span></span>

<span data-ttu-id="e96fa-331">您可以对_pxTypeText_中的返回类型代码使用一个数字_n_ , 其中_n_是从1到9的数字。</span><span class="sxs-lookup"><span data-stu-id="e96fa-331">You can use a single digit  _n_ for the return type code in  _pxTypeText_, where  _n_ is a number from 1 through 9.</span></span> <span data-ttu-id="e96fa-332">这将指示 Excel 采用_pxTypeText_中的 _n_th 参数所指向的位置中的变量值作为返回值。</span><span class="sxs-lookup"><span data-stu-id="e96fa-332">This instructs Excel to take the value of the variable in the location pointed to by the  _n_th argument in  _pxTypeText_ as the return value.</span></span> <span data-ttu-id="e96fa-333">这也称为就地修改。</span><span class="sxs-lookup"><span data-stu-id="e96fa-333">This is also known as modifying in place.</span></span> <span data-ttu-id="e96fa-334">_n_th 参数必须是一个按引用传递的数据类型 (C、D、E、f、f%、g、g%、k、k%、L、M、n、o、o%、P、Q、R 或 U)。</span><span class="sxs-lookup"><span data-stu-id="e96fa-334">The  _n_th argument must be a pass-by-reference data type (C, D, E, F, F%, G, G%, K, K%, L, M, N, O, O%, P, Q, R, or U).</span></span> <span data-ttu-id="e96fa-335">DLL 函数或代码资源还必须使用 C/c + + 语言中的**void**关键字 (或 Pascal 语言中的**procedure**关键字) 声明。</span><span class="sxs-lookup"><span data-stu-id="e96fa-335">The DLL function or code resource must also be declared with the **void** keyword in the C/C++ languages (or the **procedure** keyword in the Pascal language).</span></span> 
  
<span data-ttu-id="e96fa-336">例如, 如果 DLL 函数采用以 null 结尾的字符串, 而将两个指针指向作为参数的整数, 则可以就地修改该字符串。</span><span class="sxs-lookup"><span data-stu-id="e96fa-336">For example, a DLL function that takes a null-terminated string and two pointers to integers as arguments can modify the string in place.</span></span> <span data-ttu-id="e96fa-337">使用 "1FMM" 作为_pxTypeText_参数, 并将函数声明为 void。</span><span class="sxs-lookup"><span data-stu-id="e96fa-337">Use "1FMM" as the  _pxTypeText_ argument, and declare the function as void.</span></span> 
  
<span data-ttu-id="e96fa-338">早期版本的 Excel 在**\>** _pxTypeText_开始时使用, 以表明该函数被声明为 void, 并且必须就地修改第一个参数, 而没有办法修改除第一个参数之外的任何参数。</span><span class="sxs-lookup"><span data-stu-id="e96fa-338">Previous versions of Excel used **\>** at the start of  _pxTypeText_ to signify that the function was declared as void and that the first argument was to be modified in place—there was no way to modify any argument other than the first.</span></span> <span data-ttu-id="e96fa-339">在当前 Excel 版本中, 等效于 n = 1, 并且仅支持**\>** 在同步函数中使用, 以实现向后兼容性。 __ **\>**</span><span class="sxs-lookup"><span data-stu-id="e96fa-339">The **\>** is equivalent to  _n_ = 1 in current Excel versions and this use of **\>** in synchronous functions is supported for backward compatibility only.</span></span> 
  
#### <a name="asynchronous-functions"></a><span data-ttu-id="e96fa-340">异步函数</span><span class="sxs-lookup"><span data-stu-id="e96fa-340">Asynchronous functions</span></span>

<span data-ttu-id="e96fa-341">使用**pxTypeText**中 X 类型的参数表示的异步函数不从初始函数调用返回其结果。</span><span class="sxs-lookup"><span data-stu-id="e96fa-341">An asynchronous function, denoted by using a parameter of type X in **pxTypeText**, does not return its result from the initial function call.</span></span> <span data-ttu-id="e96fa-342">相反, 您必须将异步函数声明为 void, 随后加载项将通过回调返回结果。</span><span class="sxs-lookup"><span data-stu-id="e96fa-342">Instead, you must declare an asynchronous function as void and later the add-in returns the result through a callback.</span></span> <span data-ttu-id="e96fa-343">异步函数必须使用**\>** **pxTypeText**的开头进行注册。</span><span class="sxs-lookup"><span data-stu-id="e96fa-343">The asynchronous function must be registered by using **\>** at the start of **pxTypeText**.</span></span> <span data-ttu-id="e96fa-344">在异步函数中**\>** , 表示将函数声明为 void, 但并不指示将第一个参数就地修改。</span><span class="sxs-lookup"><span data-stu-id="e96fa-344">In asynchronous functions, **\>** denotes that the function is declared as void, but does not indicate that the first argument is modified in place.</span></span> <span data-ttu-id="e96fa-345">有关异步函数的详细信息, 请参阅[异步用户定义函数](asynchronous-user-defined-functions.md)。</span><span class="sxs-lookup"><span data-stu-id="e96fa-345">For more information about asynchronous functions, see [Asynchronous User-Defined Functions](asynchronous-user-defined-functions.md).</span></span> 

### <a name="registering-worksheet-functions-as-macro-sheet-equivalents-handling-uncalculated-cells"></a><span data-ttu-id="e96fa-346">将工作表函数注册为宏表等效项 (处理未计算所得的单元格)</span><span class="sxs-lookup"><span data-stu-id="e96fa-346">Registering worksheet functions as macro sheet equivalents (handling uncalculated cells)</span></span>

<span data-ttu-id="e96fa-347">在 pxTypeText **#** 中的最后一个参数代码后面__ 放置一个字符, 可为函数提供与宏工作表上的函数相同的调用权限。</span><span class="sxs-lookup"><span data-stu-id="e96fa-347">Placing a **#** character after the last parameter code in  _pxTypeText_ gives the function the same calling permissions as functions on a macro sheet.</span></span> <span data-ttu-id="e96fa-348">这些任务如下：</span><span class="sxs-lookup"><span data-stu-id="e96fa-348">These are as follows:</span></span> 
  
- <span data-ttu-id="e96fa-349">函数可以检索尚未在此重新计算周期中计算的单元格的值。</span><span class="sxs-lookup"><span data-stu-id="e96fa-349">The function can retrieve the values of cells that have not yet been calculated in this recalculation cycle.</span></span>
    
- <span data-ttu-id="e96fa-350">函数可以调用任何 XLM 信息 (Class 2) 函数, 例如, **xlfGetCell**。</span><span class="sxs-lookup"><span data-stu-id="e96fa-350">The function can call any of the XLM information (Class 2) functions, for example, **xlfGetCell**.</span></span>
    
- <span data-ttu-id="e96fa-351">如果数字符号 (#) 不存在, 则计算未计算的单元格将导致**xlretUncalced**错误, 并且在计算完单元格后, 会再次调用当前函数。调用任何 XLM 信息函数而不是**xlfCaller**将导致**xlretInvXlfn**错误。</span><span class="sxs-lookup"><span data-stu-id="e96fa-351">If the number sign (#) is not present: evaluating an uncalculated cell results in an **xlretUncalced** error, and the current function is called again once the cell has been calculated; calling any XLM information function other than **xlfCaller** results in an **xlretInvXlfn** error.</span></span> 
    
### <a name="registering-worksheet-functions-as-thread-safe"></a><span data-ttu-id="e96fa-352">将工作表函数注册为线程安全的</span><span class="sxs-lookup"><span data-stu-id="e96fa-352">Registering worksheet functions as thread-safe</span></span>

<span data-ttu-id="e96fa-353">从 excel 2007 开始, excel 可以执行多线程工作簿重新计算。</span><span class="sxs-lookup"><span data-stu-id="e96fa-353">Starting in Excel 2007, Excel can perform multithreaded workbook recalculation.</span></span> <span data-ttu-id="e96fa-354">这意味着它可以将线程安全函数的不同实例分配给并发线程以进行重新计算。</span><span class="sxs-lookup"><span data-stu-id="e96fa-354">This means that it can assign different instances of a thread-safe function to concurrent threads for reevaluation.</span></span> <span data-ttu-id="e96fa-355">从 Excel 2007 开始, 大多数内置工作表函数都是线程安全的。</span><span class="sxs-lookup"><span data-stu-id="e96fa-355">Starting in Excel 2007, most of the built-in worksheet functions are thread-safe.</span></span> <span data-ttu-id="e96fa-356">从 excel 2007 开始, excel 还允许 xll 将工作表函数注册为线程安全的。</span><span class="sxs-lookup"><span data-stu-id="e96fa-356">Starting in Excel 2007, Excel also allows XLLs to register worksheet functions as thread-safe.</span></span> <span data-ttu-id="e96fa-357">若要执行此操作, **$** 请在_pxTypeText_中的最后一个参数代码之后添加一个字符。</span><span class="sxs-lookup"><span data-stu-id="e96fa-357">To do this, include a **$** character after the last parameter code in  _pxTypeText_.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="e96fa-358">只有工作表函数可以声明为线程安全的。</span><span class="sxs-lookup"><span data-stu-id="e96fa-358">Only worksheet functions can be declared as thread-safe.</span></span> <span data-ttu-id="e96fa-359">Excel 不会认为宏表等效函数是线程安全的, 因此不能将这两个**#** 和**$** 一个字符追加到_pxTypeText_参数。</span><span class="sxs-lookup"><span data-stu-id="e96fa-359">Excel does not consider a macro sheet equivalent function to be thread-safe, so that you cannot append both **#** and **$** characters to the  _pxTypeText_ argument.</span></span> 
  
<span data-ttu-id="e96fa-360">如果将某个函数注册为线程安全的, 则必须确保它以线程安全方式行为, 但 Excel 会通过 C API 拒绝任何不安全的调用。</span><span class="sxs-lookup"><span data-stu-id="e96fa-360">If you have registered a function as thread-safe, you must ensure that it behaves in a thread-safe way, although Excel rejects any thread-unsafe calls via the C API.</span></span> <span data-ttu-id="e96fa-361">例如, 如果线程安全函数尝试调用**xlfGetCell**, 则调用将失败, 并出现**xlretNotThreadSafe**错误。</span><span class="sxs-lookup"><span data-stu-id="e96fa-361">For example, if a thread-safe function tries to call **xlfGetCell**, the call fails with the **xlretNotThreadSafe** error.</span></span> 
  
### <a name="registering-worksheet-functions-as-cluster-safe"></a><span data-ttu-id="e96fa-362">将工作表函数注册为群集安全</span><span class="sxs-lookup"><span data-stu-id="e96fa-362">Registering worksheet functions as cluster-safe</span></span>

<span data-ttu-id="e96fa-363">从 excel 2010 开始, excel 可以将函数调用卸载到指定的计算群集提供程序。</span><span class="sxs-lookup"><span data-stu-id="e96fa-363">Starting in Excel 2010, Excel can offload function calls to a designated compute cluster provider.</span></span> <span data-ttu-id="e96fa-364">有关详细信息, 请参阅[群集安全函数](cluster-safe-functions.md)。</span><span class="sxs-lookup"><span data-stu-id="e96fa-364">For more information, see [Cluster Safe Functions](cluster-safe-functions.md).</span></span> <span data-ttu-id="e96fa-365">如果群集可用, 则任何被注册为群集安全的 XLL 工作表函数都会进入卸载过程中。</span><span class="sxs-lookup"><span data-stu-id="e96fa-365">Any XLL worksheet functions registered as cluster-safe take part in offloading if a cluster is available.</span></span> <span data-ttu-id="e96fa-366">通过在 pxTypeText 参数中的最后一个参数**&amp;** 代码后面添加字符, 可以注册群集__ 安全函数。</span><span class="sxs-lookup"><span data-stu-id="e96fa-366">Cluster-safe functions are registered by including the **&amp;** character after the last parameter code in the  _pxTypeText_ argument.</span></span> 
  
<span data-ttu-id="e96fa-367">如果已将某个函数注册为群集安全的, 则必须确保它以群集安全的方式行为。</span><span class="sxs-lookup"><span data-stu-id="e96fa-367">If you have registered a function as cluster-safe, you must ensure that it behaves in a cluster-safe way.</span></span> <span data-ttu-id="e96fa-368">有关详细信息, 请参阅[群集安全函数](cluster-safe-functions.md)。</span><span class="sxs-lookup"><span data-stu-id="e96fa-368">For more information, see [Cluster Safe Functions](cluster-safe-functions.md).</span></span>
  
> [!NOTE]
> <span data-ttu-id="e96fa-369">只有工作表函数可以声明为群集安全的。</span><span class="sxs-lookup"><span data-stu-id="e96fa-369">Only worksheet functions can be declared as cluster-safe.</span></span> <span data-ttu-id="e96fa-370">Excel 不会认为宏表等效函数是群集安全的, 因此不能将这两个**#** 和**&amp;** 一个字符追加到_pxTypeText_参数。</span><span class="sxs-lookup"><span data-stu-id="e96fa-370">Excel does not consider a macro sheet equivalent function to be cluster-safe, so that you cannot append both **#** and **&amp;** characters to the  _pxTypeText_ argument.</span></span> <span data-ttu-id="e96fa-371">工作表函数既可声明为群集安全的, 也可声明为线程安全。</span><span class="sxs-lookup"><span data-stu-id="e96fa-371">Worksheet functions can be declared as both cluster-safe and thread-safe.</span></span> <span data-ttu-id="e96fa-372">在这种情况下, 在禁用群集卸载时, Excel 将允许这些函数参与多线程计算。</span><span class="sxs-lookup"><span data-stu-id="e96fa-372">In this case, Excel will allow these functions to take part in multithreaded recalculation when cluster offloading is disabled.</span></span> 
  
### <a name="category-names"></a><span data-ttu-id="e96fa-373">类别名称</span><span class="sxs-lookup"><span data-stu-id="e96fa-373">Category names</span></span>

<span data-ttu-id="e96fa-374">使用以下准则确定要在其中放置 XLL 函数的类别。</span><span class="sxs-lookup"><span data-stu-id="e96fa-374">Use the following guidelines to determine which category to put your XLL functions in.</span></span>
  
- <span data-ttu-id="e96fa-375">如果该函数执行的操作可能是用户作为加载项用户界面的一部分, 则应将该函数放在 "**命令**" 类别中。</span><span class="sxs-lookup"><span data-stu-id="e96fa-375">If the function does something that could be done by the user as a part of your add-in user interface, you should put the function in the **Commands** category.</span></span> 
    
- <span data-ttu-id="e96fa-376">如果函数返回有关加载项状态的信息或任何其他有用的信息, 应将该函数放置在**信息**类别中。</span><span class="sxs-lookup"><span data-stu-id="e96fa-376">If the function returns information about the state of the add-in or any other useful information, you should put the function in the **Information** category.</span></span> 
    
- <span data-ttu-id="e96fa-377">外接程序永远不应将函数或命令添加到**用户定义**的类别。</span><span class="sxs-lookup"><span data-stu-id="e96fa-377">An add-in should never add functions or commands to the **User Defined** category.</span></span> <span data-ttu-id="e96fa-378">此类别用于以独占方式使用最终用户。</span><span class="sxs-lookup"><span data-stu-id="e96fa-378">This category is for the exclusive use of end users.</span></span> 
    
<span data-ttu-id="e96fa-379">使用**xlfRegister**的_pxCategory_参数指定类别。</span><span class="sxs-lookup"><span data-stu-id="e96fa-379">The category is specified using the  _pxCategory_ parameter to **xlfRegister**.</span></span> <span data-ttu-id="e96fa-380">它可以是与硬编码的标准类别之一相对应的数字或文本, 也可以是 DLL 指定的新类别的文本。</span><span class="sxs-lookup"><span data-stu-id="e96fa-380">This can be a number or text that corresponds to one of the hard-coded standard categories, or the text of a new category specified by the DLL.</span></span> <span data-ttu-id="e96fa-381">如果给定的文本尚不存在, 则 Excel 将使用该名称创建一个新类别。</span><span class="sxs-lookup"><span data-stu-id="e96fa-381">If the text given does not already exist, Excel creates a new category with that name.</span></span>
  
<span data-ttu-id="e96fa-382">下表列出了从工作表中查看 "**粘贴函数**" 对话框时可见的标准类别。</span><span class="sxs-lookup"><span data-stu-id="e96fa-382">The following table lists the standard categories that are visible when you view the **Paste Function** dialog box from within a worksheet.</span></span> 
  
|<span data-ttu-id="e96fa-383">**Number**</span><span class="sxs-lookup"><span data-stu-id="e96fa-383">**Number**</span></span>|<span data-ttu-id="e96fa-384">**Text**</span><span class="sxs-lookup"><span data-stu-id="e96fa-384">**Text**</span></span>|
|:-----|:-----|
|<span data-ttu-id="e96fa-385">1</span><span class="sxs-lookup"><span data-stu-id="e96fa-385">1</span></span>  <br/> |<span data-ttu-id="e96fa-386">财务</span><span class="sxs-lookup"><span data-stu-id="e96fa-386">Financial</span></span>  <br/> |
|<span data-ttu-id="e96fa-387">双面</span><span class="sxs-lookup"><span data-stu-id="e96fa-387">2</span></span>  <br/> |<span data-ttu-id="e96fa-388">日期&amp;时间</span><span class="sxs-lookup"><span data-stu-id="e96fa-388">Date &amp; Time</span></span>  <br/> |
|<span data-ttu-id="e96fa-389">第三章</span><span class="sxs-lookup"><span data-stu-id="e96fa-389">3</span></span>  <br/> |<span data-ttu-id="e96fa-390">数学&amp;三角函数</span><span class="sxs-lookup"><span data-stu-id="e96fa-390">Math &amp; Trig</span></span>  <br/> |
|<span data-ttu-id="e96fa-391">4</span><span class="sxs-lookup"><span data-stu-id="e96fa-391">4</span></span>  <br/> |<span data-ttu-id="e96fa-392">文本</span><span class="sxs-lookup"><span data-stu-id="e96fa-392">Text</span></span>  <br/> |
|<span data-ttu-id="e96fa-393">5</span><span class="sxs-lookup"><span data-stu-id="e96fa-393">5</span></span>  <br/> |<span data-ttu-id="e96fa-394">合理</span><span class="sxs-lookup"><span data-stu-id="e96fa-394">Logical</span></span>  <br/> |
|<span data-ttu-id="e96fa-395">型</span><span class="sxs-lookup"><span data-stu-id="e96fa-395">6</span></span>  <br/> |<span data-ttu-id="e96fa-396">查找&amp;引用</span><span class="sxs-lookup"><span data-stu-id="e96fa-396">Lookup &amp; Reference</span></span>  <br/> |
|<span data-ttu-id="e96fa-397">步</span><span class="sxs-lookup"><span data-stu-id="e96fa-397">7</span></span>  <br/> |<span data-ttu-id="e96fa-398">Database</span><span class="sxs-lookup"><span data-stu-id="e96fa-398">Database</span></span>  <br/> |
|<span data-ttu-id="e96fa-399">utf-8</span><span class="sxs-lookup"><span data-stu-id="e96fa-399">8</span></span>  <br/> |<span data-ttu-id="e96fa-400">统计学</span><span class="sxs-lookup"><span data-stu-id="e96fa-400">Statistical</span></span>  <br/> |
|<span data-ttu-id="e96fa-401">第</span><span class="sxs-lookup"><span data-stu-id="e96fa-401">9</span></span>  <br/> |<span data-ttu-id="e96fa-402">信息</span><span class="sxs-lookup"><span data-stu-id="e96fa-402">Information</span></span>  <br/> |
|<span data-ttu-id="e96fa-403">日</span><span class="sxs-lookup"><span data-stu-id="e96fa-403">14</span></span>  <br/> |<span data-ttu-id="e96fa-404">用户定义</span><span class="sxs-lookup"><span data-stu-id="e96fa-404">User Defined</span></span>  <br/> |
||<span data-ttu-id="e96fa-405">工程 (从 Excel 2007 开始)</span><span class="sxs-lookup"><span data-stu-id="e96fa-405">Engineering (starting in Excel 2007)</span></span>  <br/> |
||<span data-ttu-id="e96fa-406">多维数据集 (从 Excel 2007 中开始)</span><span class="sxs-lookup"><span data-stu-id="e96fa-406">Cube (starting in Excel 2007)</span></span>  <br/> |
   
<span data-ttu-id="e96fa-407">此外, 当您在宏表中查看 "**粘贴函数**" 对话框时, 也会看到这些类别。</span><span class="sxs-lookup"><span data-stu-id="e96fa-407">In addition, these categories are also visible when you view the **Paste Function** dialog box from within a macro sheet.</span></span> 
  
|<span data-ttu-id="e96fa-408">**Number**</span><span class="sxs-lookup"><span data-stu-id="e96fa-408">**Number**</span></span>|<span data-ttu-id="e96fa-409">**Text**</span><span class="sxs-lookup"><span data-stu-id="e96fa-409">**Text**</span></span>|
|:-----|:-----|
|<span data-ttu-id="e96fa-410">10</span><span class="sxs-lookup"><span data-stu-id="e96fa-410">10</span></span>  <br/> |<span data-ttu-id="e96fa-411">命令</span><span class="sxs-lookup"><span data-stu-id="e96fa-411">Commands</span></span>  <br/> |
|<span data-ttu-id="e96fa-412">11x17</span><span class="sxs-lookup"><span data-stu-id="e96fa-412">11</span></span>  <br/> |<span data-ttu-id="e96fa-413">DDE/外部</span><span class="sxs-lookup"><span data-stu-id="e96fa-413">DDE/External</span></span>  <br/> |
|<span data-ttu-id="e96fa-414">12</span><span class="sxs-lookup"><span data-stu-id="e96fa-414">12</span></span>  <br/> |<span data-ttu-id="e96fa-415">个性化</span><span class="sxs-lookup"><span data-stu-id="e96fa-415">Customizing</span></span>  <br/> |
|<span data-ttu-id="e96fa-416">13</span><span class="sxs-lookup"><span data-stu-id="e96fa-416">13</span></span>  <br/> |<span data-ttu-id="e96fa-417">宏控件</span><span class="sxs-lookup"><span data-stu-id="e96fa-417">Macro Control</span></span>  <br/> |
   
### <a name="example"></a><span data-ttu-id="e96fa-418">示例</span><span class="sxs-lookup"><span data-stu-id="e96fa-418">Example</span></span>

<span data-ttu-id="e96fa-419">请参阅中`\SAMPLES\GENERIC\GENERIC.C`的**xlAutoOpen**函数的代码。</span><span class="sxs-lookup"><span data-stu-id="e96fa-419">See the code for the **xlAutoOpen** function in  `\SAMPLES\GENERIC\GENERIC.C`.</span></span>
  
## <a name="see-also"></a><span data-ttu-id="e96fa-420">另请参阅</span><span class="sxs-lookup"><span data-stu-id="e96fa-420">See also</span></span>

- [<span data-ttu-id="e96fa-421">REGISTER.ID</span><span class="sxs-lookup"><span data-stu-id="e96fa-421">REGISTER.ID</span></span>](xlfregisterid.md)
- [<span data-ttu-id="e96fa-422">注销</span><span class="sxs-lookup"><span data-stu-id="e96fa-422">UNREGISTER</span></span>](xlfunregister-form-1.md)
- [<span data-ttu-id="e96fa-423">实用的基本 C API XLM 函数</span><span class="sxs-lookup"><span data-stu-id="e96fa-423">Essential and Useful C API XLM Functions</span></span>](essential-and-useful-c-api-xlm-functions.md)

