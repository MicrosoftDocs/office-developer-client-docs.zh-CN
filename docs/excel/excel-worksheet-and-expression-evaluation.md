---
title: Excel ������ͱ��ʽ��ֵ
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: overview
keywords:
- expression evaluation [excel 2007],errors in worksheets [Excel 2007],long Unicode strings [Excel 2007],evaluating expressions [Excel 2007],evaluating worksheets [Excel 2007],worksheet evaluation [Excel 2007],worksheet errors [Excel 2007]
localization_priority: Normal
ms.assetid: 47b46a7d-6cfb-4f5b-946d-e0164d18512a
description: ���÷�Χ�� Excel 2013?| Office 2013?| Visual Studio
ms.openlocfilehash: 543ff7fcbc88253dafd7fc6e7000bf9657d8c258
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/11/2018
ms.locfileid: "19773723"
---
# <a name="excel-worksheet-and-expression-evaluation"></a>Excel ������ͱ��ʽ��ֵ

 **适用于**： Excel 2013 |Office 2013 |Visual Studio 
  
Microsoft Excel ������ĵ�Ԫ�����ݽ���������ĸ���������������֮һ��
  
- **Numbers**
    
- **Boolean TRUE** �� **FALSE**
    
- **Strings**
    
- **Errors**
    
��Щ���͵Ļ����������Ҳ������Ϊ�������뵽��ʽ�У�����Ϊ���鹫ʽ�п�Խ�����Ԫ���ֵ��
  
当内容在单元格中输入用户 （或命令宏） 时，Excel 将尝试解释输入，并显示一条错误消息，如果它不能。 如果输入开头的字符串前缀 （单引号） Excel 将输入的所有字符都放在单元格，如附带没有任何修改。 （不显示的字符串的前缀。）如果输入开头**=**， **+**，或**-**，Excel 尝试将公式作为输入解释。 如果语法不正确或评估已停止，则显示错误，并且单元格置于编辑模式。 否则，Excel 尝试标识、 转换和评估运算符、 函数名称和它们的参数。 
  
��Ӧ�������֮ǰ���Բ����������ҽ��м��㡣��������ȼ�������������ڲ㣨Ƕ����ࣩ��ʼ�Ժ������м��㡣������ܽ�������������������ת��ΪԤ�ڵ����ͣ������ʧ�ܣ������� **#VALUE!** ���󡣵�ϵͳ�������ƣ�������һ������ֵ��ʶ��Ϊ������������ƻ��ǩʱ�����㽫ʧ�ܣ����ᵼ�� **#NAME?** ���� 
  
������벻���κ���Щ���ݿ�ͷ��Excel �������������֪ģʽ�������ڡ�ʱ�䡢���ҽ��ٷֱȻ����֣����м�飬����Ӧ�ؽ��н��͡������ض����������ò�ȡ�Ĵ����ʽ�������Щ����û���κ����壬Excel ����ͷ���ǽ�������Ϊ�ַ��������������ڵ�Ԫ���б��ֲ��䡣
  
Excel ֧�������������ͣ������Ե��Ƿ�Χ���á������㲻ʹ�����ò�����������ͺ����Ĳ���ʱ���򵱵�Ԫ��ʽ�еı��ʽ����Ϊһ������ʱ��Excel ��������ת��Ϊ���õ���Ԫ���ֵ��
  
Excel ͨ�� XLM ���� **EVALUATE** ���� C API ��Ч�� **xlfEvaluate**���ܹ����κ���Ч���ַ����ַ������ٵ��ĸ������Ĺ�������������֮һ������֮�⣬�˺����ṩ���� DLL �����е���������ļ򵥷������˺�����ǰ����ʾ������Ϣ�����õ�Ԫ��༭����Ϊ��ͬ��������ʽ����ʧ�ܣ��ú����� **#VALUE!** ���� 
  
## <a name="numbers"></a>����

Excel �е����й��������ڲ���ʾΪ 8 �ֽ�˫���ȸ��������������е����������ǣ��� Excel �е���Щ���ֵ�ʵ�ֲ�����ȫ��� IEEE�����±���ʾ��
  
|**����**|**���ֵ**|**��Сֵ**|
|:-----|:-----|:-----|
|IEEE 8 �ֽ�˫����ֵ  <br/> |1.7976931348623157 E + 308  <br/> |2.2250738585072014 E-308  <br/> |
|���������������ճ��ֵ���أ�  <br/> |1.7976931348623157 E + 308  <br/> |2.22507385850721 E-308  <br/> |
|��������ֶ����룩  <br/> |9.99999999999999 E + 307  <br/> |2.22507385850721 E-308  <br/> |
   
IEEE С������ֵ��Χ����ֵ������ 2.2250738585072009E�C308 �� 4.9406564584124654E�C324 ��Χ�ڵ���ֵ���� Excel �������ڲ���֧�֣����� VBA ˫����ֵ��֧�֡�
  
如果 DLL 函数返回 + /-无穷大或无效的双 IEEE，Excel 将其转换为 **#NUM ！**。 所有 subnormal 号码以及小于最小正普通在 Excel 中的号码转换为正零。 IEEE 负零都支持，即，它可以由 DLL 函数返回并显示为 **-0**。 (**\<** 运算符不会检查负零，因此 **= A1\<0**计算结果为**TRUE** ，如果 A1 包含负零)。 
  
��ע�⣬ĳЩ���ָ�ʽ����Щ�涨��ȣ����Ƹ�Ϊ�ϸ����磬���ں�ʱ�䡣��ʵ�ϣ������������Ǹ����������������ڼ�������¿��ܻ�������������������ȷ���ӦΪ������
  
## <a name="long-unicode-strings"></a>������ Unicode �ַ���

�û��� Excel �п��Կ����������ַ���Ŀǰ���ж���汾���ڲ��洢Ϊ Unicode �ַ�����Unicode �������ַ�������Ϊ 32767 (2<sup>15</sup>-1) ���ַ����ȣ����ҿ��԰����κ���Ч�� Unicode �ַ��� 
  
���״����� C API ʱ���������ַ������ֽ��ַ�������������Ϊ 255 ���ַ����ڣ����� C API �ɷ�ӳ��Щ���ơ�ͨ��ʹ�� Excel 2007��C API ���º󣬿ɴ��� Excel ������ Unicode �ַ���������ζ�Ų�����ȷ��ʽע��� DLL �������Խ��� Unicode ���������� Unicode �ַ�����
  
> [!NOTE]
> [!ע��] Ϊ�������ݣ�C API ����Ȼ��ȫ֧���ֽ��ַ��������������Ծ���ͬ���� 255 ���ַ����ơ� 
  
## <a name="returning-errors"></a>���ش���

����޷������������������ת��Ϊ��ȷ�����ͣ���������޷�ʶ�������Ѷ�������ƣ�Excel �Ե�Ԫ��ļ�������������ַ���ǰ�涼�ѽ��ܹ���������ù����������������������ϣ�����Ҳ�ᵼ�³��������֪�û����ϵ����͡���Ӧ����������ӳ������������� Excel �е���Ϊһ�µĴ���
  
### <a name="null"></a>#NULL!

**#NULL!** ������һЩ XLM ��Ϣ�������ء����磬�����صĴ�����û�д�ӡ����װ���ʱ�����ô��в��� 78 �� **GET.DOCUMENT(78)** ���Ч�� C API ���� **xlfGetDocument**���ô��󻹿���ĳЩ�������أ����磬�ڼ�����ַ���ʱ���� 
  
��û���κ����������ƺ���ʱ����������Ҫ��������ӳ��������ش˴���
  
### <a name="div0"></a>#DIV/0!

�����ĸ�ļ�����Ϊ�����һ��С���޷��� Excel �б�ʾΪ�������ֵʱ��Excel ��������������� **#DIV/0!** ����ĳЩ���ݶ����漰�������ĺ��������ܷ��ش˴������磬��û���κ��������ת��Ϊ����ʱ�� **AVERAGE** �����ش˴��� 
  
��ֻ�迼�Ǵ�������ӳ��������ص����ִ�����ָʾ��⵽���������ĳ�����
  
### <a name="value"></a>#VALUE!

����������������������ת��Ϊ��������ͣ�Excel ������ **#VALUE!** �������������������ת��������  `=LN("X")`����Excel �Ͳ�����ú������롣�ڱ�д�͵����Լ�����ӳ�����ʱ������μ���һ�㡣 
  
������������ں���������ת����ĳЩ�����᷵�ش˴������磬���ܲ�����������ȷ�ģ� `DATEVALUE("30-Feb-2007")` Ҳ����˴��������ʧ�ܡ�����������£��ú���������������еĴ��󡣼�ʹֵ���ͺͷ�Χ��������ģ�ĳЩ�����Ի᷵�ش˴�������  `FIND("a","xyz")` �᷵�ش˴��� 
  
��Ӧ���Ǵ�������ӳ��������ش˴�����ָʾ�������������޷�������ת��Ϊ��ȷ�����ͻ򳬳��˷�Χ�Ĵ�����Ȼ��ҲӦ�ÿ��Ƿ�����ֵ����������Χ�� **#NUM!** ������Ӧ����������������������״���С����ʱ���ش˴��� 
  
### <a name="ref"></a>#REF!

�������ʽ���Ƶ����ɵ�������ó������Ƶ�λ��ʱ��Excel �ڸñ��ʽ������ **#REF!** �������磬�����Ԫ�� B2 �а�����ʽ  `=A1`�����˹�ʽ���Ƶ���Ԫ�� B1 �ᵼ�����ɹ�ʽ **=#REF!** ���˴���Ҳ������һЩ��ʽ�����а���ͨ��ʹ�ü��к�ճ���������ǵ����ã��������С��л�����ɾ����ɾ�������á���Щ�ܷ�����Щ���õĺ������Է��ش˴������磬 `OFFSET(A1,-1,-1)`�������а��������Ч���õĹ���������Ҳ����Դ˴����������
  
���������ӳ������������ò�������Ӧ�������������Ч����������յ������ô����践�ش˴���[Memory Management in Excel](memory-management-in-excel.md)���й� XLOPER/XLOPER12s �Ĳ��ֽ�������δ����ɽ��ܲ��������ò����ĺ����� 
  
### <a name="name"></a>#NAME?

�����ʽ�а���δ��ʶ��Ϊ������������Ƶ�����ʱ��Excel ���� **#NAME?** �������������ӳ��������Է����Ѷ�������ƣ�����ʵ��ȴ��δ���壬��Ӧ���Ƿ��ش˴��� 
  
### <a name="num"></a>#NUM!

����ֵ���벻������ķ�Χ�����磬 **** ����Excel ��������������ֺ���ѧ�������᷵�� `LN(0)`����Ӧ�ÿ��Ǵ�������ӳ������з��ش˴�����ָʾ����������Ч�򳬳���Χ��
  
### <a name="na"></a>#N/A

ͨ������ **#N/A** ��������ָʾ�ɹ���������Ľ���ǲ����õġ����磬����Ҳ�����ȷƥ�������������������� MATCH �����ش˴��󡣴��⣬������ʹ�ú��� **NA** ���ɴ˴��󣬲�ʹ�ú��� **ISNA** ר�Ŷ�����м�⡣��ˣ��������г������ִ�����ָʾ�ض���Ӧ�ó����������Χ��
  
## <a name="see-also"></a>�������



[Excel Programming Concepts](excel-programming-concepts.md)
  
[�� Excel ��ʹ�� C API ���б��](programming-with-the-c-api-in-excel.md)
  
[Evaluating Names and Other Worksheet Formula Expressions](evaluating-names-and-other-worksheet-formula-expressions.md)
  
[Excel XLL SDK API Function Reference](excel-xll-sdk-api-function-reference.md)

