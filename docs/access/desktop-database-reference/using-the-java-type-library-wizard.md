---
title: 使用 Java 类型库向导
TOCTitle: Using the Java Type Library Wizard
ms:assetid: 96af770c-c7c2-c905-3c3e-383a5b99cab2
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249670(v=office.15)
ms:contentKeyID: 48546455
ms.date: 09/18/2015
mtps_version: v=office.15
ms.openlocfilehash: 233e1a9e6237500b3d13e3234e7c6ddf4d556abc
ms.sourcegitcommit: c557bbcccf37a6011f89aae1ddd399dfe549d087
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 10/31/2018
ms.locfileid: "25884133"
---
# <a name="using-the-java-type-library-wizard"></a><span data-ttu-id="df71e-102">使用 Java 类型库向导</span><span class="sxs-lookup"><span data-stu-id="df71e-102">Using the Java Type Library Wizard</span></span>


<span data-ttu-id="df71e-103">**适用于**： Access 2013、 Office 2013</span><span class="sxs-lookup"><span data-stu-id="df71e-103">**Applies to**: Access 2013, Office 2013</span></span>

<span data-ttu-id="df71e-104">Java 类型库向导是一项功能的 Visual J + + 1.x，集成开发环境的**工具**菜单。</span><span class="sxs-lookup"><span data-stu-id="df71e-104">The Java Type Library Wizard is a feature of Visual J++ 1.x, integrated into the **Tools** menu of the development environment.</span></span> <span data-ttu-id="df71e-105">其用途是搜索类型库创建一个允许访问 COM 对象的 Java 接口。</span><span class="sxs-lookup"><span data-stu-id="df71e-105">Its purpose is to search a type library and create a Java interface that allows access to COM objects.</span></span> <span data-ttu-id="df71e-106">对于 Visual J + + 6.0，已使用[ADO for Windows Foundation Classes](ado-wfc-programming.md)取代 Java 类型库向导。</span><span class="sxs-lookup"><span data-stu-id="df71e-106">For Visual J++ 6.0, the Java Type Library Wizard has been replaced with [ADO for Windows Foundation Classes](ado-wfc-programming.md).</span></span>

<span data-ttu-id="df71e-p102">Java 类型库向导的执行效果与 [Microsoft SDK for Java](using-the-microsoft-sdk-for-java.md) 中的命令行工具类似。不过，您不能进入向导所生成的类包装中，这一点与 Microsoft SDK for Java 所生成的类包装不同。</span><span class="sxs-lookup"><span data-stu-id="df71e-p102">The Java Type Library Wizard produces similar results as the command-line tools included with the [Microsoft SDK for Java](using-the-microsoft-sdk-for-java.md). However, you cannot step into the class wrappers that the Wizard generates, unlike the class wrappers generated by the Microsoft SDK for Java.</span></span>

<span data-ttu-id="df71e-109">Java 类型库向导生成的类在以下位置： \\ \<windows 目录\>\\Java\\trustlib\\msado15。</span><span class="sxs-lookup"><span data-stu-id="df71e-109">The Java Type Library Wizard generates the classes in the following location: \\\<windows directory\>\\Java\\trustlib\\msado15.</span></span> <span data-ttu-id="df71e-110">生成类的目录下的 Summary.txt 文件显示了所生成的类定义。</span><span class="sxs-lookup"><span data-stu-id="df71e-110">The Summary.txt file, located in the directory where the classes were generated, shows the class definitions it generated.</span></span>

<span data-ttu-id="df71e-p104">Java 类型库向导将在任何给定类型库中发现的枚举类型转换为 INT（整数）类型。它还定义一个接口，对应于类型库中的每个枚举类型。您可以用以下语法引用 ADO 枚举类型的值：</span><span class="sxs-lookup"><span data-stu-id="df71e-p104">The Java Type Library Wizard converts enumerated types, found in any given type library, to type INT (integer). It also defines an interface that corresponds to each enumerated type in the type library. You can reference the values of an ADO enumerated type with the following syntax:</span></span>

```vb 
 
msado15.<Enum Name>.<constant Name> 
```

<span data-ttu-id="df71e-114">以设置 **Command** 对象的 **CommandType** 属性为例，其代码片断如下：</span><span class="sxs-lookup"><span data-stu-id="df71e-114">An example of this is shown in the following code fragment for setting the **CommandType** property of a **Command** object:</span></span>

```vb 
 
Cmd1.putCommandType( msado15.CommandTypeEnum.adCmdStoredProc ); 
```

<span data-ttu-id="df71e-p105">或者，您也可以从 Java 类型库向导所生成的枚举类型包装继承 ADO 对象和枚举值。如果这么做，那么可以从语法中删除"msado15."。不过，类必须从它所引用的每个 Java 对象和枚举类型接口继承，以完全避免在所有 ADO 对象和枚举值之前引用 msado15.\*。</span><span class="sxs-lookup"><span data-stu-id="df71e-p105">Alternately, you could inherit from the enumerated type wrapper generated by the Java Type Library Wizard. If so, you could remove "msado15." from the syntax. However, your class would need to inherit from each Java object and enumerated type interface that it references to completely eliminate the need to reference msado15.\* in front of all ADO objects and enumerated values.</span></span>

<span data-ttu-id="df71e-119">有关更多示例代码，请参阅 [ADO Java 类包装](ado-java-class-wrappers.md)。</span><span class="sxs-lookup"><span data-stu-id="df71e-119">For more sample code, see [ADO Java Class Wrappers](ado-java-class-wrappers.md).</span></span>

<span data-ttu-id="df71e-120">**若要从 Visual J + + 版本 1.\*x 运行 Java 类型库向导**\*</span><span class="sxs-lookup"><span data-stu-id="df71e-120">**To run the Java Type Library Wizard from Visual J++ version 1.\*x**\*</span></span>

1.  <span data-ttu-id="df71e-121">从**工具**菜单中，选择**Java 类型库向导**。</span><span class="sxs-lookup"><span data-stu-id="df71e-121">From the **Tools** menu, select **Java Type Library Wizard**.</span></span>

2.  <span data-ttu-id="df71e-122">选择"Microsoft ActiveX 数据对象库"，然后单击**确定**。</span><span class="sxs-lookup"><span data-stu-id="df71e-122">Select "Microsoft ActiveX Data Objects Library" and click **OK**.</span></span> <span data-ttu-id="df71e-123">此立即 (re) 生成文件\\ADO trustlib 目录 (默认情况下，c： 在\\可以对\\java\\trustlib\\msado15)。</span><span class="sxs-lookup"><span data-stu-id="df71e-123">This now (re)generates files in the \\trustlib directory for ADO (by default at c:\\winnt\\java\\trustlib\\msado15).</span></span> <span data-ttu-id="df71e-124">如果您使用 Microsoft SDK for Java 已生成类的 ADO，它们将使用 Java 类型库向导来自被替换。</span><span class="sxs-lookup"><span data-stu-id="df71e-124">If you used the Microsoft SDK for Java to already generate classes for ADO, they will be replaced with those from the Java Type Library Wizard.</span></span>

3.  <span data-ttu-id="df71e-125">若要使用这些文件，打开您的项目在 Visual J + + 中。</span><span class="sxs-lookup"><span data-stu-id="df71e-125">To use these files, open your project in Visual J++.</span></span> <span data-ttu-id="df71e-126">从**项目**菜单中，选择**添加到项目**。</span><span class="sxs-lookup"><span data-stu-id="df71e-126">From the **Project** menu, choose **Add To Project**.</span></span> <span data-ttu-id="df71e-127">选择**文件**，然后添加的所有。JAVA 文件中生成\\trustlib 目录 (默认情况下，c： 在\\可以对\\java\\trustlib\\msado15) 向您的项目。</span><span class="sxs-lookup"><span data-stu-id="df71e-127">Select **Files**, and add all of the .JAVA files generated in the \\trustlib directory (by default at c:\\winnt\\java\\trustlib\\msado15) to your project.</span></span>

