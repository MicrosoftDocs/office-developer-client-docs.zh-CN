---
title: 使用 Java 类型库向导
TOCTitle: Using the Java Type Library Wizard
ms:assetid: 96af770c-c7c2-c905-3c3e-383a5b99cab2
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249670(v=office.15)
ms:contentKeyID: 48546455
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: a27491acabd19f688eca4159a36dcfcfc486a026
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/23/2019
ms.locfileid: "32312080"
---
# <a name="using-the-java-type-library-wizard"></a><span data-ttu-id="c2bfc-102">使用 Java 类型库向导</span><span class="sxs-lookup"><span data-stu-id="c2bfc-102">Using the Java Type Library Wizard</span></span>


<span data-ttu-id="c2bfc-103">**适用于**：Access 2013、Office 2013</span><span class="sxs-lookup"><span data-stu-id="c2bfc-103">**Applies to**: Access 2013, Office 2013</span></span>

<span data-ttu-id="c2bfc-p101">The Java Type Library Wizard is a feature of Visual J++ 1.x, integrated into the **Tools** menu of the development environment. Its purpose is to search a type library and create a Java interface that allows access to COM objects. For Visual J++ 6.0, the Java Type Library Wizard has been replaced with [ADO for Windows Foundation Classes](ado-wfc-programming.md).</span><span class="sxs-lookup"><span data-stu-id="c2bfc-p101">The Java Type Library Wizard is a feature of Visual J++ 1.x, integrated into the **Tools** menu of the development environment. Its purpose is to search a type library and create a Java interface that allows access to COM objects. For Visual J++ 6.0, the Java Type Library Wizard has been replaced with [ADO for Windows Foundation Classes](ado-wfc-programming.md).</span></span>

<span data-ttu-id="c2bfc-p102">Java 类型库向导的执行效果与 [Microsoft SDK for Java](using-the-microsoft-sdk-for-java.md) 中的命令行工具类似。不过，您不能进入向导所生成的类包装中，这一点与 Microsoft SDK for Java 所生成的类包装不同。</span><span class="sxs-lookup"><span data-stu-id="c2bfc-p102">The Java Type Library Wizard produces similar results as the command-line tools included with the [Microsoft SDK for Java](using-the-microsoft-sdk-for-java.md). However, you cannot step into the class wrappers that the Wizard generates, unlike the class wrappers generated by the Microsoft SDK for Java.</span></span>

<span data-ttu-id="c2bfc-109">Java 类型库向导在以下位置生成类: \\ \<windows directory\>\\Java\\trustlib\\msado15.dll。</span><span class="sxs-lookup"><span data-stu-id="c2bfc-109">The Java Type Library Wizard generates the classes in the following location: \\\<windows directory\>\\Java\\trustlib\\msado15.</span></span> <span data-ttu-id="c2bfc-110">生成类的目录下的 Summary.txt 文件显示了所生成的类定义。</span><span class="sxs-lookup"><span data-stu-id="c2bfc-110">The Summary.txt file, located in the directory where the classes were generated, shows the class definitions it generated.</span></span>

<span data-ttu-id="c2bfc-p104">Java 类型库向导将在任何给定类型库中发现的枚举类型转换为 INT（整数）类型。它还定义一个接口，对应于类型库中的每个枚举类型。您可以用以下语法引用 ADO 枚举类型的值：</span><span class="sxs-lookup"><span data-stu-id="c2bfc-p104">The Java Type Library Wizard converts enumerated types, found in any given type library, to type INT (integer). It also defines an interface that corresponds to each enumerated type in the type library. You can reference the values of an ADO enumerated type with the following syntax:</span></span>

```vb 
 
msado15.<Enum Name>.<constant Name> 
```

<span data-ttu-id="c2bfc-114">以设置 **Command** 对象的 **CommandType** 属性为例，其代码片断如下：</span><span class="sxs-lookup"><span data-stu-id="c2bfc-114">An example of this is shown in the following code fragment for setting the **CommandType** property of a **Command** object:</span></span>

```vb 
 
Cmd1.putCommandType( msado15.CommandTypeEnum.adCmdStoredProc ); 
```

<span data-ttu-id="c2bfc-p105">或者，您也可以从 Java 类型库向导所生成的枚举类型包装继承 ADO 对象和枚举值。如果这么做，那么可以从语法中删除"msado15."。不过，类必须从它所引用的每个 Java 对象和枚举类型接口继承，以完全避免在所有 ADO 对象和枚举值之前引用 msado15.\*。</span><span class="sxs-lookup"><span data-stu-id="c2bfc-p105">Alternately, you could inherit from the enumerated type wrapper generated by the Java Type Library Wizard. If so, you could remove "msado15." from the syntax. However, your class would need to inherit from each Java object and enumerated type interface that it references to completely eliminate the need to reference msado15.\* in front of all ADO objects and enumerated values.</span></span>

<span data-ttu-id="c2bfc-119">有关更多示例代码，请参阅 [ADO Java 类包装](ado-java-class-wrappers.md)。</span><span class="sxs-lookup"><span data-stu-id="c2bfc-119">For more sample code, see [ADO Java Class Wrappers](ado-java-class-wrappers.md).</span></span>

<span data-ttu-id="c2bfc-120">**从 Visual j + + 版本 1. \* x 运行 Java 类型库向导**\*</span><span class="sxs-lookup"><span data-stu-id="c2bfc-120">**To run the Java Type Library Wizard from Visual J++ version 1.\*x**\*</span></span>

1.  <span data-ttu-id="c2bfc-121">From the **Tools** menu, select **Java Type Library Wizard**.</span><span class="sxs-lookup"><span data-stu-id="c2bfc-121">From the **Tools** menu, select **Java Type Library Wizard**.</span></span>

2.  <span data-ttu-id="c2bfc-122">Select "Microsoft ActiveX Data Objects Library" and click **OK**.</span><span class="sxs-lookup"><span data-stu-id="c2bfc-122">Select "Microsoft ActiveX Data Objects Library" and click **OK**.</span></span> <span data-ttu-id="c2bfc-123">这现在 (re \\) 将在 trustlib 目录中为 ADO 生成文件 (默认情况下为\\c\\:\\winnt\\java trustlib msado15.dll)。</span><span class="sxs-lookup"><span data-stu-id="c2bfc-123">This now (re)generates files in the \\trustlib directory for ADO (by default at c:\\winnt\\java\\trustlib\\msado15).</span></span> <span data-ttu-id="c2bfc-124">If you used the Microsoft SDK for Java to already generate classes for ADO, they will be replaced with those from the Java Type Library Wizard.</span><span class="sxs-lookup"><span data-stu-id="c2bfc-124">If you used the Microsoft SDK for Java to already generate classes for ADO, they will be replaced with those from the Java Type Library Wizard.</span></span>

3.  <span data-ttu-id="c2bfc-125">To use these files, open your project in Visual J++.</span><span class="sxs-lookup"><span data-stu-id="c2bfc-125">To use these files, open your project in Visual J++.</span></span> <span data-ttu-id="c2bfc-126">从“工程”\*\*\*\* 菜单中，选择“添加到工程”\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="c2bfc-126">From the **Project** menu, choose **Add To Project**.</span></span> <span data-ttu-id="c2bfc-127">选择 "**文件**", 并将所有。在\\trustlib 目录中生成的 JAVA 文件 (默认情况下为\\c\\:\\winnt\\java trustlib msado15.dll) 到您的项目。</span><span class="sxs-lookup"><span data-stu-id="c2bfc-127">Select **Files**, and add all of the .JAVA files generated in the \\trustlib directory (by default at c:\\winnt\\java\\trustlib\\msado15) to your project.</span></span>

