---
title: 应用程序接口 (OneNote)
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: overview
ms.assetid: 87926f7d-e1dc-41d5-8805-6ba91fc7b154
description: 应用程序接口包括帮助检索、操作和更新 OneNote 信息和内容的方法。这些方法分为四大类：
localization_priority: Priority
ms.openlocfilehash: 295db4fcb64541ccf461fbd8d48dc19b89e6b1f8
ms.sourcegitcommit: e7b38e37a9d79becfd679e10420a19890165606d
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/29/2019
ms.locfileid: "34537820"
---
# <a name="application-interface-onenote"></a><span data-ttu-id="27658-104">应用程序接口 (OneNote)</span><span class="sxs-lookup"><span data-stu-id="27658-104">Application interface (OneNote)</span></span>

<span data-ttu-id="27658-p102">**应用程序**接口包括帮助检索、操作和更新 OneNote 信息和内容的方法。这些方法分为四大类：</span><span class="sxs-lookup"><span data-stu-id="27658-p102">The **Application** interface includes methods help retrieve, manipulate, and update OneNote information and content. The methods are in four general categories:</span></span> 
  
- <span data-ttu-id="27658-107">**笔记本结构** &ndash; 用于处理笔记本结构的方法，包括用于发现、打开、修改、关闭和删除笔记本、节组与节的方法。</span><span class="sxs-lookup"><span data-stu-id="27658-107">**Notebook structure** &ndash; Methods for working with notebook structure, including those for discovering, opening, modifying, closing, and deleting notebooks, section groups, and sections.</span></span> 
    
- <span data-ttu-id="27658-108">**页面内容** &ndash; 用于处理页面和页面内容的方法，包括用于发现、修改、保存和删除页面内容的方法。</span><span class="sxs-lookup"><span data-stu-id="27658-108">**Page content** &ndash; Methods for working with pages and page content, including those for discovering, modifying, saving, and deleting page content.</span></span> <span data-ttu-id="27658-109">页面内容包括二进制对象（如墨迹和图像）和文本对象（如边框）。</span><span class="sxs-lookup"><span data-stu-id="27658-109">Page content includes binary objects, such as ink and images, and text objects, such as outlines.</span></span> 
    
- <span data-ttu-id="27658-110">**导航** &ndash; 用于查找、链接到和导航到页面与对象的方法。</span><span class="sxs-lookup"><span data-stu-id="27658-110">**Navigation** &ndash; Methods for finding, linking to, and navigating to pages and objects.</span></span> 
    
- <span data-ttu-id="27658-111">**功能** &ndash; 在 OneNote 中执行特定操作或设置参数的所有其他方法。</span><span class="sxs-lookup"><span data-stu-id="27658-111">**Functional** &ndash; All other methods that perform certain actions or set parameters in OneNote.</span></span> 
    
<span data-ttu-id="27658-112">此外，**应用程序**接口包含许多*属性*和*事件*。</span><span class="sxs-lookup"><span data-stu-id="27658-112">In addition, the **Application** interface includes a number of  *properties*  and  *events*  .</span></span> 
  
## <a name="notebook-structure-methods"></a><span data-ttu-id="27658-113">笔记本结构方法</span><span class="sxs-lookup"><span data-stu-id="27658-113">Notebook Structure methods</span></span>
<span data-ttu-id="27658-114"><a name="ON14DevRef_Application_NotebookStructure"> </a></span><span class="sxs-lookup"><span data-stu-id="27658-114"><a name="ON14DevRef_Application_NotebookStructure"> </a></span></span>

<span data-ttu-id="27658-115">通过本节中介绍的方法，可以发现、打开、修改、关闭和删除 OneNote 笔记本、节组和节。</span><span class="sxs-lookup"><span data-stu-id="27658-115">The methods described in this section enable you to discover, open, modify, close, and delete OneNote notebooks, section groups, and sections.</span></span>
  
### <a name="gethierarchy-method"></a><span data-ttu-id="27658-116">GetHierarchy 方法</span><span class="sxs-lookup"><span data-stu-id="27658-116">GetHierarchy method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="27658-117">**说明**</span><span class="sxs-lookup"><span data-stu-id="27658-117">**Description**</span></span> <br/> |<span data-ttu-id="27658-118">获取笔记本节点层次结构，从您指定的节点开始（所有笔记本或单个笔记本、节组或节），并向下扩展到指定级别的所有后代。</span><span class="sxs-lookup"><span data-stu-id="27658-118">Gets the notebook node hierarchy structure, starting from the node you specify (all notebooks or a single notebook, section group, or section), and extending downward to all descendants at the level you specify.</span></span>  <br/> |
|<span data-ttu-id="27658-119">**语法**</span><span class="sxs-lookup"><span data-stu-id="27658-119">**Syntax**</span></span> <br/> | `HRESULT GetHierarchy(`<br/>`[in]BSTR bstrStartNodeID,`<br/>`[in]HierarchyScope hsScope,`<br/>`[out]BSTR * pbstrHierarchyXmlOut,`<br/>`[in,defaultvalue(xs2013)]XMLSchema xsSchema);` <br/> |
|<span data-ttu-id="27658-120">**参数**</span><span class="sxs-lookup"><span data-stu-id="27658-120">**Parameters**</span></span> <br/> | <span data-ttu-id="27658-121">_bstrStartNodeID_ &ndash; 你需要其后代的节点（笔记本、节组或节）。</span><span class="sxs-lookup"><span data-stu-id="27658-121">_bstrStartNodeID_ &ndash; The node (notebook, section group, or section) whose descendants you want.</span></span> <span data-ttu-id="27658-122">如果传递 null 字符串 ("")，则该方法将获取根节点下的所有节点（即所有笔记本、节组和节）。</span><span class="sxs-lookup"><span data-stu-id="27658-122">If you pass a null string (""), the method gets all nodes below the root node (that is, all notebooks, section groups, and sections).</span></span> <span data-ttu-id="27658-123">如果指定笔记本、节组或节节点，则该方法仅获取该节点的后代。</span><span class="sxs-lookup"><span data-stu-id="27658-123">If you specify a notebook, section group, or section node, the method gets only descendants of that node.</span></span>  <br/><br/><span data-ttu-id="27658-124">_hsScope_ &ndash; 你需要的最低后代节点级别。</span><span class="sxs-lookup"><span data-stu-id="27658-124">_hsScope_ &ndash; The lowest descendant node level you want.</span></span> <span data-ttu-id="27658-125">例如，如果指定页面，则该方法将获取该页面级别下的所有节点。</span><span class="sxs-lookup"><span data-stu-id="27658-125">For example, if you specify pages, the method gets all nodes as far down as the page level.</span></span> <span data-ttu-id="27658-126">如果您指定节，该方法将仅获取笔记本下的节节点。</span><span class="sxs-lookup"><span data-stu-id="27658-126">If you specify sections, the method gets only section nodes below the notebook.</span></span> <span data-ttu-id="27658-127">有关详细信息，请参阅[枚举](enumerations-onenote-developer-reference.md#odc_HierarchyScope)主题中的 **HierarchyScope** 枚举。</span><span class="sxs-lookup"><span data-stu-id="27658-127">For more information, see the **HierarchyScope** enumeration in the [Enumerations](enumerations-onenote-developer-reference.md#odc_HierarchyScope) topic.</span></span>  <br/><br/><span data-ttu-id="27658-128">_pbstrHierarchyXmlOut_ &ndash;（输出参数）指向你希望 OneNote 在其中写入 XML 输出的字符串的指针。</span><span class="sxs-lookup"><span data-stu-id="27658-128">_pbstrHierarchyXmlOut_ &ndash; (Output parameter) A pointer to the string in which you want OneNote to write the XML output.</span></span>  <br/><br/><span data-ttu-id="27658-129">_xsSchema_ &ndash;（可选）你希望作为输出的 OneNote XML 结构的版本，其类型为 **XMLSchema**。</span><span class="sxs-lookup"><span data-stu-id="27658-129">_xsSchema_ &ndash; (Optional) The version of the OneNote XML schema, of type **XMLSchema**, that you want to be output.</span></span> <span data-ttu-id="27658-130">您可以指定您需要 XML 架构版本 2013、2010、2007 还是当前版本。</span><span class="sxs-lookup"><span data-stu-id="27658-130">You can specify whether you want XML Schema version 2013, 2010, 2007, or the current version.</span></span>  <br/><br/><span data-ttu-id="27658-131">**注意**：我们建议指定 OneNote 版本（例如 **xs2013**），而不是使用 **xsCurrent** 或将其留空，因为这样会使你的加载项使用 OneNote 的未来版本。</span><span class="sxs-lookup"><span data-stu-id="27658-131">**NOTE**:  We recommend specifying a version of OneNote (such as **xs2013**) instead of using **xsCurrent** or leaving it blank, because this will allow your add-in to work with future versions of OneNote.</span></span>           |
   
<span data-ttu-id="27658-132">默认情况下，GetHierarchy 方法返回 OneNote 2013 XML 格式的字符串，或者您可以使用可选的  _xsSchema_ 参数设置首选 XML 架构版本。</span><span class="sxs-lookup"><span data-stu-id="27658-132">The GetHierarchy method returns a string in OneNote 2013 XML format by default or you can set the preferred XML schema version by using the optional  _xsSchema_ parameter.</span></span> 
  
<span data-ttu-id="27658-p107">根据您传递的参数， **GetHierarchy** 方法可能返回各种列表（例如，所有笔记本、所有笔记本中的所有节、指定节中的所有页面或指定笔记本中的所有页面）。对于每个节点，返回的 XML 字符串会提供相关属性（例如，节或页面标题、ID 和最后修改时间）。</span><span class="sxs-lookup"><span data-stu-id="27658-p107">Depending on the parameters you pass, the **GetHierarchy** method can return various lists (for example all notebooks, all sections in all notebooks, all pages within a given section, or all pages within a given notebook). For each node, the XML string returned provides properties (for example, the section or page title, ID, and last-modified time).</span></span> 
  
<span data-ttu-id="27658-p108">并非开始节点和范围的所有组合均有效。例如，如果您指定节起始节点和笔记本范围， **GetHierarchy** 将返回一个无效结果，因为笔记本在节点层次结构中高于节。</span><span class="sxs-lookup"><span data-stu-id="27658-p108">Not all combinations of start node and scope are valid. For example, if you specify a section start node and a notebook scope, **GetHierarchy** returns a null result because a notebook is higher in the node hierarchy than a section.</span></span> 
  
<span data-ttu-id="27658-p109">以下 C# 示例说明了如何使用 **GetHierarchy** 方法获取向下到页面级别的整个 OneNote 层次结构，包括所有笔记本。它将输出字符串复制到剪贴板，您可从中将字符串粘贴到文本编辑器以进行检查。</span><span class="sxs-lookup"><span data-stu-id="27658-p109">The following C# example shows how to use the **GetHierarchy** method to get the entire OneNote hierarchy, including all notebooks, down to the page level. It copies the output string to the Clipboard, from which you can paste the string into a text editor for review.</span></span> 
  
```cs
static void GetEntireHierarchy()
    {
        String strXML;
        OneNote.Application onApplication = new OneNote.Application();
        onApplication.GetHierarchy(null, 
            OneNote.HierarchyScope.hsPages, out strXML);
        Clipboard.SetText(strXML);
        MessageBox.Show("The XML has been copied to the clipboard");
    }

```

### <a name="updatehierarchy-method"></a><span data-ttu-id="27658-139">UpdateHierarchy 方法</span><span class="sxs-lookup"><span data-stu-id="27658-139">UpdateHierarchy method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="27658-140">**说明**</span><span class="sxs-lookup"><span data-stu-id="27658-140">**Description**</span></span>|<span data-ttu-id="27658-p110">修改或更新笔记本的层次结构。例如，您可以向笔记本添加节或节组、添加新笔记本、在笔记本内移动节，更改节名称、向节添加页面或更改节内页面的顺序。</span><span class="sxs-lookup"><span data-stu-id="27658-p110">Modifies or updates the hierarchy of notebooks. For example, you can add sections or section groups to a notebook, add a new notebook, move sections within a notebook, change the name of a section, add pages to a section, or change the order of pages within sections.</span></span>|
|<span data-ttu-id="27658-143">**语法**</span><span class="sxs-lookup"><span data-stu-id="27658-143">**Syntax**</span></span>| `HRESULT UpdateHierarchy(`<br/>`[in]BSTR bstrChangesXmlIn,`<br/>`[in,defaultvalue(xsCurrent)] XMLSchema xsSchema);`|
|<span data-ttu-id="27658-144">**参数**</span><span class="sxs-lookup"><span data-stu-id="27658-144">**Parameters**</span></span>| <span data-ttu-id="27658-145">_bstrChangesXmlIn_ &ndash; 包含 OneNote XML 代码的字符串，用于指定要进行的层次结构更改。</span><span class="sxs-lookup"><span data-stu-id="27658-145">_bstrChangesXmlIn_ &ndash; A string that contains OneNote XML code that specifies the hierarchy changes to make.</span></span> <span data-ttu-id="27658-146">例如，如果要插入新节，则可以在 XML 字符串中添加**节**元素，以指示要添加新节的位置。</span><span class="sxs-lookup"><span data-stu-id="27658-146">For example, if you want to insert a new section, you can add a **Section** element in the XML string to indicate where you want the new section to be added.</span></span> <span data-ttu-id="27658-147">或者，如果要更改现有节的名称，则可以保留相同的节 ID，并在 XML 代码中更改其**名称**属性。</span><span class="sxs-lookup"><span data-stu-id="27658-147">Alternatively, if you want to change the name of an existing section, you can keep the same section ID and change its **name** attribute in the XML code.</span></span><br/><br/><span data-ttu-id="27658-148">_xsSchema_ &ndash;（可选）字符串 _bstrChangesXmln_ 的 OneNote 架构版本。</span><span class="sxs-lookup"><span data-stu-id="27658-148">_xsSchema_ &ndash; (Optional) The OneNote schema version of the string  _bstrChangesXmln_.</span></span> <span data-ttu-id="27658-149">此可选值用于指定 _bstrChangesXmlIn_ 字符串所在的 OneNote XML 架构的版本。</span><span class="sxs-lookup"><span data-stu-id="27658-149">This optional value is used to specify the version of the OneNote XML schema that the  _bstrChangesXmlIn_ string is in.</span></span> <span data-ttu-id="27658-150">如果未指定此值，则 OneNote 将假定 XML 在架构版本 _xsCurrent_ 中。</span><span class="sxs-lookup"><span data-stu-id="27658-150">If this value is not specified, OneNote will assume that the XML is in schema version  _xsCurrent_.</span></span> <br/><br/><span data-ttu-id="27658-151">**注意**：我们建议指定 OneNote 版本（例如 **xs2013**），而不是使用 **xsCurrent** 或将其留空，因为这样会使你的加载项使用 OneNote 的未来版本。</span><span class="sxs-lookup"><span data-stu-id="27658-151">**NOTE**:  We recommend specifying a version of OneNote (such as **xs2013**) instead of using **xsCurrent** or leaving it blank, because this will allow your add-in to work with future versions of OneNote.</span></span>           |
   
<span data-ttu-id="27658-p113">如果仅传递  _bstrChangesXmlIn_ 参数的部分 OneNote XML 字符串，OneNote 将尝试推断您需要的更改。例如，如果您提供了一个仅包含一个节的 **Notebook** 元素，OneNote 将在任何现有节后面添加节。但是，如果您指定的操作有歧义，结果则很难确定。例如，如果某个现有笔记本包含四个节，且您传递的 XML 字符串包括笔记本和仅第四和第一个节（按此顺序），OneNote 可能会将第二和第三个节放在第四个节之前或第一个节之后。</span><span class="sxs-lookup"><span data-stu-id="27658-p113">If you pass only a partial OneNote XML string for the  _bstrChangesXmlIn_ parameter, OneNote attempts to infer the changes you want. For example, if you include a **Notebook** element that contains only one section, OneNote adds the section after any existing sections. However, if the operation you specify is ambiguous, the result can be hard to determine. For example, if an existing notebook contains four sections, and the XML string you pass includes the notebook and only the fourth and first sections (in that order), OneNote might place the second and third sections before the fourth section or after the first section.</span></span> 
  
<span data-ttu-id="27658-p114">无法使用 **UpdateHierarchy** 方法删除笔记本的一部分，即传递仅包含现有层次结构一部分的 XML 字符串不会删除未包含在字符串中的节。要删除层次结构的一部分，请使用 **DeleteHierarchy** 方法。</span><span class="sxs-lookup"><span data-stu-id="27658-p114">You cannot use the **UpdateHierarchy** method to delete part of a notebook. That is, passing an XML string that includes only part of an existing hierarchy does not delete sections that are not included in the string. To delete part of a hierarchy, use the **DeleteHierarchy** method.</span></span> 
  
<span data-ttu-id="27658-p115">以下 C# 代码显示了通过更改现有节的名称，使用 **UpdateHierarchy** 方法更改 OneNote 层次结构的一种方式。它从 C 盘根目录一个名为 ChangeSectionName.xml 的示例文件中读取 XML 代码，将其加载到 XML 文档，然后将该文档的 XML 结构传递给方法。</span><span class="sxs-lookup"><span data-stu-id="27658-p115">The following C# code shows one way to use the **UpdateHierarchy** method to change the OneNote hierarchy, by changing the name of an existing section. It reads XML code from a sample file named ChangeSectionName.xml at the root of drive C, loads it into an XML document, and then passes the XML structure of that document to the method.</span></span> 
  
```cs
static void UpdateExistingHierarchy()
    {
        OneNote.Application onApplication = new OneNote.Application();
        
        // Get the XML from the file.
        XmlTextReader reader = new XmlTextReader("C:\\ChangeSectionName.xml");
        reader.WhitespaceHandling = WhitespaceHandling.None;
        XmlDocument xmlDocIn = new XmlDocument();
        xmlDocIn.Load(reader);
        
        // Update the hierarchy.
        onApplication.UpdateHierarchy(xmlDocIn.OuterXml,
        OneNote.XMLSchema.xs2007);   
    }

```

<span data-ttu-id="27658-p116">以下 XML 代码摘自之前的 C# 代码传递到方法的 ChangeSectionName.xml 文件。当 XML 传递到 **UpdateHierarchy** 方法时，它会更改现有层次结构中某个节的名称（通过将 **name** 属性的值更改为"My Renamed Section"）。然后它删除所有节，除了更改了名称的节以外。此外，代码将从目标 **Section** 元素中删除不必要的属性，包括 **lastModifiedTime**、 **isCurrentlyViewed** 和 **color** 属性，仅将 **name**、 **ID** 和 **path** 属性保持不变。</span><span class="sxs-lookup"><span data-stu-id="27658-p116">The following XML code is an excerpt of the ChangeSectionName.xml file that the previous C# code passes to the method. When the XML is passed to the **UpdateHierarchy** method, it changes the name of one of the sections in the existing hierarchy (by changing the value of the **name** attribute to "My Renamed Section"). It then removes all the sections except the one whose name was changed. In addition, the code removes unnecessary attributes from the target **Section** element, including the **lastModifiedTime**, **isCurrentlyViewed**, and **color** attributes, leaving only the **name**, **ID**, and **path** attributes intact.</span></span> 
  
```XML
<?xml version="1.0" ?> 
    <one:Notebooks xmlns:one="http://schemas.microsoft.com/office/onenote/12/2004/onenote"> 
        <one:Notebook name="My Notebook" nickname="My Notebook" ID="{0B8E7305-AC2C-4BCB-8651-1CDA55AAE14C}{1}{B0}"> 
            <one:Section name="My Renamed Section" ID="{5F4E2908-44BA-4C02-91FE-49FC665E9A33}{1}{B0}" path="C:\My Section.one" /> 
        </one:Notebook> 
    </one:Notebooks>
```

<span data-ttu-id="27658-165">以上 XML 代码是使用 **GetHierarchy** 方法的示例中所示的代码获取的，我们如下所述对其进行了修改，以将范围限制到节。</span><span class="sxs-lookup"><span data-stu-id="27658-165">The preceding XML code was obtained by using the code shown in the example for the **GetHierarchy** method, which is modified, as follows, to limit the scope to sections.</span></span> 
  
```cs
static void GetAllSections()
    {
        String strXML;
        OneNote.Application onApplication = new OneNote.Application();
        onApplication.GetHierarchy(System.String.Empty, 
            OneNote.HierarchyScope.hsSections, out strXML);
        Clipboard.SetText(strXML.ToString());
        MessageBox.Show("The XML has been copied to the Clipboard");
    }

```

<span data-ttu-id="27658-p117">以下 C# 示例显示了一个完整的控制台应用程序，该应用程序可搜索名为" `Sample_Section`"的节，提示用户为节输入一个新名称，然后使用 **UpdateHierarchy** 方法将节名称更改为用户键入的名称。在运行代码之前，将"  `Sample_Section`"更改为 OneNote 层次结构中存在的节的名称。</span><span class="sxs-lookup"><span data-stu-id="27658-p117">The following C# example shows a complete console application that searches for a section named " `Sample_Section`", prompts the user to input a new name for the section, and then uses the **UpdateHierarchy** method to change the section name to the name that the user typed. Before running the code, change "  `Sample_Section`" to the name of a section that exists in your OneNote hierarchy.</span></span>
  
```cs
    static void Main(string[] args)
    {
        
        // OneNote 2013 Schema namespace.
        string strNamespace = "http://schemas.microsoft.com/office/onenote/2013/onenote";
        string outputXML;
        Application onApplication = new Application();
        onApplication.GetHierarchy(null, HierarchyScope.hsSections, out outputXML);
        // Load a new XmlDocument.
        XmlDocument xmlDoc = new XmlDocument();
        xmlDoc.LoadXml(outputXML);
        XmlNamespaceManager nsmgr = new XmlNamespaceManager(xmlDoc.NameTable);
            nsmgr.AddNamespace("one", strNamespace);
        // Search for the section named "Sample_Section".
        XmlNode xmlNode = xmlDoc.SelectSingleNode("//one:Section[@name='Sample_Section']", nsmgr);
        // Prompt for a new section title.
        System.Console.Write("Please enter a new title for the section: ");
        string input = System.Console.ReadLine();
        xmlNode.Attributes["name"].Value = input; 
        // Update the section with the new title.
        onApp.UpdateHierarchy(xmlNode.OuterXml);
        System.Console.Write("Done!\n");
    }

```

### <a name="openhierarchy-method"></a><span data-ttu-id="27658-168">OpenHierarchy 方法</span><span class="sxs-lookup"><span data-stu-id="27658-168">OpenHierarchy method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="27658-169">**说明**</span><span class="sxs-lookup"><span data-stu-id="27658-169">**Description**</span></span> <br/> |<span data-ttu-id="27658-170">打开您指定的节组或节。</span><span class="sxs-lookup"><span data-stu-id="27658-170">Opens a section group or section that you specify.</span></span>  <br/> |
|<span data-ttu-id="27658-171">**语法**</span><span class="sxs-lookup"><span data-stu-id="27658-171">**Syntax**</span></span> <br/> | `HRESULT OpenHierarchy(`<br/>`[in]BSTR bstrPath,`<br/>`[in]BSTR bstrRelativeToObjectID,`<br/>`[out]BSTR * pbstrObjectID,`<br/>`[in,defaultvalue(cftNone)]CreateFileType cftIfNotExist);` <br/> |
|<span data-ttu-id="27658-172">**参数**</span><span class="sxs-lookup"><span data-stu-id="27658-172">**Parameters**</span></span> <br/> | <span data-ttu-id="27658-173">_bstrPath_ &ndash; 你想打开的路径。</span><span class="sxs-lookup"><span data-stu-id="27658-173">_bstrPath_ &ndash; The path that you want to open.</span></span> <span data-ttu-id="27658-174">对于笔记本或笔记本中的节组， _bstrPath_ 可能是文件夹路径或 .one 节文件的路径。</span><span class="sxs-lookup"><span data-stu-id="27658-174">For a notebook, or for a section group in a notebook,  _bstrPath_ can be a folder path or the path to an .one section file.</span></span> <span data-ttu-id="27658-175">如果指定 .one 节文件的路径，则必须在文件路径字符串中包含 .one 扩展名。</span><span class="sxs-lookup"><span data-stu-id="27658-175">If you specify the path to an .one section file, you must include the .one extension on the file-path string.</span></span>  <br/><br/><span data-ttu-id="27658-176">_bstrRelativeToObjectID_ &ndash; 你希望新对象在其下打开的父对象（笔记本或节组）的 OneNote ID。</span><span class="sxs-lookup"><span data-stu-id="27658-176">_bstrRelativeToObjectID_ &ndash; The OneNote ID of the parent object (notebook or section group) under which you want the new object to open.</span></span> <span data-ttu-id="27658-177">如果 _bstrPath_ 参数是绝对路径，则可以为 _bstrRelativeToObjectID_ 传递空字符串 ("")。</span><span class="sxs-lookup"><span data-stu-id="27658-177">If the  _bstrPath_ parameter is an absolute path, you can pass an empty string ("") for  _bstrRelativeToObjectID_.</span></span> <span data-ttu-id="27658-178">或者，您也可以传递应包含想要创建的对象（节或节组）的笔记本或节组的对象 ID，然后指定您希望在该父对象下创建的对象的文件名（例如 section1.one）。</span><span class="sxs-lookup"><span data-stu-id="27658-178">Alternatively, you can pass the object ID of the notebook or section group that should contain the object (section or section group) that you want to create, and then specify the file name (for example, section1.one) of the object that you want to create under that parent object.</span></span>  <br/><br/><span data-ttu-id="27658-179">_pbstrObjectID_ &ndash;（输出参数）OneNote 为 **OpenHierarchy** 方法打开的笔记本、节组或节返回的对象 ID。</span><span class="sxs-lookup"><span data-stu-id="27658-179">_pbstrObjectID_ &ndash; (Output parameter) The object ID that OneNote returns for the notebook, section group, or section that the **OpenHierarchy** method opens.</span></span> <span data-ttu-id="27658-180">此参数是指向你希望方法将 ID 写入其中的字符串的指针。</span><span class="sxs-lookup"><span data-stu-id="27658-180">This parameter is a pointer to the string into which you want the method to write the ID.</span></span>  <br/><br/><span data-ttu-id="27658-181">_cftlfNotExist_ &ndash;（可选）[CreateFileType](enumerations-onenote-developer-reference.md#odc_CreateFileType) 枚举的枚举值。</span><span class="sxs-lookup"><span data-stu-id="27658-181">_cftlfNotExist_ &ndash; (Optional) An enumerated value from the [CreateFileType](enumerations-onenote-developer-reference.md#odc_CreateFileType) enumeration.</span></span> <span data-ttu-id="27658-182">如果为  _cftIfNotExist_ 传递一个值， **OpenHierarchy** 方法将在指定路径创建节组或节文件，前提是仅当文件尚不存在。</span><span class="sxs-lookup"><span data-stu-id="27658-182">If you pass a value for  _cftIfNotExist_, the **OpenHierarchy** method creates the section group or section file at the specified path only if the file does not already exist.</span></span>  <br/> |
   
<span data-ttu-id="27658-p122">如果指定打开的笔记本中没有的节组， **OpenHierarchy** 方法会将该节组作为笔记本打开。如果您指定的节不在打开的笔记本中， **OpenHierarchy** 方法将打开"最近打开的节"节组中的节。如果您指定的节组或节已在打开的笔记本中，则不会发生任何结果，因为节组或节也已打开。不管在什么情况下， **OpenHierarchy** 都会返回您指定的节组、笔记本或节的对象 ID，以便在其他操作中使用。</span><span class="sxs-lookup"><span data-stu-id="27658-p122">If you specify a section group that is not in an open notebook, the **OpenHierarchy** method opens the section group as a notebook. If you specify a section that is not in an open notebook, the **OpenHierarchy** method opens the section in the Recent Opened Sections section group. If you specify a section group or section that is already in an open notebook, nothing happens because the section group or section is already open, as well. In any case, **OpenHierarchy** returns the object ID for the section group, notebook, or section that you specify, so that you can use it in other operations.</span></span> 
  
<span data-ttu-id="27658-187">您还可以使用 **OpenHierarchy** 方法创建新节，而不是通过导入 XML 来创建。</span><span class="sxs-lookup"><span data-stu-id="27658-187">You can also use the **OpenHierarchy** method to create new sections, instead of doing so by importing XML.</span></span> 
  
<span data-ttu-id="27658-p123">以下代码显示了如何使用 **OpenHierarchy** 方法在"工作"笔记本中打开"会议"节并获取该节的 ID。如果该节尚不存在，OneNote 将在您指定的位置进行创建。</span><span class="sxs-lookup"><span data-stu-id="27658-p123">The following code shows how to use the **OpenHierarchy** method to open the Meetings section in the Work notebook and get the ID for the section. If the section does not already exist, OneNote creates it in the location that you specify.</span></span> 
  
```cs
static void OpenSection()
    {
        String strID;
        OneNote.Application onApplication = new OneNote.Application();
        onApplication.OpenHierarchy("C:\\Documents and Settings\\user\\My Documents\\OneNote Notebooks\\Work\\Meetings.one", 
        System.String.Empty, out strID, OneNote.CreateFileType.cftSection);
    }

```

### <a name="deletehierarchy-method"></a><span data-ttu-id="27658-190">DeleteHierarchy 方法</span><span class="sxs-lookup"><span data-stu-id="27658-190">DeleteHierarchy method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="27658-191">**说明**</span><span class="sxs-lookup"><span data-stu-id="27658-191">**Description**</span></span> <br/> |<span data-ttu-id="27658-192">从 OneNote 笔记本层次结构中删除任何层次结构对象（节组、节或页面）。</span><span class="sxs-lookup"><span data-stu-id="27658-192">Deletes any hierarchy object (a section group, section, or page) from the OneNote notebook hierarchy.</span></span>  <br/> |
|<span data-ttu-id="27658-193">**语法**</span><span class="sxs-lookup"><span data-stu-id="27658-193">**Syntax**</span></span> <br/> | `HRESULT DeleteHierarchy(`<br/>`[in]BSTR bstrObjectID,`<br/>`[in,defaultvalue(0)]DATE dateExpectedLastModified,`<br/>`[in,defaultvalue(false)]VARIANT_BOOL deletePermanently);` <br/> |
|<span data-ttu-id="27658-194">**参数**</span><span class="sxs-lookup"><span data-stu-id="27658-194">**Parameters**</span></span> <br/> | <span data-ttu-id="27658-195">_bstrObjectID_ &ndash; 你想删除的对象的 OneNote ID。</span><span class="sxs-lookup"><span data-stu-id="27658-195">_bstrObjectID_ &ndash; The OneNote ID of the object you want to delete.</span></span> <span data-ttu-id="27658-196">对象可以是节组、节或页面。</span><span class="sxs-lookup"><span data-stu-id="27658-196">The object can be a section group, section, or page.</span></span>  <br/><br/><span data-ttu-id="27658-197">_dateExpectedLastModified_ &ndash;（可选）你认为要删除的对象的上次修改日期和时间。</span><span class="sxs-lookup"><span data-stu-id="27658-197">_dateExpectedLastModified_ &ndash; (Optional) The date and time that you think the object you want to delete was last modified.</span></span> <span data-ttu-id="27658-198">如果您为此参数传递一个非零值，OneNote 将继续更新，前提是仅当您传递的值与对象上次修改的实际日期和时间匹配。</span><span class="sxs-lookup"><span data-stu-id="27658-198">If you pass a non-zero value for this parameter, OneNote proceeds with the update only if the value you pass matches the actual date and time the object was last modified.</span></span> <span data-ttu-id="27658-199">为此参数传递一个值有助于防止意外覆盖自上次对象修改以来用户所做的编辑。</span><span class="sxs-lookup"><span data-stu-id="27658-199">Passing a value for this parameter helps prevent accidentally overwriting edits users made since the last time the object was modified.</span></span>  <br/><br/><span data-ttu-id="27658-200">_deletePermanently_ &ndash;（可选）设置为 **true** 可永久删除内容，设置为 **false** 可将内容移到相应笔记本的 OneNote 回收站中（默认设置）。</span><span class="sxs-lookup"><span data-stu-id="27658-200">_deletePermanently_ &ndash; (Optional) **true** to permanently delete the content; **false** to move the content into the OneNote recycle bin for the corresponding Notebook (the default).</span></span> <span data-ttu-id="27658-201">如果笔记本是 OneNote 2007 格式，则不存在回收站，因此会永久删除内容。</span><span class="sxs-lookup"><span data-stu-id="27658-201">If the Notebook is in OneNote 2007 format, no recycle bin exists, so the content is permanently deleted.</span></span>  <br/> |
   
### <a name="createnewpage-method"></a><span data-ttu-id="27658-202">CreateNewPage 方法</span><span class="sxs-lookup"><span data-stu-id="27658-202">CreateNewPage method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="27658-203">**说明**</span><span class="sxs-lookup"><span data-stu-id="27658-203">**Description**</span></span> <br/> |<span data-ttu-id="27658-p127">向您指定的节添加新页面。新页面添加为节的最后一页。</span><span class="sxs-lookup"><span data-stu-id="27658-p127">Adds a new page to the section you specify. The new page is added as the last page of the section</span></span>  <br/> |
|<span data-ttu-id="27658-206">**语法**</span><span class="sxs-lookup"><span data-stu-id="27658-206">**Syntax**</span></span> <br/> | `HRESULT CreateNewPage(`<br/>`[in]BSTR bstrSectionID,`<br/>`[out]BSTR * pbstrPageID);`<br/>`[in,defaultvalue(npsDefault)]NewPageStyle npsNewPageStyle);` <br/> |
|<span data-ttu-id="27658-207">**参数**</span><span class="sxs-lookup"><span data-stu-id="27658-207">**Parameters**</span></span> <br/> | <span data-ttu-id="27658-208">_bstrSectionID_ &ndash; 包含你希望在其中创建新页面的节的 OneNote ID 的字符串。</span><span class="sxs-lookup"><span data-stu-id="27658-208">_bstrSectionID_ &ndash; A string that contains the OneNote ID of the section in which you want to create the new page.</span></span>  <br/><br/><span data-ttu-id="27658-209">_pbstrPageID_ &ndash;（输出参数）指向该方法在其中写入新创建页面的 OneNote ID 的字符串的指针。</span><span class="sxs-lookup"><span data-stu-id="27658-209">_pbstrPageID_ &ndash; (Output parameter) A pointer to the string into which the method writes the OneNote ID for the newly created page.</span></span>  <br/><br/><span data-ttu-id="27658-210">_npsNewPageStyle_ &ndash; **NewPageStyle** 枚举中的值，用于指定要创建的页面的样式。</span><span class="sxs-lookup"><span data-stu-id="27658-210">_npsNewPageStyle_ &ndash; A value from the **NewPageStyle** enumeration that specifies the style of the page to be created.</span></span>  <br/> |
   
<span data-ttu-id="27658-p128">为了方便，OneNote API 包含 **CreateNewPage** 方法。您可以实现相同的结果，同时对新页面在层次结构中的放置进行更好的控制，方法是调用 **UpdateHierarchy** 方法。 **UpdateHierarchy** 方法还允许您在创建新页面的同时创建子页面。</span><span class="sxs-lookup"><span data-stu-id="27658-p128">The OneNote API includes the **CreateNewPage** method as a convenience. You can achieve the same result, with greater control over how the new page is positioned in the hierarchy, by calling the **UpdateHierarchy** method. The **UpdateHierarchy** method also lets you create subpages at the same time as you create a new page.</span></span> 
  
### <a name="closenotebook-method"></a><span data-ttu-id="27658-214">CloseNotebook 方法</span><span class="sxs-lookup"><span data-stu-id="27658-214">CloseNotebook method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="27658-215">**说明**</span><span class="sxs-lookup"><span data-stu-id="27658-215">**Description**</span></span> <br/> |<span data-ttu-id="27658-216">关闭指定的笔记本。</span><span class="sxs-lookup"><span data-stu-id="27658-216">Closes the specified notebook.</span></span>  <br/> |
|<span data-ttu-id="27658-217">**语法**</span><span class="sxs-lookup"><span data-stu-id="27658-217">**Syntax**</span></span> <br/> | `HRESULT CloseNotebook(`<br/>`[in]BSTR bstrNotebookID,`<br/>`[in,defaultvalue(false)]VARIANT_BOOL force);` <br/> |
|<span data-ttu-id="27658-218">**参数**</span><span class="sxs-lookup"><span data-stu-id="27658-218">**Parameters**</span></span> <br/> | <span data-ttu-id="27658-219">_bstrNotebookID_ &ndash; 你想关闭的笔记本的 OneNote ID。</span><span class="sxs-lookup"><span data-stu-id="27658-219">_bstrNotebookID_ &ndash; The OneNote ID of the notebook you want to close.</span></span>  <br/><br/><span data-ttu-id="27658-220">_force_ &ndash;（可选）设置为 **true** 可关闭笔记本，即使笔记本中包含 OneNote 在关闭之前无法同步的更改；否则设置为 **false**（默认设置）。</span><span class="sxs-lookup"><span data-stu-id="27658-220">_force_ &ndash; (Optional) **true** to close the notebook, even if there are changes in the notebook that OneNote cannot sync before closing; otherwise, **false** (the default).</span></span>  <br/> |
   
<span data-ttu-id="27658-p129">您可以使用 **CloseNotebook** 方法关闭您指定的笔记本。当调用此方法时，会将任何脱机文件与当前的笔记本内容同步，然后根据需要关闭指定的笔记本。该方法返回后，该笔记本将不会再显示在 OneNote 用户界面 (UI) 上打开的笔记本列表中。</span><span class="sxs-lookup"><span data-stu-id="27658-p129">You can use the **CloseNotebook** method to close the notebook you specify. When you call this method, OneNote synchronizes any offline files with current notebook content, if necessary, and then closes the specified notebook. After the method returns, the notebook no longer appears in the list of open notebooks in the OneNote user interface (UI).</span></span> 
  
### <a name="gethierarchyparent-method"></a><span data-ttu-id="27658-224">GetHierarchyParent 方法</span><span class="sxs-lookup"><span data-stu-id="27658-224">GetHierarchyParent method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="27658-225">**说明**</span><span class="sxs-lookup"><span data-stu-id="27658-225">**Description**</span></span> <br/> |<span data-ttu-id="27658-226">获取某个 OneNote 对象的父对象的 OneNote ID。</span><span class="sxs-lookup"><span data-stu-id="27658-226">Gets the OneNote ID for the parent object of a OneNote object.</span></span>  <br/> |
|<span data-ttu-id="27658-227">**语法**</span><span class="sxs-lookup"><span data-stu-id="27658-227">**Syntax**</span></span> <br/> | `HRESULT GetHierarchyParent (`<br/>`[in]BSTR bstrObjectID,`<br/>`[out]BSTR * pbstrParentID);` <br/> |
|<span data-ttu-id="27658-228">**参数**</span><span class="sxs-lookup"><span data-stu-id="27658-228">**Parameters**</span></span> <br/> | <span data-ttu-id="27658-229">_bstrObjectID_ &ndash; 包含你希望在其中查找父对象的对象的 OneNote ID 的字符串。</span><span class="sxs-lookup"><span data-stu-id="27658-229">_bstrObjectID_ &ndash; A string that contains the OneNote ID of the object of which you want to find the parent object.</span></span>  <br/><br/><span data-ttu-id="27658-230">_pbstrParentID_ &ndash;（输出参数）指向该方法在其中写入父对象的 OneNote ID 的字符串的指针。</span><span class="sxs-lookup"><span data-stu-id="27658-230">_pbstrParentID_ &ndash; (Output parameter) A pointer to the string into which the method writes the OneNote ID of the parent object.</span></span>  <br/> |
   
<span data-ttu-id="27658-231">如果 OneNote 对象没有父对象（例如，当用户想要获取笔记本的父对象时），将抛出一个异常。</span><span class="sxs-lookup"><span data-stu-id="27658-231">If the OneNote object has no parent object (for example, when a user wants to get the parent of a Notebook), an exception is thrown.</span></span>
  
### <a name="getspeciallocation-method"></a><span data-ttu-id="27658-232">GetSpecialLocation 方法</span><span class="sxs-lookup"><span data-stu-id="27658-232">GetSpecialLocation method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="27658-233">**说明**</span><span class="sxs-lookup"><span data-stu-id="27658-233">**Description**</span></span> <br/> |<span data-ttu-id="27658-234">查找 OneNote 在其中存储某些特殊项目（例如备份、未归档笔记和默认笔记本）的位置的路径。</span><span class="sxs-lookup"><span data-stu-id="27658-234">Finds the path to the location where OneNote stores certain special items, such as backups, unfiled notes, and the default notebook.</span></span>  <br/> |
|<span data-ttu-id="27658-235">**语法**</span><span class="sxs-lookup"><span data-stu-id="27658-235">**Syntax**</span></span> <br/> | `HRESULT GetSpecialLocation(`<br/>`[in]SpecialLocation slToGet,`<br/>`[out]BSTR * pbstrSpecialLocationPath);` <br/> |
|<span data-ttu-id="27658-236">**参数**</span><span class="sxs-lookup"><span data-stu-id="27658-236">**Parameters**</span></span> <br/> | <span data-ttu-id="27658-237">_slToGet_ &ndash; [SpecialLocation](enumerations-onenote-developer-reference.md#odc_SpecialLocation) 枚举值之一，用于指定要获取的特殊文件夹位置。</span><span class="sxs-lookup"><span data-stu-id="27658-237">_slToGet_ &ndash; One of the [SpecialLocation](enumerations-onenote-developer-reference.md#odc_SpecialLocation) enumeration values that specifies the special folder location to get.</span></span>  <br/><br/><span data-ttu-id="27658-238">_pbstrSpecialLocationPath_ &ndash;（输出参数）指向你希望 OneNote 在其中写入特殊文件夹路径的字符串的指针。</span><span class="sxs-lookup"><span data-stu-id="27658-238">_pbstrSpecialLocationPath_ &ndash; (Output parameter) A pointer to the string into which you want OneNote to write the path of the special folder.</span></span>  <br/> |
   
<span data-ttu-id="27658-p130">您可以使用此方法确定未归档笔记文件夹在磁盘上的位置。这是 OneNote 用于存储将项目拖到 OneNote 中时的笔记，以及直接来自其他应用程序的笔记（例如当您在 Microsoft Outlook 或 Microsoft Internet Explorer 中单击“发送到 OneNote”\*\*\*\* 时产生的笔记）的文件夹。</span><span class="sxs-lookup"><span data-stu-id="27658-p130">You can use this method to determine the location on disk of the Unfiled Notes folder. That is the folder in which OneNote stores notes that are created when you drag an item into OneNote, as well as notes that come directly from other applications (such as those that result when you click **Send to OneNote** in Microsoft Outlook or Microsoft Internet Explorer).</span></span> 
  
## <a name="page-content-methods"></a><span data-ttu-id="27658-241">页面内容方法</span><span class="sxs-lookup"><span data-stu-id="27658-241">Page Content methods</span></span>
<span data-ttu-id="27658-242"><a name="ON14DevRef_Application_PageContent"> </a></span><span class="sxs-lookup"><span data-stu-id="27658-242"><a name="ON14DevRef_Application_PageContent"> </a></span></span>

<span data-ttu-id="27658-243">此部分中所述的方法使您可以发现、更新和删除 OneNote 笔记本中页面上的内容，也可发布 OneNote 内容。</span><span class="sxs-lookup"><span data-stu-id="27658-243">The methods described in this section enable you to discover, update, and delete the content on pages in OneNote notebooks, as well as to publish OneNote content.</span></span>
  
### <a name="getpagecontent-method"></a><span data-ttu-id="27658-244">GetPageContent 方法</span><span class="sxs-lookup"><span data-stu-id="27658-244">GetPageContent method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="27658-245">**说明**</span><span class="sxs-lookup"><span data-stu-id="27658-245">**Description**</span></span>|<span data-ttu-id="27658-246">获取指定页面的所有内容（OneNote XML 格式）。</span><span class="sxs-lookup"><span data-stu-id="27658-246">Gets all of the content (in OneNote XML format) of the specified page.</span></span>|
|<span data-ttu-id="27658-247">**语法**</span><span class="sxs-lookup"><span data-stu-id="27658-247">**Syntax**</span></span>| `HRESULT GetPageContent(`<br/>`[in]BSTR bstrPageID,`<br/>`[out]BSTR * pbstrPageXmlOut,`<br/>`[in,defaultvalue(piBasic)]PageInfo pageInfoToExport,`<br/>`[in,defaultvalue(xsCurrent)]XMLSchema xsSchema);`|
|<span data-ttu-id="27658-248">**参数**</span><span class="sxs-lookup"><span data-stu-id="27658-248">**Parameters**</span></span>| <span data-ttu-id="27658-249">_bstrPageId_ &ndash; 你想获取其内容的页面的 OneNote ID。</span><span class="sxs-lookup"><span data-stu-id="27658-249">_bstrPageId_ &ndash; The OneNote ID of the page whose content you want to get.</span></span><br/><br/><span data-ttu-id="27658-250">_pbstrPageXmlOut_ &ndash;（输出参数）指向你希望 OneNote 在其中写入 XML 输出的字符串的指针。</span><span class="sxs-lookup"><span data-stu-id="27658-250">_pbstrPageXmlOut_ &ndash; (Output parameter) A pointer to the string into which you want OneNote to write the XML output.</span></span><br/><br/><span data-ttu-id="27658-251">_pageInfoToExport_ &ndash;（可选）指定 **GetPageContent** 方法是否返回嵌入在 XML 代码和 base-64 编码中的二进制内容。</span><span class="sxs-lookup"><span data-stu-id="27658-251">_pageInfoToExport_ &ndash; (Optional) Specifies whether the **GetPageContent** method returns binary content, embedded in the XML code and base-64 encoded.</span></span> <span data-ttu-id="27658-252">例如，二进制内容可以包括图像和墨迹数据。</span><span class="sxs-lookup"><span data-stu-id="27658-252">Binary content can include, for example, images and ink data.</span></span> <span data-ttu-id="27658-253">_pageInfoToExport_ 参数还指定是否在 **GetPageContent** 方法返回的 XML 代码中标记选择。</span><span class="sxs-lookup"><span data-stu-id="27658-253">The  _pageInfoToExport_ parameter also specifies whether to mark up the selection in the XML code that the **GetPageContent** method returns.</span></span> <span data-ttu-id="27658-254">它从 [PageInfo](enumerations-onenote-developer-reference.md#odc_PageInfo) 枚举中获取枚举值。</span><span class="sxs-lookup"><span data-stu-id="27658-254">It takes an enumerated value from the [PageInfo](enumerations-onenote-developer-reference.md#odc_PageInfo) enumeration.</span></span><br/><br/><span data-ttu-id="27658-255">_xsSchema_ &ndash;（可选）你希望作为输出的 OneNote XML 结构的版本，其类型为 **XMLSchema**。</span><span class="sxs-lookup"><span data-stu-id="27658-255">_xsSchema_ &ndash; (Optional) The version of the OneNote XML schema, of type **XMLSchema**, that you want to be output.</span></span> <span data-ttu-id="27658-256">您可以指定您需要 XML 架构版本 2013、2010、2007 还是当前版本。</span><span class="sxs-lookup"><span data-stu-id="27658-256">You can specify whether you want XML Schema version 2013, 2010, 2007, or the current version.</span></span> <br/><br/><span data-ttu-id="27658-257">**注意**：我们建议指定 OneNote 版本（例如 **xs2013**），而不是使用 **xsCurrent** 或将其留空，因为这样会使你的加载项使用 OneNote 的未来版本。</span><span class="sxs-lookup"><span data-stu-id="27658-257">**NOTE**:  We recommend specifying a version of OneNote (such as **xs2013**) instead of using **xsCurrent** or leaving it blank, because this will allow your add-in to work with future versions of OneNote.</span></span>           |
   
<span data-ttu-id="27658-p133">默认情况下，为了避免返回的 XML 字符串过长，OneNote 不会在 XML 代码中嵌入二进制内容。出于相同的原因，它不会使用选择属性标记当前选择。二进制对象的标记中包括 OneNote ID。要获取二进制对象，您可以调用 **GetBinaryPageContent** 方法并向其传递从 **GetPageContent** 方法获取的 OneNote ID。如果您并非立即需要二进制数据，可使用 **GetPageContent** 方法。</span><span class="sxs-lookup"><span data-stu-id="27658-p133">By default, to avoid excess length in the XML string it returns, OneNote does not embed binary content in the XML code. For the same reason, it does not mark up the current selection with selection attributes. Binary objects include a OneNote ID in their tags. To get a binary object, you call the **GetBinaryPageContent** method and pass it the OneNote ID you get from the **GetPageContent** method. You use the **GetPageContent** method when you do not need the binary data immediately.</span></span> 
  
### <a name="updatepagecontent-method"></a><span data-ttu-id="27658-263">UpdatePageContent 方法</span><span class="sxs-lookup"><span data-stu-id="27658-263">UpdatePageContent method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="27658-264">**说明**</span><span class="sxs-lookup"><span data-stu-id="27658-264">**Description**</span></span>|<span data-ttu-id="27658-265">更新或修改页面上的内容。</span><span class="sxs-lookup"><span data-stu-id="27658-265">Updates or modifies the content on the page.</span></span>|
|<span data-ttu-id="27658-266">**语法**</span><span class="sxs-lookup"><span data-stu-id="27658-266">**Syntax**</span></span>| `HRESULT UpdatePageContent(`<br/>`[in]BSTR bstrPageChangesXmlIn,`<br/>`[in,defaultvalue(0)]DATE dateExpectedLastModified,`<br/>`[in,defaultvalue(xsCurrent)]XMLSchema xsSchema,`<br/>`[in,defaultvalue(false)]VARIANT_BOOL force);`|
|<span data-ttu-id="27658-267">**参数**</span><span class="sxs-lookup"><span data-stu-id="27658-267">**Parameters**</span></span>| <span data-ttu-id="27658-268">_bstrPageChangesXmlIn_ &ndash; 包含 OneNote XML 代码的字符串，其中包括你想对页面所做的更改。</span><span class="sxs-lookup"><span data-stu-id="27658-268">_bstrPageChangesXmlIn_ &ndash; A string that contains OneNote XML code that includes the changes you want to make to the page.</span></span><br/><br/><span data-ttu-id="27658-269">_dateExpectedLastModified_ &ndash;（可选）你认为要更新的页面的上次修改日期和时间。</span><span class="sxs-lookup"><span data-stu-id="27658-269">_dateExpectedLastModified_ &ndash; (Optional) The date and time that you think the page you want to update was last modified.</span></span> <span data-ttu-id="27658-270">如果你为此参数传递一个非零值，OneNote 将继续更新，前提是仅当你传递的值与页面上次修改的实际日期和时间匹配。</span><span class="sxs-lookup"><span data-stu-id="27658-270">If you pass a non-zero value for this parameter, OneNote proceeds with the update only if the value you pass matches the actual date and time the page was last modified.</span></span> <span data-ttu-id="27658-271">为此参数传递一个值有助于防止意外覆盖自上次页面修改以来用户所做的编辑。</span><span class="sxs-lookup"><span data-stu-id="27658-271">Passing a value for this parameter helps prevent accidentally overwriting edits users made since the last time the page was modified.</span></span><br/><br/><span data-ttu-id="27658-272">_xsSchema_ &ndash;（可选）你希望作为输出的 OneNote XML 结构的版本，其类型为 **XMLSchema**。</span><span class="sxs-lookup"><span data-stu-id="27658-272">_xsSchema_ &ndash; (Optional) The version of the OneNote XML schema, of type **XMLSchema**, that you want to be output.</span></span> <span data-ttu-id="27658-273">你可以指定需要 XML 架构版本 2013、2010、2007 还是当前版本。</span><span class="sxs-lookup"><span data-stu-id="27658-273">You can specify whether you want XML schema version 2013, 2010, 2007, or the current version.</span></span> <br/><br/><span data-ttu-id="27658-274">**注意**：我们建议指定 OneNote 版本（例如 **xs2013**），而不是使用 **xsCurrent** 或将其留空，因为这样会使你的加载项使用 OneNote 的未来版本。</span><span class="sxs-lookup"><span data-stu-id="27658-274">**NOTE**:  We recommend specifying a version of OneNote (such as **xs2013**) instead of using **xsCurrent** or leaving it blank, because this will allow your add-in to work with future versions of OneNote.</span></span><br/><br/><span data-ttu-id="27658-275">_force_（可选）设置为 **true** 可更新页面内容，即使页面上有来自 OneNote 未来版本的未知数据；否则，设置为 **false**（默认设置）。</span><span class="sxs-lookup"><span data-stu-id="27658-275">_force_(Optional) **true** to update the page content, even if there is unknown data on the page from a future version of OneNote; otherwise, **false** (the default).</span></span> |
   
<span data-ttu-id="27658-p136">您可以使用此方法以多种方式修改页面。例如，您可以使用 **UpdatePageContent** 方法向页面添加轮廓、更改轮廓的内容、添加图像、添加墨迹、移动内容或修改轮廓中的文本。</span><span class="sxs-lookup"><span data-stu-id="27658-p136">You can use this method to modify the page in various ways. For example, you can use the **UpdatePageContent** method to add an outline to a page, change the content of an outline, add images, add ink, move content, or modify text in outlines.</span></span> 
  
<span data-ttu-id="27658-p137">更具体地说，您可以使用 **GetPageContent** 方法导入现有页面，对页面的 XML 代码进行一些更改，然后使用 **UpdatePageContent** 方法再次导入整个页面。或者，您可以使用此方法在现有页面底部添加新页面对象，例如图像。</span><span class="sxs-lookup"><span data-stu-id="27658-p137">As a more specific example, you might use the **GetPageContent** method to export an existing page, make some changes to the XML code for the page, and then use the **UpdatePageContent** method to import the entire page again. Or, you might use this method to add new page objects, such as images, to the bottom of an existing page.</span></span> 
  
<span data-ttu-id="27658-p138">在您传递到 **UpdatePageContent** 方法的 XML 代码中，您唯一必须包含的对象是已经更改的页面级别对象（例如轮廓、页面上的图像或页面上的墨迹）。此方法不会修改或删除未在  _bstrPageChangesXmlIn_ 参数中指定的页面级别对象。该方法会完全替换 ID 与所传递对象匹配的页面级别对象。因此，您必须在代码中完整指定所有页面级别对象，包括现有内容以及您想对其所做的更改。</span><span class="sxs-lookup"><span data-stu-id="27658-p138">The only objects that you must include in the XML code that you pass to the **UpdatePageContent** method are page-level objects (such as outlines, images on the page, or ink on the page) that have changed. This method does not modify or remove page-level objects that you do not specify in the  _bstrPageChangesXmlIn_ parameter. The method entirely replaces page-level objects, such as outlines, whose IDs match those of the objects you pass. Consequently, you must fully specify all page-level objects in your code, including their existing content and changes you want to make to them.</span></span> 
  
<span data-ttu-id="27658-p139">例如，如果您的页面包含轮廓和背景页面图像，您可以替换轮廓并将图像保留不变，方法是在 XML 代码中完全指定轮廓、使用现有轮廓的 ID 且不在代码中包含图像。因为您在代码中修改的轮廓完全替换了现有轮廓，您必须包含轮廓的完整内容。</span><span class="sxs-lookup"><span data-stu-id="27658-p139">For example, if your page contains an outline and a background page image, you can replace the outline and leave the image unchanged by completely specifying the outline in the XML code, using the ID of the existing outline, and not including the image in the code. Because the revised outline you include in the code completely replaces the existing outline, you must include the entire contents of the outline.</span></span>
  
<span data-ttu-id="27658-p140">此外， **UpdatePageContent** 方法仅修改在  _bstrPageChangesXmlIn_ 参数中指定的元素属性。例如，如果您指定了 **PageSettings** 元素的部分但并非全部属性，您未指定的属性将保留不变。</span><span class="sxs-lookup"><span data-stu-id="27658-p140">Also, the **UpdatePageContent** method modifies only element properties that you specify in the  _bstrPageChangesXmlIn_ parameter. For example, if you specify some, but not all, properties of the **PageSettings** element, the properties that you do not specify remain unchanged.</span></span> 
  
<span data-ttu-id="27658-p141">以下示例说明如何使用 **UpdatePageContent** 方法更改页面的标题并向页面添加示例文本。在运行此代码之前，将代码中显示的页面 ID 替换为有效的页面 ID，以便代码可在您的计算机上正常运行。您可以使用 **GetHierarchy** 方法并检查输出，以获取页面的页面 ID。</span><span class="sxs-lookup"><span data-stu-id="27658-p141">The following example shows how to use the **UpdatePageContent** method to change the title of a page and add some sample text to the page. Before running the code, substitute a valid page ID for the page ID shown in the code, so that the code works on your computer. You can get the page ID for a page by using the **GetHierarchy** method and examining the output.</span></span> 
  
```cs
static void UpdatePageContent()
    {
        OneNote.Application onApplication = new OneNote.Application();
        String strImportXML;
        strImportXML = "<?xml version=\"1.0\"?>" +
            "<one:Page xmlns:one=\"http://schemas.microsoft.com/office/onenote/12/2004/onenote\" 
            ID=\"{3428B7BB-EF39-4B9C-A167-3FAE20630C37}{1}{B0}\">" +
            "    <one:PageSettings RTL=\"false\" color=\"automatic\">" +
            "        <one:PageSize>" +
            "            <one:Automatic/>" +
            "        </one:PageSize>" +
            "        <one:RuleLines visible=\"false\"/>" +
            "    </one:PageSettings>" +
            "    <one:Title style=\"font-family:Calibri;
                 font-size:17.0pt\" lang=\"en-US\">" +
            "        <one:OE alignment=\"left\">" +
            "            <one:T>" +
            "                <![CDATA[My Sample Page]]>" +
            "            </one:T>" +
            "        </one:OE>" +
            "    </one:Title>" +
            "    <one:Outline >" +
            "        <one:Position x=\"120\" y=\"160\"/>" +
            "        <one:Size width=\"120\" height=\"15\"/>" +
            "        <one:OEChildren>" +
            "            <one:OE alignment=\"left\">" +
            "                <one:T>" +
            "                    <![CDATA[Sample Text]]>" +
            "                </one:T>" +
            "            </one:OE>" +
            "        </one:OEChildren>" +
            "    </one:Outline>" +
            "</one:Page>";
        // Update the page content.
        onApplication.UpdatePageContent(strImportXML, System.DateTime.MinValue);
    }

```

### <a name="getbinarypagecontent-method"></a><span data-ttu-id="27658-291">GetBinaryPageContent 方法</span><span class="sxs-lookup"><span data-stu-id="27658-291">GetBinaryPageContent method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="27658-292">**说明**</span><span class="sxs-lookup"><span data-stu-id="27658-292">**Description**</span></span> <br/> |<span data-ttu-id="27658-293">在 OneNote 页面上返回二进制对象（例如墨迹或图像）作为 base-64 编码的字符串。</span><span class="sxs-lookup"><span data-stu-id="27658-293">Returns a binary object, such as ink or images, on an OneNote page as a base-64-encoded string.</span></span>  <br/> |
|<span data-ttu-id="27658-294">**语法**</span><span class="sxs-lookup"><span data-stu-id="27658-294">**Syntax**</span></span> <br/> | `HRESULT GetBinaryPageContent(`<br/>`[in]BSTR bstrPageID,`<br/>`[in]BSTR bstrCallbackID,`<br/>`[out]BSTR * pbstrBinaryObjectB64Out);` <br/> |
|<span data-ttu-id="27658-295">**参数**</span><span class="sxs-lookup"><span data-stu-id="27658-295">**Parameters**</span></span> <br/> | <span data-ttu-id="27658-296">_bstrPageID_ &ndash; 包含要获取的二进制对象的页面的 OneNote ID。</span><span class="sxs-lookup"><span data-stu-id="27658-296">_bstrPageID_ &ndash; The OneNote ID of the page that contains the binary object to get.</span></span>  <br/><br/><span data-ttu-id="27658-297">_bstrCallBackID_ &ndash; 你获取的二进制对象的 OneNote ID。</span><span class="sxs-lookup"><span data-stu-id="27658-297">_bstrCallBackID_ &ndash; The OneNote ID of the binary object you want to get.</span></span> <span data-ttu-id="27658-298">此 ID 称为 **callbackID**，位于 **GetPageContent** 方法返回的页面的 OneNote XML 代码中。</span><span class="sxs-lookup"><span data-stu-id="27658-298">This ID, known as a **callbackID**, is in the OneNote XML code for a page returned by the **GetPageContent** method.</span></span>  <br/><br/><span data-ttu-id="27658-299">_pbstrBinaryObectB64Out_ &ndash;（输出参数）指向 OneNote 在其中写入二进制对象作为 base-64 编码字符串的字符串的指针。</span><span class="sxs-lookup"><span data-stu-id="27658-299">_pbstrBinaryObectB64Out_ &ndash; (Output parameter) A pointer to a string into which OneNote writes the binary object as a base-64-encoded string.</span></span>  <br/> |
   
### <a name="deletepagecontent-method"></a><span data-ttu-id="27658-300">DeletePageContent 方法</span><span class="sxs-lookup"><span data-stu-id="27658-300">DeletePageContent method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="27658-301">**说明**</span><span class="sxs-lookup"><span data-stu-id="27658-301">**Description**</span></span> <br/> |<span data-ttu-id="27658-302">从页面中删除对象 &ndash; 例如，**边框**、**墨迹**或**图像**对象。</span><span class="sxs-lookup"><span data-stu-id="27658-302">Deletes an object &ndash; such as an **Outline**, **Ink**, or **Image** object from a page.</span></span>  <br/> |
|<span data-ttu-id="27658-303">**语法**</span><span class="sxs-lookup"><span data-stu-id="27658-303">**Syntax**</span></span> <br/> | `HRESULT DeletePageContent(`<br/>`[in]BSTR bstrPageID,`<br/>`[in]BSTR bstrObjectID,`<br/>`[in,defaultvalue(0)]DATE dateExpectedLastModified,`<br/>`[in,defaultvalue(#)]VARIANT_BOOL force);` <br/> |
|<span data-ttu-id="27658-304">**参数**</span><span class="sxs-lookup"><span data-stu-id="27658-304">**Parameters**</span></span> <br/> | <span data-ttu-id="27658-305">_bstrPageID_ &ndash; 包含要删除的对象的页面的 OneNote ID。</span><span class="sxs-lookup"><span data-stu-id="27658-305">_bstrPageID_ &ndash; The OneNote ID of the page that contains the object to delete.</span></span>  <br/><br/><span data-ttu-id="27658-306">_bstrObjectID_ &ndash; 你想删除的对象的 OneNote ID。</span><span class="sxs-lookup"><span data-stu-id="27658-306">_bstrObjectID_ &ndash; The OneNote ID of the object that you want to delete.</span></span>  <br/><br/><span data-ttu-id="27658-307">_dateExpectedLastModified_ &ndash;（可选）你认为包含要删除的内容的页面的上次修改日期和时间。</span><span class="sxs-lookup"><span data-stu-id="27658-307">_dateExpectedLastModified_ &ndash; (Optional) The date and time that you think the page that contains content you want to delete was last modified.</span></span> <span data-ttu-id="27658-308">如果您为此参数传递一个非零值，OneNote 将继续删除，前提是仅当您传递的值与页面上次修改的实际日期和时间匹配。</span><span class="sxs-lookup"><span data-stu-id="27658-308">If you pass a non-zero value for this parameter, OneNote proceeds with the deletion only if the value you pass matches the actual date and time the page was last modified.</span></span> <span data-ttu-id="27658-309">为此参数传递一个值有助于防止意外覆盖自上次页面修改以来用户所做的编辑。</span><span class="sxs-lookup"><span data-stu-id="27658-309">Passing a value for this parameter helps prevent accidentally overwriting edits made by users since the last time the page was modified.</span></span>  <br/><br/><span data-ttu-id="27658-310">_force_ &ndash;（可选）设置为 **true** 可更新页面内容，即使页面上有来自 OneNote 未来版本的未知数据；否则，设置为 **false**（默认设置）。</span><span class="sxs-lookup"><span data-stu-id="27658-310">_force_ &ndash; (Optional) **true** to update the page content, even if there is unknown data on the page from a future version of OneNote; otherwise, **false** (the default).</span></span>  <br/> |
   
### <a name="publish-method"></a><span data-ttu-id="27658-311">Publish 方法</span><span class="sxs-lookup"><span data-stu-id="27658-311">Publish method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="27658-312">**说明**</span><span class="sxs-lookup"><span data-stu-id="27658-312">**Description**</span></span> <br/> |<span data-ttu-id="27658-313">将您指定的页面导出到 OneNote 支持的任何格式的文件。</span><span class="sxs-lookup"><span data-stu-id="27658-313">Exports the page you specify to a file in any format that OneNote supports.</span></span>  <br/> |
|<span data-ttu-id="27658-314">**语法**</span><span class="sxs-lookup"><span data-stu-id="27658-314">**Syntax**</span></span> <br/> | `HRESULT Publish(`<br/>`[in]BSTR bstrHierarchyID,`<br/>`[in]BSTR bstrTargetFilePath,`<br/>`[in,defaultvalue(pfOneNote)]PublishFormat pfPublishFormat,`<br/>`[in,defaultvalue(0)]BSTR bstrCLSIDofExporter);` <br/> |
|<span data-ttu-id="27658-315">**参数**</span><span class="sxs-lookup"><span data-stu-id="27658-315">**Parameters**</span></span> <br/> | <span data-ttu-id="27658-316">_bstrHierarchyID_ &ndash; 你想导出的层次结构的 OneNote ID。</span><span class="sxs-lookup"><span data-stu-id="27658-316">_bstrHierarchyID_ &ndash; The OneNote ID of the hierarchy you want to export.</span></span>  <br/><br/><span data-ttu-id="27658-317">_bstrTargetFilePath_ &ndash; 你想保存生成的输出文件的位置的绝对路径。</span><span class="sxs-lookup"><span data-stu-id="27658-317">_bstrTargetFilePath_ &ndash; The absolute path to the location where you want to save the resulting output file.</span></span> <span data-ttu-id="27658-318">你指定的文件必须是该位置尚不存在的文件。</span><span class="sxs-lookup"><span data-stu-id="27658-318">The file you specify must be one that does not already exist at that location.</span></span>  <br/><br/><span data-ttu-id="27658-319">_pfPublishFormat_ &ndash; [PublishFormat](enumerations-onenote-developer-reference.md#odc_PublishFormat) 枚举值之一，用于指定你希望发布页面所用的格式（例如 MTHML、PDF 等）。</span><span class="sxs-lookup"><span data-stu-id="27658-319">_pfPublishFormat_ &ndash; One of the [PublishFormat](enumerations-onenote-developer-reference.md#odc_PublishFormat) enumeration values that specifies the format in which you want the published page to be (for example, MTHML, PDF, and so on).</span></span>  <br/><br/><span data-ttu-id="27658-320">_bstrCLSIDofExporter_ &ndash; 可以导出 Microsoft Windows 增强型图元文件 (.emf) 的注册 COM 应用程序的类 ID (CLSID)。</span><span class="sxs-lookup"><span data-stu-id="27658-320">_bstrCLSIDofExporter_ &ndash; The class ID (CLSID) of a registered COM application that can export Microsoft Windows enhanced metafiles (.emf).</span></span> <span data-ttu-id="27658-321">COM 应用程序必须实现 **IMsoDocExporter** 接口。</span><span class="sxs-lookup"><span data-stu-id="27658-321">The COM application must implement the **IMsoDocExporter** interface.</span></span> <span data-ttu-id="27658-322">包含此参数是为了允许第三方开发人员写入自己的代码以使用自定义格式发布 OneNote 内容。</span><span class="sxs-lookup"><span data-stu-id="27658-322">This parameter is included to permit third-party developers to write their own code to publish OneNote content in a custom format.</span></span> <span data-ttu-id="27658-323">有关 **IMsoDocExporter** 界面的详细信息，请参阅 [扩展 Office 2007 固定格式导出功能](https://msdn.microsoft.com/library/office/aa338206%28v=office.12%29.aspx)。</span><span class="sxs-lookup"><span data-stu-id="27658-323">For more information about the **IMsoDocExporter** interface, see [Extending the Office 2007 Fixed-Format Export Feature](https://msdn.microsoft.com/library/office/aa338206%28v=office.12%29.aspx).</span></span>  <br/> |
   
<span data-ttu-id="27658-324">当前 OneNote 支持以下文件格式：</span><span class="sxs-lookup"><span data-stu-id="27658-324">Currently, OneNote supports the following file formats:</span></span>
  
- <span data-ttu-id="27658-325">MHTML 文件 (.mht)</span><span class="sxs-lookup"><span data-stu-id="27658-325">MHTML files (.mht)</span></span>
- <span data-ttu-id="27658-326">Adobe Acrobat PDF 文件 (.pdf)</span><span class="sxs-lookup"><span data-stu-id="27658-326">Adobe Acrobat PDF files (.pdf)</span></span>
- <span data-ttu-id="27658-327">XML Paper Specification (XPS) 文件 (.xps)</span><span class="sxs-lookup"><span data-stu-id="27658-327">XML Paper Specification (XPS) files (.xps)</span></span>
- <span data-ttu-id="27658-328">OneNote 2013、2010 或 2007 文件 (.one)</span><span class="sxs-lookup"><span data-stu-id="27658-328">OneNote 2013, 2010 or 2007 files (.one)</span></span>
- <span data-ttu-id="27658-329">OneNote Package 文件 (.onepkg)</span><span class="sxs-lookup"><span data-stu-id="27658-329">OneNote Package files (.onepkg)</span></span>
- <span data-ttu-id="27658-330">Microsoft Word 文档（.doc 或 .docx）</span><span class="sxs-lookup"><span data-stu-id="27658-330">Microsoft Word documents (.doc or .docx)</span></span>
- <span data-ttu-id="27658-331">Microsoft Windows 增强型图元文件 (.emf)</span><span class="sxs-lookup"><span data-stu-id="27658-331">Microsoft Windows Enhanced Metafiles (.emf)</span></span>
- <span data-ttu-id="27658-332">HTML 文件 (.html)</span><span class="sxs-lookup"><span data-stu-id="27658-332">HTML files (.html)</span></span>
    
<span data-ttu-id="27658-333">此方法产生的结果与你通过单击 UI 中的“发布”\*\*\*\* 并指定格式获取的结果完全相同。</span><span class="sxs-lookup"><span data-stu-id="27658-333">This method produces exactly the same results you would get by clicking **Publish** in the UI and specifying the format.</span></span> 
  
## <a name="navigation-methods"></a><span data-ttu-id="27658-334">Navigation 方法</span><span class="sxs-lookup"><span data-stu-id="27658-334">Navigation methods</span></span>
<span data-ttu-id="27658-335"><a name="ON14DevRef_Application_Navigation"> </a></span><span class="sxs-lookup"><span data-stu-id="27658-335"><a name="ON14DevRef_Application_Navigation"> </a></span></span>

<span data-ttu-id="27658-336">此部分中所述的方法使您可以查找、导航到并链接到 OneNote 笔记本、节组、节、页面和页面对象。</span><span class="sxs-lookup"><span data-stu-id="27658-336">The methods described in this section enable you to find, navigate to, and link to OneNote notebooks, section groups, sections, pages, and page objects.</span></span>
  
### <a name="navigateto-method"></a><span data-ttu-id="27658-337">NavigateTo 方法</span><span class="sxs-lookup"><span data-stu-id="27658-337">NavigateTo method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="27658-338">**说明**</span><span class="sxs-lookup"><span data-stu-id="27658-338">**Description**</span></span> <br/> |<span data-ttu-id="27658-339">导航到指定对象（例如节、页面和页面中的 **Outline** 元素）。</span><span class="sxs-lookup"><span data-stu-id="27658-339">Navigates to the specified object (for example, sections, pages, and **Outline** elements within pages).</span></span>  <br/> |
|<span data-ttu-id="27658-340">**语法**</span><span class="sxs-lookup"><span data-stu-id="27658-340">**Syntax**</span></span> <br/> | `HRESULT NavigateTo(`<br/>`[in]BSTR bstrHierarchyObjectID,`<br/>`[in,defaultvalue(#)]BSTR bstrObjectID,`<br/>`[in,defaultvalue(0)]VARIANT_BOOL fNewWindow);` <br/> |
|<span data-ttu-id="27658-341">**参数**</span><span class="sxs-lookup"><span data-stu-id="27658-341">**Parameters**</span></span> <br/> | <span data-ttu-id="27658-342">_bstrHierarchyObjectID_ &ndash; 你希望在 OneNote 层次结构中导航到的对象的 OneNote ID。</span><span class="sxs-lookup"><span data-stu-id="27658-342">_bstrHierarchyObjectID_ &ndash; The OneNote ID of the object you want to navigate to in the OneNote Hierarchy.</span></span>  <br/><br/><span data-ttu-id="27658-343">_bstrObjectID_ &ndash; 你希望在 OneNote 页面上导航到的对象的 OneNote ID。</span><span class="sxs-lookup"><span data-stu-id="27658-343">_bstrObjectID_ &ndash; The OneNote ID of the object you want to navigate to on the OneNote page.</span></span>  <br/><br/><span data-ttu-id="27658-344">_fNewWindow_ &ndash;（可选）设置为 **true** 可在一个新的 OneNote 窗口中打开指定对象。</span><span class="sxs-lookup"><span data-stu-id="27658-344">_fNewWindow_ &ndash; (Optional) **true** to open specified object in a new OneNote window.</span></span> <span data-ttu-id="27658-345">设置为 **false** 不会打开一个新的 OneNote 窗口（如果已打开一个窗口）。</span><span class="sxs-lookup"><span data-stu-id="27658-345">**false** does not open a new OneNote window if one is open.</span></span>  <br/> |
   
### <a name="navigatetourl-method"></a><span data-ttu-id="27658-346">NavigateToUrl 方法</span><span class="sxs-lookup"><span data-stu-id="27658-346">NavigateToUrl method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="27658-347">**说明**</span><span class="sxs-lookup"><span data-stu-id="27658-347">**Description**</span></span> <br/> |<span data-ttu-id="27658-p147">如果已传递 OneNote 链接 (onenote://)，OneNote 窗口便会在 OneNote 中的相应位置打开。如果链接是 OneNote 外部的（如 https:// 或 file://），便会看到安全对话框。解除后，OneNote 便会尝试打开链接，此时返回 **HResult.hrObjectDoesNotExist** 错误。</span><span class="sxs-lookup"><span data-stu-id="27658-p147">If passed a OneNote link (onenote://), opens the OneNote window to the corresponding location in OneNote. If the link is external to OneNote (such as https:// or file://), a security dialog box will appear. Upon dismissal, OneNote attempts to open the link and an **HResult.hrObjectDoesNotExist** error is returned.  </span></span><br/> |
|<span data-ttu-id="27658-351">**语法**</span><span class="sxs-lookup"><span data-stu-id="27658-351">**Syntax**</span></span> <br/> | `HRESULT NavigateTo(`<br/>`[in]BSTR bstrUrl,`<br/>`[in,defaultvalue(0)]VARIANT_BOOL fNewWindow);` <br/> |
|<span data-ttu-id="27658-352">**参数**</span><span class="sxs-lookup"><span data-stu-id="27658-352">**Parameters**</span></span> <br/> | <span data-ttu-id="27658-353">_bstrUrl_ &ndash; 指示导航到何处的字符串。</span><span class="sxs-lookup"><span data-stu-id="27658-353">_bstrUrl_ &ndash; A string that indicates where to navigate to.</span></span> <span data-ttu-id="27658-354">这可以是 OneNote 链接，也可以是任何其他 URL，例如 Web 链接或网络位置。</span><span class="sxs-lookup"><span data-stu-id="27658-354">This could be a OneNote link, or any other URL, such as a web link or network location.</span></span>  <br/><br/><span data-ttu-id="27658-355">_fNewWindow_ &ndash;（可选）设置为 **true** 可在一个新的 OneNote 窗口中打开指定 URL。</span><span class="sxs-lookup"><span data-stu-id="27658-355">_fNewWindow_ &ndash; (Optional) **true** to open the specified URL in a new OneNote window.</span></span> <span data-ttu-id="27658-356">设置为 **false** 不会打开一个新的 OneNote 窗口（如果已打开一个窗口）。</span><span class="sxs-lookup"><span data-stu-id="27658-356">**false** does not open a new OneNote window if one is open.</span></span>  <br/> |
   
### <a name="gethyperlinktoobject-method"></a><span data-ttu-id="27658-357">GetHyperLinkToObject 方法</span><span class="sxs-lookup"><span data-stu-id="27658-357">GetHyperLinkToObject method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="27658-358">**说明**</span><span class="sxs-lookup"><span data-stu-id="27658-358">**Description**</span></span> <br/> |<span data-ttu-id="27658-359">获取指定笔记本、节组、节、页面或页面对象的 OneNote 超链接。</span><span class="sxs-lookup"><span data-stu-id="27658-359">Gets a OneNote hyperlink to the specified notebook, section group, section, page, or page object.</span></span>  <br/> |
|<span data-ttu-id="27658-360">**语法**</span><span class="sxs-lookup"><span data-stu-id="27658-360">**Syntax**</span></span> <br/> | `HRESULT GetHyperlinkToObject(`<br/>`[in] BSTR bstrHierarchyID,`<br/>`[in] BSTR bstrPageContentObjectID,`<br/>`[out] BSTR * pbstrHyperlinkOut);` <br/> |
|<span data-ttu-id="27658-361">**参数**</span><span class="sxs-lookup"><span data-stu-id="27658-361">**Parameters**</span></span> <br/> | <span data-ttu-id="27658-362">_bstrHierarchyID_ &ndash; 你需要其超链接的笔记本、节组、节或页面的 OneNote ID。</span><span class="sxs-lookup"><span data-stu-id="27658-362">_bstrHierarchyID_ &ndash; The OneNote ID for the notebook, section group, section, or page for which you want a hyperlink.</span></span>  <br/><br/><span data-ttu-id="27658-363">_bstrPageContentObjectID_ &ndash;（可选）你需要其超链接的页面中对象的 OneNote ID。</span><span class="sxs-lookup"><span data-stu-id="27658-363">_bstrPageContentObjectID_ &ndash; (Optional) The OneNote ID for the object within the page for which you want a hyperlink.</span></span> <span data-ttu-id="27658-364">例如，对象可以是边框或 **Outline** 元素。</span><span class="sxs-lookup"><span data-stu-id="27658-364">For example, the object can be an outline or **Outline** element.</span></span> <span data-ttu-id="27658-365">如果您传递空字符串 ("")，返回的链接将指向在  _bstrHierarchyID_ 参数中指定的笔记本、节组、节或页面。</span><span class="sxs-lookup"><span data-stu-id="27658-365">If you pass an empty string (""), the returned link points to the notebook, section group, section, or page that you specified in the  _bstrHierarchyID_ parameter.</span></span> <span data-ttu-id="27658-366">如果您为  _bstrPageContentObjectID_ 参数指定非空字符串，  _bstrHierarchyID_ 参数必须为对包含指定对象的页面的引用。</span><span class="sxs-lookup"><span data-stu-id="27658-366">If you pass a non-empty string for the  _bstrPageContentObjectID_ parameter, the  _bstrHierarchyID_ parameter must be a reference to the page that contains the specified object.</span></span>  <br/><br/><span data-ttu-id="27658-367">_pbstrHyperlinkOut_ &ndash;（输出参数）指向 **GetHyperlinkToObject** 方法将在其中写入输出超链接文本的字符串的指针。</span><span class="sxs-lookup"><span data-stu-id="27658-367">_pbstrHyperlinkOut_ &ndash; (Output parameter) A pointer to a string into which the **GetHyperlinkToObject** method writes the output hyperlink text.</span></span>  <br/> |
   
<span data-ttu-id="27658-368">当你尝试导航到生成的链接时，OneNote 将在浏览器中打开并显示指定的对象。</span><span class="sxs-lookup"><span data-stu-id="27658-368">When you attempt to navigate to the resulting link, OneNote opens and displays the specified object in the browser.</span></span>
  
### <a name="getwebhyperlinktoobject-method"></a><span data-ttu-id="27658-369">GetWebHyperlinktoObject 方法</span><span class="sxs-lookup"><span data-stu-id="27658-369">GetWebHyperlinktoObject method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="27658-370">**说明**</span><span class="sxs-lookup"><span data-stu-id="27658-370">**Description**</span></span> <br/> |<span data-ttu-id="27658-371">返回在 OneNote Web 客户端中打开的对象的超链接。</span><span class="sxs-lookup"><span data-stu-id="27658-371">Returns a hyperlink to an object that opens in the OneNote Web Client.</span></span>  <br/> |
|<span data-ttu-id="27658-372">**语法**</span><span class="sxs-lookup"><span data-stu-id="27658-372">**Syntax**</span></span> <br/> | `HRESULT GetWebHyperlinkToObject (`<br/>`[in] BSTR bstrHierarchyID,`<br/>`[in] BSTR bstrPageContentObjectID,`<br/>`[out] BSTR * pbstrHyperlinkOut);` <br/> |
|<span data-ttu-id="27658-373">**参数**</span><span class="sxs-lookup"><span data-stu-id="27658-373">**Parameters**</span></span> <br/> | <span data-ttu-id="27658-374">_bstrHierarchyID_ &ndash; 你需要其 Web 超链接的笔记本、节组、节或页面的 OneNote ID。</span><span class="sxs-lookup"><span data-stu-id="27658-374">_bstrHierarchyID_ &ndash; The OneNote ID for the notebook, section group, section or page for which you want a web hyperlink.</span></span>  <br/><br/><span data-ttu-id="27658-375">_bstrPageContentObjectID_ &ndash;（可选）你需要其超链接的页面中对象的 OneNote ID。</span><span class="sxs-lookup"><span data-stu-id="27658-375">_bstrPageContentObjectID_ &ndash; (Optional) The OneNote ID for the object within the page for which you want a hyperlink.</span></span> <span data-ttu-id="27658-376">例如，对象可以是边框或 **Outline** 元素。</span><span class="sxs-lookup"><span data-stu-id="27658-376">For example, the object can be an outline or **Outline** element.</span></span> <span data-ttu-id="27658-377">如果您传递空字符串 ("")，返回的链接将指向在  _bstrHierarchyID_ 参数中指定的笔记本、节组、节或页面。</span><span class="sxs-lookup"><span data-stu-id="27658-377">If you pass an empty string (""), the returned link points to the notebook, section group, section, or page that you specified in the  _bstrHierarchyID_ parameter.</span></span> <span data-ttu-id="27658-378">如果您为  _bstrPageContentObjectID_ 参数指定非空字符串，  _bstrHierarchyID_ 参数必须为对包含指定对象的页面的引用。</span><span class="sxs-lookup"><span data-stu-id="27658-378">If you pass a non-empty string for the  _bstrPageContentObjectID_ parameter, the  _bstrHierarchyID_ parameter must be a reference to the page that contains the specified object.</span></span>  <br/><br/><span data-ttu-id="27658-379">_pbstrHyperlinkOut_ &ndash;（输出参数）指向 **GetWebHyperlinkToObject** 方法将在其中写入输出超链接文本的字符串的指针。</span><span class="sxs-lookup"><span data-stu-id="27658-379">_pbstrHyperlinkOut_ &ndash; (Output parameter) A pointer to a string into which the **GetWebHyperlinkToObject** method writes the output hyperlink text.</span></span> <span data-ttu-id="27658-380">如果无法为笔记本创建 Web 超链接，则返回 null 值。</span><span class="sxs-lookup"><span data-stu-id="27658-380">If a web hyperlink cannot be created for the notebook, a null value is returned.</span></span>  <br/> |
   
### <a name="findpages-method"></a><span data-ttu-id="27658-381">FindPages 方法</span><span class="sxs-lookup"><span data-stu-id="27658-381">FindPages method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="27658-382">**说明**</span><span class="sxs-lookup"><span data-stu-id="27658-382">**Description**</span></span>|<span data-ttu-id="27658-383">返回与指定查询词匹配的页面的列表。</span><span class="sxs-lookup"><span data-stu-id="27658-383">Returns a list of pages that match the specified query term.</span></span>|
|<span data-ttu-id="27658-384">**语法**</span><span class="sxs-lookup"><span data-stu-id="27658-384">**Syntax**</span></span>| `HRESULT FindPages(`<br/>`[in]BSTR bstrStartNodeID,`<br/>`[in]BSTR bstrSearchBSTR,`<br/>`[out]BSTR * pbstrHierarchyXmlOut,`<br/>`[in,defaultvalue(#)]VARIANT_BOOL fIncludeUnindexedPages,`<br/>`[in,defaultvalue(0)]VARIANT_BOOL fDisplay,`<br/>`[in,defaultvalue(#)]XMLSchema xsSchema);`|
|<span data-ttu-id="27658-385">**参数**</span><span class="sxs-lookup"><span data-stu-id="27658-385">**Parameters**</span></span>| <span data-ttu-id="27658-386">_bstrStartNodeID_ &ndash; 要在其下搜索内容的节点（根、笔记本、节组或节）。</span><span class="sxs-lookup"><span data-stu-id="27658-386">_bstrStartNodeID_ &ndash; The node (root, notebook, section group, or section) below which to search for content.</span></span> <span data-ttu-id="27658-387">此参数设置搜索的范围。</span><span class="sxs-lookup"><span data-stu-id="27658-387">This parameter sets the scope for the search.</span></span><br/><br/><span data-ttu-id="27658-388">_bstrSearchString_ &ndash; 搜索字符串。</span><span class="sxs-lookup"><span data-stu-id="27658-388">_bstrSearchString_ &ndash; The search string.</span></span> <span data-ttu-id="27658-389">传递与你在 OneNote UI 的搜索框中键入的字符串完全相同的字符串。</span><span class="sxs-lookup"><span data-stu-id="27658-389">Pass exactly the same string that you would type into the search box in the OneNote UI.</span></span> <span data-ttu-id="27658-390">可以使用按位运算符，例如 **AND** 和 **OR**，它们必须全部为大写。</span><span class="sxs-lookup"><span data-stu-id="27658-390">You can use bitwise operators, such as **AND** and **OR**, which must be all uppercase.</span></span><br/><br/><span data-ttu-id="27658-391">_pbstrHierarchyXmlOut_ &ndash;（输出参数）指向你希望 OneNote 将输出 XML 字符串写入其中的字符串的指针。</span><span class="sxs-lookup"><span data-stu-id="27658-391">_pbstrHierarchyXmlOut_ &ndash; (Output parameter) A pointer to a string into which you want OneNote to write the output XML string.</span></span> <span data-ttu-id="27658-392">生成的 XML 字符串包含从根向下到包含与搜索字符串匹配的任何页面的笔记本层次结构。</span><span class="sxs-lookup"><span data-stu-id="27658-392">The resulting XML string contains the notebook hierarchy from the root downward to, and including, any pages that match the search string.</span></span> <span data-ttu-id="27658-393">例如，**FindPages** 方法不会列出层次结构中没有页面匹配的节。</span><span class="sxs-lookup"><span data-stu-id="27658-393">For example, the **FindPages** method does not list sections that have no page matches in the hierarchy.</span></span> <span data-ttu-id="27658-394">此外，如果单个节中只有一个页面与字符串匹配，则返回的层次结构包括该节和页面的路径，但不包括笔记本层次结构的任何其他部分。</span><span class="sxs-lookup"><span data-stu-id="27658-394">Also, if only one page in a single section matches the string, the returned hierarchy includes the path to that section and page, but to no other parts of the notebook hierarchy.</span></span><br/><br/><span data-ttu-id="27658-395">_fIncludeUnindexedPages_ &ndash;（可选）设置为 **true** 可搜索尚未由 Windows Search 编制索引的页面，否则设置为 **false**。</span><span class="sxs-lookup"><span data-stu-id="27658-395">_fIncludeUnindexedPages_ &ndash; (Optional) **true** to search pages that have not been indexed by Windows Search; otherwise, **false**.</span></span><br/><br/><span data-ttu-id="27658-396">_fDisplay_ &ndash;（可选）设置为 **true** 还可以在用户的 UI 中运行搜索，就像是用户自己键入的一样。</span><span class="sxs-lookup"><span data-stu-id="27658-396">_fDisplay_ &ndash; (Optional) **true** to also run the search in the UI for the user, just as if the user had typed it themselves.</span></span> <span data-ttu-id="27658-397">设置为 **false** 则在不更改 UI 的情况下执行查询（默认设置）。</span><span class="sxs-lookup"><span data-stu-id="27658-397">**false** to perform the query with no change to the UI (the default).</span></span><br/><br/><span data-ttu-id="27658-398">_xsSchema_ &ndash;（可选）字符串 _pbstrHierarchyXmlOut_ 的 OneNote 架构版本。</span><span class="sxs-lookup"><span data-stu-id="27658-398">_xsSchema_ &ndash; (Optional) The OneNote schema version of the string  _pbstrHierarchyXmlOut_.</span></span> <span data-ttu-id="27658-399">此可选值用于指定包含 _pbstrHierarchyXmlOut_ 字符串的 OneNote XML 架构的版本。</span><span class="sxs-lookup"><span data-stu-id="27658-399">This optional value is used to specify the version of the OneNote XML schema that contains the  _pbstrHierarchyXmlOut_ string.</span></span> <span data-ttu-id="27658-400">如果未指定此值，则 OneNote 将假定 XML 在架构版本 _xsCurrent_ 中。</span><span class="sxs-lookup"><span data-stu-id="27658-400">If this value is not specified, OneNote will assume that the XML is in schema version  _xsCurrent_.</span></span> <br/><br/><span data-ttu-id="27658-401">**注意**：我们建议指定 OneNote 版本（例如 **xs2013**），而不是使用 **xsCurrent** 或将其留空，因为这样会使你的加载项使用 OneNote 的未来版本。</span><span class="sxs-lookup"><span data-stu-id="27658-401">**NOTE**:  We recommend specifying a version of OneNote (such as **xs2013**) instead of using **xsCurrent** or leaving it blank, because this will allow your add-in to work with future versions of OneNote.</span></span>           |
   
 <span data-ttu-id="27658-p158">仅当您已在计算机上安装 Microsoft Search 3.0 或 4.0 时， **FindPages** 才能正常运行。Windows Vista 和 Windows 7 包括此组件。但是，如果您运行 Windows 的早期版本，则必须安装 [Windows Search](https://www.microsoft.com/windows/products/winfamily/desktopsearch/getitnow.mspx) 才能使 **FindPages** 正常运行。</span><span class="sxs-lookup"><span data-stu-id="27658-p158">**FindPages** works only if you have Microsoft Search 3.0 or 4.0 installed on your computer. Windows Vista and Windows 7 include this component. However, if you are running an earlier version of Windows, you must install [Windows Search](https://www.microsoft.com/windows/products/winfamily/desktopsearch/getitnow.mspx) for **FindPages** to work.</span></span> 
  
### <a name="findmeta-method"></a><span data-ttu-id="27658-405">FindMeta 方法</span><span class="sxs-lookup"><span data-stu-id="27658-405">FindMeta method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="27658-406">**说明**</span><span class="sxs-lookup"><span data-stu-id="27658-406">**Description**</span></span>|<span data-ttu-id="27658-407">返回包含与指定查询词匹配的元数据的 OneNote 对象列表。</span><span class="sxs-lookup"><span data-stu-id="27658-407">Returns a list of OneNote objects that contain metadata that matches the specified query term.</span></span>|
|<span data-ttu-id="27658-408">**语法**</span><span class="sxs-lookup"><span data-stu-id="27658-408">**Syntax**</span></span>| `HRESULT FindMeta (`<br/>`[in]BSTR bstrStartNodeID,`<br/>`[in]BSTR bstrSearchBSTRName,`<br/>`[out]BSTR * pbstrHierarchyXmlOut,`<br/>`[in,defaultvalue(#)]VARIANT_BOOL fIncludeUnindexedPages,`<br/>`[in,defaultvalue(#)]XMLSchema xsSchema);`|
|<span data-ttu-id="27658-409">**参数**</span><span class="sxs-lookup"><span data-stu-id="27658-409">**Parameters**</span></span>| <span data-ttu-id="27658-410">_bstrStartNodeID_ &ndash; 要在其下搜索内容的节点（根、笔记本、节组或节）。</span><span class="sxs-lookup"><span data-stu-id="27658-410">_bstrStartNodeID_ &ndash; The node (root, notebook, section group, or section) below which to search for content.</span></span> <span data-ttu-id="27658-411">此参数设置搜索的范围。</span><span class="sxs-lookup"><span data-stu-id="27658-411">This parameter sets the scope for the search.</span></span><br/><br/><span data-ttu-id="27658-412">_bstrSearchStringName_ &ndash; 搜索字符串。</span><span class="sxs-lookup"><span data-stu-id="27658-412">_bstrSearchStringName_ &ndash; The search string.</span></span> <span data-ttu-id="27658-413">传入元数据名称的任何部分。</span><span class="sxs-lookup"><span data-stu-id="27658-413">Pass in any part of the metadata name.</span></span> <span data-ttu-id="27658-414">如果传入空字符串或 null 值，则具有元数据的所有对象将与查询匹配。</span><span class="sxs-lookup"><span data-stu-id="27658-414">If you pass in an empty string or a null value, all objects that have metadata will match the query.</span></span><br/><br/><span data-ttu-id="27658-415">_pbstrHierarchyXmlOut_ &ndash;（输出参数）指向你希望 OneNote 将输出 XML 字符串写入其中的字符串的指针。</span><span class="sxs-lookup"><span data-stu-id="27658-415">_pbstrHierarchyXmlOut_ &ndash; (Output parameter) A pointer to a string into which you want OneNote to write the output XML string.</span></span> <span data-ttu-id="27658-416">生成的 XML 字符串包含从根向下到包含与搜索字符串匹配的任何页面的笔记本层次结构。</span><span class="sxs-lookup"><span data-stu-id="27658-416">The resulting XML string contains the notebook hierarchy from the root downward to, and including, any pages that match the search string.</span></span> <span data-ttu-id="27658-417">例如，**FindPages** 方法不会列出层次结构中没有页面匹配的节。</span><span class="sxs-lookup"><span data-stu-id="27658-417">For example, the **FindPages** method does not list sections that have no page matches in the hierarchy.</span></span> <span data-ttu-id="27658-418">此外，如果单个节中只有一个页面与字符串匹配，则返回的层次结构包括该节和页面的路径，但不包括笔记本层次结构的任何其他部分。</span><span class="sxs-lookup"><span data-stu-id="27658-418">Also, if only one page in a single section matches the string, the returned hierarchy includes the path to that section and page, but to no other parts of the notebook hierarchy.</span></span>  <br/><br/><span data-ttu-id="27658-419">_fIncludeUnindexedPages_ &ndash;（可选）设置为 **true** 可搜索尚未由 Windows Search 编制索引的页面，否则设置为 **false**。</span><span class="sxs-lookup"><span data-stu-id="27658-419">_fIncludeUnindexedPages_ &ndash; (Optional) **true** to search pages that have not been indexed by Windows Search; otherwise, **false**.</span></span><br/><br/><span data-ttu-id="27658-420">_xsSchema_ &ndash;（可选）字符串 _pbstrHierarchyXmlOut_ 的 OneNote 架构版本。</span><span class="sxs-lookup"><span data-stu-id="27658-420">_xsSchema_ &ndash; (Optional) The OneNote schema version of the string  _pbstrHierarchyXmlOut_.</span></span> <span data-ttu-id="27658-421">此可选值用于指定包含 _pbstrHierarchyXmlOut_ 字符串的 OneNote XML 架构的版本。</span><span class="sxs-lookup"><span data-stu-id="27658-421">This optional value is used to specify the version of the OneNote XML schema that contains the  _pbstrHierarchyXmlOut_ string.</span></span> <span data-ttu-id="27658-422">如果未指定此值，则 OneNote 将假定 XML 在架构版本 _xsCurrent_ 中。</span><span class="sxs-lookup"><span data-stu-id="27658-422">If this value is not specified, OneNote will assume that the XML is in schema version  _xsCurrent_.</span></span> <br/><br/><span data-ttu-id="27658-423">**注意**：我们建议指定 OneNote 版本（例如 **xs2013**），而不是使用 **xsCurrent** 或将其留空，因为这样会使你的加载项使用 OneNote 的未来版本。</span><span class="sxs-lookup"><span data-stu-id="27658-423">**NOTE**:  We recommend specifying a version of OneNote (such as **xs2013**) instead of using **xsCurrent** or leaving it blank, because this will allow your add-in to work with future versions of OneNote.</span></span>           |
   
<span data-ttu-id="27658-p163">仅当您已在计算机上安装 Microsoft Windows Search 3.0 或 4.0 时， **FindMeta** 才能正常运行。Windows Vista 和 Windows 7 包括此组件。但是，如果您运行 Windows 的早期版本，则必须安装 [Windows Search](https://www.microsoft.com/windows/products/winfamily/desktopsearch/getitnow.mspx) 才能使 **FindMeta** 正常运行。</span><span class="sxs-lookup"><span data-stu-id="27658-p163">**FindMeta** works only if you have Microsoft Windows Search 3.0 or 4.0 installed on your computer. Windows Vista and Windows 7 include this component. However, if you are running an earlier version of Windows, you must install [Windows Search](https://www.microsoft.com/windows/products/winfamily/desktopsearch/getitnow.mspx) for **FindMeta** to work.</span></span> 
  
## <a name="functional-methods"></a><span data-ttu-id="27658-427">功能性方法</span><span class="sxs-lookup"><span data-stu-id="27658-427">Functional methods</span></span>
<span data-ttu-id="27658-428"><a name="ON14DevRef_Application_Functional"> </a></span><span class="sxs-lookup"><span data-stu-id="27658-428"><a name="ON14DevRef_Application_Functional"> </a></span></span>

<span data-ttu-id="27658-429">本节中介绍的方法使你可以在 OneNote 应用程序中执行某些操作或设置参数。</span><span class="sxs-lookup"><span data-stu-id="27658-429">The methods described in this section enable you to perform certain actions or set parameters within the OneNote application.</span></span>
  
### <a name="mergefiles-method"></a><span data-ttu-id="27658-430">MergeFiles 方法</span><span class="sxs-lookup"><span data-stu-id="27658-430">MergeFiles method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="27658-431">**说明**</span><span class="sxs-lookup"><span data-stu-id="27658-431">**Description**</span></span> <br/> |<span data-ttu-id="27658-p164">允许用户将同一个文件的更改合并为一个。要使文件被视为同一个，它们必须使用相同的 OneNote ID。</span><span class="sxs-lookup"><span data-stu-id="27658-p164">Allows users to merge changes for the same file into one. For the files to be considered the same, they must have the same OneNote ID.</span></span>  <br/> |
|<span data-ttu-id="27658-434">**语法**</span><span class="sxs-lookup"><span data-stu-id="27658-434">**Syntax**</span></span> <br/> | `HRESULT MergeFiles (`<br/>`[in]BSTR bstrBaseFile,`<br/>`[in]BSTR bstrClientFile,`<br/>`[in]BSTR bstrServerFile,`<br/>`[in]BSTR bstrTargetFile);` <br/> |
|<span data-ttu-id="27658-435">**参数**</span><span class="sxs-lookup"><span data-stu-id="27658-435">**Parameters**</span></span> <br/> | <span data-ttu-id="27658-436">_bstrBaseFile_ &ndash; 文件的初始状态的 .one 文件位置的路径字符串。</span><span class="sxs-lookup"><span data-stu-id="27658-436">_bstrBaseFile_ &ndash; The path string to the .one file location of the initial state of the file.</span></span>  <br/><br/><span data-ttu-id="27658-437">_bstrClientFile_ &ndash; 服务器文件更改与基文件合并后，第二组更改要与基文件合并的 .one 文件位置的路径字符串。</span><span class="sxs-lookup"><span data-stu-id="27658-437">_bstrClientFile_ &ndash; The path string to the .one file location of the second set of changes to be merged with the base file after the server file changes are merged with the base.</span></span>  <br/><br/><span data-ttu-id="27658-438">_bstrServerFile_ &ndash; 第一组更改要与基文件合并的 .one 文件位置的路径字符串。</span><span class="sxs-lookup"><span data-stu-id="27658-438">_bstrServerFile_ &ndash; The path string to the .one file location of the first set of changes to be merged with the base file.</span></span>  <br/><br/><span data-ttu-id="27658-439">_bstrTargetFile_ &ndash; 包含合并后更改的文件的 .one 文件位置的路径字符串。</span><span class="sxs-lookup"><span data-stu-id="27658-439">_bstrTargetFile_ &ndash; The path string to the .one file location of the file with the merged changes.</span></span>  <br/> |
   
<span data-ttu-id="27658-440">**MergeFiles** 方法适用于可能存在多个版本的 OneNote 文件的移动方案。</span><span class="sxs-lookup"><span data-stu-id="27658-440">The **MergeFiles** method was intended for mobile scenarios in which multiple versions of an OneNote file may exist.</span></span> 
  
### <a name="mergesections-method"></a><span data-ttu-id="27658-441">MergeSections 方法</span><span class="sxs-lookup"><span data-stu-id="27658-441">MergeSections method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="27658-442">**说明**</span><span class="sxs-lookup"><span data-stu-id="27658-442">**Description**</span></span> <br/> |<span data-ttu-id="27658-443">将一个节的内容合并到 OneNote 中的另一个节。</span><span class="sxs-lookup"><span data-stu-id="27658-443">Merges the content of one section into another in OneNote.</span></span>  <br/> |
|<span data-ttu-id="27658-444">**语法**</span><span class="sxs-lookup"><span data-stu-id="27658-444">**Syntax**</span></span> <br/> | `HRESULT MergeSections (`<br/>`[in]BSTR bstrSectionSourceId,`<br/>`[in]BSTR bstrSectionDestinationId);` <br/> |
|<span data-ttu-id="27658-445">**参数**</span><span class="sxs-lookup"><span data-stu-id="27658-445">**Parameters**</span></span> <br/> | <span data-ttu-id="27658-446">_bstrSectionSourceId_ &ndash; 要合并的节的 OneNote ID。</span><span class="sxs-lookup"><span data-stu-id="27658-446">_bstrSectionSourceId_ &ndash; The OneNote ID of the section to be merged.</span></span>  <br/><br/><span data-ttu-id="27658-447">_bstrSectionDestinationId_ &ndash; 要合并到的节的 OneNote ID。</span><span class="sxs-lookup"><span data-stu-id="27658-447">_bstrSectionDestinationId_ &ndash; The OneNote ID of the section to be merged into.</span></span> <span data-ttu-id="27658-448">源节将合并到此目标节。</span><span class="sxs-lookup"><span data-stu-id="27658-448">The source section will be merged into this destination section.</span></span>  <br/> |
   
<span data-ttu-id="27658-449">此方法执行的操作与你右键单击某个节时可见的**合并到另一个节**功能相同。</span><span class="sxs-lookup"><span data-stu-id="27658-449">This method performs the same operation as the **Merge into Another Section** feature that is visible when you right-click a section.</span></span> 
  
### <a name="quickfiling-method"></a><span data-ttu-id="27658-450">QuickFiling 方法</span><span class="sxs-lookup"><span data-stu-id="27658-450">QuickFiling method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="27658-451">**说明**</span><span class="sxs-lookup"><span data-stu-id="27658-451">**Description**</span></span> <br/> |<span data-ttu-id="27658-452">返回 [IQuickFilingDialog](quick-filing-dialog-box-interfaces-onenote.md#odc_IQuickFilingDialog) 对话框的一个实例，可用于在 OneNote 层次结构树中选择位置。</span><span class="sxs-lookup"><span data-stu-id="27658-452">Returns an instance of the [IQuickFilingDialog](quick-filing-dialog-box-interfaces-onenote.md#odc_IQuickFilingDialog) dialog box, which can be used to select a location within the OneNote hierarchy tree.</span></span>  <br/> |
|<span data-ttu-id="27658-453">**语法**</span><span class="sxs-lookup"><span data-stu-id="27658-453">**Syntax**</span></span> <br/> | `HRESULT QuickFiling (`<br/>` );` <br/> |
   
### <a name="synchierarchy-method"></a><span data-ttu-id="27658-454">SyncHierarchy 方法</span><span class="sxs-lookup"><span data-stu-id="27658-454">SyncHierarchy method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="27658-455">**说明**</span><span class="sxs-lookup"><span data-stu-id="27658-455">**Description**</span></span> <br/> |<span data-ttu-id="27658-456">强制 OneNote 将指定对象与磁盘上的源文件中同步。</span><span class="sxs-lookup"><span data-stu-id="27658-456">Forces OneNote to sync the specified object with the source file on disk.</span></span>  <br/> |
|<span data-ttu-id="27658-457">**语法**</span><span class="sxs-lookup"><span data-stu-id="27658-457">**Syntax**</span></span> <br/> | `HRESULT SyncHierarchy (`<br/>`[in]BSTR bstrHierarchyID);` <br/> |
|<span data-ttu-id="27658-458">**参数**</span><span class="sxs-lookup"><span data-stu-id="27658-458">**Parameters**</span></span> <br/> | <span data-ttu-id="27658-459">_bstrHierarchyID_ &ndash; 要同步的对象的 OneNote ID。</span><span class="sxs-lookup"><span data-stu-id="27658-459">_bstrHierarchyID_ &ndash; The OneNote ID of the object to be synced.</span></span>  <br/> |
   
### <a name="setfilinglocation-method"></a><span data-ttu-id="27658-460">SetFilingLocation 方法</span><span class="sxs-lookup"><span data-stu-id="27658-460">SetFilingLocation method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="27658-461">**说明**</span><span class="sxs-lookup"><span data-stu-id="27658-461">**Description**</span></span> <br/> |<span data-ttu-id="27658-462">允许用户指定应在 OneNote 中的什么位置以及如何归档特定类型的内容。</span><span class="sxs-lookup"><span data-stu-id="27658-462">Allows users to specify where and how certain types of content should be filed in OneNote.</span></span>  <br/> |
|<span data-ttu-id="27658-463">**语法**</span><span class="sxs-lookup"><span data-stu-id="27658-463">**Syntax**</span></span> <br/> | `HRESULT SetFilingLocation (`<br/>`[in]FilingLocation flToSet,`<br/>`[in]FilingLocationType fltToSet,`<br/>`[in]BSTR bstrFilingSectionID);`           <br/> |
|<span data-ttu-id="27658-464">**参数**</span><span class="sxs-lookup"><span data-stu-id="27658-464">**Parameters**</span></span> <br/> | <span data-ttu-id="27658-465">_flToSet_ &ndash; 要设置的归档位置的对象类型。</span><span class="sxs-lookup"><span data-stu-id="27658-465">_flToSet_ &ndash; The object type of the filing location to set.</span></span>  <br/><br/><span data-ttu-id="27658-466">_fltToSet_ &ndash; 类型要归档到的位置。</span><span class="sxs-lookup"><span data-stu-id="27658-466">_fltToSet_ &ndash; The location in which to file the type.</span></span>  <br/><br/><span data-ttu-id="27658-467">_bstrFilingSectionID_ &ndash; 你希望在其中设置位置的节或页面的 OneNote ID。</span><span class="sxs-lookup"><span data-stu-id="27658-467">_bstrFilingSectionID_ &ndash; The OneNote ID of the section or page at which location you want to set.</span></span> <span data-ttu-id="27658-468">如果不适用，则用户可以传入 null 或空字符串。</span><span class="sxs-lookup"><span data-stu-id="27658-468">If not applicable, the user can pass in null or an empty string.</span></span>  <br/> |
   
<span data-ttu-id="27658-p167">可以归档的内容类型包括 Outlook 项目和 Internet Explorer 中的 Web 笔记，这些笔记在各个应用程序中通过“发送到 OneNote”\*\*\*\* 命令导入到 OneNote。打印到 OneNote 的项目的归档位置也可以使用此方法进行设置。</span><span class="sxs-lookup"><span data-stu-id="27658-p167">The types of content that can be filed include Outlook items and Web Notes from Internet Explorer that are imported to OneNote through the **Send to OneNote** command in each application. The filing location of items that are printed into OneNote can also be set with this method.</span></span> 
  
## <a name="properties"></a><span data-ttu-id="27658-471">属性</span><span class="sxs-lookup"><span data-stu-id="27658-471">Properties</span></span>
<span data-ttu-id="27658-472"><a name="ON14DevRef_Application_Properties"> </a></span><span class="sxs-lookup"><span data-stu-id="27658-472"><a name="ON14DevRef_Application_Properties"> </a></span></span>

<span data-ttu-id="27658-473">此部分介绍了 **Application** 界面的属性。</span><span class="sxs-lookup"><span data-stu-id="27658-473">This section describes the properties of the **Application** interface.</span></span> 
  
|<span data-ttu-id="27658-474">**属性**</span><span class="sxs-lookup"><span data-stu-id="27658-474">**Property**</span></span>|<span data-ttu-id="27658-475">**说明**</span><span class="sxs-lookup"><span data-stu-id="27658-475">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="27658-476">**Windows**</span><span class="sxs-lookup"><span data-stu-id="27658-476">**Windows**</span></span> <br/> |<span data-ttu-id="27658-p168">允许用户访问打开的 OneNote 窗口。此属性允许用户通过一系列 OneNote 窗口进行枚举并修改特定的窗口属性。有关详细信息，请参阅 [Windows 界面](window-interfaces-onenote.md)。  </span><span class="sxs-lookup"><span data-stu-id="27658-p168">Gives users access to opened OneNote windows. This property allows users to enumerate through the set of OneNote windows and modify certain window properties. For more information, see [Windows Interfaces](window-interfaces-onenote.md).  </span></span><br/> |
|<span data-ttu-id="27658-480">**COMAddIns**</span><span class="sxs-lookup"><span data-stu-id="27658-480">**COMAddIns**</span></span> <br/> |<span data-ttu-id="27658-p169">返回 OneNote 的 **COMAddIns** 集合。该集合包含对 OneNote 可用的所有 COM 加载项。 **COMAddins** 集合的 **Count** 属性返回可用 COM 加载项的数目。有关详细信息，请参阅 [COMAddIns](https://msdn.microsoft.com/library/office/ff865489.aspx) 对象。  </span><span class="sxs-lookup"><span data-stu-id="27658-p169">Returns the **COMAddIns** collection for OneNote. This collection contains all of the COM add-ins that are available to OneNote. The **Count** property of the **COMAddins** collection returns the number of available COM add-ins. For more information, see the [COMAddIns](https://msdn.microsoft.com/library/office/ff865489.aspx) object.  </span></span><br/> |
|<span data-ttu-id="27658-484">**LanguageSettings**</span><span class="sxs-lookup"><span data-stu-id="27658-484">**LanguageSettings**</span></span> <br/> |<span data-ttu-id="27658-485">使您可以访问一些 API 以更改 OneNote 的公共语言设置。</span><span class="sxs-lookup"><span data-stu-id="27658-485">Enables you to access some APIs to change the common language settings of OneNote.</span></span>  <br/> |
   
## <a name="events"></a><span data-ttu-id="27658-486">活动</span><span class="sxs-lookup"><span data-stu-id="27658-486">Events</span></span>
<span data-ttu-id="27658-487"><a name="ON14DevRef_Application_Events"> </a></span><span class="sxs-lookup"><span data-stu-id="27658-487"><a name="ON14DevRef_Application_Events"> </a></span></span>

<span data-ttu-id="27658-488">此部分介绍了 Application 界面的事件。</span><span class="sxs-lookup"><span data-stu-id="27658-488">This section describes the events of the Application interface.</span></span>
  
> [!CAUTION]
> <span data-ttu-id="27658-489">当前无法在托管代码中添加事件。</span><span class="sxs-lookup"><span data-stu-id="27658-489">Events cannot currently be added in managed code.</span></span> 
  
### <a name="onnavigate-event"></a><span data-ttu-id="27658-490">OnNavigate 事件</span><span class="sxs-lookup"><span data-stu-id="27658-490">OnNavigate event</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="27658-491">**说明**</span><span class="sxs-lookup"><span data-stu-id="27658-491">**Description**</span></span> <br/> |<span data-ttu-id="27658-492">允许用户指定在从当前 OneNote 位置离开以导航 OneNote UI 时要调用的函数。</span><span class="sxs-lookup"><span data-stu-id="27658-492">Allows a user to assign a function to be called when the OneNote UI is navigated away from the current OneNote location.</span></span>  <br/> |
|<span data-ttu-id="27658-493">**语法**</span><span class="sxs-lookup"><span data-stu-id="27658-493">**Syntax**</span></span> <br/> | `Event OnNavigate (`<br/>` );` <br/> |
   
### <a name="onhierarchychange-method"></a><span data-ttu-id="27658-494">OnHierarchyChange 方法</span><span class="sxs-lookup"><span data-stu-id="27658-494">OnHierarchyChange method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="27658-495">**说明**</span><span class="sxs-lookup"><span data-stu-id="27658-495">**Description**</span></span> <br/> |<span data-ttu-id="27658-p170">允许用户指定在 OneNote 层次结构变更（例如，添加或删除页面，或移动各个节）时要调用的函数。层次结构变更分批进行，因此如果同时或几乎同时发生了多个变更，OneNote 引发事件一次。</span><span class="sxs-lookup"><span data-stu-id="27658-p170">Allows a user to assign a function to be called any time the OneNote hierarchy changes (for example, adding or deleting pages, or moving sections). Hierarchy changes are batched, so if multiple changes occur at or near the same time, OneNote raises the event once.</span></span>  <br/> |
|<span data-ttu-id="27658-498">**语法**</span><span class="sxs-lookup"><span data-stu-id="27658-498">**Syntax**</span></span> <br/> | `Event OnHierarchyChange (`<br/>` BSTR bstrActivePageID);` <br/> |
|<span data-ttu-id="27658-499">**参数**</span><span class="sxs-lookup"><span data-stu-id="27658-499">**Parameters**</span></span> <br/> | <span data-ttu-id="27658-500">_bstrActivePageID_ &ndash; 传递活动页面的 OneNote ID。</span><span class="sxs-lookup"><span data-stu-id="27658-500">_bstrActivePageID_ &ndash; Passes the OneNote ID of the active page.</span></span>  <br/> |
   
## <a name="see-also"></a><span data-ttu-id="27658-501">另请参阅</span><span class="sxs-lookup"><span data-stu-id="27658-501">See also</span></span>

- [<span data-ttu-id="27658-502">OneNote 开发人员参考</span><span class="sxs-lookup"><span data-stu-id="27658-502">OneNote developer reference</span></span>](onenote-developer-reference.md)

