---
title: 为什么要使用 Outlook PIA
TOCTitle: Why use the Outlook PIA
ms:assetid: 5cc9085e-7c97-4698-8cb9-e33e427c02e7
ms:mtpsurl: https://msdn.microsoft.com/library/office/bb645534(v=office.15)
ms:contentKeyID: 55119773
ms.date: 07/24/2014
mtps_version: v=office.15
ms.openlocfilehash: 7e36a0de33ea3e23d53ff82b31cc937dff0d7e14
ms.sourcegitcommit: ef717c65d8dd41ababffb01eafc443c79950aed4
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 10/04/2018
ms.locfileid: "25406055"
---
# <a name="why-use-the-outlook-pia"></a><span data-ttu-id="c46e2-102">为什么要使用 Outlook PIA</span><span class="sxs-lookup"><span data-stu-id="c46e2-102">Why Use the Outlook PIA</span></span>

<span data-ttu-id="c46e2-103">从 Outlook 98 开始，Outlook 为开发人员提供了一个对象模型，用于将 Outlook 功能集成到应用程序中、扩展 Outlook 或实现 Outlook 的自动化。</span><span class="sxs-lookup"><span data-stu-id="c46e2-103">Starting in Microsoft Office Outlook 98, Microsoft Outlook provides an object model for developers to integrate Outlook functionality into an application, extend Outlook, or automate Outlook.</span></span> <span data-ttu-id="c46e2-104">此对象模型旨在使用组件对象模型 (COM) 技术。</span><span class="sxs-lookup"><span data-stu-id="c46e2-104">This object model is designed to work with the Component Object Model (COM) technology.</span></span> <span data-ttu-id="c46e2-105">过去，Outlook 应用程序开发人员都是使用 Visual Basic for Applications (VBA) 和 Visual Basic 来开发 COM 解决方案。</span><span class="sxs-lookup"><span data-stu-id="c46e2-105">Historically, Outlook application developers developed COM solutions by using Microsoft Visual Basic for Applications (VBA) and Microsoft Visual Basic.</span></span> <span data-ttu-id="c46e2-106">但是，使用 VBA 开发的 Outlook 解决方案具有部署限制（尤其是在企业环境中），而且在部署后很难再进行更新。</span><span class="sxs-lookup"><span data-stu-id="c46e2-106">However, Outlook solutions developed with VBA have deployment limitations, particularly in corporate environments, and are difficult to update after they are deployed.</span></span>

<span data-ttu-id="c46e2-107">.NET Framework 提供了一套丰富的类库和支持技术，它们可突破 VBA 和 COM 加载项的许多限制。但是，对于托管应用程序而言，我们需要在 .NET 环境和 COM 环境之间架设一座桥梁，以便根据 COM 对象模型进行编程。</span><span class="sxs-lookup"><span data-stu-id="c46e2-107">The Microsoft .NET Framework provides a rich set of class libraries and support technologies that address many of the limitations of VBA and COM add-ins. However, a managed application needs a bridge between the .NET and COM environments in order to program against a COM object model. An interop assembly is a COM wrapper that acts as the bridge. Consequently, more Outlook solutions are now developed as managed applications that rely on an interop assembly. For more information about how interop assemblies facilitate interoperability between .NET and COM, see Introduction to Interoperability Between COM and .NET.</span></span> <span data-ttu-id="c46e2-108">互操作程序集便是一种充当这种桥梁的 COM 包装。</span><span class="sxs-lookup"><span data-stu-id="c46e2-108">An interop assembly is a COM wrapper that acts as the bridge.</span></span> <span data-ttu-id="c46e2-109">因此，现在越来越多的 Outlook 解决方案都是以依赖于互操作程序集的托管应用程序的形式进行开发。</span><span class="sxs-lookup"><span data-stu-id="c46e2-109">Consequently, more Outlook solutions are now developed as managed applications that rely on an interop assembly.</span></span> <span data-ttu-id="c46e2-110">有关互操作程序集如何利用 .NET 和 COM 之间的互操作性的更多信息，请参阅 [COM 和 .NET 之间的互操作性简介](introduction-to-interoperability-between-com-and-net.md)。</span><span class="sxs-lookup"><span data-stu-id="c46e2-110">For more information about how interop assemblies facilitate interoperability between .NET and COM, see [Introduction to interoperability between COM and .NET](introduction-to-interoperability-between-com-and-net.md).</span></span>

<span data-ttu-id="c46e2-p103">互操作程序集用于描述 COM 类型，允许托管代码与 COM 对象模型交互。可以使用任意数量的互操作程序集来描述一个给定的 COM 类型。作为类型库的发布者，Outlook 提供主互操作程序集 (PIA)，其中包含对基于 COM 的 Outlook 对象模型的官方描述。通常，最好使用 Outlook PIA，而不要依靠来自另一个源的互操作程序集。</span><span class="sxs-lookup"><span data-stu-id="c46e2-p103">An interop assembly describes COM types and enables managed code to interact with a COM object model. Any number of interop assemblies can exist to describe a given COM type. As publisher of the type library, Outlook provides a Primary Interop Assembly (PIA) that contains the official description of the COM-based Outlook object model. In general, it is best to use the Outlook PIA rather than relying on an interop assembly from another source.</span></span>

## <a name="using-visual-studio-and-office-developer-tools-for-visual-studio"></a><span data-ttu-id="c46e2-115">使用 Visual Studio 和面向 Visual Studio 的 Office 开发人员工具</span><span class="sxs-lookup"><span data-stu-id="c46e2-115">Install Visual Studio and Office Developer Tools for Visual Studio</span></span>

<span data-ttu-id="c46e2-116">开发人员可以在 Visual Studio 外部创建托管的 Outlook 解决方案，但是，在使用 Visual Studio 后，将 Outlook 功能集成到托管代码中的过程会变得更加简单。</span><span class="sxs-lookup"><span data-stu-id="c46e2-116">It is possible for developers to create managed Outlook solutions outside of Visual Studio, but using Visual Studio makes integrating Outlook functionality into managed code much easier.</span></span> <span data-ttu-id="c46e2-117">由于这种开发的便捷性，加载项开发人员更喜欢从 COM 开发迁移至 .NET 开发。</span><span class="sxs-lookup"><span data-stu-id="c46e2-117">The convenience and ease of development makes it more favorable for add-in developers to migrate from COM to .NET development.</span></span> <span data-ttu-id="c46e2-118">在设计时，开发人员可以使用面向 Visual Studio 的 Office 开发人员工具来创建对 Outlook 对象模型和 .NET Framework 均具有访问权限的加载项。</span><span class="sxs-lookup"><span data-stu-id="c46e2-118">At design time, developers can use Office Developer Tools for Visual Studio to create add-ins that have access to both the Outlook object model and the .NET Framework.</span></span> <span data-ttu-id="c46e2-119">在运行时，面向 Visual Studio 的 Office 开发人员工具会为这些加载项提供加载程序：当用户启动 Outlook 时，此加载程序会启动 Visual Studio Tools for Office Runtime 这一公共语言运行时 (CLR)，然后加载相应的加载项程序集。</span><span class="sxs-lookup"><span data-stu-id="c46e2-119">At run time, Office Developer Tools for Visual Studio provide a loader for these add-ins: when a user starts Outlook, this loader starts the common language runtime (CLR), the Visual Studio Tools for Office Runtime, and then loads the add-in assembly.</span></span> <span data-ttu-id="c46e2-120">该程序集可以捕获在 Outlook 中引发的事件。</span><span class="sxs-lookup"><span data-stu-id="c46e2-120">The assembly can capture events raised in Outlook.</span></span>

<span data-ttu-id="c46e2-121">Visual Studio 2012 会默认安装适用于 Office 2010 的加载项模板。</span><span class="sxs-lookup"><span data-stu-id="c46e2-121">Visual Studio 2012 installs the add-in templates for Office 2010 by default.</span></span> <span data-ttu-id="c46e2-122">若要使用面向 Visual Studio 的 Office 开发人员工具来开发适用于 Outlook 2013 的托管加载项，则必须[下载](https://aka.ms/officedevtoolsforvs2012)适用于 Office 2013 的模板。</span><span class="sxs-lookup"><span data-stu-id="c46e2-122">To use Office Developer Tools for Visual Studio to develop managed add-ins for Outlook 2013, you must [download](https://aka.ms/officedevtoolsforvs2012) the templates for Office 2013.</span></span>

<span data-ttu-id="c46e2-123">有关面向 Visual Studio 的 Office 开发人员工具的详细信息，请参阅[配置计算机以开发 Office 解决方案](https://docs.microsoft.com/visualstudio/vsto/how-to-configure-a-computer-to-develop-office-solutions?view=vs-2017)。</span><span class="sxs-lookup"><span data-stu-id="c46e2-123">For more information about Office Developer Tools for Visual Studio, see [Configure a computer to develop Office solutions](https://docs.microsoft.com/visualstudio/vsto/how-to-configure-a-computer-to-develop-office-solutions?view=vs-2017).</span></span> <span data-ttu-id="c46e2-124">有关为 Outlook 编程托管的加载项的详细信息，请参阅 [VSTO 加载项编程入门](https://docs.microsoft.com/visualstudio/vsto/getting-started-programming-vsto-add-ins?view=vs-2017)。</span><span class="sxs-lookup"><span data-stu-id="c46e2-124">For more information about programming managed add-ins for Outlook, see [Get started programming VSTO Add-ins](https://docs.microsoft.com/visualstudio/vsto/getting-started-programming-vsto-add-ins?view=vs-2017).</span></span>

## <a name="see-also"></a><span data-ttu-id="c46e2-125">另请参阅</span><span class="sxs-lookup"><span data-stu-id="c46e2-125">See also</span></span>

- [<span data-ttu-id="c46e2-126">安装和参考 Outlook PIA</span><span class="sxs-lookup"><span data-stu-id="c46e2-126">Installing and Referencing the Outlook PIA</span></span>](installing-and-referencing-the-outlook-pia.md)

