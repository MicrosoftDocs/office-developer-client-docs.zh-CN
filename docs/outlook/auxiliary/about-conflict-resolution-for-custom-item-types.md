---
title: 关于自定义项类型的冲突解决
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: overview
localization_priority: Normal
ms.assetid: 3f0853fc-f9f2-4314-ac55-47fe1e52d019
description: 本主题介绍如何解决在 Outlook 中创建的自定义项目类型的冲突。
ms.openlocfilehash: 357dd9182f26c4e9e1e264afdee296859e7b3483
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/23/2019
ms.locfileid: "32316945"
---
# <a name="about-conflict-resolution-for-custom-item-types"></a><span data-ttu-id="0ba50-103">关于自定义项类型的冲突解决</span><span class="sxs-lookup"><span data-stu-id="0ba50-103">About conflict resolution for custom item types</span></span>

<span data-ttu-id="0ba50-104">本主题介绍如何解决在 Outlook 中创建的自定义项目类型的冲突。</span><span class="sxs-lookup"><span data-stu-id="0ba50-104">This topic describes how to resolve conflicts for custom item types that you create in Outlook.</span></span>
  
## <a name="conflict-resolution-for-standard-outlook-item-types"></a><span data-ttu-id="0ba50-105">标准 Outlook 项目类型的冲突解决</span><span class="sxs-lookup"><span data-stu-id="0ba50-105">Conflict resolution for standard Outlook item types</span></span>

<span data-ttu-id="0ba50-106">在 Outlook 中, 同一项目的两个或更多副本相互独立修改时, 将发生冲突。</span><span class="sxs-lookup"><span data-stu-id="0ba50-106">In Outlook, conflicts occur when two or more copies of the same item have been modified independently of each other.</span></span> <span data-ttu-id="0ba50-107">Outlook 在同步过程中检测冲突。</span><span class="sxs-lookup"><span data-stu-id="0ba50-107">Outlook detects conflicts during synchronization.</span></span> <span data-ttu-id="0ba50-108">例如, 您可以在 outlook Web App 中更新会议项目, 然后在脱机工作时更新 outlook 中的同一会议项目。</span><span class="sxs-lookup"><span data-stu-id="0ba50-108">For example, you might update a meeting item online in Outlook Web App and then update the same meeting item in Outlook when you work offline.</span></span> <span data-ttu-id="0ba50-109">当 Outlook 再次联机并同步客户端计算机和服务器之间的数据时, 它会检测到同一会议项目有两个不同的副本。</span><span class="sxs-lookup"><span data-stu-id="0ba50-109">When Outlook goes online again and synchronizes the data between the client computer and the server, it detects that there are two different copies of the same meeting item.</span></span>
  
<span data-ttu-id="0ba50-110">当 Outlook 同步属于标准 Outlook 项目类型的项目时, 它会考虑特定于该项目类型的属性, 以检测可能的冲突。</span><span class="sxs-lookup"><span data-stu-id="0ba50-110">When Outlook synchronizes items that belong to a standard Outlook item type, it takes into consideration the properties that are specific to that item type to detect possible conflicts.</span></span> <span data-ttu-id="0ba50-111">Outlook 尝试解决冲突并将生成的副本存储在适当的文件夹中, 而无需请求用户干预。</span><span class="sxs-lookup"><span data-stu-id="0ba50-111">Outlook tries to resolve conflicts and stores the resultant copy in the appropriate folder without requesting user intervention.</span></span> <span data-ttu-id="0ba50-112">如果 outlook 认为, 生成的副本可能不包含所有重要数据, outlook 会将冲突副本存储在 "同步问题" 文件夹下的 "冲突" 文件夹中。</span><span class="sxs-lookup"><span data-stu-id="0ba50-112">In cases where Outlook considers that there is a possibility that the resultant copy may not contain all essential data, Outlook stores the conflicting copies in the Conflicts folder, under the Sync Issues folder.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="0ba50-113">只有在单击导航窗格中的 "**文件夹列表**" 之后, 才会隐藏同步问题及其子文件夹。</span><span class="sxs-lookup"><span data-stu-id="0ba50-113">Sync Issues and its subfolders are hidden until you click **Folder List** in the Navigation Pane.</span></span> 
  
<span data-ttu-id="0ba50-114">在这种情况下, 用户可以选择转到 "冲突" 文件夹以确认哪些项目发生冲突, 以及是否使用 "冲突" 文件夹中的副本替换 Outlook 决定保留的副本。</span><span class="sxs-lookup"><span data-stu-id="0ba50-114">In such cases, users can choose to go to the Conflicts folder to verify which items were in conflict and whether to use a copy in the Conflicts folder to replace the copy that Outlook decided to retain.</span></span>
  
## <a name="conflict-resolution-for-custom-item-types"></a><span data-ttu-id="0ba50-115">自定义项类型的冲突解决方法</span><span class="sxs-lookup"><span data-stu-id="0ba50-115">Conflict resolution for custom item types</span></span>

### <a name="item-types-and-message-classes"></a><span data-ttu-id="0ba50-116">项目类型和邮件类别</span><span class="sxs-lookup"><span data-stu-id="0ba50-116">Item types and message classes</span></span>
  
<span data-ttu-id="0ba50-117">Outlook 中的所有项目都与一个邮件类别相关联。</span><span class="sxs-lookup"><span data-stu-id="0ba50-117">All items in Outlook are associated with a message class.</span></span> <span data-ttu-id="0ba50-118">例如, 默认情况下, 邮件项目与邮件类 IPM 相关联 **。注释**。</span><span class="sxs-lookup"><span data-stu-id="0ba50-118">For example, by default, a mail item is associated with the message class **IPM.Note**.</span></span> <span data-ttu-id="0ba50-119">邮件类主要用于标识在 Outlook 中显示项目时应使用的窗体。</span><span class="sxs-lookup"><span data-stu-id="0ba50-119">The message class is primarily used to identify the form that should be used to display the item in Outlook.</span></span> <span data-ttu-id="0ba50-120">outlook 支持映射到 Outlook 中内置项目类型的邮件类别的列表。</span><span class="sxs-lookup"><span data-stu-id="0ba50-120">Outlook supports a list of message classes that are mapped to the types of items built in to Outlook.</span></span> <span data-ttu-id="0ba50-121">若要详细了解邮件类，请参阅[项类型和邮件类](https://msdn.microsoft.com/library/15b709cc-7486-b6c7-88a3-4a4d8e0ab292%28Office.15%29.aspx)。</span><span class="sxs-lookup"><span data-stu-id="0ba50-121">For more information about message classes, see [Item Types and Message Classes](https://msdn.microsoft.com/library/15b709cc-7486-b6c7-88a3-4a4d8e0ab292%28Office.15%29.aspx).</span></span> 
  
<span data-ttu-id="0ba50-122">用户可以创建自定义项目类型, 将自定义邮件类分配给自定义项目类型, 并让 Outlook 使用自定义窗体显示自定义项目类型。</span><span class="sxs-lookup"><span data-stu-id="0ba50-122">Users can create custom item types, assign custom message classes to the custom item types, and have Outlook use a custom form to display the custom item types.</span></span> <span data-ttu-id="0ba50-123">例如, 您可能希望 Outlook 为业务联系人显示自定义商务联系人窗体。</span><span class="sxs-lookup"><span data-stu-id="0ba50-123">For example, you may want Outlook to display a custom business contact form for your business contacts.</span></span> <span data-ttu-id="0ba50-124">若要执行此操作, 您可以创建自定义邮件类**IPM。请与**此邮件类别联系, 为此邮件类别创建自定义窗体, 并为其分配商务联系人。</span><span class="sxs-lookup"><span data-stu-id="0ba50-124">To do that, you can create a custom message class **IPM.Contact.Business**, create a custom form for this message class, and assign business contacts with this message class.</span></span> 
  
### <a name="registering-a-conflict-resolution-scheme-for-custom-item-types"></a><span data-ttu-id="0ba50-125">为自定义项类型注册冲突解决方案</span><span class="sxs-lookup"><span data-stu-id="0ba50-125">Registering a conflict resolution scheme for custom item types</span></span>
  
<span data-ttu-id="0ba50-126">当您创建自定义邮件类和自定义窗体之外的自定义项目类型时, 您还应考虑 Outlook 如何处理此项目类型的项目的副本之间的冲突。</span><span class="sxs-lookup"><span data-stu-id="0ba50-126">When you create a custom item type, other than the custom message class and custom form, you should also consider how you would like Outlook to handle conflicts between copies of an item of this item type.</span></span> <span data-ttu-id="0ba50-127">默认情况下, Outlook 使用所有项目通用的解决方案方案, 不会考虑特定于项目类型的属性, 并且会为用户提供冲突的副本以做出决定。</span><span class="sxs-lookup"><span data-stu-id="0ba50-127">By default, Outlook employs a resolution scheme common to all items, does not consider properties that are specific to an item type, and presents conflicting copies for the user to make a decision.</span></span> <span data-ttu-id="0ba50-128">这是因为自定义项类型可能在自定义窗体中定义自定义字段, 并且可能具有自定义属性和自定义代码。</span><span class="sxs-lookup"><span data-stu-id="0ba50-128">This is because custom item types may define custom fields in the custom form, and may have custom properties and custom code.</span></span> <span data-ttu-id="0ba50-129">如果您希望 Outlook 考虑项目特定的属性, 并尝试通过最少的用户干预解决冲突, 则必须通过 Windows 注册表中的设置指定。</span><span class="sxs-lookup"><span data-stu-id="0ba50-129">If you want Outlook to consider item-specific properties and attempt to resolve the conflict with minimal user intervention, you must specify that through a setting in the Windows registry.</span></span> <span data-ttu-id="0ba50-130">可以通过以下两种方式之一实现此目的:</span><span class="sxs-lookup"><span data-stu-id="0ba50-130">This can be achieved in one of two ways:</span></span> 
  
- <span data-ttu-id="0ba50-131">通过将组策略设置应用于设置注册表项 ConflictMsgCls 的本地计算机。</span><span class="sxs-lookup"><span data-stu-id="0ba50-131">By applying a Group Policy setting to the local computer that sets the registry key ConflictMsgCls.</span></span> <span data-ttu-id="0ba50-132">下面的示例指定 Outlook 2010 的版本 "14.0":</span><span class="sxs-lookup"><span data-stu-id="0ba50-132">The following example specifies the version "14.0" for Outlook 2010:</span></span> 
  
   `[HKCU]\Software\Policies\Microsoft\Office\14.0\Outlook\Options\ConflictMsgCls`
    
- <span data-ttu-id="0ba50-133">通过直接修改用户注册表项 ConflictMsgCls。</span><span class="sxs-lookup"><span data-stu-id="0ba50-133">By directly modifying the user registry key ConflictMsgCls.</span></span> <span data-ttu-id="0ba50-134">下面的示例指定 Outlook 2010 的版本 "14.0":</span><span class="sxs-lookup"><span data-stu-id="0ba50-134">The following example specifies the version "14.0" for Outlook 2010:</span></span> 
  
   `[HKCU]\Software\Microsoft\Office\14.0\Outlook\Options\ConflictMsgCls`
    
<span data-ttu-id="0ba50-135">通过组策略设置冲突解决优先于直接修改用户注册表项。</span><span class="sxs-lookup"><span data-stu-id="0ba50-135">Setting the conflict resolution through Group Policy takes precedence over directly modifying the user registry key.</span></span> <span data-ttu-id="0ba50-136">注册表项在注册表中的位置取决于 Outlook 的版本。</span><span class="sxs-lookup"><span data-stu-id="0ba50-136">The location of the key in the registry depends on the version of Outlook.</span></span> <span data-ttu-id="0ba50-137">将自定义邮件类的名称指定为此项下的值。</span><span class="sxs-lookup"><span data-stu-id="0ba50-137">You specify the name of the custom message class as a value under this key.</span></span> <span data-ttu-id="0ba50-138">将值的类型指定为**DWORD**, 将值的数据指定为下表中显示的值之一, 具体取决于所选的分辨率方案。</span><span class="sxs-lookup"><span data-stu-id="0ba50-138">Specify the type of the value as **DWORD**, and the data of the value as one of the values shown in the following table, depending on the resolution scheme you choose.</span></span> 
  
|<span data-ttu-id="0ba50-139">Data</span><span class="sxs-lookup"><span data-stu-id="0ba50-139">Data</span></span>  | <span data-ttu-id="0ba50-140">说明</span><span class="sxs-lookup"><span data-stu-id="0ba50-140">Description</span></span>  |
|:-----|:-----|
|<span data-ttu-id="0ba50-141">0</span><span class="sxs-lookup"><span data-stu-id="0ba50-141">0</span></span>  <br/> |<span data-ttu-id="0ba50-142">需要用户决策的常见项目解析, 在 Outlook 2002 和早期版本中使用。</span><span class="sxs-lookup"><span data-stu-id="0ba50-142">Common item resolution that requires a user decision, as used in Outlook 2002 and earlier versions.</span></span>  <br/> |
|<span data-ttu-id="0ba50-143">1</span><span class="sxs-lookup"><span data-stu-id="0ba50-143">1</span></span>  <br/> |<span data-ttu-id="0ba50-144">需要最少用户干预的常见项目分辨率, 这是由于 outlook 2003 中的原因而在 outlook 中使用。</span><span class="sxs-lookup"><span data-stu-id="0ba50-144">Common item resolution that requires minimal user intervention, as used in Outlook since Outlook 2003.</span></span>  <br/> |
|<span data-ttu-id="0ba50-145">双面</span><span class="sxs-lookup"><span data-stu-id="0ba50-145">2</span></span>  <br/> |<span data-ttu-id="0ba50-146">特定于邮件项目的解决方案。</span><span class="sxs-lookup"><span data-stu-id="0ba50-146">Resolution specific to mail items.</span></span>  <br/> |
|<span data-ttu-id="0ba50-147">第三章</span><span class="sxs-lookup"><span data-stu-id="0ba50-147">3</span></span>  <br/> |<span data-ttu-id="0ba50-148">会议项目特定的解决方案。</span><span class="sxs-lookup"><span data-stu-id="0ba50-148">Resolution specific to meeting items.</span></span>  <br/> |
|<span data-ttu-id="0ba50-149">4</span><span class="sxs-lookup"><span data-stu-id="0ba50-149">4</span></span>  <br/> |<span data-ttu-id="0ba50-150">特定于约会项目的解决方案。</span><span class="sxs-lookup"><span data-stu-id="0ba50-150">Resolution specific to appointment items.</span></span>  <br/> |
|<span data-ttu-id="0ba50-151">5</span><span class="sxs-lookup"><span data-stu-id="0ba50-151">5</span></span>  <br/> |<span data-ttu-id="0ba50-152">特定于联系人项目的分辨率。</span><span class="sxs-lookup"><span data-stu-id="0ba50-152">Resolution specific to contact items.</span></span>  <br/> |
|<span data-ttu-id="0ba50-153">型</span><span class="sxs-lookup"><span data-stu-id="0ba50-153">6</span></span>  <br/> |<span data-ttu-id="0ba50-154">特定于任务项的解决方案。</span><span class="sxs-lookup"><span data-stu-id="0ba50-154">Resolution specific to task items.</span></span>  <br/> |
|<span data-ttu-id="0ba50-155">步</span><span class="sxs-lookup"><span data-stu-id="0ba50-155">7</span></span>  <br/> |<span data-ttu-id="0ba50-156">特定于粘滞便笺项目的分辨率。</span><span class="sxs-lookup"><span data-stu-id="0ba50-156">Resolution specific to sticky note items.</span></span>  <br/> |
|<span data-ttu-id="0ba50-157">utf-8</span><span class="sxs-lookup"><span data-stu-id="0ba50-157">8</span></span>  <br/> |<span data-ttu-id="0ba50-158">日记项目特定的解决方案。</span><span class="sxs-lookup"><span data-stu-id="0ba50-158">Resolution specific to journal items.</span></span>  <br/> |
   
<span data-ttu-id="0ba50-159">如果指定了特定于项目的分辨率方案之一 (key data 2 到 8), Outlook 将尝试解决特定于项目的字段 (例如, 约会项目的**开始**和**结束**字段) 中的冲突, 而不会发生用户干预.</span><span class="sxs-lookup"><span data-stu-id="0ba50-159">If you specify one of the item-specific resolution schemes (key data 2 through 8), Outlook will try to resolve conflicts in item-specific fields (for example, **Start** and **End** fields of an appointment item) automatically without user intervention.</span></span> <span data-ttu-id="0ba50-160">如果 outlook 认为解决方案可能导致丢失重要数据, outlook 将在 "冲突" 文件夹中保留相互冲突的副本, 并且用户可以选择转到 "冲突" 文件夹以手动重新解析这些项目, 并覆盖自动办法.</span><span class="sxs-lookup"><span data-stu-id="0ba50-160">If Outlook considers that the resolution may result in the loss of essential data, Outlook will retain conflicting copies in the Conflicts folder, and users can choose to go to the Conflicts folder to manually re-resolve these items and override the automatic resolution.</span></span> 
  
<span data-ttu-id="0ba50-161">如果要为自定义邮件类 IPM 指定联系人项目特定的解决方案方案, 请使用上面的同一个业务联系人示例 **。请与我们联系**, 可以将其作为**DWORD**值添加到`[HKCU]\Software\Microsoft\Office\15.0\Outlook\Options\ConflictMsgCls`, 并将5指定为数据。</span><span class="sxs-lookup"><span data-stu-id="0ba50-161">Using the same business contacts example above, if you want to specify the contact item-specific resolution scheme for the custom message class **IPM.Contact.Business**, you can add it as a **DWORD** value under  `[HKCU]\Software\Microsoft\Office\15.0\Outlook\Options\ConflictMsgCls`, and specify 5 as the data.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="0ba50-162">Outlook 始终使用特定于基于约会邮件类 (IPM) 的自定义邮件类的约会项目的解决方案 **。约会**(例如, **IPM。约会. 个人**)。</span><span class="sxs-lookup"><span data-stu-id="0ba50-162">Outlook always uses a resolution scheme that is specific to appointment items for custom message classes that are based on the appointment message class, **IPM.Appointment** (for example, **IPM.Appointment.Personal**).</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="0ba50-163">另请参阅</span><span class="sxs-lookup"><span data-stu-id="0ba50-163">See also</span></span>

- [<span data-ttu-id="0ba50-164">Outlook 项目对象</span><span class="sxs-lookup"><span data-stu-id="0ba50-164">Outlook Item Objects</span></span>](https://msdn.microsoft.com/library/6ea4babf-facf-4018-ef5a-4a484e55153a%28Office.15%29.aspx)

