---
title: 关于注册新域以进行自动配置
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: overview
localization_priority: Normal
ms.assetid: a7ab8a50-dd30-4ba5-b6d8-e6d1f482e6f1
description: Outlook为自动配置指定新邮件服务域并允许邮件服务提供商配置帐户的方法。
ms.openlocfilehash: bf06ff8d145ed6173e3545f784f8b5b7b5f433be
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/23/2019
ms.locfileid: "32316966"
---
# <a name="about-registering-a-new-domain-for-automatic-configuration"></a><span data-ttu-id="e580d-103">关于注册新域以进行自动配置</span><span class="sxs-lookup"><span data-stu-id="e580d-103">About registering a new domain for automatic configuration</span></span>

<span data-ttu-id="e580d-104">Outlook为自动配置指定新邮件服务域并允许邮件服务提供商配置帐户的方法。</span><span class="sxs-lookup"><span data-stu-id="e580d-104">Outlook provides a way to specify a new message service domain for automatic configuration and allow the message service provider to configure the account.</span></span>
  
<span data-ttu-id="e580d-105">在设计邮件服务提供商时，可以使用 Windows 注册表中的以下注册表项指定由相应的邮件服务提供商自动配置的新域：</span><span class="sxs-lookup"><span data-stu-id="e580d-105">When designing a message service provider, you can use the following key in the Windows registry to specify a new domain to be automatically configured by the corresponding message service provider:</span></span> 
  
`HKLM\Software\Microsoft\Office\Outlook\AutoConfigDomains\<domain name>\`
  
<span data-ttu-id="e580d-106">在 键中 `<domain name>` ， 是自动配置的域。</span><span class="sxs-lookup"><span data-stu-id="e580d-106">In the key, `<domain name>` is the domain for automatic configuration.</span></span> <span data-ttu-id="e580d-107">此域名仅在开始时 \* 支持通配符。</span><span class="sxs-lookup"><span data-stu-id="e580d-107">This domain name supports a wildcard \* at the beginning only.</span></span> <span data-ttu-id="e580d-108">下表显示了此键支持的值。</span><span class="sxs-lookup"><span data-stu-id="e580d-108">The following table shows the values that this key supports.</span></span> 
  
| <span data-ttu-id="e580d-109">值</span><span class="sxs-lookup"><span data-stu-id="e580d-109">Value</span></span> | <span data-ttu-id="e580d-110">类型</span><span class="sxs-lookup"><span data-stu-id="e580d-110">Type</span></span> | <span data-ttu-id="e580d-111">说明</span><span class="sxs-lookup"><span data-stu-id="e580d-111">Description</span></span> |
|:-----|:-----|:-----|
|<span data-ttu-id="e580d-112">友好名称</span><span class="sxs-lookup"><span data-stu-id="e580d-112">Friendly Name</span></span>  <br/> |<span data-ttu-id="e580d-113">REG_SZ</span><span class="sxs-lookup"><span data-stu-id="e580d-113">REG_SZ</span></span>  <br/> |<span data-ttu-id="e580d-114">在自动配置过程中向用户显示的域名。</span><span class="sxs-lookup"><span data-stu-id="e580d-114">The domain name that is displayed to the user during automatic configuration.</span></span>  <br/> |
|<span data-ttu-id="e580d-115">服务名称</span><span class="sxs-lookup"><span data-stu-id="e580d-115">Service Name</span></span>  <br/> |<span data-ttu-id="e580d-116">REG_SZ</span><span class="sxs-lookup"><span data-stu-id="e580d-116">REG_SZ</span></span>  <br/> |<span data-ttu-id="e580d-117">在支持此域的 mapisvc.inf 中注册的邮件服务。</span><span class="sxs-lookup"><span data-stu-id="e580d-117">The message service registered in mapisvc.inf that supports this domain.</span></span>  <br/> |
|<span data-ttu-id="e580d-118">安装位置</span><span class="sxs-lookup"><span data-stu-id="e580d-118">Install Location</span></span>  <br/> |<span data-ttu-id="e580d-119">REG_SZ</span><span class="sxs-lookup"><span data-stu-id="e580d-119">REG_SZ</span></span>  <br/> |<span data-ttu-id="e580d-120">要安装邮件服务提供商的位置的 URL（如果尚未安装）。</span><span class="sxs-lookup"><span data-stu-id="e580d-120">The URL of the location to install the message service provider, if it is not already installed.</span></span>  <br/> |
|<span data-ttu-id="e580d-121">最低版本</span><span class="sxs-lookup"><span data-stu-id="e580d-121">Minimum Version</span></span>  <br/> |<span data-ttu-id="e580d-122">REG_DWORD</span><span class="sxs-lookup"><span data-stu-id="e580d-122">REG_DWORD</span></span>  <br/> |<span data-ttu-id="e580d-123">邮件服务提供商.dll的最低版本。</span><span class="sxs-lookup"><span data-stu-id="e580d-123">The minimum version of the .dll of the message service provider that is required.</span></span> <span data-ttu-id="e580d-124">该值是可选的。</span><span class="sxs-lookup"><span data-stu-id="e580d-124">This value is optional.</span></span>  <br/> |
   
<span data-ttu-id="e580d-125">当Outlook自动配置电子邮件帐户时，它会检查Windows注册表中是否注册电子邮件地址指定的域。</span><span class="sxs-lookup"><span data-stu-id="e580d-125">When Outlook begins automatic configuration for an email account, it checks the Windows registry for the registration of the domain specified by the email address.</span></span> <span data-ttu-id="e580d-126">如果已在注册表中指定域Windows，Outlook检查邮件服务是否已在 Mapisvc.inf 中注册。</span><span class="sxs-lookup"><span data-stu-id="e580d-126">If the domain is already specified in the Windows registry, Outlook checks whether the message service is registered in Mapisvc.inf.</span></span> <span data-ttu-id="e580d-127">Outlook域的自动配置，除非已在注册表中指定Windows配置。</span><span class="sxs-lookup"><span data-stu-id="e580d-127">Outlook cannot proceed with automatic configuration of the domain unless it has been specified in the Windows registry.</span></span>
  
<span data-ttu-id="e580d-128">如果指定的邮件服务当前未在 Mapisvc.inf 中注册，或者安装了邮件服务提供商，但 .dll 的版本早于指定的最小值，Outlook 将使用指定的友好名称并提示用户安装提供程序。</span><span class="sxs-lookup"><span data-stu-id="e580d-128">If the specified message service is not currently registered in Mapisvc.inf, or the message service provider is installed but the .dll has a version earlier than the specified minimum, Outlook uses the specified friendly name and prompts the user to install the provider.</span></span> <span data-ttu-id="e580d-129">如果用户接受，Outlook将用户重定向到指定的安装位置，以便用户可以安装提供程序。</span><span class="sxs-lookup"><span data-stu-id="e580d-129">If the user accepts, Outlook redirects the user to the specified installation location so that the user can install the provider.</span></span> <span data-ttu-id="e580d-130">安装提供程序会注册 Mapisvc.inf 中的邮件服务。</span><span class="sxs-lookup"><span data-stu-id="e580d-130">Installing the provider registers the message service in Mapisvc.inf.</span></span>
  
<span data-ttu-id="e580d-131">如果邮件服务当前在 Mapisvc.inf 中注册，并且服务提供商 .dll 是一个合适的版本，Outlook 会使用[IMsgServiceAdmin：：CreateMsgService](https://msdn.microsoft.com/library/0135f049-0311-45e5-9685-78597d599a4e%28Office.15%29.aspx)创建邮件服务，然后使用[IMsgServiceAdmin：：ConfigureMsgService](https://msdn.microsoft.com/library/a08f5905-2585-49ca-abb7-a77f2736f604%28Office.15%29.aspx)对其进行配置。</span><span class="sxs-lookup"><span data-stu-id="e580d-131">If the message service is currently registered in Mapisvc.inf and the service provider .dll is an appropriate version, Outlook creates the message service by using [IMsgServiceAdmin::CreateMsgService](https://msdn.microsoft.com/library/0135f049-0311-45e5-9685-78597d599a4e%28Office.15%29.aspx), and then configures it by using [IMsgServiceAdmin::ConfigureMsgService](https://msdn.microsoft.com/library/a08f5905-2585-49ca-abb7-a77f2736f604%28Office.15%29.aspx).</span></span> <span data-ttu-id="e580d-132">Outlook自动配置使用下列三个属性允许提供程序设置帐户[：PidTagAutoConfigurationUserName、PidTagAutoConfigurationUserEmail](https://msdn.microsoft.com/library/05dfa0e2-4ab1-4f57-9009-6a815aca87bd%28Office.15%29.aspx)和[PidTagAutoConfigurationUserPassword](https://msdn.microsoft.com/library/d33e7c45-55d8-4dc1-ade9-605542d87e61%28Office.15%29.aspx)。 [](https://msdn.microsoft.com/library/845140c8-5454-4b47-acec-ab5aff00b768%28Office.15%29.aspx)</span><span class="sxs-lookup"><span data-stu-id="e580d-132">Outlook automatic configuration uses the following three properties to allow the provider to set up the account: [PidTagAutoConfigurationUserName](https://msdn.microsoft.com/library/05dfa0e2-4ab1-4f57-9009-6a815aca87bd%28Office.15%29.aspx), [PidTagAutoConfigurationUserEmail](https://msdn.microsoft.com/library/845140c8-5454-4b47-acec-ab5aff00b768%28Office.15%29.aspx), and [PidTagAutoConfigurationUserPassword](https://msdn.microsoft.com/library/d33e7c45-55d8-4dc1-ade9-605542d87e61%28Office.15%29.aspx).</span></span>
  
## <a name="see-also"></a><span data-ttu-id="e580d-133">另请参阅</span><span class="sxs-lookup"><span data-stu-id="e580d-133">See also</span></span>

- [<span data-ttu-id="e580d-134">MapiSvc.inf 的文件格式</span><span class="sxs-lookup"><span data-stu-id="e580d-134">File Format of MapiSvc.inf</span></span>](https://msdn.microsoft.com/library/b48eda17-83a8-4dc4-85c8-4ca827d13d25%28Office.15%29.aspx)

