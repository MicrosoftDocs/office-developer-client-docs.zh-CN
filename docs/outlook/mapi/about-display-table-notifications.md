---
title: 关于显示表通知
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 085151e9-4809-4d2b-ae4d-e318355e1f5a
description: 上次修改时间：2015 年 3 月 9 日
ms.openlocfilehash: 41e6a2c8b6856bf072972325e7e08aabe3e17446
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/23/2019
ms.locfileid: "32326409"
---
# <a name="about-display-table-notifications"></a><span data-ttu-id="13d8c-103">关于显示表通知</span><span class="sxs-lookup"><span data-stu-id="13d8c-103">About display table notifications</span></span>

<span data-ttu-id="13d8c-104">**适用于**：Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="13d8c-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="13d8c-105">显示表上的通知由负责创建显示表到 MAPI 的服务提供程序发送。</span><span class="sxs-lookup"><span data-stu-id="13d8c-105">Notifications on a display table are sent by the service provider responsible for creating the display table to MAPI.</span></span> <span data-ttu-id="13d8c-106">这些通知的 MAPI 寄存器, 方法是调用显示表的[IMAPITable:: Advise](imapitable-advise.md)方法并指定表修改事件。</span><span class="sxs-lookup"><span data-stu-id="13d8c-106">MAPI registers for these notifications by calling a display table's [IMAPITable::Advise](imapitable-advise.md) method and specifying the table modified event.</span></span> 
  
<span data-ttu-id="13d8c-107">与所有表通知一样, 显示表通知包括[TABLE_NOTIFICATION](table_notification.md)结构。</span><span class="sxs-lookup"><span data-stu-id="13d8c-107">As with all table notifications, display table notifications include a [TABLE_NOTIFICATION](table_notification.md) structure.</span></span> <span data-ttu-id="13d8c-108">只有此结构的**ulTableEvent**和**propIndex**成员是非常重要的;其他成员将被忽略。</span><span class="sxs-lookup"><span data-stu-id="13d8c-108">Only the **ulTableEvent** and the **propIndex** members of this structure are significant; the other members are ignored.</span></span> <span data-ttu-id="13d8c-109">**ulTableEvent**成员设置为 TABLE_ROW_MODIFIED, **propIndex**成员设置为相应行中**PR_CONTROL_ID** ([PidTagControlId](pidtagcontrolid-canonical-property.md)) 列的值。</span><span class="sxs-lookup"><span data-stu-id="13d8c-109">The **ulTableEvent** member is set to TABLE_ROW_MODIFIED and the **propIndex** member is set to the value of the **PR_CONTROL_ID** ([PidTagControlId](pidtagcontrolid-canonical-property.md)) column in the corresponding row.</span></span> <span data-ttu-id="13d8c-110">MAPI 通过调用控件中显示的属性的[IMAPIProp:: GetProps](imapiprop-getprops.md)方法, 并显示新值, 从而对通知做出响应。</span><span class="sxs-lookup"><span data-stu-id="13d8c-110">MAPI responds to the notification by calling the [IMAPIProp::GetProps](imapiprop-getprops.md) method for the property displayed in the control and by displaying the new value.</span></span> 
  
<span data-ttu-id="13d8c-111">服务提供程序可以使用显示表通知来协调对对话框上的相关控件所做的更改。</span><span class="sxs-lookup"><span data-stu-id="13d8c-111">Display table notifications can be used by a service provider to coordinate changes to related controls on the dialog box.</span></span> <span data-ttu-id="13d8c-112">例如, 如果属性接口实现需要刷新对话框上的一个或多个字段—可能会响应在其**PR_CONTROL_FLAGS** ([PidTagControlFlags](pidtagcontrolflags-canonical-property.md)) 属性中设置了 DT_SET_IMMEDIATE 标志的另一个控件)。它可以生成显示表通知。</span><span class="sxs-lookup"><span data-stu-id="13d8c-112">For example, if the property interface implementation needs to refresh one or more fields on the dialog box — perhaps in response to another control that has set the DT_SET_IMMEDIATE flag in its **PR_CONTROL_FLAGS** ([PidTagControlFlags](pidtagcontrolflags-canonical-property.md)) property — it can generate a display table notification.</span></span> <span data-ttu-id="13d8c-113">显示表通知可警告属性接口实现, 因为有一个或多个控件的值因正在进行更改或发生外部事件而需要重新读取。</span><span class="sxs-lookup"><span data-stu-id="13d8c-113">A display table notification can alert the property interface implementation that the value of one or more controls needs to be reread due to a change being made or an external event occurring.</span></span> 
  
<span data-ttu-id="13d8c-114">服务提供商可以通过以下方式发出显示表通知:</span><span class="sxs-lookup"><span data-stu-id="13d8c-114">A service provider can issue display table notifications by:</span></span>
  
- <span data-ttu-id="13d8c-115">调用[ITableData:: HrNotify](itabledata-hrnotify.md), 如果显示表是使用 table data 对象生成的。</span><span class="sxs-lookup"><span data-stu-id="13d8c-115">Calling [ITableData::HrNotify](itabledata-hrnotify.md), if the display table was built with a table data object.</span></span>
    
    - <span data-ttu-id="13d8c-116">和</span><span class="sxs-lookup"><span data-stu-id="13d8c-116">Or -</span></span>
    
- <span data-ttu-id="13d8c-117">如果显示表是使用提供程序的**IMAPITable**实现生成的, 则使用其自己的代码。</span><span class="sxs-lookup"><span data-stu-id="13d8c-117">Using its own code, if the display table was built with the provider's **IMAPITable** implementation.</span></span> 
    
<span data-ttu-id="13d8c-118">根据需要, MAPI 会根据属性接口实现中的并控件的值来响应显示表通知。</span><span class="sxs-lookup"><span data-stu-id="13d8c-118">MAPI responds to display table notifications when necessary by rereading a control's value from the property interface implementation.</span></span> <span data-ttu-id="13d8c-119">下表介绍了有关 MAPI 如何处理特定类型的控件的通知的详细信息。</span><span class="sxs-lookup"><span data-stu-id="13d8c-119">The following table describes the details surrounding how MAPI handles notifications for specific types of controls.</span></span>
  
|<span data-ttu-id="13d8c-120">**Control**</span><span class="sxs-lookup"><span data-stu-id="13d8c-120">**Control**</span></span>|<span data-ttu-id="13d8c-121">**MAPI 操作**</span><span class="sxs-lookup"><span data-stu-id="13d8c-121">**MAPI action**</span></span>|
|:-----|:-----|
|<span data-ttu-id="13d8c-122">按钮</span><span class="sxs-lookup"><span data-stu-id="13d8c-122">Button</span></span>  <br/> |<span data-ttu-id="13d8c-123">调用[IMAPIProp:: OpenProperty](imapiprop-openproperty.md)通过[DTBLBUTTON](dtblbutton.md)结构的**ulPRControl**成员所表示的属性检索 control 对象 (如果调用以前失败)。</span><span class="sxs-lookup"><span data-stu-id="13d8c-123">Calls [IMAPIProp::OpenProperty](imapiprop-openproperty.md)to retrieve the control object by way of the property represented by the **ulPRControl** member of the [DTBLBUTTON](dtblbutton.md) structure if the call had failed previously.</span></span> <span data-ttu-id="13d8c-124">调用 control 对象的[IMAPIControl:: GetState](imapicontrol-getstate.md)以确定是否应启用该按钮, 并相应地启用或禁用该按钮。</span><span class="sxs-lookup"><span data-stu-id="13d8c-124">Calls the control object's [IMAPIControl::GetState](imapicontrol-getstate.md) to determine whether the button should be enabled and enables or disables the button accordingly.</span></span>  <br/> |
|<span data-ttu-id="13d8c-125">复选框</span><span class="sxs-lookup"><span data-stu-id="13d8c-125">Check box</span></span>  <br/> |<span data-ttu-id="13d8c-126">Rereads **ulPRPropertyName**成员的值。</span><span class="sxs-lookup"><span data-stu-id="13d8c-126">Rereads the value for the **ulPRPropertyName** member.</span></span>  <br/> |
|<span data-ttu-id="13d8c-127">组合框</span><span class="sxs-lookup"><span data-stu-id="13d8c-127">Combo box</span></span>  <br/> |<span data-ttu-id="13d8c-128">重新打开与[DTBLCOMBOBOX](dtblcombobox.md)结构的**ulPRTableName**成员相关联的表。</span><span class="sxs-lookup"><span data-stu-id="13d8c-128">Reopens the table associated with the **ulPRTableName** member of the [DTBLCOMBOBOX](dtblcombobox.md) structure.</span></span> <span data-ttu-id="13d8c-129">Rereads 所有行, 包括**ulPRPropertyName**成员的值。</span><span class="sxs-lookup"><span data-stu-id="13d8c-129">Rereads all of the rows including the value for the **ulPRPropertyName**member.</span></span>  <br/> |
|<span data-ttu-id="13d8c-130">下拉列表框</span><span class="sxs-lookup"><span data-stu-id="13d8c-130">Drop-down list box</span></span>  <br/> |<span data-ttu-id="13d8c-131">重新打开与[DTBLDDLBX](dtblddlbx.md)结构的**ulPRTableName**成员关联的表, 并 rereads 所有行。</span><span class="sxs-lookup"><span data-stu-id="13d8c-131">Reopens the table associated with the **ulPRTableName** member of the [DTBLDDLBX](dtblddlbx.md) structure and rereads all of the rows.</span></span> <span data-ttu-id="13d8c-132">调用[IMAPIProp:: GetProps](imapiprop-getprops.md)检索存储在**ulPRDisplayProperty**和**ulPRSetProperty**成员中的属性的值。</span><span class="sxs-lookup"><span data-stu-id="13d8c-132">Calls [IMAPIProp::GetProps](imapiprop-getprops.md) to retrieve the values for the properties stored in the **ulPRDisplayProperty** and the **ulPRSetProperty** members.</span></span>  <br/> |
|<span data-ttu-id="13d8c-133">编辑</span><span class="sxs-lookup"><span data-stu-id="13d8c-133">Edit</span></span>  <br/> |<span data-ttu-id="13d8c-134">Rereads 属性并重新所的属性。</span><span class="sxs-lookup"><span data-stu-id="13d8c-134">Rereads the property and redisplays.</span></span>  <br/> |
|<span data-ttu-id="13d8c-135">分组框</span><span class="sxs-lookup"><span data-stu-id="13d8c-135">Group box</span></span>  <br/> |<span data-ttu-id="13d8c-136">忽略通知。</span><span class="sxs-lookup"><span data-stu-id="13d8c-136">Ignores the notification.</span></span>  <br/> |
|<span data-ttu-id="13d8c-137">标签</span><span class="sxs-lookup"><span data-stu-id="13d8c-137">Label</span></span>  <br/> |<span data-ttu-id="13d8c-138">忽略通知。</span><span class="sxs-lookup"><span data-stu-id="13d8c-138">Ignores the notification.</span></span>  <br/> |
|<span data-ttu-id="13d8c-139">多选列表框</span><span class="sxs-lookup"><span data-stu-id="13d8c-139">Multiple selection list box</span></span>  <br/> |<span data-ttu-id="13d8c-140">如果其中一个列是条目标识符, 则刷新列表框。</span><span class="sxs-lookup"><span data-stu-id="13d8c-140">If one of the columns is an entry identifier, refreshes the list box.</span></span> <span data-ttu-id="13d8c-141">相应的对象不会关闭或重新加载。</span><span class="sxs-lookup"><span data-stu-id="13d8c-141">The corresponding object is not closed or reloaded.</span></span>  <br/> |
|<span data-ttu-id="13d8c-142">单个选择列表框</span><span class="sxs-lookup"><span data-stu-id="13d8c-142">Single selection list box</span></span>  <br/> |<span data-ttu-id="13d8c-143">读取 set 属性, 尝试识别该属性。</span><span class="sxs-lookup"><span data-stu-id="13d8c-143">Reads the set property, trying to identify it.</span></span>  <br/> |
|<span data-ttu-id="13d8c-144">多值列表框</span><span class="sxs-lookup"><span data-stu-id="13d8c-144">Multivalued list box</span></span>  <br/> |<span data-ttu-id="13d8c-145">Rereads 属性并重新填充列表框。</span><span class="sxs-lookup"><span data-stu-id="13d8c-145">Rereads the property and repopulates the list box.</span></span>  <br/> |
|<span data-ttu-id="13d8c-146">选项卡页</span><span class="sxs-lookup"><span data-stu-id="13d8c-146">Tabbed page</span></span>  <br/> |<span data-ttu-id="13d8c-147">此控件没有通知;一切都是静态的。</span><span class="sxs-lookup"><span data-stu-id="13d8c-147">There are no notifications for this control; everything is static.</span></span>  <br/> |
|<span data-ttu-id="13d8c-148">单选按钮</span><span class="sxs-lookup"><span data-stu-id="13d8c-148">Radio button</span></span>  <br/> |<span data-ttu-id="13d8c-149">Rereads 与按钮关联的属性, 并将其存储在[DTBLRADIOBUTTON](dtblradiobutton.md)结构的**ulPropTag**成员中, 并使用控件进行适当的选择。</span><span class="sxs-lookup"><span data-stu-id="13d8c-149">Rereads the property that is associated with the button and is stored in the **ulPropTag** member of the [DTBLRADIOBUTTON](dtblradiobutton.md) structure and makes the appropriate selection with the controls.</span></span>  <br/> |
   
## <a name="see-also"></a><span data-ttu-id="13d8c-150">另请参阅</span><span class="sxs-lookup"><span data-stu-id="13d8c-150">See also</span></span>

- [<span data-ttu-id="13d8c-151">MAPI 表</span><span class="sxs-lookup"><span data-stu-id="13d8c-151">MAPI Tables</span></span>](mapi-tables.md)

