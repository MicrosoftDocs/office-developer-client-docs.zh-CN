---
title: 文件夹字段流结构
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
ms.assetid: edbc9e6c-008c-4c13-9a0c-cb47ac0f3686
description: 上次修改时间：2015 年 3 月 9 日
ms.openlocfilehash: 96051bd2b62fd7c0e908a1018aac0225e44986be
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/23/2019
ms.locfileid: "32336888"
---
# <a name="folder-fields-stream-structures"></a><span data-ttu-id="88493-103">文件夹字段流结构</span><span class="sxs-lookup"><span data-stu-id="88493-103">Folder Fields Stream Structures</span></span>

<span data-ttu-id="88493-104">**适用于**：Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="88493-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="88493-105">邮件的 [PidTagUserFields](pidtaguserfields-canonical-property.md) 属性包含二进制流 FolderUserFields，其中包含文件夹用户定义的字段定义。</span><span class="sxs-lookup"><span data-stu-id="88493-105">A message's [PidTagUserFields](pidtaguserfields-canonical-property.md) property contains a binary stream, FolderUserFields, which contains the folder user-defined field definitions.</span></span> <span data-ttu-id="88493-106">本主题介绍文件夹用户定义的字段定义的流结构。</span><span class="sxs-lookup"><span data-stu-id="88493-106">This topic describes the stream structures for folder user-defined field definitions.</span></span> 

<span data-ttu-id="88493-107">FolderUserFields 流结构由 FolderUserFieldsA 结构或 FolderUserFieldsA 结构后跟 FolderUserFieldsW 结构组成。</span><span class="sxs-lookup"><span data-stu-id="88493-107">A FolderUserFields stream structure consists of either a FolderUserFieldsA structure or a FolderUserFieldsA structure followed by a FolderUserFieldsW structure.</span></span>
  
<span data-ttu-id="88493-108">此流中的数据元素按以下指定顺序紧接在一起存储：</span><span class="sxs-lookup"><span data-stu-id="88493-108">Data elements in this stream are stored immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="88493-109">**FolderUserFieldsAnsi：FolderUserFieldsA** 流结构。</span><span class="sxs-lookup"><span data-stu-id="88493-109">**FolderUserFieldsAnsi**: A FolderUserFieldsA stream structure.</span></span>
    
- <span data-ttu-id="88493-110">**FolderUserFieldsUnicode** (可选) ：FolderUserFieldsW 流结构。</span><span class="sxs-lookup"><span data-stu-id="88493-110">**FolderUserFieldsUnicode** (optional): A FolderUserFieldsW stream structure.</span></span>
    
<span data-ttu-id="88493-111">FolderUserFieldsUnicode 存在由 FolderUserFields 的总长度大于 FolderUserFieldsAnsi 的长度检测到。</span><span class="sxs-lookup"><span data-stu-id="88493-111">The presence of FolderUserFieldsUnicode is detected by the total length of the FolderUserFields being greater than the length of FolderUserFieldsAnsi.</span></span>
  
> [!IMPORTANT]
> <span data-ttu-id="88493-112">FolderUserFieldsAnsi 用于兼容较旧的非 Unicode 版本的 MAPI 客户端，因此如果存在 FolderUserFieldsUnicode，则忽略 FolderUserFieldsAnsi 的内容。</span><span class="sxs-lookup"><span data-stu-id="88493-112">FolderUserFieldsAnsi is used for compatibility with older, non-Unicode, versions of MAPI clients, therefore if FolderUserFieldsUnicode is present, the contents of FolderUserFieldsAnsi is ignored.</span></span> <span data-ttu-id="88493-113">为了避免在 ANSI 转换中丢失数据，在创建 FolderUserFields 流时，始终包括 FolderUserFieldsW 部件。</span><span class="sxs-lookup"><span data-stu-id="88493-113">To avoid possible data loss in ANSI conversion, when creating a FolderUserFields stream always include the FolderUserFieldsW part.</span></span> 
  
## <a name="folderuserfieldsa-stream-structure"></a><span data-ttu-id="88493-114">FolderUserFieldsA 流结构</span><span class="sxs-lookup"><span data-stu-id="88493-114">FolderUserFieldsA Stream Structure</span></span>

<span data-ttu-id="88493-115">FolderUserFieldsA 流结构是 FolderFieldDefinitionA 流结构的数组，其中包含 Outlook 文件夹中所有用户定义字段的定义，除非 FolderUserFields 结构的 FolderUserFieldsW 部分重写。</span><span class="sxs-lookup"><span data-stu-id="88493-115">A FolderUserFieldsA stream structure is an array of FolderFieldDefinitionA stream structures that contain definitions for all user-defined fields in an Outlook folder, unless overridden by the FolderUserFieldsW part of the FolderUserFields structure.</span></span>
  
<span data-ttu-id="88493-116">此流中的数据元素按小尾字节顺序存储，并按以下指定顺序彼此紧随：</span><span class="sxs-lookup"><span data-stu-id="88493-116">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="88493-117">**FieldDefinitionCount**：DWORD (4 字节) ，即此流中的字段定义数。</span><span class="sxs-lookup"><span data-stu-id="88493-117">**FieldDefinitionCount**: DWORD (4 bytes), the number of field definitions in this stream.</span></span> <span data-ttu-id="88493-118">这是 **FieldDefinitions 数组中的元素** 计数。</span><span class="sxs-lookup"><span data-stu-id="88493-118">This is the count of elements in the **FieldDefinitions** array.</span></span>
    
- <span data-ttu-id="88493-119">**FieldDefinitions：FolderFieldDefinitionA** 流结构的数组。</span><span class="sxs-lookup"><span data-stu-id="88493-119">**FieldDefinitions**: An array of FolderFieldDefinitionA stream structures.</span></span> <span data-ttu-id="88493-120">此数组的计数等于 **FieldDefinitionCount** 数据元素。</span><span class="sxs-lookup"><span data-stu-id="88493-120">The count of this array is equal to the **FieldDefinitionCount** data element.</span></span>
    
<span data-ttu-id="88493-121">除非 FolderUserFieldsA 由 FolderUserFields 结构的 FolderUserFieldsW 部分替代，否则 **FieldDefinitions** 数组必须通过将最后一个 FolderFieldDefinitionA 元素的 Common.FieldType 字段等于 ftNull 来"以 null 终止"。</span><span class="sxs-lookup"><span data-stu-id="88493-121">Unless this FolderUserFieldsA is overridden by the FolderUserFieldsW part of the FolderUserFields structure, the **FieldDefinitions** array must be "null-terminated" by having its last FolderFieldDefinitionA element's Common.FieldType field equal to ftNull.</span></span>
  
## <a name="folderuserfieldsw-stream-structure"></a><span data-ttu-id="88493-122">FolderUserFieldsW Stream 结构</span><span class="sxs-lookup"><span data-stu-id="88493-122">FolderUserFieldsW Stream Structure</span></span>

<span data-ttu-id="88493-123">FolderUserFieldsW 流结构是 FolderFieldDefinitionW 流结构的数组，其中包含 Outlook 文件夹中所有用户定义字段的定义。</span><span class="sxs-lookup"><span data-stu-id="88493-123">A FolderUserFieldsW stream structure is an array of FolderFieldDefinitionW stream structures that contain definitions for all user-defined fields in an Outlook folder.</span></span>
  
<span data-ttu-id="88493-124">此流中的数据元素按小尾字节顺序存储，并按以下指定顺序彼此紧随：</span><span class="sxs-lookup"><span data-stu-id="88493-124">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="88493-125">**FieldDefinitionCount**：DWORD (4 字节) ，即此流中的字段定义数。</span><span class="sxs-lookup"><span data-stu-id="88493-125">**FieldDefinitionCount**: DWORD (4 bytes), the number of field definitions in this stream.</span></span> <span data-ttu-id="88493-126">这是 **FieldDefinitions 数组中的元素** 计数。</span><span class="sxs-lookup"><span data-stu-id="88493-126">This is the count of elements in the **FieldDefinitions** array.</span></span>
    
- <span data-ttu-id="88493-127">**FieldDefinitions：FolderFieldDefinitionW** 流结构的数组。</span><span class="sxs-lookup"><span data-stu-id="88493-127">**FieldDefinitions**: An array of FolderFieldDefinitionW stream structures.</span></span> <span data-ttu-id="88493-128">此数组的计数等于 **FieldDefinitionCount** 数据元素。</span><span class="sxs-lookup"><span data-stu-id="88493-128">The count of this array is equal to the **FieldDefinitionCount** data element.</span></span>
    
<span data-ttu-id="88493-129">**FieldDefinitions** 数组必须"null-terminated"，其最后一个 FolderFieldDefinitionW 元素的 Common.FieldType 字段等于 ftNull。</span><span class="sxs-lookup"><span data-stu-id="88493-129">The **FieldDefinitions** array must be "null-terminated" by having its last FolderFieldDefinitionW element's Common.FieldType field equal to ftNull.</span></span>
  
## <a name="folderfielddefinitiona-stream-structure"></a><span data-ttu-id="88493-130">FolderFieldDefinitionA 流结构</span><span class="sxs-lookup"><span data-stu-id="88493-130">FolderFieldDefinitionA Stream Structure</span></span>

<span data-ttu-id="88493-131">FolderFieldDefinitionA 流结构包含用户定义的字段的定义，该字段的名称存储在 ANSI 中。</span><span class="sxs-lookup"><span data-stu-id="88493-131">A FolderFieldDefinitionA stream structure contains a definition of a user-defined field with the field name stored in ANSI.</span></span>
  
<span data-ttu-id="88493-132">此流中的数据元素按小尾字节顺序存储，并按以下指定顺序彼此紧随：</span><span class="sxs-lookup"><span data-stu-id="88493-132">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="88493-133">**FieldType**：FldType (4 字节) ，此字段的类型。</span><span class="sxs-lookup"><span data-stu-id="88493-133">**FieldType**: FldType (4 bytes), the type of this field.</span></span>
    
- <span data-ttu-id="88493-134">**FieldNameLength：WORD** (2 字节) ， **即 FieldName** 数组中的元素数。</span><span class="sxs-lookup"><span data-stu-id="88493-134">**FieldNameLength**: WORD (2 bytes), the number of elements in the **FieldName** array.</span></span>
    
- <span data-ttu-id="88493-135">**FieldName**：CHAR 的数组。</span><span class="sxs-lookup"><span data-stu-id="88493-135">**FieldName**: An array of CHAR.</span></span> <span data-ttu-id="88493-136">这是字段名称CP_ACP ANSI 代码页表示形式。</span><span class="sxs-lookup"><span data-stu-id="88493-136">This is the ANSI CP_ACP codepage representation of the field name.</span></span> <span data-ttu-id="88493-137">此数组的计数等于 **FieldNameLength**。</span><span class="sxs-lookup"><span data-stu-id="88493-137">The count of this array is equal to **FieldNameLength**.</span></span> <span data-ttu-id="88493-138">字段名称必须满足 [UserProperties.Add](https://msdn.microsoft.com/library/microsoft.office.interop.outlook.userproperties.add.aspx) 方法中指定的对 Name 参数的限制。</span><span class="sxs-lookup"><span data-stu-id="88493-138">The field name must satisfy the restrictions on the Name parameter as specified in the [UserProperties.Add](https://msdn.microsoft.com/library/microsoft.office.interop.outlook.userproperties.add.aspx) Method.</span></span> 
    
   > [!NOTE]
   > <span data-ttu-id="88493-139">出于旧版兼容性的原因，Outlook 可能无法处理某些不满足这些限制的 **FieldName** 值，但本主题未涵盖此类情况。</span><span class="sxs-lookup"><span data-stu-id="88493-139">For reasons of legacy compatibility, Outlook may be able to handle some **FieldName** values not satisfying these restrictions, however such cases are not covered by this topic.</span></span> 
  
- <span data-ttu-id="88493-140">**常见**：FolderFieldDefinitionCommon 流结构。</span><span class="sxs-lookup"><span data-stu-id="88493-140">**Common**: A FolderFieldDefinitionCommon stream structure.</span></span>
    
## <a name="folderfielddefinitionw-stream-structure"></a><span data-ttu-id="88493-141">FolderFieldDefinitionW 流结构</span><span class="sxs-lookup"><span data-stu-id="88493-141">FolderFieldDefinitionW Stream Structure</span></span>

<span data-ttu-id="88493-142">FolderFieldDefinitionW 流结构包含用户定义的字段的定义，该字段的名称存储在 Unicode 中。</span><span class="sxs-lookup"><span data-stu-id="88493-142">A FolderFieldDefinitionW stream structure contains a definition of a user-defined field with the field name stored in Unicode.</span></span>
  
<span data-ttu-id="88493-143">此流中的数据元素按小尾字节顺序存储，并按以下指定顺序彼此紧随：</span><span class="sxs-lookup"><span data-stu-id="88493-143">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="88493-144">**FieldType**：FldType (4 字节) ，此字段的类型。</span><span class="sxs-lookup"><span data-stu-id="88493-144">**FieldType**: FldType (4 bytes), the type of this field.</span></span>
    
- <span data-ttu-id="88493-145">**FieldNameLength：WORD** (2 字节) ， **即 FieldName** 数组中的元素数。</span><span class="sxs-lookup"><span data-stu-id="88493-145">**FieldNameLength**: WORD (2 bytes), the number of elements in the **FieldName** array.</span></span>
    
- <span data-ttu-id="88493-146">**FieldName：WCHAR** 的数组。</span><span class="sxs-lookup"><span data-stu-id="88493-146">**FieldName**: An array of WCHAR.</span></span> <span data-ttu-id="88493-147">这是字段名称的 Unicode (UTF-16) 表示形式。</span><span class="sxs-lookup"><span data-stu-id="88493-147">This is the Unicode (UTF-16) representation of the field name.</span></span> <span data-ttu-id="88493-148">此数组的计数等于 **FieldNameLength**。</span><span class="sxs-lookup"><span data-stu-id="88493-148">The count of this array is equal to **FieldNameLength**.</span></span> <span data-ttu-id="88493-149">字段名称必须满足 [UserProperties.Add](https://msdn.microsoft.com/library/microsoft.office.interop.outlook.userproperties.add.aspx) 方法中指定的对 Name 参数的限制。</span><span class="sxs-lookup"><span data-stu-id="88493-149">The field name must satisfy the restrictions on the Name parameter as specified in the [UserProperties.Add](https://msdn.microsoft.com/library/microsoft.office.interop.outlook.userproperties.add.aspx) Method.</span></span> 
    
   > [!NOTE]
   > <span data-ttu-id="88493-150">出于旧版兼容性的原因，Outlook 可能能够处理一些不满足这些限制的 **FieldName** 值，但本主题未涵盖此类情况。</span><span class="sxs-lookup"><span data-stu-id="88493-150">For reasons of legacy compatibility, Outlook may be able to handle some **FieldName** values not satisfying these restrictions, but such cases are not covered by this topic.</span></span> 
  
- <span data-ttu-id="88493-151">**常见**：FolderFieldDefinitionCommon 流结构。</span><span class="sxs-lookup"><span data-stu-id="88493-151">**Common**: A FolderFieldDefinitionCommon stream structure.</span></span>
    
## <a name="fldtype-enumeration"></a><span data-ttu-id="88493-152">FldType 枚举</span><span class="sxs-lookup"><span data-stu-id="88493-152">FldType Enumeration</span></span>

<span data-ttu-id="88493-153">**FldType** 枚举值如下表所列。</span><span class="sxs-lookup"><span data-stu-id="88493-153">**FldType** enumeration values are listed in the following table.</span></span> 
  
|<span data-ttu-id="88493-154">名称</span><span class="sxs-lookup"><span data-stu-id="88493-154">Name</span></span>|<span data-ttu-id="88493-155">值</span><span class="sxs-lookup"><span data-stu-id="88493-155">Value</span></span>|<span data-ttu-id="88493-156">含义</span><span class="sxs-lookup"><span data-stu-id="88493-156">Meaning</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="88493-157">ftNull</span><span class="sxs-lookup"><span data-stu-id="88493-157">ftNull</span></span>  <br/> |<span data-ttu-id="88493-158">0x0</span><span class="sxs-lookup"><span data-stu-id="88493-158">0x0</span></span>  <br/> |<span data-ttu-id="88493-159">此字段类型用于以 null 终止字段定义的数组。</span><span class="sxs-lookup"><span data-stu-id="88493-159">This field type is used to null-terminate an array of field definitions.</span></span>  <br/> |
|<span data-ttu-id="88493-160">ftString</span><span class="sxs-lookup"><span data-stu-id="88493-160">ftString</span></span>  <br/> |<span data-ttu-id="88493-161">0x1</span><span class="sxs-lookup"><span data-stu-id="88493-161">0x1</span></span>  <br/> |<span data-ttu-id="88493-162">文本</span><span class="sxs-lookup"><span data-stu-id="88493-162">Text</span></span>  <br/> |
|<span data-ttu-id="88493-163">ftInteger</span><span class="sxs-lookup"><span data-stu-id="88493-163">ftInteger</span></span>  <br/> |<span data-ttu-id="88493-164">0x3</span><span class="sxs-lookup"><span data-stu-id="88493-164">0x3</span></span>  <br/> |<span data-ttu-id="88493-165">整数</span><span class="sxs-lookup"><span data-stu-id="88493-165">Integer</span></span>  <br/> |
|<span data-ttu-id="88493-166">ftTime</span><span class="sxs-lookup"><span data-stu-id="88493-166">ftTime</span></span>  <br/> |<span data-ttu-id="88493-167">0x5</span><span class="sxs-lookup"><span data-stu-id="88493-167">0x5</span></span>  <br/> |<span data-ttu-id="88493-168">日期/时间</span><span class="sxs-lookup"><span data-stu-id="88493-168">Date/Time</span></span>  <br/> |
|<span data-ttu-id="88493-169">ftBoolean</span><span class="sxs-lookup"><span data-stu-id="88493-169">ftBoolean</span></span>  <br/> |<span data-ttu-id="88493-170">0x6</span><span class="sxs-lookup"><span data-stu-id="88493-170">0x6</span></span>  <br/> |<span data-ttu-id="88493-171">是/否</span><span class="sxs-lookup"><span data-stu-id="88493-171">Yes/No</span></span>  <br/> |
|<span data-ttu-id="88493-172">ftDuration</span><span class="sxs-lookup"><span data-stu-id="88493-172">ftDuration</span></span>  <br/> |<span data-ttu-id="88493-173">0x7</span><span class="sxs-lookup"><span data-stu-id="88493-173">0x7</span></span>  <br/> |<span data-ttu-id="88493-174">期限</span><span class="sxs-lookup"><span data-stu-id="88493-174">Duration</span></span>  <br/> |
|<span data-ttu-id="88493-175">ftMultiString</span><span class="sxs-lookup"><span data-stu-id="88493-175">ftMultiString</span></span>  <br/> |<span data-ttu-id="88493-176">0xB</span><span class="sxs-lookup"><span data-stu-id="88493-176">0xB</span></span>  <br/> |<span data-ttu-id="88493-177">关键字</span><span class="sxs-lookup"><span data-stu-id="88493-177">Keywords</span></span>  <br/> |
|<span data-ttu-id="88493-178">ftFloat</span><span class="sxs-lookup"><span data-stu-id="88493-178">ftFloat</span></span>  <br/> |<span data-ttu-id="88493-179">0xC</span><span class="sxs-lookup"><span data-stu-id="88493-179">0xC</span></span>  <br/> |<span data-ttu-id="88493-180">数字或百分比</span><span class="sxs-lookup"><span data-stu-id="88493-180">Number or Percent</span></span>  <br/> |
|<span data-ttu-id="88493-181">ftCurrency</span><span class="sxs-lookup"><span data-stu-id="88493-181">ftCurrency</span></span>  <br/> |<span data-ttu-id="88493-182">0xE</span><span class="sxs-lookup"><span data-stu-id="88493-182">0xE</span></span>  <br/> |<span data-ttu-id="88493-183">货币</span><span class="sxs-lookup"><span data-stu-id="88493-183">Currency</span></span>  <br/> |
|<span data-ttu-id="88493-184">ftCalc</span><span class="sxs-lookup"><span data-stu-id="88493-184">ftCalc</span></span>  <br/> |<span data-ttu-id="88493-185">0x12</span><span class="sxs-lookup"><span data-stu-id="88493-185">0x12</span></span>  <br/> |<span data-ttu-id="88493-186">公式</span><span class="sxs-lookup"><span data-stu-id="88493-186">Formula</span></span>  <br/> |
|<span data-ttu-id="88493-187">ftSwitch</span><span class="sxs-lookup"><span data-stu-id="88493-187">ftSwitch</span></span>  <br/> |<span data-ttu-id="88493-188">0x13</span><span class="sxs-lookup"><span data-stu-id="88493-188">0x13</span></span>  <br/> |<span data-ttu-id="88493-189">只显示第一个非空字段的类型组合 - 忽略后续字段。</span><span class="sxs-lookup"><span data-stu-id="88493-189">Combination of type showing only the first non-empty field - ignoring subsequent ones.</span></span>  <br/> |
|<span data-ttu-id="88493-190">ftConcat</span><span class="sxs-lookup"><span data-stu-id="88493-190">ftConcat</span></span>  <br/> |<span data-ttu-id="88493-191">0x17</span><span class="sxs-lookup"><span data-stu-id="88493-191">0x17</span></span>  <br/> |<span data-ttu-id="88493-192">将字段类型与任意文本片段相互组合。</span><span class="sxs-lookup"><span data-stu-id="88493-192">Combination of type joining fields and any text fragments to each other.</span></span>  <br/> |
   
## <a name="folderfielddefinitioncommon-stream-structure"></a><span data-ttu-id="88493-193">FolderFieldDefinitionCommon 流结构</span><span class="sxs-lookup"><span data-stu-id="88493-193">FolderFieldDefinitionCommon Stream Structure</span></span>

<span data-ttu-id="88493-194">FolderFieldDefinitionCommon 流结构包含用户定义的字段定义的数据，该定义对 FolderFieldDefinitionA 和 FolderFieldDefinitionW 都很常见。</span><span class="sxs-lookup"><span data-stu-id="88493-194">A FolderFieldDefinitionCommon stream structure contains the data of a user-defined field definition that is common to both a FolderFieldDefinitionA and a FolderFieldDefinitionW.</span></span>
  
<span data-ttu-id="88493-195">此流中的数据元素按小尾字节顺序存储，并按以下指定顺序彼此紧随：</span><span class="sxs-lookup"><span data-stu-id="88493-195">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="88493-196">**PropSetGuid**：GUID (16) ，即文件夹字段的相应 MAPI 属性名称的属性集 GUID。</span><span class="sxs-lookup"><span data-stu-id="88493-196">**PropSetGuid**: GUID (16 bytes), the property set GUID of the folder field's corresponding MAPI property name.</span></span> <span data-ttu-id="88493-197">此字段的值必须等于 PS_PUBLIC_STRINGS，除非字段类型是 **ftNone，** 在这种情况下，此字段的值必须等于 GUID_NULL。</span><span class="sxs-lookup"><span data-stu-id="88493-197">This field's value must be equal to PS_PUBLIC_STRINGS, unless the field type is **ftNone** in which case this field's value must be equal to GUID_NULL.</span></span> 
    
   > [!NOTE]
   > <span data-ttu-id="88493-198">出于旧版兼容性的原因，Outlook 也许能够处理一些不满足此限制的 **PropSetGuid** 值，但本主题未涵盖此类情况。</span><span class="sxs-lookup"><span data-stu-id="88493-198">For reasons of legacy compatibility, Outlook may be able to handle some **PropSetGuid** values not satisfying this restriction, however such cases are not covered by this topic.</span></span> 
  
- <span data-ttu-id="88493-199">**fcapm：DWORD** (4 字节) ，零个或多个标记的组合标记下表列出了其值和含义。</span><span class="sxs-lookup"><span data-stu-id="88493-199">**fcapm**: DWORD (4 bytes), a combination of zero or more flags the values of which and meanings are listed in the following table.</span></span> <span data-ttu-id="88493-200">具有相同值的标志的含义取决于字段的类型，即 FldType 值。</span><span class="sxs-lookup"><span data-stu-id="88493-200">Flags with the same value have meanings dependent on the field's type, that is, FldType value.</span></span>
    
    |<span data-ttu-id="88493-201">标志名称</span><span class="sxs-lookup"><span data-stu-id="88493-201">Flag name</span></span>|<span data-ttu-id="88493-202">值</span><span class="sxs-lookup"><span data-stu-id="88493-202">Value</span></span>|<span data-ttu-id="88493-203">含义</span><span class="sxs-lookup"><span data-stu-id="88493-203">Meaning</span></span>|
    |:-----|:-----|:-----|
    |<span data-ttu-id="88493-204">FCAPM_CAN_EDIT</span><span class="sxs-lookup"><span data-stu-id="88493-204">FCAPM_CAN_EDIT</span></span>  <br/> |<span data-ttu-id="88493-205">0x00000001</span><span class="sxs-lookup"><span data-stu-id="88493-205">0x00000001</span></span>  <br/> |<span data-ttu-id="88493-206">字段是可编辑的。</span><span class="sxs-lookup"><span data-stu-id="88493-206">The field is editable.</span></span>  <br/> |
    |<span data-ttu-id="88493-207">FCAPM_CAN_SORT</span><span class="sxs-lookup"><span data-stu-id="88493-207">FCAPM_CAN_SORT</span></span>  <br/> |<span data-ttu-id="88493-208">0x00000002</span><span class="sxs-lookup"><span data-stu-id="88493-208">0x00000002</span></span>  <br/> |<span data-ttu-id="88493-209">字段可排序。</span><span class="sxs-lookup"><span data-stu-id="88493-209">The field is sortable.</span></span>  <br/> |
    |<span data-ttu-id="88493-210">FCAPM_CAN_GROUP</span><span class="sxs-lookup"><span data-stu-id="88493-210">FCAPM_CAN_GROUP</span></span>  <br/> |<span data-ttu-id="88493-211">0x00000004</span><span class="sxs-lookup"><span data-stu-id="88493-211">0x00000004</span></span>  <br/> |<span data-ttu-id="88493-212">字段可分组。</span><span class="sxs-lookup"><span data-stu-id="88493-212">The field is groupable.</span></span>  <br/> |
    |<span data-ttu-id="88493-213">FCAPM_MULTILINE_TEXT</span><span class="sxs-lookup"><span data-stu-id="88493-213">FCAPM_MULTILINE_TEXT</span></span>  <br/> |<span data-ttu-id="88493-214">0x00000100</span><span class="sxs-lookup"><span data-stu-id="88493-214">0x00000100</span></span>  <br/> |<span data-ttu-id="88493-215">该字段可以包含多个文本行。</span><span class="sxs-lookup"><span data-stu-id="88493-215">The field can hold multiple lines of text.</span></span>  <br/> |
    |<span data-ttu-id="88493-216">FCAPM_PERCENT</span><span class="sxs-lookup"><span data-stu-id="88493-216">FCAPM_PERCENT</span></span>  <br/> |<span data-ttu-id="88493-217">0x01000000</span><span class="sxs-lookup"><span data-stu-id="88493-217">0x01000000</span></span>  <br/> |<span data-ttu-id="88493-218">类型为 ftFloat 的此字段是百分比字段。</span><span class="sxs-lookup"><span data-stu-id="88493-218">This field of the type ftFloat is a percentage field.</span></span>  <br/> |
    |<span data-ttu-id="88493-219">FCAPM_DATEONLY</span><span class="sxs-lookup"><span data-stu-id="88493-219">FCAPM_DATEONLY</span></span>  <br/> |<span data-ttu-id="88493-220">0x01000000</span><span class="sxs-lookup"><span data-stu-id="88493-220">0x01000000</span></span>  <br/> |<span data-ttu-id="88493-221">类型 ftTime 的此字段是仅日期时间字段。</span><span class="sxs-lookup"><span data-stu-id="88493-221">This field of the type ftTime is a date-only time field.</span></span>  <br/> |
    |<span data-ttu-id="88493-222">FCAPM_UNITLESS</span><span class="sxs-lookup"><span data-stu-id="88493-222">FCAPM_UNITLESS</span></span>  <br/> |<span data-ttu-id="88493-223">0x01000000</span><span class="sxs-lookup"><span data-stu-id="88493-223">0x01000000</span></span>  <br/> |<span data-ttu-id="88493-224">对于 ftInteger 类型的此字段，不允许以显示格式使用单位;例如，"Computer - 640 K..."等格式不允许。</span><span class="sxs-lookup"><span data-stu-id="88493-224">For this field of the type ftInteger, no unit is allowed in display format; for example such formats as "Computer - 640 K…" are not allowed.</span></span>  <br/> |
    |<span data-ttu-id="88493-225">FCAPM_CAN_EDIT_IN_ITEM</span><span class="sxs-lookup"><span data-stu-id="88493-225">FCAPM_CAN_EDIT_IN_ITEM</span></span>  <br/> |<span data-ttu-id="88493-226">0x80000000</span><span class="sxs-lookup"><span data-stu-id="88493-226">0x80000000</span></span>  <br/> |<span data-ttu-id="88493-227">可以在项中编辑字段：这专用于自定义窗体。</span><span class="sxs-lookup"><span data-stu-id="88493-227">The field can be edited in the item: This is specifically for custom forms.</span></span>  <br/> |
   
- <span data-ttu-id="88493-228">**dwString**：DWORD (4 字节) 。</span><span class="sxs-lookup"><span data-stu-id="88493-228">**dwString**: DWORD (4 bytes).</span></span> <span data-ttu-id="88493-229">请参阅下面的第一条"注意"。</span><span class="sxs-lookup"><span data-stu-id="88493-229">See the first following Note.</span></span>
    
- <span data-ttu-id="88493-230">**dwBitmap**：DWORD (4 字节) 。</span><span class="sxs-lookup"><span data-stu-id="88493-230">**dwBitmap**: DWORD (4 bytes).</span></span> <span data-ttu-id="88493-231">请参阅下面的第一条"注意"。</span><span class="sxs-lookup"><span data-stu-id="88493-231">See the first following Note.</span></span>
    
- <span data-ttu-id="88493-232">**dwDisplay**：DWORD (4 字节) 。</span><span class="sxs-lookup"><span data-stu-id="88493-232">**dwDisplay**: DWORD (4 bytes).</span></span> <span data-ttu-id="88493-233">请参阅下面的第一条"注意"。</span><span class="sxs-lookup"><span data-stu-id="88493-233">See the first following Note.</span></span>
    
- <span data-ttu-id="88493-234">**iFmt**：INT (4 字节) 。</span><span class="sxs-lookup"><span data-stu-id="88493-234">**iFmt**: INT (4 bytes).</span></span> <span data-ttu-id="88493-235">对于"新建字段"、"编辑字段"和"字段属性"对话框中具有"Format："组合框的字段类型，该组合框中所选格式的基于 0 的索引。</span><span class="sxs-lookup"><span data-stu-id="88493-235">For the field types that have the "Format:" combo box in the "New Field", "Edit Field", and "Field Properties" dialogs, the 0-based index of the format selected in that combo box.</span></span> <span data-ttu-id="88493-236">对于没有该组合框的字段类型，必须为 0。</span><span class="sxs-lookup"><span data-stu-id="88493-236">For the field types without that combo box, this must be 0.</span></span> <span data-ttu-id="88493-237">字段值与字段类型一起唯一地确定 **dwString、dwBitmap** 和 **dwDisplay** 字段的值，请参阅下面的第一个注释。</span><span class="sxs-lookup"><span data-stu-id="88493-237">The field's value together with the field type uniquely determine the values of the **dwString**, **dwBitmap**, and **dwDisplay** fields, see the first following Note.</span></span>
    
- <span data-ttu-id="88493-238">**wszFormulaLength：WORD** (2 字节) ， **即 wszFormulaLength 数组中的元素** 数。</span><span class="sxs-lookup"><span data-stu-id="88493-238">**wszFormulaLength**: WORD (2 bytes), the number of elements in the **wszFormulaLength** array.</span></span>
    
- <span data-ttu-id="88493-239">**wszFormulaLength：WCHAR** 的数组。</span><span class="sxs-lookup"><span data-stu-id="88493-239">**wszFormulaLength**: An array of WCHAR.</span></span> <span data-ttu-id="88493-240">这是 Unicode (UTF-16) 格式的字段公式字符串的表示形式。</span><span class="sxs-lookup"><span data-stu-id="88493-240">This is the Unicode (UTF-16) representation of the field's formula string in its standard format.</span></span> <span data-ttu-id="88493-241">有关字段公式的标准和 UI 格式的说明，请参阅下面的第二个注释。</span><span class="sxs-lookup"><span data-stu-id="88493-241">See the second following Note for the description of the standard and UI formats of a field's formula.</span></span> <span data-ttu-id="88493-242">此数组的计数等于 **wszFormulaLength**。</span><span class="sxs-lookup"><span data-stu-id="88493-242">The count of this array is equal to **wszFormulaLength**.</span></span> <span data-ttu-id="88493-243">公式字符串必须为空字符串，除非字段类型是 **ftCalc**、 **ftSwitch** 或 **ftConcat**。</span><span class="sxs-lookup"><span data-stu-id="88493-243">The formula string must be an empty string unless the field type is **ftCalc**, **ftSwitch** or **ftConcat**.</span></span>
    
> [!NOTE]
> <span data-ttu-id="88493-244">尽管 **dwString、dwBitmap** 和 **dwDisplay** 的值根据 **FldType** 值和 **iFmt** 值（冗余）进行唯一确定，但是 Outlook 正确处理字段定义仍然需要这些值。</span><span class="sxs-lookup"><span data-stu-id="88493-244">Although the values of **dwString**, **dwBitmap**, and **dwDisplay** are uniquely determined based on the **FldType** value and the **iFmt** value, which are redundant, their correct values are still necessary for correct processing of the field definition by Outlook.</span></span> <span data-ttu-id="88493-245">没有用于执行此确定算法的简单说明。</span><span class="sxs-lookup"><span data-stu-id="88493-245">There is no simple description of the algorithm that performs this determination.</span></span> 
> 
> <span data-ttu-id="88493-246">因此，若要找出哪些 **dwString、dwBitmap** 和 **dwDisplay** 值对应于给定的 **FldType** 值和 **iFmt** 值，请通过创建该类型的用户定义的字段来执行测试，使用在"格式"组合框中选择的格式（假定其适用性）检查 Outlook 为该用户定义的字段创建的结果 **FolderUserFields** 流。 </span><span class="sxs-lookup"><span data-stu-id="88493-246">Therefore, to find out which **dwString**, **dwBitmap**, and **dwDisplay** values correspond to a given **FldType** value and **iFmt** value, perform a test by creating a user-defined field of that type, and with that format selected in the **Format** combo box, assuming its applicability, inspect the resulting **FolderUserFields** stream that Outlook creates for that user-defined field.</span></span> 
  
<span data-ttu-id="88493-247">字段的 UI 格式的公式在用户定义的字段的"新建字段"、"编辑字段"和"字段属性"对话框的"公式"文本框中编辑。 </span><span class="sxs-lookup"><span data-stu-id="88493-247">The field's formula in its UI format is edited in the **Formula** text box of the **New Field**, **Edit Field**, and **Field Properties** dialogs for the user-defined field.</span></span> <span data-ttu-id="88493-248">将公式从 UI 格式转换为标准格式的算法取决于字段类型，如下所述：</span><span class="sxs-lookup"><span data-stu-id="88493-248">The algorithm to convert a formula from the UI format to the standard format depends on the field type as described in the following:</span></span> 
- <span data-ttu-id="88493-249">对于 **类型为 ftCalc** 和 **ftSwitch** 的字段，内置字段的标准格式（对应的 MAPI 属性不是类型 MNID STRING 的命名属性）通过替换字段名称片段（即片段）获取。 \_ `[<field_name>]` `[_<field_dispid_decimal>]`</span><span class="sxs-lookup"><span data-stu-id="88493-249">For fields of types **ftCalc** and **ftSwitch**, the standard format for built-in fields, which corresponding MAPI properties are not named properties of the kind MNID\_STRING, is obtained by replacing field name fragments, that is `[<field_name>]` with fragments `[_<field_dispid_decimal>]`.</span></span> 

  <span data-ttu-id="88493-250">例如，如果公式类型为 **Formula** 的字段（即 **ftCalc，Office** UI 语言为美国英语）的 UI 格式为 ，其中 是用户定义字段的名称，则此类公式的标准格式为 `[Business Phone] & [My custom field]` `My custom field` `[_14856] & [My custom field]` 。</span><span class="sxs-lookup"><span data-stu-id="88493-250">For example, if the UI format of a formula for a field of the type **Formula**, that is **ftCalc**, with the Office UI language being US English, is `[Business Phone] & [My custom field]`, where `My custom field` is the name of a user-defined field, the standard format of such a formula would be `[_14856] & [My custom field]`.</span></span>

- <span data-ttu-id="88493-251">对于 **类型 ftConcat** 的字段，通过执行下列操作获得标准格式：</span><span class="sxs-lookup"><span data-stu-id="88493-251">For fields of the type **ftConcat**, the standard format is obtained by performing the following:</span></span>

  1. <span data-ttu-id="88493-252">截断前导空格和尾随空格。</span><span class="sxs-lookup"><span data-stu-id="88493-252">Truncate leading and trailing whitespace.</span></span> 
  2. <span data-ttu-id="88493-253">将公式解析为以下两种类型的片段序列：</span><span class="sxs-lookup"><span data-stu-id="88493-253">Parse the formula into a sequence of fragments of the following two kinds:</span></span> 
     - <span data-ttu-id="88493-254">方括号中的字段名称，即 `[<field_name>]` 。</span><span class="sxs-lookup"><span data-stu-id="88493-254">A field name in square brackets, that is, `[<field_name>]`.</span></span> 
     - <span data-ttu-id="88493-255">不包含任何方括号的子字符串。</span><span class="sxs-lookup"><span data-stu-id="88493-255">A substring not containing any square brackets.</span></span>   
      <span data-ttu-id="88493-256">确保序列中不相邻第二类的两个片段。</span><span class="sxs-lookup"><span data-stu-id="88493-256">Assure that no two fragments of the second kind are adjacent in the sequence.</span></span> <span data-ttu-id="88493-257">如果无法通过此方式分析公式，则认为它无效。</span><span class="sxs-lookup"><span data-stu-id="88493-257">If the formula cannot be parsed this way, it is considered invalid.</span></span> 
  3. <span data-ttu-id="88493-258">对第一种片段执行与 **ftCalc** 和 **ftSwitch** 字段相同的替换。</span><span class="sxs-lookup"><span data-stu-id="88493-258">Perform the same replacement for fragments of the first kind as for the **ftCalc** and **ftSwitch** fields.</span></span> 
  4. <span data-ttu-id="88493-259">对于第二种的每个片段，用两个连续的双引号字符转义所有双引号 (""") 字符（如果有）并括在双引号中。</span><span class="sxs-lookup"><span data-stu-id="88493-259">For each fragment of the second kind, escape all double-quote (""") characters, if any, with two consecutive double-quote characters, and enclose it in double quotes.</span></span> 
  5. <span data-ttu-id="88493-260">在每个相邻片段对 () 插入一个 `&` 与字符的字符串。</span><span class="sxs-lookup"><span data-stu-id="88493-260">Insert an ampersand string (`&`) between each pair of adjacent fragments.</span></span>
 
  <span data-ttu-id="88493-261">例如，使用 Office UI 语言美国英语，如果 **ftConcat** 类型的字段的公式的 UI 格式为 ，其中 是用户定义的域的名称，则此类公式的标准格式为 `text1 [Business Phone] "text2" [My custom field]` `My custom field` `""text1" & [_14856] & """text2""" & [My custom field]"` 。</span><span class="sxs-lookup"><span data-stu-id="88493-261">For example, using the Office UI language US English, if the UI format of a formula for a field of the type **ftConcat** is `text1 [Business Phone] "text2" [My custom field]`, where `My custom field` is the name of a user-defined field, the standard format for such a formula would be `""text1" & [_14856] & """text2""" & [My custom field]"`.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="88493-262">另请参阅</span><span class="sxs-lookup"><span data-stu-id="88493-262">See also</span></span>

- [<span data-ttu-id="88493-263">FolderUserFields 流示例</span><span class="sxs-lookup"><span data-stu-id="88493-263">FolderUserFields Stream Sample</span></span>](folderuserfields-stream-sample.md)
- [<span data-ttu-id="88493-264">添加新字段User-Defined定义</span><span class="sxs-lookup"><span data-stu-id="88493-264">Add a Definition for a New User-Defined Field</span></span>](how-to-add-a-definition-for-a-new-user-defined-field.md)

