---
title: 限制类型
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 0d3bd58b-7100-4117-91ac-27139715c85b
description: 上次修改时间：2015 年 3 月 9 日
ms.openlocfilehash: 28159dfb947b4fb0ea54680627588b7c10bee3b3
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/28/2019
ms.locfileid: "33416284"
---
# <a name="types-of-restrictions"></a><span data-ttu-id="0ba4b-103">限制类型</span><span class="sxs-lookup"><span data-stu-id="0ba4b-103">Types of Restrictions</span></span>

  
  
<span data-ttu-id="0ba4b-104">**适用于**：Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="0ba4b-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="0ba4b-105">存在许多类型的限制，其中一些限制侧重于特定列。</span><span class="sxs-lookup"><span data-stu-id="0ba4b-105">There are many types of restrictions, some that focus on specific columns.</span></span> <span data-ttu-id="0ba4b-106">所有表实现应支持对当前列集内列的限制。</span><span class="sxs-lookup"><span data-stu-id="0ba4b-106">All table implementations are expected to support restrictions on the columns in the current column set.</span></span> <span data-ttu-id="0ba4b-107">但是，若要添加值，表实施者还可以支持基于当前不在表视图中的对象属性的限制。</span><span class="sxs-lookup"><span data-stu-id="0ba4b-107">However, to add value, table implementers can also support restrictions based on object properties that are not currently in the table view.</span></span>
  
<span data-ttu-id="0ba4b-108">可以使用执行逻辑 **AND、OR** 或 **NOT** 操作的限制来组合某些限制。</span><span class="sxs-lookup"><span data-stu-id="0ba4b-108">Some restrictions can be combined using a restriction that performs a logical **AND**, **OR**, or **NOT** operation.</span></span> <span data-ttu-id="0ba4b-109">例如，必须使用 AND 限制将大多数属性限制与 **存在限制联接** 。</span><span class="sxs-lookup"><span data-stu-id="0ba4b-109">For example, most property restrictions must be joined with exist restrictions using **AND** restrictions.</span></span> <span data-ttu-id="0ba4b-110">有一些例外情况，例如当属性限制中使用的属性是 **PR_ANR** ([PidTagAnr](pidtaganr-canonical-property.md)) 属性时，或者当该属性是表格中的必需列时。</span><span class="sxs-lookup"><span data-stu-id="0ba4b-110">There are a few exceptions, such as when the property used in the property restriction is the **PR_ANR** ([PidTagAnr](pidtaganr-canonical-property.md)) property or when it is a required column in a table.</span></span> <span data-ttu-id="0ba4b-111">用于限制其视图的客户端构建限制应该使用具有属性限制的已存在限制，因为 MAPI 不指定当属性不存在时，服务提供商如何评估属性限制。</span><span class="sxs-lookup"><span data-stu-id="0ba4b-111">A client building restrictions to limit its view should use exist restrictions with its property restrictions because MAPI does not specify how service providers should evaluate property restrictions when a property does not exist.</span></span> <span data-ttu-id="0ba4b-112">建议服务提供商不满足限制，但没有任何要求，这是合理的。</span><span class="sxs-lookup"><span data-stu-id="0ba4b-112">It is reasonable and recommended that service providers fail the restriction, but there are no requirements.</span></span> 
  
<span data-ttu-id="0ba4b-113">限制是使用 [SRestriction 数据结构定义的，SRestriction](srestriction.md) 数据结构包含一组更专门的限制结构和联合中包含的结构类型的指示器。</span><span class="sxs-lookup"><span data-stu-id="0ba4b-113">A restriction is defined using the [SRestriction](srestriction.md) data structure which contains a union of more specialized restriction structures and an indicator of the type of structure included in the union.</span></span> 
  
<span data-ttu-id="0ba4b-114">联合中的每个专用限制结构表示不同类型的限制。</span><span class="sxs-lookup"><span data-stu-id="0ba4b-114">Each of the specialized restriction structures in the union represents a different type of restriction.</span></span> <span data-ttu-id="0ba4b-115">限制类型及其关联的数据结构包括：</span><span class="sxs-lookup"><span data-stu-id="0ba4b-115">The types of restrictions and their associated data structures are:</span></span>
  
|<span data-ttu-id="0ba4b-116">**限制类型**</span><span class="sxs-lookup"><span data-stu-id="0ba4b-116">**Type of restriction**</span></span>|<span data-ttu-id="0ba4b-117">**关联的数据结构**</span><span class="sxs-lookup"><span data-stu-id="0ba4b-117">**Associated data structure**</span></span>|<span data-ttu-id="0ba4b-118">**说明**</span><span class="sxs-lookup"><span data-stu-id="0ba4b-118">**Description**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="0ba4b-119">Compare 属性</span><span class="sxs-lookup"><span data-stu-id="0ba4b-119">Compare property</span></span>  <br/> |[<span data-ttu-id="0ba4b-120">SComparePropsRestriction</span><span class="sxs-lookup"><span data-stu-id="0ba4b-120">SComparePropsRestriction</span></span>](scomparepropsrestriction.md) <br/> |<span data-ttu-id="0ba4b-121">比较同一类型的两个属性。</span><span class="sxs-lookup"><span data-stu-id="0ba4b-121">Compares two properties of the same type.</span></span>  <br/> |
|<span data-ttu-id="0ba4b-122">AND</span><span class="sxs-lookup"><span data-stu-id="0ba4b-122">**AND**</span></span> <br/> |[<span data-ttu-id="0ba4b-123">SAndRestriction</span><span class="sxs-lookup"><span data-stu-id="0ba4b-123">SAndRestriction</span></span>](sandrestriction.md) <br/> |<span data-ttu-id="0ba4b-124">对两个或多个限制执行逻辑 **AND** 操作。</span><span class="sxs-lookup"><span data-stu-id="0ba4b-124">Performs a logical **AND** operation on two or more restrictions.</span></span>  <br/> |
|<span data-ttu-id="0ba4b-125">**OR**</span><span class="sxs-lookup"><span data-stu-id="0ba4b-125">**OR**</span></span> <br/> |[<span data-ttu-id="0ba4b-126">SOrRestriction</span><span class="sxs-lookup"><span data-stu-id="0ba4b-126">SOrRestriction</span></span>](sorrestriction.md) <br/> |<span data-ttu-id="0ba4b-127">对两个或多个限制执行逻辑 **OR** 操作。</span><span class="sxs-lookup"><span data-stu-id="0ba4b-127">Performs a logical **OR** operation on two or more restrictions.</span></span>  <br/> |
|<span data-ttu-id="0ba4b-128">**NOT**</span><span class="sxs-lookup"><span data-stu-id="0ba4b-128">**NOT**</span></span> <br/> |[<span data-ttu-id="0ba4b-129">SNotRestriction</span><span class="sxs-lookup"><span data-stu-id="0ba4b-129">SNotRestriction</span></span>](snotrestriction.md) <br/> |<span data-ttu-id="0ba4b-130">对两个或多个限制执行逻辑 **NOT** 操作。</span><span class="sxs-lookup"><span data-stu-id="0ba4b-130">Performs a logical **NOT** operation on two or more restrictions.</span></span>  <br/> |
|<span data-ttu-id="0ba4b-131">Content</span><span class="sxs-lookup"><span data-stu-id="0ba4b-131">Content</span></span>  <br/> |[<span data-ttu-id="0ba4b-132">SContentRestriction</span><span class="sxs-lookup"><span data-stu-id="0ba4b-132">SContentRestriction</span></span>](scontentrestriction.md) <br/> |<span data-ttu-id="0ba4b-133">查找指定数据。</span><span class="sxs-lookup"><span data-stu-id="0ba4b-133">Locates specified data.</span></span>  <br/> |
|<span data-ttu-id="0ba4b-134">属性</span><span class="sxs-lookup"><span data-stu-id="0ba4b-134">Property</span></span>  <br/> |[<span data-ttu-id="0ba4b-135">SPropertyRestriction</span><span class="sxs-lookup"><span data-stu-id="0ba4b-135">SPropertyRestriction</span></span>](spropertyrestriction.md) <br/> |<span data-ttu-id="0ba4b-136">指定特定属性值作为匹配条件。</span><span class="sxs-lookup"><span data-stu-id="0ba4b-136">Specifies a particular property value as criteria for matching.</span></span> <span data-ttu-id="0ba4b-137">例如，可用于搜索特定类型的附件。</span><span class="sxs-lookup"><span data-stu-id="0ba4b-137">Can be used, for example, to search for a particular type of attachment.</span></span>  <br/> |
|<span data-ttu-id="0ba4b-138">Bitmask</span><span class="sxs-lookup"><span data-stu-id="0ba4b-138">Bitmask</span></span>  <br/> |[<span data-ttu-id="0ba4b-139">SBitMaskRestriction</span><span class="sxs-lookup"><span data-stu-id="0ba4b-139">SBitMaskRestriction</span></span>](sbitmaskrestriction.md) <br/> |<span data-ttu-id="0ba4b-140">将位掩码应用于PT_LONG，通常用于确定是否设置了特定标志。</span><span class="sxs-lookup"><span data-stu-id="0ba4b-140">Applies a bitmask to a PT_LONG property, typically to determine whether particular flags are set.</span></span>  <br/> |
|<span data-ttu-id="0ba4b-141">Size</span><span class="sxs-lookup"><span data-stu-id="0ba4b-141">Size</span></span>  <br/> |[<span data-ttu-id="0ba4b-142">SSizeRestriction</span><span class="sxs-lookup"><span data-stu-id="0ba4b-142">SSizeRestriction</span></span>](ssizerestriction.md) <br/> |<span data-ttu-id="0ba4b-143">使用标准关系运算符测试属性的大小。</span><span class="sxs-lookup"><span data-stu-id="0ba4b-143">Tests the size of a property using standard relational operators.</span></span>  <br/> |
|<span data-ttu-id="0ba4b-144">存在</span><span class="sxs-lookup"><span data-stu-id="0ba4b-144">Exist</span></span>  <br/> |[<span data-ttu-id="0ba4b-145">SExistRestriction</span><span class="sxs-lookup"><span data-stu-id="0ba4b-145">SExistRestriction</span></span>](sexistrestriction.md) <br/> |<span data-ttu-id="0ba4b-146">测试对象是否具有属性的值。</span><span class="sxs-lookup"><span data-stu-id="0ba4b-146">Tests whether an object has a value for a property.</span></span>  <br/> |
|<span data-ttu-id="0ba4b-147">子对象</span><span class="sxs-lookup"><span data-stu-id="0ba4b-147">Subobject</span></span>  <br/> |[<span data-ttu-id="0ba4b-148">SSubRestriction</span><span class="sxs-lookup"><span data-stu-id="0ba4b-148">SSubRestriction</span></span>](ssubrestriction.md) <br/> |<span data-ttu-id="0ba4b-149">用于搜索子对象，或无法使用条目标识符访问的对象，例如收件人和附件。</span><span class="sxs-lookup"><span data-stu-id="0ba4b-149">Used for searching through subobjects, or objects that cannot be accessed with an entry identifier, such as recipients and attachments.</span></span> <span data-ttu-id="0ba4b-150">例如，可用于查找特定收件人的邮件。</span><span class="sxs-lookup"><span data-stu-id="0ba4b-150">Can be used, for example, to look for messages for a particular recipient.</span></span>  <br/> |
|<span data-ttu-id="0ba4b-151">评论</span><span class="sxs-lookup"><span data-stu-id="0ba4b-151">Comment</span></span>  <br/> |[<span data-ttu-id="0ba4b-152">SCommentRestriction</span><span class="sxs-lookup"><span data-stu-id="0ba4b-152">SCommentRestriction</span></span>](scommentrestriction.md) <br/> |<span data-ttu-id="0ba4b-153">将对象与一组命名属性关联。</span><span class="sxs-lookup"><span data-stu-id="0ba4b-153">Associates an object with a set of named properties.</span></span>  <br/> |
   
<span data-ttu-id="0ba4b-154">某些限制使用正则表达式，MAPI 支持采用许多文本应用程序的样式中的有限形式的正则表达式表示法。</span><span class="sxs-lookup"><span data-stu-id="0ba4b-154">Some restrictions use regular expressions, and MAPI supports a limited form of regular expression notation in the style that is used many text applications.</span></span>
  
<span data-ttu-id="0ba4b-155">注释限制由在磁盘上保存限制的客户端使用，以保留具有限制的应用程序特定信息。</span><span class="sxs-lookup"><span data-stu-id="0ba4b-155">The comment restriction is used by clients that save restrictions on disk to keep application-specific information with the restriction.</span></span> <span data-ttu-id="0ba4b-156">例如，保存属性限制中使用的命名属性的名称的客户端可以使用注释限制来这样做。</span><span class="sxs-lookup"><span data-stu-id="0ba4b-156">For example, a client saving the name of a named property used in a property restriction can do so with a comment restriction.</span></span> <span data-ttu-id="0ba4b-157">在属性限制中无法保存名称; [SPropertyRestriction](spropertyrestriction.md) 数据结构仅保留属性标记。</span><span class="sxs-lookup"><span data-stu-id="0ba4b-157">Saving the name is not possible in a property restriction; the [SPropertyRestriction](spropertyrestriction.md) data structure holds only the property tag.</span></span> <span data-ttu-id="0ba4b-158">[IMAPITable：：Restrict](imapitable-restrict.md)将忽略注释限制，因为它们在执行 **Restrict** 调用后对 [IMAPITable：：QueryRows](imapitable-queryrows.md)返回的行没有影响。</span><span class="sxs-lookup"><span data-stu-id="0ba4b-158">Comment restrictions are ignored by [IMAPITable::Restrict](imapitable-restrict.md) in that they have no effect on the rows returned by [IMAPITable::QueryRows](imapitable-queryrows.md) after a **Restrict** call has been made.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="0ba4b-159">另请参阅</span><span class="sxs-lookup"><span data-stu-id="0ba4b-159">See also</span></span>



[<span data-ttu-id="0ba4b-160">MAPI 表</span><span class="sxs-lookup"><span data-stu-id="0ba4b-160">MAPI Tables</span></span>](mapi-tables.md)

