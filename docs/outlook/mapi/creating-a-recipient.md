---
title: 创建收件人
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 586c901f-d9f9-44f2-a328-051775a81265
description: 上次修改时间：2015 年 3 月 9 日
ms.openlocfilehash: e14430d1539b90e089a9dabe1315384050f3dd5e
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/23/2019
ms.locfileid: "32332954"
---
# <a name="creating-a-recipient"></a><span data-ttu-id="c6942-103">创建收件人</span><span class="sxs-lookup"><span data-stu-id="c6942-103">Creating a Recipient</span></span>

  
  
<span data-ttu-id="c6942-104">**适用于**：Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="c6942-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="c6942-105">客户端在对邮件进行寻址以及将条目添加到可修改通讯簿容器时创建收件人。</span><span class="sxs-lookup"><span data-stu-id="c6942-105">Clients create recipients when they are addressing messages and when they are adding entries to modifiable address book containers.</span></span> <span data-ttu-id="c6942-106">MAPI 提供了三种创建收件人的方法:</span><span class="sxs-lookup"><span data-stu-id="c6942-106">MAPI provides three methods for creating recipients:</span></span>
  
- [<span data-ttu-id="c6942-107">IAddrBook::CreateOneOff</span><span class="sxs-lookup"><span data-stu-id="c6942-107">IAddrBook::CreateOneOff</span></span>](iaddrbook-createoneoff.md)
    
- [<span data-ttu-id="c6942-108">IAddrBook::NewEntry</span><span class="sxs-lookup"><span data-stu-id="c6942-108">IAddrBook::NewEntry</span></span>](iaddrbook-newentry.md)
    
- [<span data-ttu-id="c6942-109">IABContainer::CreateEntry</span><span class="sxs-lookup"><span data-stu-id="c6942-109">IABContainer::CreateEntry</span></span>](iabcontainer-createentry.md)
    
<span data-ttu-id="c6942-110">在创建用于处理邮件的收件人时, 调用**IAddrBook:: CreateOneOff** 。</span><span class="sxs-lookup"><span data-stu-id="c6942-110">Call **IAddrBook::CreateOneOff** when you are creating recipients to be used to address messages.</span></span> <span data-ttu-id="c6942-111">**CreateOneOff**创建一个专门设置的一次性条目标识符, 以与特定地址类型的地址相关联。</span><span class="sxs-lookup"><span data-stu-id="c6942-111">**CreateOneOff** creates a specially formatted one-off entry identifier to be associated with an address of a particular address type.</span></span> <span data-ttu-id="c6942-112">有关一次性和一次性条目标识符的详细信息, 请参阅[一次性地址](one-off-addresses.md)和[一次性条目标识符](one-off-entry-identifiers.md)。</span><span class="sxs-lookup"><span data-stu-id="c6942-112">For more information about one-offs and one-off entry identifiers, see [One-Off Addresses](one-off-addresses.md) and [One-Off Entry Identifiers](one-off-entry-identifiers.md).</span></span>
  
<span data-ttu-id="c6942-113">在创建要用于解决邮件或添加到容器中的收件人时, 调用**IAddrBook:: NewEntry** 。</span><span class="sxs-lookup"><span data-stu-id="c6942-113">Call **IAddrBook::NewEntry** when you are creating recipients to be used either to address messages or to add to a container.</span></span> <span data-ttu-id="c6942-114">**NewEntry**具有三对包含条目标识符的参数。</span><span class="sxs-lookup"><span data-stu-id="c6942-114">**NewEntry** has three pairs of parameters that contain entry identifiers.</span></span> <span data-ttu-id="c6942-115">这些参数如下所述:</span><span class="sxs-lookup"><span data-stu-id="c6942-115">These parameters are described as follows:</span></span> 
  
|<span data-ttu-id="c6942-116">**参数对**</span><span class="sxs-lookup"><span data-stu-id="c6942-116">**Parameter pair**</span></span>|<span data-ttu-id="c6942-117">**Description**</span><span class="sxs-lookup"><span data-stu-id="c6942-117">**Description**</span></span>|
|:-----|:-----|
| <span data-ttu-id="c6942-118">_cbEidContainer_和_lpEidContainer_</span><span class="sxs-lookup"><span data-stu-id="c6942-118">_cbEidContainer_ and  _lpEidContainer_</span></span> <br/> |<span data-ttu-id="c6942-119">应放置新条目的容器的条目标识符。</span><span class="sxs-lookup"><span data-stu-id="c6942-119">Entry identifier for the container into which the new entry should be placed.</span></span>  <br/> |
| <span data-ttu-id="c6942-120">_cbEidNewEntryTpl_和_lpEidNewEntryTpl_</span><span class="sxs-lookup"><span data-stu-id="c6942-120">_cbEidNewEntryTpl_ and  _lpEidNewEntryTpl_</span></span> <br/> |<span data-ttu-id="c6942-121">用于创建新条目的模板的条目标识符。</span><span class="sxs-lookup"><span data-stu-id="c6942-121">Entry identifier for the template to be used to create the new entry.</span></span>  <br/> |
| <span data-ttu-id="c6942-122">_lpcbEidNewEntry_和_lppEidNewEntry_</span><span class="sxs-lookup"><span data-stu-id="c6942-122">_lpcbEidNewEntry_ and  _lppEidNewEntry_</span></span> <br/> |<span data-ttu-id="c6942-123">新条目的条目标识符。</span><span class="sxs-lookup"><span data-stu-id="c6942-123">Entry identifier for the new entry.</span></span>  <br/> |
   
<span data-ttu-id="c6942-124">若要为传出邮件创建收件人, 请将_cbEidContainer_设置为零, 将_lpEidContainer_设置为 NULL。</span><span class="sxs-lookup"><span data-stu-id="c6942-124">To create a recipient for an outgoing message, set  _cbEidContainer_ to zero and  _lpEidContainer_ to NULL.</span></span> <span data-ttu-id="c6942-125">**NewEntry**创建具有符合一次性格式的条目标识符的收件人, 即调用**IAddrBook:: CreateOneOff**所生成的相同类型的收件人。</span><span class="sxs-lookup"><span data-stu-id="c6942-125">**NewEntry** creates a recipient with an entry identifier that conforms to the one-off format, the same type of recipient that is produced by a call to **IAddrBook::CreateOneOff**.</span></span> 
  
<span data-ttu-id="c6942-126">若要创建要插入到特定容器中的收件人, 请将_lpEidContainer_的条目标识符和_cbEidContainer_设置为容器条目标识符中的字节数。</span><span class="sxs-lookup"><span data-stu-id="c6942-126">To create a recipient to be inserted into a particular container, set  _lpEidContainer_ to the container's entry identifier and  _cbEidContainer_ to the number of bytes in the container's entry identifier.</span></span> 
  
<span data-ttu-id="c6942-127">若要使用模板创建收件人, 请将_lpEidNewEntryTpl_设置为要使用的模板的条目标识符, 并将_cbEidNewEntryTpl_设置为此条目标识符中的字节数。</span><span class="sxs-lookup"><span data-stu-id="c6942-127">To use a template to create a recipient, set  _lpEidNewEntryTpl_ to the entry identifier of the template to be used and  _cbEidNewEntryTpl_ to the count of bytes in this entry identifier.</span></span> <span data-ttu-id="c6942-128">大多数可修改的通讯簿容器都支持一个或多个模板来创建特定类型的条目。</span><span class="sxs-lookup"><span data-stu-id="c6942-128">Most modifiable address book containers support one or more templates for creating entries of a particular type.</span></span> <span data-ttu-id="c6942-129">一次性模板通常是 (但不总是) 对话框。</span><span class="sxs-lookup"><span data-stu-id="c6942-129">One-off templates are typically, but not always, dialog boxes.</span></span> <span data-ttu-id="c6942-130">将信息输入到模板中时, 将生成一个收件人, 其地址的格式为正确的类型。</span><span class="sxs-lookup"><span data-stu-id="c6942-130">Entering information into the template produces a recipient with an address that is correctly formatted for the type.</span></span> 
  
<span data-ttu-id="c6942-131">从以下任一项获取模板条目标识符:</span><span class="sxs-lookup"><span data-stu-id="c6942-131">Obtain the template entry identifier from either:</span></span>
  
- <span data-ttu-id="c6942-132">容器的一次性表中的**PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)) 列 (通过调用容器的[IMAPIProp:: OpenProperty](imapiprop-openproperty.md)方法并指定**PR_CREATE_TEMPLATES** ([PidTagCreateTemplates](pidtagcreatetemplates-canonical-property.md))) 来访问作为接口标识符的属性标记和 IID_IMAPITable。</span><span class="sxs-lookup"><span data-stu-id="c6942-132">The **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)) column in the container's one-off table, accessed by calling the container's [IMAPIProp::OpenProperty](imapiprop-openproperty.md) method and specifying **PR_CREATE_TEMPLATES** ([PidTagCreateTemplates](pidtagcreatetemplates-canonical-property.md)) as the property tag and IID_IMAPITable as the interface identifier.</span></span> 
    
- <span data-ttu-id="c6942-133">通讯簿提供程序的**PR_DEF_CREATE_MAILUSER** ([PidTagDefCreateMailuser](pidtagdefcreatemailuser-canonical-property.md)) 和**PR_DEF_CREATE_DL** ([PidTagDefCreateDl](pidtagdefcreatedl-canonical-property.md)) 属性, 其中包含提供程序的邮件用户对象的条目标识符和通讯组列表模板。</span><span class="sxs-lookup"><span data-stu-id="c6942-133">An address book provider's **PR_DEF_CREATE_MAILUSER** ([PidTagDefCreateMailuser](pidtagdefcreatemailuser-canonical-property.md)) and **PR_DEF_CREATE_DL** ([PidTagDefCreateDl](pidtagdefcreatedl-canonical-property.md)) properties which hold the entry identifiers for the provider's messaging user object and distribution list templates.</span></span> 
    
> [!NOTE]
> <span data-ttu-id="c6942-134">请勿将新条目模板的条目标识符与称为模板标识符的不同类型的条目标识符相混淆。</span><span class="sxs-lookup"><span data-stu-id="c6942-134">Do not confuse a new entry template's entry identifier with a different type of entry identifier called a template identifier.</span></span> <span data-ttu-id="c6942-135">模板标识符仅由提供程序使用, 用于维护从其他提供程序复制的条目;它从不用于客户端, 它不用于创建新条目。</span><span class="sxs-lookup"><span data-stu-id="c6942-135">A template identifier is used only by providers to maintain entries copied from other providers; it is never used by clients and it is not used to create new entries.</span></span> 
  
<span data-ttu-id="c6942-136">若要使用户能够确定要创建的条目的类型, 请为_cbEidNewEntryTpl_传递零, 并为_lpEidNewEntryTpl_传递 NULL。</span><span class="sxs-lookup"><span data-stu-id="c6942-136">To enable the user to determine the type of entry to be created, pass zero for  _cbEidNewEntryTpl_ and NULL for  _lpEidNewEntryTpl_.</span></span> <span data-ttu-id="c6942-137">发生这种情况时, **NewEntry**会显示一个内置于 MAPI 一次性表的通用对话框, 即配置文件中每个通讯簿提供程序所支持的所有模板的分层列表。</span><span class="sxs-lookup"><span data-stu-id="c6942-137">When this occurs, **NewEntry** displays a common dialog box built from MAPI's one-off table — a hierarchical list of all of the templates supported by each address book provider in the profile.</span></span> 
  
<span data-ttu-id="c6942-138">如果已确定地址类型 (通过_lpEidNewEntryTpl_参数的设置或用户从一次性表格显示的选择), **NewEntry**将使用其显示表显示相应的模板。</span><span class="sxs-lookup"><span data-stu-id="c6942-138">When an address type has been determined, either through the setting of the  _lpEidNewEntryTpl_ parameter or a selection by the user from the one-off table display, **NewEntry** displays the corresponding template using its display table.</span></span> <span data-ttu-id="c6942-139">所有新的条目模板都支持**PR_DETAILS_TABLE** ([PidTagDetailsTable](pidtagdetailstable-canonical-property.md)) 属性。</span><span class="sxs-lookup"><span data-stu-id="c6942-139">All new entry templates support the **PR_DETAILS_TABLE** ([PidTagDetailsTable](pidtagdetailstable-canonical-property.md)) property.</span></span> 
  
<span data-ttu-id="c6942-140">若要让**NewEntry**返回已创建条目的条目标识符, 请为_lpcbEidNewEntry_和_lppEidNewEntry_参数传递一个有效的地址。</span><span class="sxs-lookup"><span data-stu-id="c6942-140">To have **NewEntry** return the entry identifier of the created entry, pass a valid address for the  _lpcbEidNewEntry_ and  _lppEidNewEntry_ parameters.</span></span> <span data-ttu-id="c6942-141">MAPI 将新条目标识符放在_lppEidNewEntry_所指向的地址和_lpcbEidNewEntry_指向的地址的新条目标识符的字节数。</span><span class="sxs-lookup"><span data-stu-id="c6942-141">MAPI places the new entry identifier at the address pointed to by  _lppEidNewEntry_ and the byte count of the new entry identifier at the address pointed to by  _lpcbEidNewEntry_.</span></span>
  
<span data-ttu-id="c6942-142">调用[IABContainer:: CreateEntry](iabcontainer-createentry.md)以创建收件人并将其保存到特定的通讯簿容器中。</span><span class="sxs-lookup"><span data-stu-id="c6942-142">Call [IABContainer::CreateEntry](iabcontainer-createentry.md) to create a recipient and save it into a particular address book container.</span></span> <span data-ttu-id="c6942-143">此方法只能与可修改的容器 (在其**PR_CONTAINER_FLAGS** ([PidTagContainerFlags](pidtagcontainerflags-canonical-property.md)) 属性中设置了 AB_MODIFIABLE 标志的容器) 一起使用。</span><span class="sxs-lookup"><span data-stu-id="c6942-143">You can use this method only with modifiable containers — containers that have the AB_MODIFIABLE flag set in their **PR_CONTAINER_FLAGS** ([PidTagContainerFlags](pidtagcontainerflags-canonical-property.md)) property.</span></span> <span data-ttu-id="c6942-144">具有不可更改容器的通讯簿提供程序不支持此方法。</span><span class="sxs-lookup"><span data-stu-id="c6942-144">Address book providers with nonmodifiable containers do not support this method.</span></span> <span data-ttu-id="c6942-145">指定用于在_lpEntryID_参数中创建所需类型的条目的模板的条目标识符。</span><span class="sxs-lookup"><span data-stu-id="c6942-145">Specify the entry identifier of the template for creating an entry of the desired type in the  _lpEntryID_ parameter.</span></span> 
  
<span data-ttu-id="c6942-146">在_ulCreateFlags_参数中, 指定所需的重复项检查的类型以及新条目是否应替换现有条目。</span><span class="sxs-lookup"><span data-stu-id="c6942-146">In the  _ulCreateFlags_ parameter, specify the type of duplicate entry checking required and whether or not new entries should replace existing ones.</span></span> <span data-ttu-id="c6942-147">如果**CreateEntry**由于提供程序强加的重复条目检查而无法新建对象, 则不会看到返回的错误或警告。</span><span class="sxs-lookup"><span data-stu-id="c6942-147">If **CreateEntry** fails to create a new object because of the duplicate entry checking imposed by the provider, do not expect to see an error or warning returned.</span></span> <span data-ttu-id="c6942-148">在这些情况下, 提供程序将返回成功代码。</span><span class="sxs-lookup"><span data-stu-id="c6942-148">Under these conditions, providers return a success code.</span></span> 
  
<span data-ttu-id="c6942-149">如果要直接使用容器并知道容器可以创建的地址类型, 则可以调用**IABContainer:: CreateEntry**并传递相应模板的条目标识符。</span><span class="sxs-lookup"><span data-stu-id="c6942-149">If you are working directly with a container and you know exactly the types of addresses that the container can create, you can call **IABContainer::CreateEntry** and pass the entry identifier for the appropriate template.</span></span> <span data-ttu-id="c6942-150">通讯簿提供程序设置一些初始默认属性;您可以调用**SetProps**以设置其他人。</span><span class="sxs-lookup"><span data-stu-id="c6942-150">The address book provider sets some initial default properties; you can call **SetProps** to set others.</span></span> <span data-ttu-id="c6942-151">永远不会涉及该用户。</span><span class="sxs-lookup"><span data-stu-id="c6942-151">The user is never involved.</span></span> 
  

