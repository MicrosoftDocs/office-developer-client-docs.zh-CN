---
title: 创建收件人
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 586c901f-d9f9-44f2-a328-051775a81265
description: 上次修改时间：2015 年 3 月 9 日
ms.openlocfilehash: e14430d1539b90e089a9dabe1315384050f3dd5e
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/28/2019
ms.locfileid: "33429584"
---
# <a name="creating-a-recipient"></a><span data-ttu-id="70aa8-103">创建收件人</span><span class="sxs-lookup"><span data-stu-id="70aa8-103">Creating a Recipient</span></span>

  
  
<span data-ttu-id="70aa8-104">**适用于**：Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="70aa8-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="70aa8-105">客户端在设置邮件地址以及将条目添加到可修改通讯簿容器时创建收件人。</span><span class="sxs-lookup"><span data-stu-id="70aa8-105">Clients create recipients when they are addressing messages and when they are adding entries to modifiable address book containers.</span></span> <span data-ttu-id="70aa8-106">MAPI 提供了三种创建收件人的方法：</span><span class="sxs-lookup"><span data-stu-id="70aa8-106">MAPI provides three methods for creating recipients:</span></span>
  
- [<span data-ttu-id="70aa8-107">IAddrBook::CreateOneOff</span><span class="sxs-lookup"><span data-stu-id="70aa8-107">IAddrBook::CreateOneOff</span></span>](iaddrbook-createoneoff.md)
    
- [<span data-ttu-id="70aa8-108">IAddrBook::NewEntry</span><span class="sxs-lookup"><span data-stu-id="70aa8-108">IAddrBook::NewEntry</span></span>](iaddrbook-newentry.md)
    
- [<span data-ttu-id="70aa8-109">IABContainer::CreateEntry</span><span class="sxs-lookup"><span data-stu-id="70aa8-109">IABContainer::CreateEntry</span></span>](iabcontainer-createentry.md)
    
<span data-ttu-id="70aa8-110">创建用于处理邮件的收件人时，请调用 **IAddrBook：：CreateOneOff。**</span><span class="sxs-lookup"><span data-stu-id="70aa8-110">Call **IAddrBook::CreateOneOff** when you are creating recipients to be used to address messages.</span></span> <span data-ttu-id="70aa8-111">**CreateOneOff** 创建一个特殊格式的一次输入标识符，该标识符与特定地址类型的地址相关联。</span><span class="sxs-lookup"><span data-stu-id="70aa8-111">**CreateOneOff** creates a specially formatted one-off entry identifier to be associated with an address of a particular address type.</span></span> <span data-ttu-id="70aa8-112">有关一对一条目标识符和一次输入标识符的信息，请参阅 [一](one-off-addresses.md) 次使用地址和 [一次使用条目标识符](one-off-entry-identifiers.md)。</span><span class="sxs-lookup"><span data-stu-id="70aa8-112">For more information about one-offs and one-off entry identifiers, see [One-Off Addresses](one-off-addresses.md) and [One-Off Entry Identifiers](one-off-entry-identifiers.md).</span></span>
  
<span data-ttu-id="70aa8-113">创建收件人以用于地址邮件或添加到容器时，请调用 **IAddrBook：：NewEntry。**</span><span class="sxs-lookup"><span data-stu-id="70aa8-113">Call **IAddrBook::NewEntry** when you are creating recipients to be used either to address messages or to add to a container.</span></span> <span data-ttu-id="70aa8-114">**NewEntry** 有三对包含条目标识符的参数。</span><span class="sxs-lookup"><span data-stu-id="70aa8-114">**NewEntry** has three pairs of parameters that contain entry identifiers.</span></span> <span data-ttu-id="70aa8-115">这些参数描述如下：</span><span class="sxs-lookup"><span data-stu-id="70aa8-115">These parameters are described as follows:</span></span> 
  
|<span data-ttu-id="70aa8-116">**参数对**</span><span class="sxs-lookup"><span data-stu-id="70aa8-116">**Parameter pair**</span></span>|<span data-ttu-id="70aa8-117">**说明**</span><span class="sxs-lookup"><span data-stu-id="70aa8-117">**Description**</span></span>|
|:-----|:-----|
| <span data-ttu-id="70aa8-118">_cbEidContainer_ 和  _lpEidContainer_</span><span class="sxs-lookup"><span data-stu-id="70aa8-118">_cbEidContainer_ and  _lpEidContainer_</span></span> <br/> |<span data-ttu-id="70aa8-119">新条目应放置到的容器的条目标识符。</span><span class="sxs-lookup"><span data-stu-id="70aa8-119">Entry identifier for the container into which the new entry should be placed.</span></span>  <br/> |
| <span data-ttu-id="70aa8-120">_cbEidNewEntryTpl_ 和  _lpEidNewEntryTpl_</span><span class="sxs-lookup"><span data-stu-id="70aa8-120">_cbEidNewEntryTpl_ and  _lpEidNewEntryTpl_</span></span> <br/> |<span data-ttu-id="70aa8-121">用于创建新条目的模板的条目标识符。</span><span class="sxs-lookup"><span data-stu-id="70aa8-121">Entry identifier for the template to be used to create the new entry.</span></span>  <br/> |
| <span data-ttu-id="70aa8-122">_lpcbEidNewEntry_ 和  _lppEidNewEntry_</span><span class="sxs-lookup"><span data-stu-id="70aa8-122">_lpcbEidNewEntry_ and  _lppEidNewEntry_</span></span> <br/> |<span data-ttu-id="70aa8-123">新条目的条目标识符。</span><span class="sxs-lookup"><span data-stu-id="70aa8-123">Entry identifier for the new entry.</span></span>  <br/> |
   
<span data-ttu-id="70aa8-124">若要为传出邮件创建收件人，请设置  _cbEidContainer_ 为零，将  _lpEidContainer 设置为_ NULL。</span><span class="sxs-lookup"><span data-stu-id="70aa8-124">To create a recipient for an outgoing message, set  _cbEidContainer_ to zero and  _lpEidContainer_ to NULL.</span></span> <span data-ttu-id="70aa8-125">**NewEntry** 创建一个收件人，其条目标识符符合一次发送格式，即通过调用 **IAddrBook：：CreateOneOff** 生成的相同类型的收件人。</span><span class="sxs-lookup"><span data-stu-id="70aa8-125">**NewEntry** creates a recipient with an entry identifier that conforms to the one-off format, the same type of recipient that is produced by a call to **IAddrBook::CreateOneOff**.</span></span> 
  
<span data-ttu-id="70aa8-126">若要创建要插入到特定容器中的收件人，请将  _lpEidContainer_ 设置为容器的条目标识符，将  _cbEidContainer_ 设置为容器的条目标识符中的字节数。</span><span class="sxs-lookup"><span data-stu-id="70aa8-126">To create a recipient to be inserted into a particular container, set  _lpEidContainer_ to the container's entry identifier and  _cbEidContainer_ to the number of bytes in the container's entry identifier.</span></span> 
  
<span data-ttu-id="70aa8-127">若要使用模板创建收件人，将  _lpEidNewEntryTpl_ 设置为要使用的模板的条目标识符，将  _cbEidNewEntryTpl_ 设置为此条目标识符中的字节数。</span><span class="sxs-lookup"><span data-stu-id="70aa8-127">To use a template to create a recipient, set  _lpEidNewEntryTpl_ to the entry identifier of the template to be used and  _cbEidNewEntryTpl_ to the count of bytes in this entry identifier.</span></span> <span data-ttu-id="70aa8-128">大多数可修改通讯簿容器都支持用于创建特定类型条目的一个或多个模板。</span><span class="sxs-lookup"><span data-stu-id="70aa8-128">Most modifiable address book containers support one or more templates for creating entries of a particular type.</span></span> <span data-ttu-id="70aa8-129">一次使用模板通常是（但并不总是）对话框。</span><span class="sxs-lookup"><span data-stu-id="70aa8-129">One-off templates are typically, but not always, dialog boxes.</span></span> <span data-ttu-id="70aa8-130">在模板中输入信息会生成一个收件人，该收件人的地址类型格式正确。</span><span class="sxs-lookup"><span data-stu-id="70aa8-130">Entering information into the template produces a recipient with an address that is correctly formatted for the type.</span></span> 
  
<span data-ttu-id="70aa8-131">从以下任一位置获取模板项标识符：</span><span class="sxs-lookup"><span data-stu-id="70aa8-131">Obtain the template entry identifier from either:</span></span>
  
- <span data-ttu-id="70aa8-132">容器一键式表中的 **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)) 列，该列通过调用容器的 [IMAPIProp：：OpenProperty](imapiprop-openproperty.md) 方法并指定 **PR_CREATE_TEMPLATES** ([PidTagCreateTemplates](pidtagcreatetemplates-canonical-property.md)) 作为属性标记和 IID_IMAPITable 作为接口标识符来访问。</span><span class="sxs-lookup"><span data-stu-id="70aa8-132">The **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)) column in the container's one-off table, accessed by calling the container's [IMAPIProp::OpenProperty](imapiprop-openproperty.md) method and specifying **PR_CREATE_TEMPLATES** ([PidTagCreateTemplates](pidtagcreatetemplates-canonical-property.md)) as the property tag and IID_IMAPITable as the interface identifier.</span></span> 
    
- <span data-ttu-id="70aa8-133">通讯簿提供程序的 **PR_DEF_CREATE_MAILUSER** ([PidTagDefCreateMailuser](pidtagdefcreatemailuser-canonical-property.md)) 和 **PR_DEF_CREATE_DL** ([PidTagDefCreateDl](pidtagdefcreatedl-canonical-property.md)) 属性保存提供程序的邮件用户对象和通讯组列表模板的条目标识符。</span><span class="sxs-lookup"><span data-stu-id="70aa8-133">An address book provider's **PR_DEF_CREATE_MAILUSER** ([PidTagDefCreateMailuser](pidtagdefcreatemailuser-canonical-property.md)) and **PR_DEF_CREATE_DL** ([PidTagDefCreateDl](pidtagdefcreatedl-canonical-property.md)) properties which hold the entry identifiers for the provider's messaging user object and distribution list templates.</span></span> 
    
> [!NOTE]
> <span data-ttu-id="70aa8-134">不要将新条目模板的条目标识符与名为模板标识符的不同类型的条目标识符混淆。</span><span class="sxs-lookup"><span data-stu-id="70aa8-134">Do not confuse a new entry template's entry identifier with a different type of entry identifier called a template identifier.</span></span> <span data-ttu-id="70aa8-135">模板标识符仅由提供程序用于维护从其他提供程序复制的条目;客户端从不使用，也不用于创建新条目。</span><span class="sxs-lookup"><span data-stu-id="70aa8-135">A template identifier is used only by providers to maintain entries copied from other providers; it is never used by clients and it is not used to create new entries.</span></span> 
  
<span data-ttu-id="70aa8-136">若要使用户能够确定要创建的条目的类型，请为  _cbEidNewEntryTpl_ 传递零，为  _lpEidNewEntryTpl_ 传递 NULL。</span><span class="sxs-lookup"><span data-stu-id="70aa8-136">To enable the user to determine the type of entry to be created, pass zero for  _cbEidNewEntryTpl_ and NULL for  _lpEidNewEntryTpl_.</span></span> <span data-ttu-id="70aa8-137">出现此情况时 **，NewEntry** 将显示一个从 MAPI 的一对一表构建的常见对话框— 配置文件中每个通讯簿提供程序支持的所有模板的分层列表。</span><span class="sxs-lookup"><span data-stu-id="70aa8-137">When this occurs, **NewEntry** displays a common dialog box built from MAPI's one-off table — a hierarchical list of all of the templates supported by each address book provider in the profile.</span></span> 
  
<span data-ttu-id="70aa8-138">在通过  _设置 lpEidNewEntryTpl_ 参数或用户从一次表显示选择的地址类型确定后 **，NewEntry** 会使用其显示表显示相应的模板。</span><span class="sxs-lookup"><span data-stu-id="70aa8-138">When an address type has been determined, either through the setting of the  _lpEidNewEntryTpl_ parameter or a selection by the user from the one-off table display, **NewEntry** displays the corresponding template using its display table.</span></span> <span data-ttu-id="70aa8-139">所有新条目模板都支持PR_DETAILS_TABLE ([PidTagDetailsTable](pidtagdetailstable-canonical-property.md)) 属性。</span><span class="sxs-lookup"><span data-stu-id="70aa8-139">All new entry templates support the **PR_DETAILS_TABLE** ([PidTagDetailsTable](pidtagdetailstable-canonical-property.md)) property.</span></span> 
  
<span data-ttu-id="70aa8-140">若要让 **NewEntry** 返回所创建条目的条目标识符，请传递  _lpcbEidNewEntry_ 和  _lppEidNewEntry_ 参数的有效地址。</span><span class="sxs-lookup"><span data-stu-id="70aa8-140">To have **NewEntry** return the entry identifier of the created entry, pass a valid address for the  _lpcbEidNewEntry_ and  _lppEidNewEntry_ parameters.</span></span> <span data-ttu-id="70aa8-141">MAPI 将新条目标识符位于  _lppEidNewEntry_ 指向的地址处，新条目标识符的字节计数位于  _lpcbEidNewEntry_ 指向的地址处。</span><span class="sxs-lookup"><span data-stu-id="70aa8-141">MAPI places the new entry identifier at the address pointed to by  _lppEidNewEntry_ and the byte count of the new entry identifier at the address pointed to by  _lpcbEidNewEntry_.</span></span>
  
<span data-ttu-id="70aa8-142">调用 [IABContainer：：CreateEntry](iabcontainer-createentry.md) 以创建收件人并将其保存到特定的通讯簿容器中。</span><span class="sxs-lookup"><span data-stu-id="70aa8-142">Call [IABContainer::CreateEntry](iabcontainer-createentry.md) to create a recipient and save it into a particular address book container.</span></span> <span data-ttu-id="70aa8-143">只能对可修改的容器（在 PR_CONTAINER_FLAGS ([PidTagContainerFlags](pidtagcontainerflags-canonical-property.md)属性中设置了 **AB_MODIFIABLE** 标志的容器) 使用此方法。</span><span class="sxs-lookup"><span data-stu-id="70aa8-143">You can use this method only with modifiable containers — containers that have the AB_MODIFIABLE flag set in their **PR_CONTAINER_FLAGS** ([PidTagContainerFlags](pidtagcontainerflags-canonical-property.md)) property.</span></span> <span data-ttu-id="70aa8-144">具有不可修改容器的通讯簿提供程序不支持此方法。</span><span class="sxs-lookup"><span data-stu-id="70aa8-144">Address book providers with nonmodifiable containers do not support this method.</span></span> <span data-ttu-id="70aa8-145">指定模板的条目标识符，以在  _lpEntryID_ 参数中创建所需类型的条目。</span><span class="sxs-lookup"><span data-stu-id="70aa8-145">Specify the entry identifier of the template for creating an entry of the desired type in the  _lpEntryID_ parameter.</span></span> 
  
<span data-ttu-id="70aa8-146">在  _ulCreateFlags_ 参数中，指定需要重复项检查的类型以及新条目是否应该替换现有条目。</span><span class="sxs-lookup"><span data-stu-id="70aa8-146">In the  _ulCreateFlags_ parameter, specify the type of duplicate entry checking required and whether or not new entries should replace existing ones.</span></span> <span data-ttu-id="70aa8-147">如果 **CreateEntry** 由于提供程序强制进行重复条目检查而未能创建新对象，则不要期望看到返回错误或警告。</span><span class="sxs-lookup"><span data-stu-id="70aa8-147">If **CreateEntry** fails to create a new object because of the duplicate entry checking imposed by the provider, do not expect to see an error or warning returned.</span></span> <span data-ttu-id="70aa8-148">在这些条件下，提供程序将返回成功代码。</span><span class="sxs-lookup"><span data-stu-id="70aa8-148">Under these conditions, providers return a success code.</span></span> 
  
<span data-ttu-id="70aa8-149">如果你直接使用容器并且确切知道容器可以创建的地址类型，可以调用 **IABContainer：：CreateEntry** 并传递相应模板的条目标识符。</span><span class="sxs-lookup"><span data-stu-id="70aa8-149">If you are working directly with a container and you know exactly the types of addresses that the container can create, you can call **IABContainer::CreateEntry** and pass the entry identifier for the appropriate template.</span></span> <span data-ttu-id="70aa8-150">通讯簿提供程序设置一些初始默认属性;可以调用 **SetProps** 来设置其他设置。</span><span class="sxs-lookup"><span data-stu-id="70aa8-150">The address book provider sets some initial default properties; you can call **SetProps** to set others.</span></span> <span data-ttu-id="70aa8-151">用户从不参与。</span><span class="sxs-lookup"><span data-stu-id="70aa8-151">The user is never involved.</span></span> 
  

