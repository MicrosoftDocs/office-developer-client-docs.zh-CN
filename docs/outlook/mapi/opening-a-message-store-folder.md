---
title: 打开邮件存储文件夹
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: d858e4fe-822e-4330-9ed3-4b7d22fa51dc
description: 上次修改时间：2015 年 3 月 9 日
ms.openlocfilehash: df7db013cb435484c721388abab51ab4ba43828f
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/28/2019
ms.locfileid: "33436536"
---
# <a name="opening-a-message-store-folder"></a><span data-ttu-id="2c9d2-103">打开邮件存储文件夹</span><span class="sxs-lookup"><span data-stu-id="2c9d2-103">Opening a message store folder</span></span>

<span data-ttu-id="2c9d2-104">**适用于**：Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="2c9d2-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="2c9d2-105">在可以打开任何文件夹之前, 必须提供其条目标识符。</span><span class="sxs-lookup"><span data-stu-id="2c9d2-105">Before any folder can be opened, its entry identifier must be available.</span></span> <span data-ttu-id="2c9d2-106">对于大多数文件夹, 这意味着检索其**PR_ENTRYID**属性。</span><span class="sxs-lookup"><span data-stu-id="2c9d2-106">For most folders, this means retrieving their **PR_ENTRYID** properties.</span></span> <span data-ttu-id="2c9d2-107">对于特殊文件夹 (如一些 IPM 子树文件夹和其他根文件夹), MAPI 定义了可通过调用邮件存储区的**IMAPIProp:: GetProps**方法访问的特殊条目标识符属性。</span><span class="sxs-lookup"><span data-stu-id="2c9d2-107">For special folders, such as some of the IPM subtree folders and other root folders, MAPI defines special entry identifier properties that are accessible by calling the message store's **IMAPIProp::GetProps** method.</span></span> <span data-ttu-id="2c9d2-108">这些条目标识符始终为长期, 并按如下方式命名:</span><span class="sxs-lookup"><span data-stu-id="2c9d2-108">These entry identifiers are always long-term and are named as follows:</span></span> 
  
|<span data-ttu-id="2c9d2-109">**Folder**</span><span class="sxs-lookup"><span data-stu-id="2c9d2-109">**Folder**</span></span>|<span data-ttu-id="2c9d2-110">**条目标识符属性**</span><span class="sxs-lookup"><span data-stu-id="2c9d2-110">**Entry identifier property**</span></span>|
|:-----|:-----|
|<span data-ttu-id="2c9d2-111">发件箱文件夹</span><span class="sxs-lookup"><span data-stu-id="2c9d2-111">Outbox folder</span></span>  <br/> |<span data-ttu-id="2c9d2-112">**PR_IPM_OUTBOX_ENTRYID**([PidTagIpmOutboxEntryId](pidtagipmoutboxentryid-canonical-property.md))(仅限 IPM 邮件类)</span><span class="sxs-lookup"><span data-stu-id="2c9d2-112">**PR_IPM_OUTBOX_ENTRYID** ([PidTagIpmOutboxEntryId](pidtagipmoutboxentryid-canonical-property.md)) (IPM message class only)</span></span>  <br/> |
|<span data-ttu-id="2c9d2-113">“已删除邮件”文件夹</span><span class="sxs-lookup"><span data-stu-id="2c9d2-113">Deleted Items folder</span></span>  <br/> |<span data-ttu-id="2c9d2-114">**PR_IPM_WASTEBASKET_ENTRYID**([PidTagIpmWastebasketEntryId](pidtagipmwastebasketentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="2c9d2-114">**PR_IPM_WASTEBASKET_ENTRYID** ([PidTagIpmWastebasketEntryId](pidtagipmwastebasketentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="2c9d2-115">"已发送邮件" 文件夹</span><span class="sxs-lookup"><span data-stu-id="2c9d2-115">Sent Items folder</span></span>  <br/> |<span data-ttu-id="2c9d2-116">**PR_IPM_SENTMAIL_ENTRYID**([PidTagIpmSentMailEntryId](pidtagipmsentmailentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="2c9d2-116">**PR_IPM_SENTMAIL_ENTRYID** ([PidTagIpmSentMailEntryId](pidtagipmsentmailentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="2c9d2-117">IPM 根文件夹</span><span class="sxs-lookup"><span data-stu-id="2c9d2-117">IPM root folder</span></span>  <br/> |<span data-ttu-id="2c9d2-118">**PR_IPM_SUBTREE_ENTRYID**([PidTagIpmSubtreeEntryId](pidtagipmsubtreeentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="2c9d2-118">**PR_IPM_SUBTREE_ENTRYID** ([PidTagIpmSubtreeEntryId](pidtagipmsubtreeentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="2c9d2-119">搜索结果根文件夹</span><span class="sxs-lookup"><span data-stu-id="2c9d2-119">Search-results root folder</span></span>  <br/> |<span data-ttu-id="2c9d2-120">**PR_FINDER_ENTRYID**([PidTagFinderEntryId](pidtagfinderentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="2c9d2-120">**PR_FINDER_ENTRYID** ([PidTagFinderEntryId](pidtagfinderentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="2c9d2-121">公用视图根文件夹</span><span class="sxs-lookup"><span data-stu-id="2c9d2-121">Common views root folder</span></span>  <br/> |<span data-ttu-id="2c9d2-122">**PR_COMMON_VIEWS_ENTRYID**([PidTagCommonViewsEntryId](pidtagcommonviewsentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="2c9d2-122">**PR_COMMON_VIEWS_ENTRYID** ([PidTagCommonViewsEntryId](pidtagcommonviewsentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="2c9d2-123">个人视图根文件夹</span><span class="sxs-lookup"><span data-stu-id="2c9d2-123">Personal views root folder</span></span>  <br/> |<span data-ttu-id="2c9d2-124">**PR_VIEWS_ENTRYID**([PidTagViewsEntryId](pidtagviewsentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="2c9d2-124">**PR_VIEWS_ENTRYID** ([PidTagViewsEntryId](pidtagviewsentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="2c9d2-125">联系人根文件夹</span><span class="sxs-lookup"><span data-stu-id="2c9d2-125">Contacts root folder</span></span>  <br/> |<span data-ttu-id="2c9d2-126">**PR_IPM_CONTACT_ENTRYID**([PidTagIpmContactEntryId](pidtagipmcontactentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="2c9d2-126">**PR_IPM_CONTACT_ENTRYID** ([PidTagIpmContactEntryId](pidtagipmcontactentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="2c9d2-127">草稿根文件夹</span><span class="sxs-lookup"><span data-stu-id="2c9d2-127">Drafts root folder</span></span>  <br/> |<span data-ttu-id="2c9d2-128">**PR_IPM_DRAFTS_ENTRYID**([PidTagIpmDraftsEntryId](pidtagipmdraftsentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="2c9d2-128">**PR_IPM_DRAFTS_ENTRYID** ([PidTagIpmDraftsEntryId](pidtagipmdraftsentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="2c9d2-129">日记根文件夹</span><span class="sxs-lookup"><span data-stu-id="2c9d2-129">Journal root folder</span></span>  <br/> |<span data-ttu-id="2c9d2-130">**PR_IPM_JOURNAL_ENTRYID**([PidTagIpmJournalEntryId](pidtagipmjournalentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="2c9d2-130">**PR_IPM_JOURNAL_ENTRYID** ([PidTagIpmJournalEntryId](pidtagipmjournalentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="2c9d2-131">日历根文件夹</span><span class="sxs-lookup"><span data-stu-id="2c9d2-131">Calendar root folder</span></span>  <br/> |<span data-ttu-id="2c9d2-132">**PR_IPM_APPOINTMENT_ENTRYID**([PidTagIpmAppointmentEntryId](pidtagipmappointmententryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="2c9d2-132">**PR_IPM_APPOINTMENT_ENTRYID** ([PidTagIpmAppointmentEntryId](pidtagipmappointmententryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="2c9d2-133">备注根文件夹</span><span class="sxs-lookup"><span data-stu-id="2c9d2-133">Notes root folder</span></span>  <br/> |<span data-ttu-id="2c9d2-134">**PR_IPM_NOTE_ENTRYID**([PidTagIpmNoteEntryId](pidtagipmnoteentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="2c9d2-134">**PR_IPM_NOTE_ENTRYID** ([PidTagIpmNoteEntryId](pidtagipmnoteentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="2c9d2-135">任务根文件夹</span><span class="sxs-lookup"><span data-stu-id="2c9d2-135">Tasks root folder</span></span>  <br/> |<span data-ttu-id="2c9d2-136">**PR_IPM_TASK_ENTRYID**([PidTagIpmTaskEntryId](pidtagipmtaskentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="2c9d2-136">**PR_IPM_TASK_ENTRYID** ([PidTagIpmTaskEntryId](pidtagipmtaskentryid-canonical-property.md))</span></span>  <br/> |
   
<span data-ttu-id="2c9d2-137">在尝试检索这些特殊条目标识符之一之前, 请先检索邮件存储区的**\_PR VALID_FOLDER_MASK** ([PidTagValidFolderMask](pidtagvalidfoldermask-canonical-property.md)) 属性。</span><span class="sxs-lookup"><span data-stu-id="2c9d2-137">Before you try to retrieve one of these special entry identifiers, retrieve the **PR\_VALID_FOLDER_MASK** ([PidTagValidFolderMask](pidtagvalidfoldermask-canonical-property.md)) property of the message store.</span></span> <span data-ttu-id="2c9d2-138">**PR\_VALID_FOLDER_MASK**是标识存在哪些特殊条目标识符的位掩码。</span><span class="sxs-lookup"><span data-stu-id="2c9d2-138">**PR\_VALID_FOLDER_MASK** is a bitmask that identifies which of the special entry identifiers exist.</span></span> <span data-ttu-id="2c9d2-139">每个特殊文件夹都有一个位。</span><span class="sxs-lookup"><span data-stu-id="2c9d2-139">There is one bit for each of the special folders.</span></span> <span data-ttu-id="2c9d2-140">如果设置了位, 则表明相应的文件夹受支持且具有有效的条目标识符。</span><span class="sxs-lookup"><span data-stu-id="2c9d2-140">If the bit is set, it indicates that the corresponding folder is supported and has a valid entry identifier.</span></span> <span data-ttu-id="2c9d2-141">例如, 如果 "已删除邮件" 文件夹存在且具有有效的条目标识符, 则\_将在**PR_VALID_FOLDER_MASK**中设置文件夹 IPM_WASTEBASKET_VALID 位。</span><span class="sxs-lookup"><span data-stu-id="2c9d2-141">For example, if the Deleted Items folder exists and has a valid entry identifier, the FOLDER\_IPM_WASTEBASKET_VALID bit will be set in **PR_VALID_FOLDER_MASK**.</span></span> 
  
## <a name="open-the-folder-where-all-incoming-messages-of-a-particular-class-are-placed"></a><span data-ttu-id="2c9d2-142">打开在其中放置特定类的所有传入邮件的文件夹</span><span class="sxs-lookup"><span data-stu-id="2c9d2-142">Open the folder where all incoming messages of a particular class are placed</span></span>
  
1. <span data-ttu-id="2c9d2-143">调用[IMsgStore:: GetReceiveFolder](imsgstore-getreceivefolder.md)以检索其条目标识符, 并将_lpszMessageClass_参数设置为指向标识邮件类的字符字符串。</span><span class="sxs-lookup"><span data-stu-id="2c9d2-143">Call [IMsgStore::GetReceiveFolder](imsgstore-getreceivefolder.md) to retrieve its entry identifier, setting the  _lpszMessageClass_ parameter to point to a character string identifying the message class.</span></span> <span data-ttu-id="2c9d2-144">例如, 如果要打开 ipm 子树的收件箱, 请将_lpszMessageClass_指向 ipm。</span><span class="sxs-lookup"><span data-stu-id="2c9d2-144">For example, if you want to open the Inbox for your IPM subtree, point  _lpszMessageClass_ to IPM.</span></span> <span data-ttu-id="2c9d2-145">如果要打开接收文件夹中的 IPC 消息, 请将其设置为指向 "ipc"。</span><span class="sxs-lookup"><span data-stu-id="2c9d2-145">If you want to open the receive folder for IPC messages, set it to point to IPC.</span></span> 

   <span data-ttu-id="2c9d2-146">如果邮件类别没有已注册的接收文件夹, **GetReceiveFolder**将选择其关联邮件类别与传入的邮件类别的最长可能前缀相匹配的接收文件夹。</span><span class="sxs-lookup"><span data-stu-id="2c9d2-146">If there is no registered receive folder for the message class, **GetReceiveFolder** chooses the receive folder whose associated message class matches the longest possible prefix of the message class passed in.</span></span> <span data-ttu-id="2c9d2-147">有关详细信息, 请参阅[MAPI 接收文件夹](mapi-receive-folders.md)。</span><span class="sxs-lookup"><span data-stu-id="2c9d2-147">For more information, see [MAPI Receive Folders](mapi-receive-folders.md).</span></span> 
   
   <span data-ttu-id="2c9d2-148">请注意, **PR_IPM_OUTBOX_ENTRYID**属性仅用于为 IPM 邮件打开 "发件箱" 文件夹。</span><span class="sxs-lookup"><span data-stu-id="2c9d2-148">Note that the **PR_IPM_OUTBOX_ENTRYID** property is used to open the Outbox folder only for IPM messages.</span></span> <span data-ttu-id="2c9d2-149">如果要打开 IPC 邮件的发件箱, 请改用其接收文件夹的条目标识符。</span><span class="sxs-lookup"><span data-stu-id="2c9d2-149">If you are opening the Outbox for IPC messages, use instead the entry identifier for its receive folder.</span></span> <span data-ttu-id="2c9d2-150">传入和传出的 IPC 消息都放在接收文件夹中。</span><span class="sxs-lookup"><span data-stu-id="2c9d2-150">Both incoming and outgoing IPC messages are placed in the receive folder.</span></span> 
    
2. <span data-ttu-id="2c9d2-151">调用四个**OpenEntry**方法之一以打开文件夹, 并返回可用于访问该文件夹的接口指针。</span><span class="sxs-lookup"><span data-stu-id="2c9d2-151">Call one of four **OpenEntry** methods to open the folder and return an interface pointer that you can use to access it.</span></span> <span data-ttu-id="2c9d2-152">您可以调用下列任意一种方法来打开文件夹:</span><span class="sxs-lookup"><span data-stu-id="2c9d2-152">You can call any one of the following methods to open a folder:</span></span> 
    
   - [<span data-ttu-id="2c9d2-153">IMAPISession::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="2c9d2-153">IMAPISession::OpenEntry</span></span>](imapisession-openentry.md)
    
   - [<span data-ttu-id="2c9d2-154">IMSLogon::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="2c9d2-154">IMSLogon::OpenEntry</span></span>](imslogon-openentry.md)
    
   - [<span data-ttu-id="2c9d2-155">IMsgStore::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="2c9d2-155">IMsgStore::OpenEntry</span></span>](imsgstore-openentry.md)
    
   - [<span data-ttu-id="2c9d2-156">IMAPIContainer::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="2c9d2-156">IMAPIContainer::OpenEntry</span></span>](imapicontainer-openentry.md)
    
   <span data-ttu-id="2c9d2-157">您选择的具体方法取决于要打开的文件夹以及在该时间可用的对象。</span><span class="sxs-lookup"><span data-stu-id="2c9d2-157">The specific method that you choose depends on the folder to be opened and the objects that are available at the time.</span></span> <span data-ttu-id="2c9d2-158">由于**IMAPISession**方法可以打开当前配置文件中任何邮件存储区的任何文件夹, 因此当您不知道要打开的文件夹的任何内容时, 请调用此**OpenEntry** 。</span><span class="sxs-lookup"><span data-stu-id="2c9d2-158">Because the **IMAPISession** method can open any folder for any message store in the current profile, call this **OpenEntry** when you do not know anything about the folder to be opened.</span></span> <span data-ttu-id="2c9d2-159">如果您知道哪个邮件存储区拥有该文件夹, 并且您具有指向邮件存储区的指针, 则调用**IMsgStore:: OpenEntry**。</span><span class="sxs-lookup"><span data-stu-id="2c9d2-159">If you know which message store owns the folder and you have a pointer to the message store, call **IMsgStore::OpenEntry**.</span></span> 
    
   <span data-ttu-id="2c9d2-160">例如, 使用**IMsgStore**方法打开接收文件夹。</span><span class="sxs-lookup"><span data-stu-id="2c9d2-160">For example, use the **IMsgStore** method to open a receive folder.</span></span> <span data-ttu-id="2c9d2-161">如果您有一个指向邮件存储提供程序的登录对象的指针, 则调用**IMSLogon:: OpenEntry**。</span><span class="sxs-lookup"><span data-stu-id="2c9d2-161">If you have a pointer to the message store provider's logon object, call **IMSLogon::OpenEntry**.</span></span> <span data-ttu-id="2c9d2-162">由于这些呼叫直接转到邮件存储提供程序 (而不是通过 MAPI), 因此处理速度更快。</span><span class="sxs-lookup"><span data-stu-id="2c9d2-162">Because these calls go directly to the message store provider rather than through MAPI, processing is faster.</span></span> <span data-ttu-id="2c9d2-163">如果要打开的文件夹是已打开的文件夹的子文件夹, 请调用 open 文件夹的**IMAPIContainer:: OpenEntry**方法。</span><span class="sxs-lookup"><span data-stu-id="2c9d2-163">If the folder you are opening is a subfolder of a folder that you already have open, call the open folder's **IMAPIContainer::OpenEntry** method.</span></span> <span data-ttu-id="2c9d2-164">**IMAPIContainer**方法仅打开当前打开的文件夹的子文件夹, 并且是保证使用短期输入标识符的唯一方法。</span><span class="sxs-lookup"><span data-stu-id="2c9d2-164">The **IMAPIContainer** method only opens subfolders of a currently opened folder and is the only method guaranteed to work with short-term entry identifiers.</span></span> 
    
3. <span data-ttu-id="2c9d2-165">如果您\_希望能够对要打开的文件夹进行更改, 请通过在**OpenEntry**调用中设置 mapi 最佳\_访问或 mapi\_修改标志来指定访问级别。</span><span class="sxs-lookup"><span data-stu-id="2c9d2-165">If you want to be able to make changes to the folder to be opened, specify an access level by setting either the MAPI\_BEST\_ACCESS or MAPI\_MODIFY flag in the **OpenEntry** call.</span></span> <span data-ttu-id="2c9d2-166">这些标志是邮件存储提供程序的建议, 用于在打开文件夹时授予最高级别的\_访问\_权限、mapi 最佳访问或读/写访问\_权限 (用于 mapi 修改)。</span><span class="sxs-lookup"><span data-stu-id="2c9d2-166">These flags are suggestions to the message store provider to grant the highest level of access, for MAPI\_BEST\_ACCESS, or read/write access, for MAPI\_MODIFY, when opening the folder.</span></span> 

   <span data-ttu-id="2c9d2-167">由于这些标志只是建议, 因此可能会打开文件夹, 也可能无法使用所需的访问级别打开文件夹。</span><span class="sxs-lookup"><span data-stu-id="2c9d2-167">Because these flags are only suggestions, the folder may or may not be opened with the access level you expect.</span></span> <span data-ttu-id="2c9d2-168">通过检索**PR_ACCESS** ([PidTagAccess](pidtagaccess-canonical-property.md)) 属性, 可以确定可在打开的文件夹上执行的操作的范围。</span><span class="sxs-lookup"><span data-stu-id="2c9d2-168">By retrieving the **PR_ACCESS** ([PidTagAccess](pidtagaccess-canonical-property.md)) property, you can determine the range of operations that can be performed on the open folder.</span></span> 
    
   <span data-ttu-id="2c9d2-169">但是, 由于许多邮件存储提供程序都按需计算此属性的值, 而不是将其作为 folder 属性或作为其层次结构表中的列进行支持, 因此检索它可能非常耗时。</span><span class="sxs-lookup"><span data-stu-id="2c9d2-169">However, because many message store providers calculate the value for this property on demand rather than supporting it as a folder property or as a column in their hierarchy table, retrieving it can be time-consuming.</span></span> <span data-ttu-id="2c9d2-170">另一种策略是尝试执行所需的任何操作, 并在必要时返回一个错误。</span><span class="sxs-lookup"><span data-stu-id="2c9d2-170">An alternate strategy is to attempt whatever operation you need to perform and return an error if necessary.</span></span>
    
## <a name="see-also"></a><span data-ttu-id="2c9d2-171">另请参阅</span><span class="sxs-lookup"><span data-stu-id="2c9d2-171">See also</span></span>

- [<span data-ttu-id="2c9d2-172">PidTagEntryId 规范属性</span><span class="sxs-lookup"><span data-stu-id="2c9d2-172">PidTagEntryId Canonical Property</span></span>](pidtagentryid-canonical-property.md) 
- [<span data-ttu-id="2c9d2-173">IMAPIProp::GetProps</span><span class="sxs-lookup"><span data-stu-id="2c9d2-173">IMAPIProp::GetProps</span></span>](imapiprop-getprops.md)

