---
title: 使用会话访问对象
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: ecada707-2960-41ec-be7e-619cad257c57
description: 上次修改时间：2015 年 3 月 9 日
ms.openlocfilehash: ee20e73e5bc7bb6854b956da541d3a318a267d0f
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/11/2018
ms.locfileid: "19774509"
---
# <a name="accessing-objects-by-using-the-session"></a><span data-ttu-id="d03f2-103">使用会话访问对象</span><span class="sxs-lookup"><span data-stu-id="d03f2-103">Accessing Objects by Using the Session</span></span>

  
  
<span data-ttu-id="d03f2-104">**适用于**： Outlook</span><span class="sxs-lookup"><span data-stu-id="d03f2-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="d03f2-105">您收到来自呼叫到[MAPILogonEx](mapilogonex.md)会话指针可用于访问各种对象。</span><span class="sxs-lookup"><span data-stu-id="d03f2-105">The session pointer that you receive from your call to [MAPILogonEx](mapilogonex.md) can be used to access a wide variety of objects.</span></span> <span data-ttu-id="d03f2-106">下表列出了用于访问各种对象的方法：</span><span class="sxs-lookup"><span data-stu-id="d03f2-106">The following table lists the methods that are used to access various objects:</span></span> 
  
|<span data-ttu-id="d03f2-107">**对象**</span><span class="sxs-lookup"><span data-stu-id="d03f2-107">**Object**</span></span>|<span data-ttu-id="d03f2-108">**会话方法**</span><span class="sxs-lookup"><span data-stu-id="d03f2-108">**Session method**</span></span>|
|:-----|:-----|
|<span data-ttu-id="d03f2-109">配置文件节</span><span class="sxs-lookup"><span data-stu-id="d03f2-109">Profile section</span></span>  <br/> |[<span data-ttu-id="d03f2-110">IMAPISession::OpenProfileSection</span><span class="sxs-lookup"><span data-stu-id="d03f2-110">IMAPISession::OpenProfileSection</span></span>](imapisession-openprofilesection.md) <br/> |
|<span data-ttu-id="d03f2-111">消息存储库</span><span class="sxs-lookup"><span data-stu-id="d03f2-111">Message store</span></span>  <br/> |[<span data-ttu-id="d03f2-112">IMAPISession::OpenMsgStore</span><span class="sxs-lookup"><span data-stu-id="d03f2-112">IMAPISession::OpenMsgStore</span></span>](imapisession-openmsgstore.md) <br/> |
|<span data-ttu-id="d03f2-113">通讯簿</span><span class="sxs-lookup"><span data-stu-id="d03f2-113">Address book</span></span>  <br/> |[<span data-ttu-id="d03f2-114">IMAPISession::OpenAddressBook</span><span class="sxs-lookup"><span data-stu-id="d03f2-114">IMAPISession::OpenAddressBook</span></span>](imapisession-openaddressbook.md) <br/> |
|<span data-ttu-id="d03f2-115">消息服务管理对象</span><span class="sxs-lookup"><span data-stu-id="d03f2-115">Message service administration object</span></span>  <br/> |[<span data-ttu-id="d03f2-116">IMAPISession::AdminServices</span><span class="sxs-lookup"><span data-stu-id="d03f2-116">IMAPISession::AdminServices</span></span>](imapisession-adminservices.md) <br/> |
|<span data-ttu-id="d03f2-117">文件夹、 邮件、 通讯簿容器、 通讯组列表或消息的用户</span><span class="sxs-lookup"><span data-stu-id="d03f2-117">Folder, message, address book container, distribution list, or messaging user</span></span>  <br/> |[<span data-ttu-id="d03f2-118">IMAPISession::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="d03f2-118">IMAPISession::OpenEntry</span></span>](imapisession-openentry.md) <br/> |
   
<span data-ttu-id="d03f2-119">使用**OpenEntry**方法和有效项标识符，您可以打开任何通讯簿或消息存储提供程序对象。</span><span class="sxs-lookup"><span data-stu-id="d03f2-119">With the **OpenEntry** method and a valid entry identifier, you can open any address book or message store provider object.</span></span> <span data-ttu-id="d03f2-120">还有其他**OpenEntry**方法中 MAPI，除了**IMAPISession**方法。</span><span class="sxs-lookup"><span data-stu-id="d03f2-120">There are other **OpenEntry** methods in MAPI, in addition to the **IMAPISession** method.</span></span> <span data-ttu-id="d03f2-121">在下列对象中实现**OpenEntry** :</span><span class="sxs-lookup"><span data-stu-id="d03f2-121">**OpenEntry** is implemented in the following objects:</span></span> 
  
|<span data-ttu-id="d03f2-122">**对象**</span><span class="sxs-lookup"><span data-stu-id="d03f2-122">**Object**</span></span>|<span data-ttu-id="d03f2-123">**方法**</span><span class="sxs-lookup"><span data-stu-id="d03f2-123">**Method**</span></span>|
|:-----|:-----|
|<span data-ttu-id="d03f2-124">通讯簿提供程序的登录对象</span><span class="sxs-lookup"><span data-stu-id="d03f2-124">Address book provider's logon object</span></span>  <br/> |[<span data-ttu-id="d03f2-125">IABLogon::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="d03f2-125">IABLogon::OpenEntry</span></span>](iablogon-openentry.md) <br/> |
|<span data-ttu-id="d03f2-126">通讯簿</span><span class="sxs-lookup"><span data-stu-id="d03f2-126">Address book</span></span>  <br/> |[<span data-ttu-id="d03f2-127">IAddrBook::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="d03f2-127">IAddrBook::OpenEntry</span></span>](iaddrbook-openentry.md) <br/> |
|<span data-ttu-id="d03f2-128">通讯簿容器</span><span class="sxs-lookup"><span data-stu-id="d03f2-128">Address book container</span></span>  <br/> |[<span data-ttu-id="d03f2-129">IMAPIContainer::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="d03f2-129">IMAPIContainer::OpenEntry</span></span>](imapicontainer-openentry.md) <br/> |
|<span data-ttu-id="d03f2-130">会话</span><span class="sxs-lookup"><span data-stu-id="d03f2-130">Session</span></span>  <br/> |[<span data-ttu-id="d03f2-131">IMAPISession::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="d03f2-131">IMAPISession::OpenEntry</span></span>](imapisession-openentry.md) <br/> |
|<span data-ttu-id="d03f2-132">消息存储库</span><span class="sxs-lookup"><span data-stu-id="d03f2-132">Message store</span></span>  <br/> |[<span data-ttu-id="d03f2-133">IMsgStore::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="d03f2-133">IMsgStore::OpenEntry</span></span>](imsgstore-openentry.md) <br/> |
|<span data-ttu-id="d03f2-134">消息存储提供程序的登录对象</span><span class="sxs-lookup"><span data-stu-id="d03f2-134">Message store provider's logon object</span></span>  <br/> |[<span data-ttu-id="d03f2-135">IMSLogon::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="d03f2-135">IMSLogon::OpenEntry</span></span>](imslogon-openentry.md) <br/> |
|<span data-ttu-id="d03f2-136">Folder</span><span class="sxs-lookup"><span data-stu-id="d03f2-136">Folder</span></span>  <br/> |[<span data-ttu-id="d03f2-137">IMAPIContainer::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="d03f2-137">IMAPIContainer::OpenEntry</span></span>](imapicontainer-openentry.md) <br/> |
|<span data-ttu-id="d03f2-138">支持对象</span><span class="sxs-lookup"><span data-stu-id="d03f2-138">Support object</span></span>  <br/> |[<span data-ttu-id="d03f2-139">IMAPISupport::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="d03f2-139">IMAPISupport::OpenEntry</span></span>](imapisupport-openentry.md) <br/> |
   
<span data-ttu-id="d03f2-140">某些**OpenEntry**方法要求要在打开的对象的项标识符，一样**IMAPISession::OpenEntry**;其他方法允许 null 值指定。</span><span class="sxs-lookup"><span data-stu-id="d03f2-140">Some **OpenEntry** methods require an entry identifier of the object to be opened, as does **IMAPISession::OpenEntry**; other methods allow NULL to be specified.</span></span> <span data-ttu-id="d03f2-141">NULL 条目标识符被解释不同，具体取决于该对象。</span><span class="sxs-lookup"><span data-stu-id="d03f2-141">A NULL entry identifier is interpreted differently depending on the object.</span></span> <span data-ttu-id="d03f2-142">例如，当调用**IAddrBook::OpenEntry**具有 NULL 条目标识符时，MAPI 打开通讯簿根容器。</span><span class="sxs-lookup"><span data-stu-id="d03f2-142">For example, when you call **IAddrBook::OpenEntry** with a NULL entry identifier, MAPI opens the root container of the address book.</span></span> <span data-ttu-id="d03f2-143">消息存储库的**OpenEntry**方法的行为类似;打开的邮件存储区的根文件夹。</span><span class="sxs-lookup"><span data-stu-id="d03f2-143">The message store's **OpenEntry** method behaves similarly; it opens the root folder of the message store.</span></span> <span data-ttu-id="d03f2-144">**IMAPIContainer::OpenEntry**，由文件夹和通讯簿容器实现可能返回 MAPI_E_INVALID_PARAMETER 或根容器，具体取决于实施。</span><span class="sxs-lookup"><span data-stu-id="d03f2-144">**IMAPIContainer::OpenEntry**, implemented by both folders and address book containers, might return MAPI_E_INVALID_PARAMETER or the root container, depending on the implementer.</span></span> 
  
<span data-ttu-id="d03f2-145">不允许 NULL 值的项标识符，除了会话的**OpenEntry**方法从其他**OpenEntry**方法不同，因为其作业是不打开对象。</span><span class="sxs-lookup"><span data-stu-id="d03f2-145">In addition to disallowing a NULL value for the entry identifier, the session's **OpenEntry** method differs from other **OpenEntry** methods because its job is not to open objects.</span></span> <span data-ttu-id="d03f2-146">相反，它探讨的项标识符，并将转发对实现适当的服务提供商的另一个**OpenEntry**方法的调用。</span><span class="sxs-lookup"><span data-stu-id="d03f2-146">Instead, it examines the entry identifier and forwards the call to another **OpenEntry** method implemented by the appropriate service provider.</span></span> <span data-ttu-id="d03f2-147">例如，如果具有一条消息的项标识符调用**IMAPISession::OpenEntry** ，MAPI 调用的**IMSLogon::OpenEntry**方法的消息存储负责邮件。</span><span class="sxs-lookup"><span data-stu-id="d03f2-147">For example, if you call **IMAPISession::OpenEntry** with the entry identifier of a message, MAPI calls the **IMSLogon::OpenEntry** method of the message store responsible for the message.</span></span> 
  
<span data-ttu-id="d03f2-148">除了使用会话打开对象时，客户端使用它对它们进行比较。</span><span class="sxs-lookup"><span data-stu-id="d03f2-148">In addition to using the session to open objects, clients use it to compare them.</span></span> <span data-ttu-id="d03f2-149">[IMAPISession::CompareEntryIDs](imapisession-compareentryids.md)方法通过比较其条目标识符比较对象。</span><span class="sxs-lookup"><span data-stu-id="d03f2-149">The [IMAPISession::CompareEntryIDs](imapisession-compareentryids.md) method compares objects by comparing their entry identifiers.</span></span> <span data-ttu-id="d03f2-150">如果包含的项标识符的[MAPIUID](mapiuid.md)结构属于同一服务提供商，MAPI 转发到该提供程序的调用。</span><span class="sxs-lookup"><span data-stu-id="d03f2-150">If the [MAPIUID](mapiuid.md) structures contained within the entry identifiers belong to the same service provider, MAPI forwards the call to that provider.</span></span> <span data-ttu-id="d03f2-151">两个条目标识符不匹配时， **CompareEntryIDs**将返回错误值。</span><span class="sxs-lookup"><span data-stu-id="d03f2-151">**CompareEntryIDs** returns an error value when the two entry identifiers do not match.</span></span> <span data-ttu-id="d03f2-152">尽管此方法可以将条目标识符属于任何类型的对象进行比较， **CompareEntryIDs**最适用于邮件存储通讯簿容器等更高级的对象。</span><span class="sxs-lookup"><span data-stu-id="d03f2-152">Although this method can compare entry identifiers that belong to any type of object, **CompareEntryIDs** works best for higher level objects such as message stores and address book containers.</span></span> <span data-ttu-id="d03f2-153">要比较较低级别的对象，直接比较对象的搜索键 (**PR_SEARCH_KEY** ([PidTagSearchKey](pidtagsearchkey-canonical-property.md))) 或记录键 (**PR_RECORD_KEY** ([PidTagRecordKey](pidtagrecordkey-canonical-property.md)))。</span><span class="sxs-lookup"><span data-stu-id="d03f2-153">To compare lower level objects, compare directly the objects' search keys (**PR_SEARCH_KEY** ([PidTagSearchKey](pidtagsearchkey-canonical-property.md))) or record keys (**PR_RECORD_KEY** ([PidTagRecordKey](pidtagrecordkey-canonical-property.md))).</span></span> 
  
<span data-ttu-id="d03f2-154">**OpenEntry**，如**CompareEntryIDs**由多个对象实现。</span><span class="sxs-lookup"><span data-stu-id="d03f2-154">Like **OpenEntry**, **CompareEntryIDs** is implemented by multiple objects.</span></span> <span data-ttu-id="d03f2-155">选择使用有关的对象必须信息量根据要打开或比较哪种**OpenEntry**和**CompareEntryID**方法。</span><span class="sxs-lookup"><span data-stu-id="d03f2-155">Choose which **OpenEntry** and **CompareEntryID** method to use according to the amount of information that you have about the object or objects to be opened or compared.</span></span> <span data-ttu-id="d03f2-156">决定要调用的接口方法时，请使用以下准则：</span><span class="sxs-lookup"><span data-stu-id="d03f2-156">Use the following guidelines when deciding which interface method to call:</span></span> 
  
- <span data-ttu-id="d03f2-157">如果您没有任何信息有关的目标对象，调用[IMAPISession::OpenEntry](imapisession-openentry.md)或[IMAPISession::CompareEntryIDs](imapisession-compareentryids.md)。</span><span class="sxs-lookup"><span data-stu-id="d03f2-157">If you have no information about the target objects, call [IMAPISession::OpenEntry](imapisession-openentry.md) or [IMAPISession::CompareEntryIDs](imapisession-compareentryids.md).</span></span> <span data-ttu-id="d03f2-158">此方法允许访问任何对象，但最慢的三个。</span><span class="sxs-lookup"><span data-stu-id="d03f2-158">This approach enables access to any object, but is the slowest of the three.</span></span>
    
- <span data-ttu-id="d03f2-159">如果您知道目标对象的通讯簿条目而不是，例如，文件夹，调用[IAddrBook::OpenEntry](iaddrbook-openentry.md)或[IAddrBook::CompareEntryIDs](iaddrbook-compareentryids.md)方法。</span><span class="sxs-lookup"><span data-stu-id="d03f2-159">If you know that the target objects are address book entries rather than, for example, folders, call the [IAddrBook::OpenEntry](iaddrbook-openentry.md) or [IAddrBook::CompareEntryIDs](iaddrbook-compareentryids.md) method.</span></span> <span data-ttu-id="d03f2-160">**IAddrBook::OpenEntry** NULL 指定为目标对象时打开通讯簿根的容器。</span><span class="sxs-lookup"><span data-stu-id="d03f2-160">**IAddrBook::OpenEntry** opens the root container of the address book when NULL is specified as the target object.</span></span> <span data-ttu-id="d03f2-161">此方法使任意地址簿对象的访问权，并且比使用**IMAPISession**，但比使用**IMAPIContainer**慢。</span><span class="sxs-lookup"><span data-stu-id="d03f2-161">This approach enables access to any address book object and is faster than using **IMAPISession**, but slower than using **IMAPIContainer**.</span></span>
    
- <span data-ttu-id="d03f2-162">如果正在使用的项标识符是短期条目标识符，或者如果您知道目标对象属于某个特定的通讯簿容器或文件夹，调用[IMAPIContainer::OpenEntry](imapicontainer-openentry.md)方法。</span><span class="sxs-lookup"><span data-stu-id="d03f2-162">If the entry identifier being used is a short-term entry identifier or if you know that the target objects belong to a particular address book container or folder, call the [IMAPIContainer::OpenEntry](imapicontainer-openentry.md) method.</span></span> <span data-ttu-id="d03f2-163">此方法生成的最快的性能，但允许仅对特定的容器或文件夹中的对象的访问。</span><span class="sxs-lookup"><span data-stu-id="d03f2-163">This approach yields the fastest performance, but enables access only to objects in a specific container or folder.</span></span> 
    

