---
title: 显示表
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: c314ff6d-3e60-4b81-87ac-6ca6753ff633
description: 上次修改时间：2015 年 3 月 9 日
ms.openlocfilehash: 1b94b0ea69237be3675e1ea02fc3e2bfac337025
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/28/2019
ms.locfileid: "33406218"
---
# <a name="display-tables"></a><span data-ttu-id="8acc6-103">显示表</span><span class="sxs-lookup"><span data-stu-id="8acc6-103">Display Tables</span></span>

  
  
<span data-ttu-id="8acc6-104">**适用于**：Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="8acc6-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="8acc6-105">显示表介绍如何显示特定类型的对话框, 其中一个或多个选项卡式属性页专用于显示且可能编辑一个或多个属性。</span><span class="sxs-lookup"><span data-stu-id="8acc6-105">A display table describes how to show a specific type of dialog box — one having one or more tabbed property pages dedicated to displaying and possibly editing one or more properties.</span></span> <span data-ttu-id="8acc6-106">与每个显示表相关的是[IMAPIProp: IUnknown](imapipropiunknown.md)接口实现。</span><span class="sxs-lookup"><span data-stu-id="8acc6-106">Associated with every display table is an [IMAPIProp : IUnknown](imapipropiunknown.md) interface implementation.</span></span> <span data-ttu-id="8acc6-107">**IMAPIProp**实现维护对话框中显示的属性数据。</span><span class="sxs-lookup"><span data-stu-id="8acc6-107">The **IMAPIProp** implementation maintains the property data that is presented in the dialog box.</span></span> 
  
<span data-ttu-id="8acc6-108">显示表中的行表示在对话框中显示的控件或用户界面对象。</span><span class="sxs-lookup"><span data-stu-id="8acc6-108">The rows in a display table represent the controls, or user interface objects, that are displayed in the dialog box.</span></span> <span data-ttu-id="8acc6-109">MAPI 定义了许多类型的控件, 有些控件使用静态值, 而有些则是用户可以更改的动态值。</span><span class="sxs-lookup"><span data-stu-id="8acc6-109">MAPI defines many types of controls, some with static values and some with dynamic values that a user can change.</span></span> <span data-ttu-id="8acc6-110">大多数控件都可以与**IMAPIProp**实现所维护的属性相关联。</span><span class="sxs-lookup"><span data-stu-id="8acc6-110">Most controls can be associated with properties maintained with the **IMAPIProp** implementation.</span></span> <span data-ttu-id="8acc6-111">当用户更改了可修改控件的值时, 相应的属性也会更新。</span><span class="sxs-lookup"><span data-stu-id="8acc6-111">When a user changes the value of a modifiable control, the corresponding property is updated.</span></span> 
  
<span data-ttu-id="8acc6-112">服务提供程序实现显示表和**IMAPIProp**接口。</span><span class="sxs-lookup"><span data-stu-id="8acc6-112">Service providers implement display tables and the **IMAPIProp** interface.</span></span> <span data-ttu-id="8acc6-113">创建显示表类似于编写带有脚本语言的程序。</span><span class="sxs-lookup"><span data-stu-id="8acc6-113">Creating a display table is similar to writing a program with a scripting language.</span></span> <span data-ttu-id="8acc6-114">服务提供商可以通过以下方式创建显示表:</span><span class="sxs-lookup"><span data-stu-id="8acc6-114">Service providers can create a display table by:</span></span> 
  
- <span data-ttu-id="8acc6-115">调用[BuildDisplayTable](builddisplaytable.md)函数。</span><span class="sxs-lookup"><span data-stu-id="8acc6-115">Calling the [BuildDisplayTable](builddisplaytable.md) function.</span></span> 
    
    - <span data-ttu-id="8acc6-116">和</span><span class="sxs-lookup"><span data-stu-id="8acc6-116">Or -</span></span>
    
- <span data-ttu-id="8acc6-117">包括支持[ITableData: IUnknown](itabledataiunknown.md)接口的对象, 用于直接使用表数据对象填充显示表的自定义代码。</span><span class="sxs-lookup"><span data-stu-id="8acc6-117">Including custom code that populates the display table directly using a table data object — an object that supports the [ITableData : IUnknown](itabledataiunknown.md) interface.</span></span> 
    
<span data-ttu-id="8acc6-118">**BuildDisplayTable**函数将显示表结构中的信息与对话框资源中的可视元素组合在一起, 以生成显示表行。</span><span class="sxs-lookup"><span data-stu-id="8acc6-118">The **BuildDisplayTable** function combines information from display table structures with visual elements from a dialog box resource to build display table rows.</span></span> <span data-ttu-id="8acc6-119">函数返回指向[IMAPITable: IUnknown](imapitableiunknown.md)接口实现的指针, 如果请求, 则返回指向**ITableData**接口实现的指针。</span><span class="sxs-lookup"><span data-stu-id="8acc6-119">The function returns a pointer to an [IMAPITable : IUnknown](imapitableiunknown.md) interface implementation, and, if requested, a pointer to an **ITableData** interface implementation.</span></span> 
  
<span data-ttu-id="8acc6-120">使用**BuildDisplayTable**创建显示表非常简单, 并且在显示可视元素时便于维护。</span><span class="sxs-lookup"><span data-stu-id="8acc6-120">Using **BuildDisplayTable** to create a display table is straightforward and makes maintenance easier when visual elements of the display change.</span></span> <span data-ttu-id="8acc6-121">但是, 不愿使用**BuildDisplayTable**的服务提供程序可以使用自定义代码创建显示表, 该自定义代码使用**ITableData**的方法。</span><span class="sxs-lookup"><span data-stu-id="8acc6-121">However, service providers that prefer not to use **BuildDisplayTable** can create a display table with custom code that uses the methods of **ITableData**.</span></span> <span data-ttu-id="8acc6-122">例如, 具有其属性页的现有模板结构的服务提供商可能想要创建自定义代码, 而不是使用**BuildDisplayTable**。</span><span class="sxs-lookup"><span data-stu-id="8acc6-122">For example, service providers that have an existing template structure for their property pages might want to create custom code rather than use **BuildDisplayTable**.</span></span>
  
<span data-ttu-id="8acc6-123">服务提供程序可以通过多种方式为其显示表实现属性接口。</span><span class="sxs-lookup"><span data-stu-id="8acc6-123">There are a variety of ways service providers can implement the property interface for their display table.</span></span> <span data-ttu-id="8acc6-124">具体包括：</span><span class="sxs-lookup"><span data-stu-id="8acc6-124">These include:</span></span>
  
- <span data-ttu-id="8acc6-125">提供标准的[IMAPIProp: IUnknown](imapipropiunknown.md)实现。</span><span class="sxs-lookup"><span data-stu-id="8acc6-125">Supplying a standard [IMAPIProp : IUnknown](imapipropiunknown.md) implementation.</span></span> 
    
- <span data-ttu-id="8acc6-126">提供包装的**IMAPIProp**实现, 其中包括在进行标准调用之前进行的特殊处理。</span><span class="sxs-lookup"><span data-stu-id="8acc6-126">Supplying a wrapped **IMAPIProp** implementation that includes special processing before making the standard calls.</span></span> 
    
- <span data-ttu-id="8acc6-127">提供[IPropData: IMAPIProp](ipropdataimapiprop.md)实现。</span><span class="sxs-lookup"><span data-stu-id="8acc6-127">Supplying an [IPropData : IMAPIProp](ipropdataimapiprop.md) implementation.</span></span> 
    
<span data-ttu-id="8acc6-128">实现类型取决于要显示的数据的特征和负责的服务提供商。</span><span class="sxs-lookup"><span data-stu-id="8acc6-128">The type of implementation depends on the characteristics of the data to be displayed and the responsible service provider.</span></span> <span data-ttu-id="8acc6-129">例如, 如果两个编辑控件中的数据之间存在隐式关系, 其中一个控件发生了更改, 则**IMAPIProp**实现必须相应地更改另一个控件的值。</span><span class="sxs-lookup"><span data-stu-id="8acc6-129">For example, if there is an implicit relationship between the data in two edit controls and one of the controls changes, the **IMAPIProp** implementation must change the value of the other control appropriately.</span></span> 
  
<span data-ttu-id="8acc6-130">显示表在其必需的列集中具有以下属性:</span><span class="sxs-lookup"><span data-stu-id="8acc6-130">Display tables have the following properties in their required column set:</span></span>
  
|||
|:-----|:-----|
|<span data-ttu-id="8acc6-131">**PR_XPOS**([PidTagXCoordinate](pidtagxcoordinate-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="8acc6-131">**PR_XPOS** ([PidTagXCoordinate](pidtagxcoordinate-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="8acc6-132">**PR_YPOS**([PidTagYCoordinate](pidtagycoordinate-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="8acc6-132">**PR_YPOS** ([PidTagYCoordinate](pidtagycoordinate-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="8acc6-133">**PR_DELTAX**([PidTagDeltaX](pidtagdeltax-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="8acc6-133">**PR_DELTAX** ([PidTagDeltaX](pidtagdeltax-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="8acc6-134">**PR_DELTAY**([PidTagDeltaY](pidtagdeltay-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="8acc6-134">**PR_DELTAY** ([PidTagDeltaY](pidtagdeltay-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="8acc6-135">**PR_CONTROL_TYPE**([PidTagControlType](pidtagcontroltype-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="8acc6-135">**PR_CONTROL_TYPE** ([PidTagControlType](pidtagcontroltype-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="8acc6-136">**PR_CONTROL_FLAGS**([PidTagControlFlags](pidtagcontrolflags-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="8acc6-136">**PR_CONTROL_FLAGS** ([PidTagControlFlags](pidtagcontrolflags-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="8acc6-137">**PR_CONTROL_STRUCTURE**([PidTagControlStructure](pidtagcontrolstructure-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="8acc6-137">**PR_CONTROL_STRUCTURE** ([PidTagControlStructure](pidtagcontrolstructure-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="8acc6-138">**PR_CONTROL_ID**([PidTagControlId](pidtagcontrolid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="8acc6-138">**PR_CONTROL_ID** ([PidTagControlId](pidtagcontrolid-canonical-property.md))</span></span>  <br/> |
   
 <span data-ttu-id="8acc6-139">**PR_XPOS**和**PR_YPOS**指定控件左上角的 X 和 Y 坐标。</span><span class="sxs-lookup"><span data-stu-id="8acc6-139">**PR_XPOS** and **PR_YPOS** specify the X and Y coordinates of the upper left corner of the control.</span></span> <span data-ttu-id="8acc6-140">水平单位为对话框基本宽度单位的 1/4;垂直单位为对话框基本高度单位的1/8。</span><span class="sxs-lookup"><span data-stu-id="8acc6-140">The horizontal units are 1/4 of the dialog base width unit; the vertical units are 1/8 of the dialog base height unit.</span></span> <span data-ttu-id="8acc6-141">Windows 将根据当前系统字体的高度和宽度计算当前的对话框基本单位。</span><span class="sxs-lookup"><span data-stu-id="8acc6-141">Windows computes the current dialog base units from the height and width of the current system font.</span></span> <span data-ttu-id="8acc6-142">坐标相对于属性页区域的原点。</span><span class="sxs-lookup"><span data-stu-id="8acc6-142">The coordinates are relative to the origin of the property page area.</span></span> <span data-ttu-id="8acc6-143">属性页的大小限制为约 200 x 180 个对话框单元。</span><span class="sxs-lookup"><span data-stu-id="8acc6-143">The size of property pages is limited to approximately 200 by 180 dialog units.</span></span> 
  
 <span data-ttu-id="8acc6-144">**PR_DELTAX**和**PR_DELTAY**是控件的宽度和高度。</span><span class="sxs-lookup"><span data-stu-id="8acc6-144">**PR_DELTAX** and **PR_DELTAY** are the width and height of the control.</span></span> <span data-ttu-id="8acc6-145">这些值是 ULONG 值。</span><span class="sxs-lookup"><span data-stu-id="8acc6-145">These are ULONG values.</span></span> <span data-ttu-id="8acc6-146">宽度单位为对话框基本宽度单位的 1/4;高度单位为对话框基本高度单位的1/8。</span><span class="sxs-lookup"><span data-stu-id="8acc6-146">The width units are 1/4 of the dialog base width unit; the height units are 1/8 of the dialog base height unit.</span></span> <span data-ttu-id="8acc6-147">坐标相对于控件的原点。</span><span class="sxs-lookup"><span data-stu-id="8acc6-147">The coordinates are relative to the origin of the control.</span></span> 
  
<span data-ttu-id="8acc6-148">其他四个属性描述控件的各种特征。</span><span class="sxs-lookup"><span data-stu-id="8acc6-148">The other four properties describe various characteristics of the control.</span></span> <span data-ttu-id="8acc6-149">**PR_CONTROL_TYPE**指示控件的类型。</span><span class="sxs-lookup"><span data-stu-id="8acc6-149">**PR_CONTROL_TYPE** indicates the type of control.</span></span> <span data-ttu-id="8acc6-150">MAPI 定义了十二种类型的控件, 每种类型都有一组不同的属性。</span><span class="sxs-lookup"><span data-stu-id="8acc6-150">MAPI defines twelve types of controls, each with a different set of attributes.</span></span> <span data-ttu-id="8acc6-151">这些属性在 flags 属性**PR_CONTROL_FLAGS**中进行了说明。</span><span class="sxs-lookup"><span data-stu-id="8acc6-151">These attributes are described in the flags property, **PR_CONTROL_FLAGS**.</span></span> <span data-ttu-id="8acc6-152">属性的示例包括控件是否可编辑或是否必需。</span><span class="sxs-lookup"><span data-stu-id="8acc6-152">Examples of attributes include whether or not a control is editable or required.</span></span> 
  
<span data-ttu-id="8acc6-153">控制结构**PR_CONTROL_STRUCTURE**包含与特定类型的控件相关的信息。</span><span class="sxs-lookup"><span data-stu-id="8acc6-153">The control structure, **PR_CONTROL_STRUCTURE**, contains information relevant to the particular type of control.</span></span> <span data-ttu-id="8acc6-154">每种类型的控件都以不同的结构进行描述。</span><span class="sxs-lookup"><span data-stu-id="8acc6-154">Each type of control is described with a different structure.</span></span> <span data-ttu-id="8acc6-155">例如, 使用[DTBLEDIT](dtbledit.md)结构对编辑控件进行了描述。</span><span class="sxs-lookup"><span data-stu-id="8acc6-155">For example, edit controls are described with the [DTBLEDIT](dtbledit.md) structure.</span></span> <span data-ttu-id="8acc6-156">**DTBLEDIT**结构包含的成员列出可以在控件上放置的特定类型的字符数以及用于标识其值将在控件中显示的属性的属性标记。</span><span class="sxs-lookup"><span data-stu-id="8acc6-156">**DTBLEDIT** structures contain members that list the number of and specific types of characters that can be placed on the control and a property tag that identifies the property whose value is to be displayed in the control.</span></span> <span data-ttu-id="8acc6-157">**PR_CONTROL_STRUCTURE**存储为二进制属性。</span><span class="sxs-lookup"><span data-stu-id="8acc6-157">**PR_CONTROL_STRUCTURE** is stored as a binary property.</span></span> 
  
<span data-ttu-id="8acc6-158">控件标识符 ( **PR_CONTROL_ID**) 唯一标识显示表所描述的对话框中的控件。</span><span class="sxs-lookup"><span data-stu-id="8acc6-158">The control identifier, **PR_CONTROL_ID**, uniquely identifies the control in the dialog box described by the display table.</span></span> <span data-ttu-id="8acc6-159">**PR_CONTROL_ID**是从[DTCTL](dtctl.md)结构的*lpbNotif*和*cbNotif*成员中的值设置的, 由**BuildDisplayTable**用来创建显示表的值。</span><span class="sxs-lookup"><span data-stu-id="8acc6-159">**PR_CONTROL_ID** is set from the values placed in the  *lpbNotif*  and  *cbNotif*  members of the [DTCTL](dtctl.md) structure that is used by **BuildDisplayTable** to create the display table.</span></span> <span data-ttu-id="8acc6-160">由于 MAPI 有时会组合显示表, 因此**PR_CONTROL_ID**中的标识符应始终是唯一的。</span><span class="sxs-lookup"><span data-stu-id="8acc6-160">Because MAPI sometimes combines display tables, the identifier in **PR_CONTROL_ID** should always be unique.</span></span> <span data-ttu-id="8acc6-161">通常, 提供程序将[GUID](guid.md)结构分配给**PR_CONTROL_ID** , 以确保其唯一性。</span><span class="sxs-lookup"><span data-stu-id="8acc6-161">Typically, providers assign a [GUID](guid.md) structure to **PR_CONTROL_ID** to ensure its uniqueness.</span></span> <span data-ttu-id="8acc6-162">当生成显示表通知时, **PR_CONTROL_ID**属性包含在[TABLE_NOTIFICATION](table_notification.md)结构中。</span><span class="sxs-lookup"><span data-stu-id="8acc6-162">The **PR_CONTROL_ID** property is included in the [TABLE_NOTIFICATION](table_notification.md) structure when a display table notification is generated.</span></span> 
  
<span data-ttu-id="8acc6-163">有关显示表的详细信息, 请参阅[显示表实现](display-table-implementation.md)和[关于显示表通知](about-display-table-notifications.md)。</span><span class="sxs-lookup"><span data-stu-id="8acc6-163">For more information about display tables, see [Display Table Implementation](display-table-implementation.md) and [About Display Table Notifications](about-display-table-notifications.md).</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="8acc6-164">另请参阅</span><span class="sxs-lookup"><span data-stu-id="8acc6-164">See also</span></span>



[<span data-ttu-id="8acc6-165">MAPI 表</span><span class="sxs-lookup"><span data-stu-id="8acc6-165">MAPI Tables</span></span>](mapi-tables.md)

