---
title: 显示表
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: c314ff6d-3e60-4b81-87ac-6ca6753ff633
description: 上次修改时间：2015 年 3 月 9 日
ms.openlocfilehash: 1b94b0ea69237be3675e1ea02fc3e2bfac337025
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/28/2019
ms.locfileid: "33406218"
---
# <a name="display-tables"></a><span data-ttu-id="09c38-103">显示表</span><span class="sxs-lookup"><span data-stu-id="09c38-103">Display Tables</span></span>

  
  
<span data-ttu-id="09c38-104">**适用于**：Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="09c38-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="09c38-105">显示表描述如何显示特定类型的对话框，即具有一个或多个专用于显示并可能编辑一个或多个属性的选项卡式属性页的对话框。</span><span class="sxs-lookup"><span data-stu-id="09c38-105">A display table describes how to show a specific type of dialog box — one having one or more tabbed property pages dedicated to displaying and possibly editing one or more properties.</span></span> <span data-ttu-id="09c38-106">与每个显示表相关联的是 [IMAPIProp ： IUnknown](imapipropiunknown.md) 接口实现。</span><span class="sxs-lookup"><span data-stu-id="09c38-106">Associated with every display table is an [IMAPIProp : IUnknown](imapipropiunknown.md) interface implementation.</span></span> <span data-ttu-id="09c38-107">**IMAPIProp** 实现维护对话框中显示的属性数据。</span><span class="sxs-lookup"><span data-stu-id="09c38-107">The **IMAPIProp** implementation maintains the property data that is presented in the dialog box.</span></span> 
  
<span data-ttu-id="09c38-108">显示表中的行代表对话框中显示的控件或用户界面对象。</span><span class="sxs-lookup"><span data-stu-id="09c38-108">The rows in a display table represent the controls, or user interface objects, that are displayed in the dialog box.</span></span> <span data-ttu-id="09c38-109">MAPI 定义许多类型的控件，一些控件具有静态值，有些控件具有用户可更改的动态值。</span><span class="sxs-lookup"><span data-stu-id="09c38-109">MAPI defines many types of controls, some with static values and some with dynamic values that a user can change.</span></span> <span data-ttu-id="09c38-110">大多数控件都可以与使用 **IMAPIProp** 实现维护的属性相关联。</span><span class="sxs-lookup"><span data-stu-id="09c38-110">Most controls can be associated with properties maintained with the **IMAPIProp** implementation.</span></span> <span data-ttu-id="09c38-111">当用户更改可修改控件的值时，将更新相应的属性。</span><span class="sxs-lookup"><span data-stu-id="09c38-111">When a user changes the value of a modifiable control, the corresponding property is updated.</span></span> 
  
<span data-ttu-id="09c38-112">服务提供程序实现显示表和 **IMAPIProp** 接口。</span><span class="sxs-lookup"><span data-stu-id="09c38-112">Service providers implement display tables and the **IMAPIProp** interface.</span></span> <span data-ttu-id="09c38-113">创建显示表类似于使用脚本语言编写程序。</span><span class="sxs-lookup"><span data-stu-id="09c38-113">Creating a display table is similar to writing a program with a scripting language.</span></span> <span data-ttu-id="09c38-114">服务提供程序可以通过：</span><span class="sxs-lookup"><span data-stu-id="09c38-114">Service providers can create a display table by:</span></span> 
  
- <span data-ttu-id="09c38-115">调用 [BuildDisplayTable](builddisplaytable.md) 函数。</span><span class="sxs-lookup"><span data-stu-id="09c38-115">Calling the [BuildDisplayTable](builddisplaytable.md) function.</span></span> 
    
    - <span data-ttu-id="09c38-116">或 -</span><span class="sxs-lookup"><span data-stu-id="09c38-116">Or -</span></span>
    
- <span data-ttu-id="09c38-117">包括使用表数据对象（支持 [ITableData ： IUnknown](itabledataiunknown.md) 接口的对象）直接填充显示表的自定义代码。</span><span class="sxs-lookup"><span data-stu-id="09c38-117">Including custom code that populates the display table directly using a table data object — an object that supports the [ITableData : IUnknown](itabledataiunknown.md) interface.</span></span> 
    
<span data-ttu-id="09c38-118">**BuildDisplayTable** 函数将显示表结构中的信息与对话框资源中的可视元素组合在一起，以生成显示表行。</span><span class="sxs-lookup"><span data-stu-id="09c38-118">The **BuildDisplayTable** function combines information from display table structures with visual elements from a dialog box resource to build display table rows.</span></span> <span data-ttu-id="09c38-119">函数返回一个指向 [IMAPITable ： IUnknown](imapitableiunknown.md) 接口实现的指针，以及指向 **ITableData** 接口实现（如果需要）的指针。</span><span class="sxs-lookup"><span data-stu-id="09c38-119">The function returns a pointer to an [IMAPITable : IUnknown](imapitableiunknown.md) interface implementation, and, if requested, a pointer to an **ITableData** interface implementation.</span></span> 
  
<span data-ttu-id="09c38-120">使用 **BuildDisplayTable** 创建显示表非常简单，并且当显示元素更改时，维护将更容易。</span><span class="sxs-lookup"><span data-stu-id="09c38-120">Using **BuildDisplayTable** to create a display table is straightforward and makes maintenance easier when visual elements of the display change.</span></span> <span data-ttu-id="09c38-121">但是，喜欢不使用 **BuildDisplayTable** 的服务提供商可以使用使用 **ITableData** 方法的自定义代码创建显示表。</span><span class="sxs-lookup"><span data-stu-id="09c38-121">However, service providers that prefer not to use **BuildDisplayTable** can create a display table with custom code that uses the methods of **ITableData**.</span></span> <span data-ttu-id="09c38-122">例如，具有属性页的现有模板结构的服务提供商可能希望创建自定义代码，而不是 **使用 BuildDisplayTable**。</span><span class="sxs-lookup"><span data-stu-id="09c38-122">For example, service providers that have an existing template structure for their property pages might want to create custom code rather than use **BuildDisplayTable**.</span></span>
  
<span data-ttu-id="09c38-123">服务提供商有多种方法可以针对其显示表实现属性接口。</span><span class="sxs-lookup"><span data-stu-id="09c38-123">There are a variety of ways service providers can implement the property interface for their display table.</span></span> <span data-ttu-id="09c38-124">其中包括：</span><span class="sxs-lookup"><span data-stu-id="09c38-124">These include:</span></span>
  
- <span data-ttu-id="09c38-125">提供标准 [IMAPIProp ：IUnknown](imapipropiunknown.md) 实现。</span><span class="sxs-lookup"><span data-stu-id="09c38-125">Supplying a standard [IMAPIProp : IUnknown](imapipropiunknown.md) implementation.</span></span> 
    
- <span data-ttu-id="09c38-126">提供包装 **的 IMAPIProp** 实现，该实现包括执行标准调用之前的特殊处理。</span><span class="sxs-lookup"><span data-stu-id="09c38-126">Supplying a wrapped **IMAPIProp** implementation that includes special processing before making the standard calls.</span></span> 
    
- <span data-ttu-id="09c38-127">提供 [IPropData ：IMAPIProp](ipropdataimapiprop.md) 实现。</span><span class="sxs-lookup"><span data-stu-id="09c38-127">Supplying an [IPropData : IMAPIProp](ipropdataimapiprop.md) implementation.</span></span> 
    
<span data-ttu-id="09c38-128">实现的类型取决于要显示的数据的特征和负责的服务提供商。</span><span class="sxs-lookup"><span data-stu-id="09c38-128">The type of implementation depends on the characteristics of the data to be displayed and the responsible service provider.</span></span> <span data-ttu-id="09c38-129">例如，如果两个编辑控件的数据与其中一个控件发生更改时存在隐式关系， **则 IMAPIProp** 实现必须适当地更改另一个控件的值。</span><span class="sxs-lookup"><span data-stu-id="09c38-129">For example, if there is an implicit relationship between the data in two edit controls and one of the controls changes, the **IMAPIProp** implementation must change the value of the other control appropriately.</span></span> 
  
<span data-ttu-id="09c38-130">显示表的必需列集具有以下属性：</span><span class="sxs-lookup"><span data-stu-id="09c38-130">Display tables have the following properties in their required column set:</span></span>
  
|||
|:-----|:-----|
|<span data-ttu-id="09c38-131">**PR_XPOS (** [PidTagXCoordinate](pidtagxcoordinate-canonical-property.md)) </span><span class="sxs-lookup"><span data-stu-id="09c38-131">**PR_XPOS** ([PidTagXCoordinate](pidtagxcoordinate-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="09c38-132">**PR_YPOS (** [PidTagYCoordinate](pidtagycoordinate-canonical-property.md)) </span><span class="sxs-lookup"><span data-stu-id="09c38-132">**PR_YPOS** ([PidTagYCoordinate](pidtagycoordinate-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="09c38-133">**PR_DELTAX (** [PidTagDeltaX](pidtagdeltax-canonical-property.md)) </span><span class="sxs-lookup"><span data-stu-id="09c38-133">**PR_DELTAX** ([PidTagDeltaX](pidtagdeltax-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="09c38-134">**PR_DELTAY (** [PidTagDeltaY](pidtagdeltay-canonical-property.md)) </span><span class="sxs-lookup"><span data-stu-id="09c38-134">**PR_DELTAY** ([PidTagDeltaY](pidtagdeltay-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="09c38-135">**PR_CONTROL_TYPE (** [PidTagControlType)](pidtagcontroltype-canonical-property.md)</span><span class="sxs-lookup"><span data-stu-id="09c38-135">**PR_CONTROL_TYPE** ([PidTagControlType](pidtagcontroltype-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="09c38-136">**PR_CONTROL_FLAGS (** [PidTagControlFlags](pidtagcontrolflags-canonical-property.md)) </span><span class="sxs-lookup"><span data-stu-id="09c38-136">**PR_CONTROL_FLAGS** ([PidTagControlFlags](pidtagcontrolflags-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="09c38-137">**PR_CONTROL_STRUCTURE (** [PidTagControlStructure](pidtagcontrolstructure-canonical-property.md)) </span><span class="sxs-lookup"><span data-stu-id="09c38-137">**PR_CONTROL_STRUCTURE** ([PidTagControlStructure](pidtagcontrolstructure-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="09c38-138">**PR_CONTROL_ID (** [PidTagControlId)](pidtagcontrolid-canonical-property.md)</span><span class="sxs-lookup"><span data-stu-id="09c38-138">**PR_CONTROL_ID** ([PidTagControlId](pidtagcontrolid-canonical-property.md))</span></span>  <br/> |
   
 <span data-ttu-id="09c38-139">**PR_XPOS** 和 **PR_YPOS** 指定控件左上角的 X 和 Y 坐标。</span><span class="sxs-lookup"><span data-stu-id="09c38-139">**PR_XPOS** and **PR_YPOS** specify the X and Y coordinates of the upper left corner of the control.</span></span> <span data-ttu-id="09c38-140">水平单位为对话框基本宽度单位的 1/4;垂直单位为对话框基本高度单位的 1/8。</span><span class="sxs-lookup"><span data-stu-id="09c38-140">The horizontal units are 1/4 of the dialog base width unit; the vertical units are 1/8 of the dialog base height unit.</span></span> <span data-ttu-id="09c38-141">Windows从当前系统字体的高度和宽度计算当前对话框的基本单位。</span><span class="sxs-lookup"><span data-stu-id="09c38-141">Windows computes the current dialog base units from the height and width of the current system font.</span></span> <span data-ttu-id="09c38-142">坐标相对于属性页区域原点。</span><span class="sxs-lookup"><span data-stu-id="09c38-142">The coordinates are relative to the origin of the property page area.</span></span> <span data-ttu-id="09c38-143">属性页的大小限制为大约 200 到 180 个对话框单位。</span><span class="sxs-lookup"><span data-stu-id="09c38-143">The size of property pages is limited to approximately 200 by 180 dialog units.</span></span> 
  
 <span data-ttu-id="09c38-144">**PR_DELTAX** 和 **PR_DELTAY** 控件的宽度和高度。</span><span class="sxs-lookup"><span data-stu-id="09c38-144">**PR_DELTAX** and **PR_DELTAY** are the width and height of the control.</span></span> <span data-ttu-id="09c38-145">这些是 ULONG 值。</span><span class="sxs-lookup"><span data-stu-id="09c38-145">These are ULONG values.</span></span> <span data-ttu-id="09c38-146">宽度单位为对话框基本宽度单位的 1/4;高度单位是对话框基本高度单位的 1/8。</span><span class="sxs-lookup"><span data-stu-id="09c38-146">The width units are 1/4 of the dialog base width unit; the height units are 1/8 of the dialog base height unit.</span></span> <span data-ttu-id="09c38-147">坐标相对于控件的原点。</span><span class="sxs-lookup"><span data-stu-id="09c38-147">The coordinates are relative to the origin of the control.</span></span> 
  
<span data-ttu-id="09c38-148">其他四个属性描述了控件的各种特征。</span><span class="sxs-lookup"><span data-stu-id="09c38-148">The other four properties describe various characteristics of the control.</span></span> <span data-ttu-id="09c38-149">**PR_CONTROL_TYPE** 指示控件的类型。</span><span class="sxs-lookup"><span data-stu-id="09c38-149">**PR_CONTROL_TYPE** indicates the type of control.</span></span> <span data-ttu-id="09c38-150">MAPI 定义 12 种类型的控件，每个控件都有一组不同的属性。</span><span class="sxs-lookup"><span data-stu-id="09c38-150">MAPI defines twelve types of controls, each with a different set of attributes.</span></span> <span data-ttu-id="09c38-151">这些属性在 flags 属性中进行了 **描述，PR_CONTROL_FLAGS。**</span><span class="sxs-lookup"><span data-stu-id="09c38-151">These attributes are described in the flags property, **PR_CONTROL_FLAGS**.</span></span> <span data-ttu-id="09c38-152">属性示例包括控件是可编辑还是必需。</span><span class="sxs-lookup"><span data-stu-id="09c38-152">Examples of attributes include whether or not a control is editable or required.</span></span> 
  
<span data-ttu-id="09c38-153">控件结构 **PR_CONTROL_STRUCTURE** 包含与特定控件类型有关的信息。</span><span class="sxs-lookup"><span data-stu-id="09c38-153">The control structure, **PR_CONTROL_STRUCTURE**, contains information relevant to the particular type of control.</span></span> <span data-ttu-id="09c38-154">每种类型的控件都使用不同的结构进行描述。</span><span class="sxs-lookup"><span data-stu-id="09c38-154">Each type of control is described with a different structure.</span></span> <span data-ttu-id="09c38-155">例如，使用 [DTBLEDIT](dtbledit.md) 结构描述编辑控件。</span><span class="sxs-lookup"><span data-stu-id="09c38-155">For example, edit controls are described with the [DTBLEDIT](dtbledit.md) structure.</span></span> <span data-ttu-id="09c38-156">**DTBLEDIT** 结构包含列出可放置在控件上的字符数和特定类型的成员，以及一个属性标记，用于标识其值将显示在控件中的属性。</span><span class="sxs-lookup"><span data-stu-id="09c38-156">**DTBLEDIT** structures contain members that list the number of and specific types of characters that can be placed on the control and a property tag that identifies the property whose value is to be displayed in the control.</span></span> <span data-ttu-id="09c38-157">**PR_CONTROL_STRUCTURE** 存储为二进制属性。</span><span class="sxs-lookup"><span data-stu-id="09c38-157">**PR_CONTROL_STRUCTURE** is stored as a binary property.</span></span> 
  
<span data-ttu-id="09c38-158">控件标识符 PR_CONTROL_ID **，唯** 一标识显示表所描述的对话框中的控件。</span><span class="sxs-lookup"><span data-stu-id="09c38-158">The control identifier, **PR_CONTROL_ID**, uniquely identifies the control in the dialog box described by the display table.</span></span> <span data-ttu-id="09c38-159">**PR_CONTROL_ID** 从 **BuildDisplayTable** 用于创建显示表的 [DTCTL](dtctl.md)结构的 *lpbNotif* 和 *cbNotif* 成员中设置的值。</span><span class="sxs-lookup"><span data-stu-id="09c38-159">**PR_CONTROL_ID** is set from the values placed in the  *lpbNotif*  and  *cbNotif*  members of the [DTCTL](dtctl.md) structure that is used by **BuildDisplayTable** to create the display table.</span></span> <span data-ttu-id="09c38-160">由于 MAPI 有时组合显示表，因此PR_CONTROL_ID **标识符应** 始终是唯一的。</span><span class="sxs-lookup"><span data-stu-id="09c38-160">Because MAPI sometimes combines display tables, the identifier in **PR_CONTROL_ID** should always be unique.</span></span> <span data-ttu-id="09c38-161">通常，提供程序会向用户分配 [GUID](guid.md) **PR_CONTROL_ID** 以确保其唯一性。</span><span class="sxs-lookup"><span data-stu-id="09c38-161">Typically, providers assign a [GUID](guid.md) structure to **PR_CONTROL_ID** to ensure its uniqueness.</span></span> <span data-ttu-id="09c38-162">当 **PR_CONTROL_ID** 显示表通知时，TABLE_NOTIFICATION属性将 [](table_notification.md)包含在该结构中。</span><span class="sxs-lookup"><span data-stu-id="09c38-162">The **PR_CONTROL_ID** property is included in the [TABLE_NOTIFICATION](table_notification.md) structure when a display table notification is generated.</span></span> 
  
<span data-ttu-id="09c38-163">有关显示表的信息，请参阅显示表[实现](display-table-implementation.md)[和关于显示表通知](about-display-table-notifications.md)。</span><span class="sxs-lookup"><span data-stu-id="09c38-163">For more information about display tables, see [Display Table Implementation](display-table-implementation.md) and [About Display Table Notifications](about-display-table-notifications.md).</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="09c38-164">另请参阅</span><span class="sxs-lookup"><span data-stu-id="09c38-164">See also</span></span>



[<span data-ttu-id="09c38-165">MAPI 表</span><span class="sxs-lookup"><span data-stu-id="09c38-165">MAPI Tables</span></span>](mapi-tables.md)

