---
title: 一次性表
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 0f2040b7-9b6c-4eae-aa68-29c4f7b8bd76
description: '上次修改时间: 2011 年11月8日'
ms.openlocfilehash: 8719536efa9bffb1226f8fb665b912eb872227f1
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/23/2019
ms.locfileid: "32336482"
---
# <a name="one-off-tables"></a><span data-ttu-id="e20eb-103">一次性表</span><span class="sxs-lookup"><span data-stu-id="e20eb-103">One-Off Tables</span></span>

<span data-ttu-id="e20eb-104">**适用于**：Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="e20eb-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="e20eb-105">一次性表格包含有关通讯簿提供程序为创建新收件人所支持的模板的信息。</span><span class="sxs-lookup"><span data-stu-id="e20eb-105">A one-off table contains information about the templates that an address book provider supports for creating new recipients.</span></span> <span data-ttu-id="e20eb-106">一次性表格由通讯簿提供程序、单独的通讯簿容器和 MAPI 实现, 并且可以是持久的或临时的。</span><span class="sxs-lookup"><span data-stu-id="e20eb-106">One-off tables are implemented by address book providers, individual address book containers, and by MAPI, and can be persistent or temporary.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="e20eb-107">请勿将一次性表格中的模板与模板标识符混淆;尽管它们的目的是相似的, 但其代码构造不是什么相似。</span><span class="sxs-lookup"><span data-stu-id="e20eb-107">Do not confuse the templates in one-off tables with template identifiers; while their purposes are similar, their code constructs are nothing alike.</span></span> <span data-ttu-id="e20eb-108">模板用于创建特定类型的收件人, 而模板标识符用于绑定属于主机提供程序的一个收件人的数据, 以支持属于外部提供程序的另一个收件人。</span><span class="sxs-lookup"><span data-stu-id="e20eb-108">Templates are used to create recipients of a particular type while template identifiers are used to bind the data of one recipient that belong to a host provider with code to support another recipient that belong to a foreign provider.</span></span> 
  
<span data-ttu-id="e20eb-109">客户端创建新的收件人:</span><span class="sxs-lookup"><span data-stu-id="e20eb-109">Clients create new recipients:</span></span>
  
- <span data-ttu-id="e20eb-110">添加到传出邮件的收件人列表中。</span><span class="sxs-lookup"><span data-stu-id="e20eb-110">To add to the recipient list of an outgoing message.</span></span>
    
- <span data-ttu-id="e20eb-111">添加到通讯簿中的某个容器。</span><span class="sxs-lookup"><span data-stu-id="e20eb-111">To add to one of the containers in the address book.</span></span>
    
<span data-ttu-id="e20eb-112">在这两种情况下, 都要求通讯簿提供程序返回一个一次性表格。</span><span class="sxs-lookup"><span data-stu-id="e20eb-112">In both scenarios, an address book provider is asked to return a one-off table.</span></span> <span data-ttu-id="e20eb-113">通讯簿提供程序可以实现在这两种情况下使用一个一次性表, 也可以在每种情况下使用唯一的一次性表。</span><span class="sxs-lookup"><span data-stu-id="e20eb-113">Address book providers can implement either a single one-off table to be used in both situations or a unique one-off table for each situation.</span></span> 
  
<span data-ttu-id="e20eb-114">当收件人将包含在传出邮件中时, MAPI 会调用通讯簿提供程序的[IABLogon:: GetOneOffTable](iablogon-getoneofftable.md)方法来检索其一次性表。</span><span class="sxs-lookup"><span data-stu-id="e20eb-114">When the recipient will be included with an outgoing message, MAPI calls the address book provider's [IABLogon::GetOneOffTable](iablogon-getoneofftable.md) method to retrieve its one-off table.</span></span> <span data-ttu-id="e20eb-115">一次性表格包含模板, 使用户可以输入信息, 从而创建具有有效地址的收件人。</span><span class="sxs-lookup"><span data-stu-id="e20eb-115">The one-off table includes templates which enable a user to enter information resulting in the creation of a recipient with a valid address.</span></span> <span data-ttu-id="e20eb-116">此表上的通知的 MAPI 寄存器, 使其保持打开状态, 以便可以将更改反映到用户。</span><span class="sxs-lookup"><span data-stu-id="e20eb-116">MAPI registers for notifications on this table, keeping it open so that changes can be reflected to the user.</span></span> <span data-ttu-id="e20eb-117">只有在调用其子系统或通讯簿状态对象的[IMAPIStatus:: ValidateState](imapistatus-validatestate.md)方法时, MAPI 才会释放该表。</span><span class="sxs-lookup"><span data-stu-id="e20eb-117">MAPI releases the table only when its subsystem or address book status object's [IMAPIStatus::ValidateState](imapistatus-validatestate.md) method is called.</span></span> 
  
<span data-ttu-id="e20eb-118">将收件人添加到容器中时, MAPI 将发出不同的调用, 调用容器的[IMAPIProp:: OpenProperty](imapiprop-openproperty.md)方法检索其**PR_CREATE_TEMPLATES** ([PidTagCreateTemplates](pidtagcreatetemplates-canonical-property.md)) 属性。</span><span class="sxs-lookup"><span data-stu-id="e20eb-118">When the recipient will be added to a container, MAPI makes a different call, invoking the container's [IMAPIProp::OpenProperty](imapiprop-openproperty.md) method to retrieve its **PR_CREATE_TEMPLATES** ([PidTagCreateTemplates](pidtagcreatetemplates-canonical-property.md)) property.</span></span> <span data-ttu-id="e20eb-119">此一次性表格中包含的模板集代表可添加到容器中的收件人的类型。</span><span class="sxs-lookup"><span data-stu-id="e20eb-119">The set of templates included in this one-off table represents the types of recipients that can be added to the container.</span></span> <span data-ttu-id="e20eb-120">例如, 邮件服务器通常会为每个已安装的网关公开一个容器, 以便每个容器仅保留特定于相应网关的地址。</span><span class="sxs-lookup"><span data-stu-id="e20eb-120">For example, mail servers often expose one container for every gateway that is installed so that each container only holds addresses specific to the corresponding gateway.</span></span>
  
<span data-ttu-id="e20eb-121">MAPI 提供了一个一次性表格, 其中包含自己的模板以及会话中每个通讯簿提供程序中的模板。</span><span class="sxs-lookup"><span data-stu-id="e20eb-121">MAPI provides a one-off table that includes its own templates as well as templates from each of the address book providers in the session.</span></span> <span data-ttu-id="e20eb-122">MAPI 提供了一个通用模板, 可用于为任何地址类型创建新的收件人, 假定用户知道其格式。</span><span class="sxs-lookup"><span data-stu-id="e20eb-122">MAPI provides a generic template that can be used to create a new recipient for any address type, assuming that the user knows its format.</span></span> <span data-ttu-id="e20eb-123">通讯簿提供程序通过调用[IMAPISupport:: GetOneOffTable](imapisupport-getoneofftable.md)来使用此一次性表格。</span><span class="sxs-lookup"><span data-stu-id="e20eb-123">Address book providers use this one-off table by calling [IMAPISupport::GetOneOffTable](imapisupport-getoneofftable.md).</span></span> <span data-ttu-id="e20eb-124">MAPI 一次性表中包含的每个模板都将创建具有有效收件人地址的收件人。</span><span class="sxs-lookup"><span data-stu-id="e20eb-124">Each of the templates included in the MAPI one-off table results in the creation of recipients with valid recipient addresses.</span></span>
  
<span data-ttu-id="e20eb-125">通讯簿提供程序通常为其支持的每种地址类型提供一个模板。</span><span class="sxs-lookup"><span data-stu-id="e20eb-125">Address book providers typically supply one template for every address type they support.</span></span> <span data-ttu-id="e20eb-126">但是, 不需要对模板的支持。</span><span class="sxs-lookup"><span data-stu-id="e20eb-126">However, support for templates is not required.</span></span> <span data-ttu-id="e20eb-127">当 MAPI 调用请求一次性表时, 不允许创建新地址的通讯簿提供程序可能会返回 MAPI_E_NO_SUPPORT。</span><span class="sxs-lookup"><span data-stu-id="e20eb-127">Address book providers that do not allow the creation of new addresses can return MAPI_E_NO_SUPPORT when MAPI calls to request a one-off table.</span></span> <span data-ttu-id="e20eb-128">允许创建新地址但不提供任何模板的通讯簿提供程序可以调用**IMAPISupport:: GetOneOffTable**以使用 MAPI 一次性表中列出的模板。</span><span class="sxs-lookup"><span data-stu-id="e20eb-128">Address book providers that do allow new address creation but do not supply any templates can call **IMAPISupport::GetOneOffTable** to use the templates listed in the MAPI one-off table.</span></span> 
  
<span data-ttu-id="e20eb-129">以下属性构成了一次性表中所需的列集:</span><span class="sxs-lookup"><span data-stu-id="e20eb-129">The following properties make up the required column set in one-off tables:</span></span>
  
- <span data-ttu-id="e20eb-130">**PR_ADDRTYPE**([PidTagAddressType](pidtagaddresstype-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="e20eb-130">**PR_ADDRTYPE** ([PidTagAddressType](pidtagaddresstype-canonical-property.md))</span></span>
    
- <span data-ttu-id="e20eb-131">**PR_DEPTH**([PidTagDepth](pidtagdepth-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="e20eb-131">**PR_DEPTH** ([PidTagDepth](pidtagdepth-canonical-property.md))</span></span>
    
- <span data-ttu-id="e20eb-132">**PR_DISPLAY_NAME**([PidTagDisplayName](pidtagdisplayname-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="e20eb-132">**PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md))</span></span>
    
- <span data-ttu-id="e20eb-133">**PR_DISPLAY_TYPE**([PidTagDisplayType](pidtagdisplaytype-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="e20eb-133">**PR_DISPLAY_TYPE** ([PidTagDisplayType](pidtagdisplaytype-canonical-property.md))</span></span>
    
- <span data-ttu-id="e20eb-134">**PR_ENTRYID**([PidTagEntryId](pidtagentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="e20eb-134">**PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md))</span></span>
    
- <span data-ttu-id="e20eb-135">**PR_INSTANCE_KEY**([PidTagInstanceKey](pidtaginstancekey-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="e20eb-135">**PR_INSTANCE_KEY** ([PidTagInstanceKey](pidtaginstancekey-canonical-property.md))</span></span>
    
- <span data-ttu-id="e20eb-136">**PR_SELECTABLE**([PidTagSelectable](pidtagselectable-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="e20eb-136">**PR_SELECTABLE** ([PidTagSelectable](pidtagselectable-canonical-property.md))</span></span>
    
 <span data-ttu-id="e20eb-137">**PR_ADDRTYPE**指示可与使用模板创建的新收件人相关联的地址类型。</span><span class="sxs-lookup"><span data-stu-id="e20eb-137">**PR_ADDRTYPE** indicates the type of address that can be associated with the new recipient created with the template.</span></span> 
  
 <span data-ttu-id="e20eb-138">**PR_DISPLAY_NAME**和**PR_DISPLAY_TYPE**将数据与新的收件人相关联。</span><span class="sxs-lookup"><span data-stu-id="e20eb-138">**PR_DISPLAY_NAME** and **PR_DISPLAY_TYPE** associate data with the new recipient.</span></span> <span data-ttu-id="e20eb-139">**PR_DISPLAY_NAME**包含一个标识新的收件人和**PR_DISPLAY_TYPE**的字符串, 该字符串包含一个常量, 用于标识要与行一起显示的图标的类型。</span><span class="sxs-lookup"><span data-stu-id="e20eb-139">**PR_DISPLAY_NAME** contains a character string that identifies the new recipient and **PR_DISPLAY_TYPE** contains a constant that identifies the type of icon to be displayed with the row.</span></span> <span data-ttu-id="e20eb-140">邮件用户的模板将其 " **PR_DISPLAY_TYPE** " 列设置为 "DT_MAILUSER"。通讯组列表的模板将其**PR_DISPLAY_TYPE**列设置为 DT_DISTLIST。</span><span class="sxs-lookup"><span data-stu-id="e20eb-140">Templates for messaging users have their **PR_DISPLAY_TYPE** column set to DT_MAILUSER; templates for distribution lists have their **PR_DISPLAY_TYPE** column set to DT_DISTLIST.</span></span> 
  
 <span data-ttu-id="e20eb-141">**PR_ENTRYID**是要用于创建新收件人的模板的条目标识符。</span><span class="sxs-lookup"><span data-stu-id="e20eb-141">**PR_ENTRYID** is the entry identifier of the template to be used to create a new recipient.</span></span> <span data-ttu-id="e20eb-142">此条目标识符可传递给未来的[IAddrBook:: NewEntry](iaddrbook-newentry.md), [IAddrBook:: OpenEntry](iaddrbook-openentry.md), and [IABContainer:: CreateEntry](iabcontainer-createentry.md) calls。</span><span class="sxs-lookup"><span data-stu-id="e20eb-142">This entry identifier can be passed to future [IAddrBook::NewEntry](iaddrbook-newentry.md), [IAddrBook::OpenEntry](iaddrbook-openentry.md), and [IABContainer::CreateEntry](iabcontainer-createentry.md) calls.</span></span> <span data-ttu-id="e20eb-143">容器将默认邮件用户模板的行的**PR_ENTRYID**列设置为**PR_DEF_CREATE_MAILUSER** ([PidTagDefCreateMailuser](pidtagdefcreatemailuser-canonical-property.md)), 并将其行的**PR_ENTRYID**列设置为默认的通讯组列表模板到**PR_DEF_CREATE_DL** ([PidTagDefCreateDl](pidtagdefcreatedl-canonical-property.md))。</span><span class="sxs-lookup"><span data-stu-id="e20eb-143">Containers set the **PR_ENTRYID** column of their row for the default messaging user template to **PR_DEF_CREATE_MAILUSER** ([PidTagDefCreateMailuser](pidtagdefcreatemailuser-canonical-property.md)) and the **PR_ENTRYID** column of their row for the default distribution list template to **PR_DEF_CREATE_DL** ([PidTagDefCreateDl](pidtagdefcreatedl-canonical-property.md)).</span></span> 
  
 <span data-ttu-id="e20eb-144">**PR_DEPTH**用于通过指示模板的缩进级别来支持一次性表格中的条目的分层显示。</span><span class="sxs-lookup"><span data-stu-id="e20eb-144">**PR_DEPTH** is used to support the hierarchical display of the entries in a one-off table by indicating the level of indentation for the template.</span></span> <span data-ttu-id="e20eb-145">虽然一次性表可以显示为简单列表或层次结构显示, 但后者是首选的, 通讯簿提供程序应通过相应地为每行设置**PR_DEPTH**列来支持这两个表。</span><span class="sxs-lookup"><span data-stu-id="e20eb-145">Although one-off tables can be displayed either as a flat list or a hierarchical display, the latter is preferable and address book providers should support it by setting the **PR_DEPTH** column for each row appropriately.</span></span> <span data-ttu-id="e20eb-146">**PR_DEPTH**是从零开始的;**PR_DEPTH**列中值为0的行不缩进。</span><span class="sxs-lookup"><span data-stu-id="e20eb-146">**PR_DEPTH** is zero-based; rows with a value of 0 in their **PR_DEPTH** column are not indented.</span></span> <span data-ttu-id="e20eb-147">**PR_DEPTH**的值越大, 缩进的行越多。</span><span class="sxs-lookup"><span data-stu-id="e20eb-147">The higher the value of **PR_DEPTH**, the more the row is indented.</span></span> <span data-ttu-id="e20eb-148">例如, 将**PR_DEPTH**设置为1的行会缩进一个制表符, 而**PR_DEPTH**设置为3的行缩进三个选项卡。</span><span class="sxs-lookup"><span data-stu-id="e20eb-148">For example, rows with **PR_DEPTH** set to 1 are indented one tab while rows with **PR_DEPTH** set to 3 are indented three tabs.</span></span> 
  
 <span data-ttu-id="e20eb-149">**PR_SELECTABLE**用于指示表中的行是否表示可选择并用于创建新收件人的模板。</span><span class="sxs-lookup"><span data-stu-id="e20eb-149">**PR_SELECTABLE** is used to indicate whether a row in the table represents a template that can be selected and used to create a new recipient.</span></span> <span data-ttu-id="e20eb-150">尽管一次性表格中的大多数行都代表模板, 但提供程序可以包含非模板行。</span><span class="sxs-lookup"><span data-stu-id="e20eb-150">Although most rows in a one-off table do represent templates, providers can include non-template rows.</span></span> <span data-ttu-id="e20eb-151">例如, 提供商可能希望按模板类型组织一次性表格, 包括显示在显示中但不用于创建收件人的类别行。</span><span class="sxs-lookup"><span data-stu-id="e20eb-151">For example, a provider might want to organize the one-off table by template type, including a category row that appears in the display but is not used for recipient creation.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="e20eb-152">另请参阅</span><span class="sxs-lookup"><span data-stu-id="e20eb-152">See also</span></span>



[<span data-ttu-id="e20eb-153">MAPI 表</span><span class="sxs-lookup"><span data-stu-id="e20eb-153">MAPI Tables</span></span>](mapi-tables.md)

