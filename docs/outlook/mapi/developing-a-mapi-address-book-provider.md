---
title: 开发 MAPI 通讯簿提供程序
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 821cc42d-eebb-4327-b2d4-594421a5c22c
description: 上次修改时间：2011 年 7 月 23 日
ms.openlocfilehash: 1db3ce53a1da60d946e52a03369c10547676277f
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/28/2019
ms.locfileid: "33409368"
---
# <a name="developing-a-mapi-address-book-provider"></a>开发 MAPI 通讯簿提供程序

  
  
**适用于**：Outlook 2013 | Outlook 2016 
  
通讯簿提供程序向客户端应用程序、邮件存储和传输提供程序以及 MAPI 提供收件人信息。 收件人信息按层次结构组织到称为容器的存储隔离舱中。 配置文件中的每个通讯簿都会将一个或多个顶级容器 (或父容器) 分配给 MAPI 通讯簿, 这是来自会话中所有通讯簿提供程序的收件人信息的集成视图。 通过 MAPI 通讯簿, 客户端和其他服务提供商即可访问通讯簿提供程序的数据。
  
MAPI 通过以下方式构建集成的通讯簿:
  
1. 从每个通讯簿提供程序检索顶级容器。
    
2. 检索每个容器的层次结构表。 
    
3. 将每个层次结构表复制到一个集成的层次结构表中。 它是向客户端公开的集成层次结构表。 
    
MAPI 对通讯簿提供程序编写者施加的要求很少。 作为通讯簿编写者而可以实现的可能功能的范围是不同且灵活的。 例如, 您的提供程序可以限制为提供特定类型的收件人信息的只读视图, 也可以实现一组完整的功能, 从而允许客户端或提供程序对收件人数据进行添加或修改并强制实施用于定义自定义视图的搜索条件。 
  
提供程序的数据可以驻留在本地的文件或数据库中或远程服务器上。 有些通讯簿提供程序用于处理特定的邮件系统, 与传输提供程序紧密结合, 而其他人可以在任何邮件系统上运行。
  
MAPI 定义一种特殊类型的通讯簿提供程序, 称为个人通讯簿或 PAB, 它实现单个可修改容器, 并可以保留从其他容器复制的收件人信息以及直接创建的信息。 尽管任何通讯簿提供程序都可以实现 PAB, 并且可以将多个 PABs 添加到配置文件中, 但只有其中一个提供程序可以指定为在任何一个会话过程中作为 PAB 运行。 
  

