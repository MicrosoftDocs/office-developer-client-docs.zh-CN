---
title: 设置传入邮件的属性
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: cf4a0501-f42b-4652-a239-003022686475
description: 上次修改时间：2015 年 3 月 9 日
ms.openlocfilehash: 44b5b489d3efce3ecea69ccd8b7b7a638b173c13
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/23/2018
ms.locfileid: "22578435"
---
# <a name="setting-properties-on-incoming-messages"></a><span data-ttu-id="bcc39-103">设置传入邮件的属性</span><span class="sxs-lookup"><span data-stu-id="bcc39-103">Setting Properties on Incoming Messages</span></span>

  
  
<span data-ttu-id="bcc39-104">**适用于**： Outlook 2013 |Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="bcc39-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="bcc39-105">MAPI 子系统中的客户端应用程序期望中接收的任何消息的属性数目。</span><span class="sxs-lookup"><span data-stu-id="bcc39-105">The client applications within the MAPI subsystem expect a number of properties in any received message.</span></span> <span data-ttu-id="bcc39-106">当传输提供程序到 MAPI，将显示一条消息时，应设置这些属性，因为它是过程任一仅使用所需的信息，为此，请或至少是最佳源的信息。</span><span class="sxs-lookup"><span data-stu-id="bcc39-106">When the transport provider brings a message into MAPI, it should set these properties, since it is either the only process with the necessary information to do so, or is at least the best source of the information.</span></span>
  
<span data-ttu-id="bcc39-107">鼓励设置接收的邮件中的所有这些属性的值将提供程序。</span><span class="sxs-lookup"><span data-stu-id="bcc39-107">Providers are encouraged to set the values for all of these properties in incoming messages.</span></span>
  
|<span data-ttu-id="bcc39-108">**属性名称**</span><span class="sxs-lookup"><span data-stu-id="bcc39-108">**Property name**</span></span>|<span data-ttu-id="bcc39-109">**说明**</span><span class="sxs-lookup"><span data-stu-id="bcc39-109">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="bcc39-110">**PR_SUBJECT**([PidTagSubject](pidtagsubject-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="bcc39-110">**PR_SUBJECT** ([PidTagSubject](pidtagsubject-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="bcc39-111">邮件的主题。</span><span class="sxs-lookup"><span data-stu-id="bcc39-111">The subject of the message.</span></span>  <br/> |
|<span data-ttu-id="bcc39-112">**PR_BODY**([PidTagBody](pidtagbody-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="bcc39-112">**PR_BODY** ([PidTagBody](pidtagbody-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="bcc39-113">纯文本消息文本。</span><span class="sxs-lookup"><span data-stu-id="bcc39-113">Plain text message text.</span></span>  <br/> |
|<span data-ttu-id="bcc39-114">**PR_RTF_COMPRESSED**([PidTagRtfCompressed](pidtagrtfcompressed-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="bcc39-114">**PR_RTF_COMPRESSED** ([PidTagRtfCompressed](pidtagrtfcompressed-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="bcc39-115">压缩的 RTF 消息文本。</span><span class="sxs-lookup"><span data-stu-id="bcc39-115">Compressed RTF message text.</span></span>  <br/> |
|<span data-ttu-id="bcc39-116">**PR_MESSAGE_DELIVERY_TIME**([PidTagMessageDeliveryTime](pidtagmessagedeliverytime-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="bcc39-116">**PR_MESSAGE_DELIVERY_TIME** ([PidTagMessageDeliveryTime](pidtagmessagedeliverytime-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="bcc39-117">日期和时间邮件已送达。</span><span class="sxs-lookup"><span data-stu-id="bcc39-117">The date and time the message was delivered.</span></span>  <br/> |
|<span data-ttu-id="bcc39-118">**PR_SENDER_NAME**([PidTagSenderName](pidtagsendername-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="bcc39-118">**PR_SENDER_NAME** ([PidTagSenderName](pidtagsendername-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="bcc39-119">原始邮件发件人显示名称。</span><span class="sxs-lookup"><span data-stu-id="bcc39-119">The display name of the message originator.</span></span>  <br/> |
|<span data-ttu-id="bcc39-120">**PR_SENDER_ENTRYID**([PidTagSenderEntryId](pidtagsenderentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="bcc39-120">**PR_SENDER_ENTRYID** ([PidTagSenderEntryId](pidtagsenderentryid-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="bcc39-121">消息发起方的通讯簿条目。</span><span class="sxs-lookup"><span data-stu-id="bcc39-121">The address book entry of the message originator.</span></span>  <br/> |
|<span data-ttu-id="bcc39-122">**PR_SENDER_SEARCH_KEY**([PidTagSenderSearchKey](pidtagsendersearchkey-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="bcc39-122">**PR_SENDER_SEARCH_KEY** ([PidTagSenderSearchKey](pidtagsendersearchkey-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="bcc39-123">消息发起方的通讯簿搜索键。</span><span class="sxs-lookup"><span data-stu-id="bcc39-123">The address book search key of the message originator.</span></span>  <br/> |
|<span data-ttu-id="bcc39-124">**期限**([PidTagClientSubmitTime](pidtagclientsubmittime-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="bcc39-124">**PR_CLIENT_SUBMIT_TIME** ([PidTagClientSubmitTime](pidtagclientsubmittime-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="bcc39-125">邮件由发件人的邮件客户端已提交到其消息的系统时间。</span><span class="sxs-lookup"><span data-stu-id="bcc39-125">The time that the message was submitted to its messaging system by the sender's messaging client.</span></span>  <br/> |
|<span data-ttu-id="bcc39-126">**PR_SENT_REPRESENTING_NAME**([PidTagSentRepresentingName](pidtagsentrepresentingname-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="bcc39-126">**PR_SENT_REPRESENTING_NAME** ([PidTagSentRepresentingName](pidtagsentrepresentingname-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="bcc39-127">发送代表性代理人的姓名。</span><span class="sxs-lookup"><span data-stu-id="bcc39-127">The name of the representative delegate for sending.</span></span>  <br/> |
|<span data-ttu-id="bcc39-128">**PR_SENT_REPRESENTING_ENTRYID**([PidTagSentRepresentingEntryId](pidtagsentrepresentingentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="bcc39-128">**PR_SENT_REPRESENTING_ENTRYID** ([PidTagSentRepresentingEntryId](pidtagsentrepresentingentryid-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="bcc39-129">发送委托通讯簿条目。</span><span class="sxs-lookup"><span data-stu-id="bcc39-129">The address book entry of the sending delegate.</span></span>  <br/> |
|<span data-ttu-id="bcc39-130">**PR_SENT_REPRESENTING_SEARCH_KEY**([PidTagSentRepresentingSearchKey](pidtagsentrepresentingsearchkey-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="bcc39-130">**PR_SENT_REPRESENTING_SEARCH_KEY** ([PidTagSentRepresentingSearchKey](pidtagsentrepresentingsearchkey-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="bcc39-131">地址簿搜索关键字的发送的代理人。</span><span class="sxs-lookup"><span data-stu-id="bcc39-131">The address book search key of the sending delegate.</span></span>  <br/> |
|<span data-ttu-id="bcc39-132">**PR_RCVD_REPRESENTING_NAME**([PidTagReceivedRepresentingName](pidtagreceivedrepresentingname-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="bcc39-132">**PR_RCVD_REPRESENTING_NAME** ([PidTagReceivedRepresentingName](pidtagreceivedrepresentingname-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="bcc39-133">用于接收代表性代理人的姓名。</span><span class="sxs-lookup"><span data-stu-id="bcc39-133">The name of the representative delegate for receiving.</span></span>  <br/> |
|<span data-ttu-id="bcc39-134">**PR_RCVD_REPRESENTING_ENTRYID**([PidTagReceivedRepresentingEntryId](pidtagreceivedrepresentingentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="bcc39-134">**PR_RCVD_REPRESENTING_ENTRYID** ([PidTagReceivedRepresentingEntryId](pidtagreceivedrepresentingentryid-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="bcc39-135">接收委托通讯簿条目。</span><span class="sxs-lookup"><span data-stu-id="bcc39-135">The address book entry of the receiving delegate.</span></span>  <br/> |
|<span data-ttu-id="bcc39-136">**PR_RCVD_REPRESENTING_SEARCH_KEY**([PidTagReceivedRepresentingSearchKey](pidtagreceivedrepresentingsearchkey-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="bcc39-136">**PR_RCVD_REPRESENTING_SEARCH_KEY** ([PidTagReceivedRepresentingSearchKey](pidtagreceivedrepresentingsearchkey-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="bcc39-137">地址簿搜索关键字的接收的代理人。</span><span class="sxs-lookup"><span data-stu-id="bcc39-137">The address book search key of the receiving delegate.</span></span>  <br/> |
|<span data-ttu-id="bcc39-138">**PR_REPLY_RECIPIENT_NAMES**([PidTagReplyRecipientNames](pidtagreplyrecipientnames-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="bcc39-138">**PR_REPLY_RECIPIENT_NAMES** ([PidTagReplyRecipientNames](pidtagreplyrecipientnames-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="bcc39-139">委派的收件人的列表显示由分号和空格分隔的名称 （";"）。</span><span class="sxs-lookup"><span data-stu-id="bcc39-139">The list of delegated recipient display names, separated by a semicolon and space ("; ").</span></span>  <br/> |
|<span data-ttu-id="bcc39-140">**PR_REPLY_RECIPIENT_ENTRIES**([PidTagReplyRecipientEntries](pidtagreplyrecipiententries-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="bcc39-140">**PR_REPLY_RECIPIENT_ENTRIES** ([PidTagReplyRecipientEntries](pidtagreplyrecipiententries-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="bcc39-141">委派的回复的收件人列表。</span><span class="sxs-lookup"><span data-stu-id="bcc39-141">The list of delegated recipients for a reply.</span></span>  <br/> |
|<span data-ttu-id="bcc39-142">**PR_MESSAGE_TO_ME**([PidTagMessageToMe](pidtagmessagetome-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="bcc39-142">**PR_MESSAGE_TO_ME** ([PidTagMessageToMe](pidtagmessagetome-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="bcc39-143">指示收件人已专门命名为"目标"收件人 （不在一组）。</span><span class="sxs-lookup"><span data-stu-id="bcc39-143">Indicates that the recipient was specifically named as a "to" recipient (not in a group).</span></span>  <br/> |
|<span data-ttu-id="bcc39-144">**PR_MESSAGE_CC_ME**([PidTagMessageCcMe](pidtagmessageccme-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="bcc39-144">**PR_MESSAGE_CC_ME** ([PidTagMessageCcMe](pidtagmessageccme-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="bcc39-145">指示收件人已专门命名为"抄送"收件人 （不在一组）。</span><span class="sxs-lookup"><span data-stu-id="bcc39-145">Indicates that the recipient was specifically named as a "cc" recipient (not in a group).</span></span>  <br/> |
|<span data-ttu-id="bcc39-146">**PR_MESSAGE_RECIP_ME**([PidTagMessageRecipientMe](pidtagmessagerecipientme-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="bcc39-146">**PR_MESSAGE_RECIP_ME** ([PidTagMessageRecipientMe](pidtagmessagerecipientme-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="bcc39-147">指示收件人为"目标"，特别是名为"抄送"或"密件抄送"收件人 （不在一组）。</span><span class="sxs-lookup"><span data-stu-id="bcc39-147">Indicates that the recipient was specifically named as a "to", "cc" or "bcc" recipient (not in a group).</span></span>  <br/> |
   
<span data-ttu-id="bcc39-148">不明显映射提供商可以将**PR_SENT_REPRESENTING**组属性设置为相同的值的**PR_SENDER**组中，属性设置为相同的值**PR_RECEIVED_BY **PR_RCVD_REPRESENTING**组**组，并可以生成的基于**PR_SENDER**组的值的属性**PR_REPLY_RECIPIENT**组。</span><span class="sxs-lookup"><span data-stu-id="bcc39-148">Providers that have no apparent mappings can set the **PR_SENT_REPRESENTING** group of properties to the same values as the **PR_SENDER** group, the **PR_RCVD_REPRESENTING** group of properties to the same values as the **PR_RECEIVED_BY** group, and can build the **PR_REPLY_RECIPIENT** group of properties based on the values of the **PR_SENDER** group.</span></span> <span data-ttu-id="bcc39-149">例如， **PR_SENT_REPRESENTING_NAME**可以设置为**PR_SENDER_NAME**相同的值。</span><span class="sxs-lookup"><span data-stu-id="bcc39-149">For example, **PR_SENT_REPRESENTING_NAME** can be set to the same value as **PR_SENDER_NAME**.</span></span>
  
<span data-ttu-id="bcc39-150">**PR_ENTRYID**或**PR_ENTRYLIST**属性可以生成，如有必要，通过调用[IMAPISupport::CreateOneOff](imapisupport-createoneoff.md)方法。</span><span class="sxs-lookup"><span data-stu-id="bcc39-150">The **PR_ENTRYID** or **PR_ENTRYLIST** property can be generated, if necessary, by calling the [IMAPISupport::CreateOneOff](imapisupport-createoneoff.md) method.</span></span> <span data-ttu-id="bcc39-151">可以通过将与用户、 冒号 （:） 和与用户关联的**PR_EMAIL_ADDRESS**属性关联的**PR_ADDRTYPE**属性生成的属性**PR_SEARCH_KEY**组然后更改为大写形式的结果.</span><span class="sxs-lookup"><span data-stu-id="bcc39-151">The **PR_SEARCH_KEY** group of properties can be generated by concatenating the **PR_ADDRTYPE** property associated with a user, a colon (:), and the **PR_EMAIL_ADDRESS** property associated with the user, then changing the result to uppercase.</span></span> <span data-ttu-id="bcc39-152">Windows API 函数**CharUpperBuff**是一种方便的功能，用于实现此目的。</span><span class="sxs-lookup"><span data-stu-id="bcc39-152">The Windows API function **CharUpperBuff** is a convenient function to use for this purpose.</span></span> <span data-ttu-id="bcc39-153">必须执行此过程的是使规范窗体可以作为二进制数量比较的地址。</span><span class="sxs-lookup"><span data-stu-id="bcc39-153">What is required of this process is to make a canonical form of the address that can be compared as a binary quantity.</span></span> <span data-ttu-id="bcc39-154">注意，这是不必要传输提供程序是否区分大小写相对于电子邮件地址。</span><span class="sxs-lookup"><span data-stu-id="bcc39-154">Note that this is not necessary if the transport provider is case-sensitive with respect to email addresses.</span></span> 
  

