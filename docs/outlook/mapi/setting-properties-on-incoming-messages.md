---
title: 设置传入邮件的属性
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: cf4a0501-f42b-4652-a239-003022686475
description: 上次修改时间：2015 年 3 月 9 日
ms.openlocfilehash: d7043004799d534f11aa98770e2e323cbdae95a8
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/28/2019
ms.locfileid: "33432693"
---
# <a name="setting-properties-on-incoming-messages"></a><span data-ttu-id="b1623-103">设置传入邮件的属性</span><span class="sxs-lookup"><span data-stu-id="b1623-103">Setting Properties on Incoming Messages</span></span>

  
  
<span data-ttu-id="b1623-104">**适用于**：Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="b1623-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="b1623-105">MAPI 子系统中的客户端应用程序会在收到的任何邮件中使用多个属性。</span><span class="sxs-lookup"><span data-stu-id="b1623-105">The client applications within the MAPI subsystem expect a number of properties in any received message.</span></span> <span data-ttu-id="b1623-106">当传输提供程序将邮件引入 MAPI 时, 它应设置这些属性, 因为它是唯一具有必要信息的进程, 或者至少是信息的最佳来源。</span><span class="sxs-lookup"><span data-stu-id="b1623-106">When the transport provider brings a message into MAPI, it should set these properties, since it is either the only process with the necessary information to do so, or is at least the best source of the information.</span></span>
  
<span data-ttu-id="b1623-107">建议提供程序在传入邮件中设置所有这些属性的值。</span><span class="sxs-lookup"><span data-stu-id="b1623-107">Providers are encouraged to set the values for all of these properties in incoming messages.</span></span>
  
|<span data-ttu-id="b1623-108">**属性名称**</span><span class="sxs-lookup"><span data-stu-id="b1623-108">**Property name**</span></span>|<span data-ttu-id="b1623-109">**说明**</span><span class="sxs-lookup"><span data-stu-id="b1623-109">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="b1623-110">**PR_SUBJECT**([PidTagSubject](pidtagsubject-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="b1623-110">**PR_SUBJECT** ([PidTagSubject](pidtagsubject-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="b1623-111">邮件的主题。</span><span class="sxs-lookup"><span data-stu-id="b1623-111">The subject of the message.</span></span>  <br/> |
|<span data-ttu-id="b1623-112">**PR_BODY**([PidTagBody](pidtagbody-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="b1623-112">**PR_BODY** ([PidTagBody](pidtagbody-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="b1623-113">纯文本邮件文本。</span><span class="sxs-lookup"><span data-stu-id="b1623-113">Plain text message text.</span></span>  <br/> |
|<span data-ttu-id="b1623-114">**PR_RTF_COMPRESSED**([PidTagRtfCompressed](pidtagrtfcompressed-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="b1623-114">**PR_RTF_COMPRESSED** ([PidTagRtfCompressed](pidtagrtfcompressed-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="b1623-115">压缩的 RTF 邮件文本。</span><span class="sxs-lookup"><span data-stu-id="b1623-115">Compressed RTF message text.</span></span>  <br/> |
|<span data-ttu-id="b1623-116">**PR_MESSAGE_DELIVERY_TIME**([PidTagMessageDeliveryTime](pidtagmessagedeliverytime-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="b1623-116">**PR_MESSAGE_DELIVERY_TIME** ([PidTagMessageDeliveryTime](pidtagmessagedeliverytime-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="b1623-117">邮件的传递日期和时间。</span><span class="sxs-lookup"><span data-stu-id="b1623-117">The date and time the message was delivered.</span></span>  <br/> |
|<span data-ttu-id="b1623-118">**PR_SENDER_NAME**([PidTagSenderName](pidtagsendername-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="b1623-118">**PR_SENDER_NAME** ([PidTagSenderName](pidtagsendername-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="b1623-119">邮件原始发件人的显示名称。</span><span class="sxs-lookup"><span data-stu-id="b1623-119">The display name of the message originator.</span></span>  <br/> |
|<span data-ttu-id="b1623-120">**PR_SENDER_ENTRYID**([PidTagSenderEntryId](pidtagsenderentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="b1623-120">**PR_SENDER_ENTRYID** ([PidTagSenderEntryId](pidtagsenderentryid-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="b1623-121">邮件原始发件人的通讯簿条目。</span><span class="sxs-lookup"><span data-stu-id="b1623-121">The address book entry of the message originator.</span></span>  <br/> |
|<span data-ttu-id="b1623-122">**PR_SENDER_SEARCH_KEY**([PidTagSenderSearchKey](pidtagsendersearchkey-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="b1623-122">**PR_SENDER_SEARCH_KEY** ([PidTagSenderSearchKey](pidtagsendersearchkey-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="b1623-123">邮件原始发件人的通讯簿搜索键。</span><span class="sxs-lookup"><span data-stu-id="b1623-123">The address book search key of the message originator.</span></span>  <br/> |
|<span data-ttu-id="b1623-124">**PR_CLIENT_SUBMIT_TIME**([PidTagClientSubmitTime](pidtagclientsubmittime-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="b1623-124">**PR_CLIENT_SUBMIT_TIME** ([PidTagClientSubmitTime](pidtagclientsubmittime-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="b1623-125">发件人的邮件客户端向其邮件系统提交邮件的时间。</span><span class="sxs-lookup"><span data-stu-id="b1623-125">The time that the message was submitted to its messaging system by the sender's messaging client.</span></span>  <br/> |
|<span data-ttu-id="b1623-126">**PR_SENT_REPRESENTING_NAME**([PidTagSentRepresentingName](pidtagsentrepresentingname-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="b1623-126">**PR_SENT_REPRESENTING_NAME** ([PidTagSentRepresentingName](pidtagsentrepresentingname-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="b1623-127">用于发送的代表委派的名称。</span><span class="sxs-lookup"><span data-stu-id="b1623-127">The name of the representative delegate for sending.</span></span>  <br/> |
|<span data-ttu-id="b1623-128">**PR_SENT_REPRESENTING_ENTRYID**([PidTagSentRepresentingEntryId](pidtagsentrepresentingentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="b1623-128">**PR_SENT_REPRESENTING_ENTRYID** ([PidTagSentRepresentingEntryId](pidtagsentrepresentingentryid-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="b1623-129">发送委派的通讯簿条目。</span><span class="sxs-lookup"><span data-stu-id="b1623-129">The address book entry of the sending delegate.</span></span>  <br/> |
|<span data-ttu-id="b1623-130">**PR_SENT_REPRESENTING_SEARCH_KEY**([PidTagSentRepresentingSearchKey](pidtagsentrepresentingsearchkey-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="b1623-130">**PR_SENT_REPRESENTING_SEARCH_KEY** ([PidTagSentRepresentingSearchKey](pidtagsentrepresentingsearchkey-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="b1623-131">发送委派的通讯簿搜索关键字。</span><span class="sxs-lookup"><span data-stu-id="b1623-131">The address book search key of the sending delegate.</span></span>  <br/> |
|<span data-ttu-id="b1623-132">**PR_RCVD_REPRESENTING_NAME**([PidTagReceivedRepresentingName](pidtagreceivedrepresentingname-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="b1623-132">**PR_RCVD_REPRESENTING_NAME** ([PidTagReceivedRepresentingName](pidtagreceivedrepresentingname-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="b1623-133">用于接收的代表委派的名称。</span><span class="sxs-lookup"><span data-stu-id="b1623-133">The name of the representative delegate for receiving.</span></span>  <br/> |
|<span data-ttu-id="b1623-134">**PR_RCVD_REPRESENTING_ENTRYID**([PidTagReceivedRepresentingEntryId](pidtagreceivedrepresentingentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="b1623-134">**PR_RCVD_REPRESENTING_ENTRYID** ([PidTagReceivedRepresentingEntryId](pidtagreceivedrepresentingentryid-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="b1623-135">接收代理的通讯簿条目。</span><span class="sxs-lookup"><span data-stu-id="b1623-135">The address book entry of the receiving delegate.</span></span>  <br/> |
|<span data-ttu-id="b1623-136">**PR_RCVD_REPRESENTING_SEARCH_KEY**([PidTagReceivedRepresentingSearchKey](pidtagreceivedrepresentingsearchkey-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="b1623-136">**PR_RCVD_REPRESENTING_SEARCH_KEY** ([PidTagReceivedRepresentingSearchKey](pidtagreceivedrepresentingsearchkey-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="b1623-137">接收代理的通讯簿搜索关键字。</span><span class="sxs-lookup"><span data-stu-id="b1623-137">The address book search key of the receiving delegate.</span></span>  <br/> |
|<span data-ttu-id="b1623-138">**PR_REPLY_RECIPIENT_NAMES**([PidTagReplyRecipientNames](pidtagreplyrecipientnames-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="b1623-138">**PR_REPLY_RECIPIENT_NAMES** ([PidTagReplyRecipientNames](pidtagreplyrecipientnames-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="b1623-139">委派收件人显示名称的列表, 用分号和空格 (";") 分隔。</span><span class="sxs-lookup"><span data-stu-id="b1623-139">The list of delegated recipient display names, separated by a semicolon and space ("; ").</span></span>  <br/> |
|<span data-ttu-id="b1623-140">**PR_REPLY_RECIPIENT_ENTRIES**([PidTagReplyRecipientEntries](pidtagreplyrecipiententries-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="b1623-140">**PR_REPLY_RECIPIENT_ENTRIES** ([PidTagReplyRecipientEntries](pidtagreplyrecipiententries-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="b1623-141">答复的已委派收件人列表。</span><span class="sxs-lookup"><span data-stu-id="b1623-141">The list of delegated recipients for a reply.</span></span>  <br/> |
|<span data-ttu-id="b1623-142">**PR_MESSAGE_TO_ME**([PidTagMessageToMe](pidtagmessagetome-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="b1623-142">**PR_MESSAGE_TO_ME** ([PidTagMessageToMe](pidtagmessagetome-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="b1623-143">指示收件人专门指定为 "收件人" 收件人 (不在组中)。</span><span class="sxs-lookup"><span data-stu-id="b1623-143">Indicates that the recipient was specifically named as a "to" recipient (not in a group).</span></span>  <br/> |
|<span data-ttu-id="b1623-144">**PR_MESSAGE_CC_ME**([PidTagMessageCcMe](pidtagmessageccme-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="b1623-144">**PR_MESSAGE_CC_ME** ([PidTagMessageCcMe](pidtagmessageccme-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="b1623-145">指示收件人专门指定为 "抄送" 收件人 (不在组中)。</span><span class="sxs-lookup"><span data-stu-id="b1623-145">Indicates that the recipient was specifically named as a "cc" recipient (not in a group).</span></span>  <br/> |
|<span data-ttu-id="b1623-146">**PR_MESSAGE_RECIP_ME**([PidTagMessageRecipientMe](pidtagmessagerecipientme-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="b1623-146">**PR_MESSAGE_RECIP_ME** ([PidTagMessageRecipientMe](pidtagmessagerecipientme-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="b1623-147">指示收件人专门指定为 "收件人"、"抄送" 或 "密件抄送" 收件人 (不在组中)。</span><span class="sxs-lookup"><span data-stu-id="b1623-147">Indicates that the recipient was specifically named as a "to", "cc" or "bcc" recipient (not in a group).</span></span>  <br/> |
   
<span data-ttu-id="b1623-148">没有明显映射的提供程序可以将**PR_SENT_REPRESENTING**组属性设置为与**PR_SENDER**组相同的值, 将**PR_RCVD_REPRESENTING**组属性设置为与 PR_RECEIVED_BY 相同的值。 \*\*\*\* 组, 并且可以根据**PR_SENDER**组的值生成**PR_REPLY_RECIPIENT**组的属性。</span><span class="sxs-lookup"><span data-stu-id="b1623-148">Providers that have no apparent mappings can set the **PR_SENT_REPRESENTING** group of properties to the same values as the **PR_SENDER** group, the **PR_RCVD_REPRESENTING** group of properties to the same values as the **PR_RECEIVED_BY** group, and can build the **PR_REPLY_RECIPIENT** group of properties based on the values of the **PR_SENDER** group.</span></span> <span data-ttu-id="b1623-149">例如, **PR_SENT_REPRESENTING_NAME**可以设置为与**PR_SENDER_NAME**相同的值。</span><span class="sxs-lookup"><span data-stu-id="b1623-149">For example, **PR_SENT_REPRESENTING_NAME** can be set to the same value as **PR_SENDER_NAME**.</span></span>
  
<span data-ttu-id="b1623-150">如有必要, 可以通过调用[IMAPISupport:: CreateOneOff](imapisupport-createoneoff.md)方法来生成**PR_ENTRYID**或**PR_ENTRYLIST**属性。</span><span class="sxs-lookup"><span data-stu-id="b1623-150">The **PR_ENTRYID** or **PR_ENTRYLIST** property can be generated, if necessary, by calling the [IMAPISupport::CreateOneOff](imapisupport-createoneoff.md) method.</span></span> <span data-ttu-id="b1623-151">可以通过将与用户关联的**PR_ADDRTYPE**属性、冒号 (:) 和与用户关联的**PR_EMAIL_ADDRESS**属性, 然后将结果更改为大写来生成属性的**PR_SEARCH_KEY**组。.</span><span class="sxs-lookup"><span data-stu-id="b1623-151">The **PR_SEARCH_KEY** group of properties can be generated by concatenating the **PR_ADDRTYPE** property associated with a user, a colon (:), and the **PR_EMAIL_ADDRESS** property associated with the user, then changing the result to uppercase.</span></span> <span data-ttu-id="b1623-152">Windows API 函数**CharUpperBuff**是用于此目的的一种方便的函数。</span><span class="sxs-lookup"><span data-stu-id="b1623-152">The Windows API function **CharUpperBuff** is a convenient function to use for this purpose.</span></span> <span data-ttu-id="b1623-153">此过程所需的操作是, 对可以作为二进制数量进行比较的地址采用规范形式。</span><span class="sxs-lookup"><span data-stu-id="b1623-153">What is required of this process is to make a canonical form of the address that can be compared as a binary quantity.</span></span> <span data-ttu-id="b1623-154">请注意, 如果传输提供程序对电子邮件地址而言区分大小写, 则不需要执行此步骤。</span><span class="sxs-lookup"><span data-stu-id="b1623-154">Note that this is not necessary if the transport provider is case-sensitive with respect to email addresses.</span></span> 
  

