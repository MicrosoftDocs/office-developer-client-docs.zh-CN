---
title: 支持呈现附件的格式化的文本
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 68abe85b-5dc0-40d0-8917-30ea002aa816
description: 上次修改时间： 2011 年 7 月 23 日
ms.openlocfilehash: 14c1162bd4e225fd3ab2ea5ab11536b3bdf08edd
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/11/2018
ms.locfileid: "19778901"
---
# <a name="supporting-formatted-text-rendering-attachments"></a><span data-ttu-id="10b38-103">支持格式化文本：显示附件</span><span class="sxs-lookup"><span data-stu-id="10b38-103">Supporting Formatted Text: Rendering Attachments</span></span>

  
  
<span data-ttu-id="10b38-104">**适用于**： Outlook</span><span class="sxs-lookup"><span data-stu-id="10b38-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="10b38-105">没及其附件的邮件中呈现其中一个客户端应用程序设置消息组合期间这些附件的**PR_RENDERING_POSITION** ([PidTagRenderingPosition](pidtagrenderingposition-canonical-property.md)) 属性。</span><span class="sxs-lookup"><span data-stu-id="10b38-105">A client application that cares about where in a message its attachments are rendered sets the **PR_RENDERING_POSITION** ([PidTagRenderingPosition](pidtagrenderingposition-canonical-property.md)) property for these attachments during message composition.</span></span> <span data-ttu-id="10b38-106">不关心呈现位置的客户端离开此属性未设置。</span><span class="sxs-lookup"><span data-stu-id="10b38-106">A client that does not care about rendering placement leaves this property unset.</span></span>
  
<span data-ttu-id="10b38-107">当客户端打开一封邮件的附件时，它会尝试检索每个附件**PR_RENDERING_POSITION**属性可以确定消息文本中应呈现附件的位置。</span><span class="sxs-lookup"><span data-stu-id="10b38-107">When a client opens a message with attachments, it attempts to retrieve each attachment's **PR_RENDERING_POSITION** property to determine where in the message text the attachment should be rendered.</span></span> <span data-ttu-id="10b38-108">客户端可以使用下列方法之一来检索**PR_RENDERING_POSITION**:</span><span class="sxs-lookup"><span data-stu-id="10b38-108">A client can use one of the following methods to retrieve **PR_RENDERING_POSITION**:</span></span>
  
- <span data-ttu-id="10b38-109">[IMAPIProp::GetProps](imapiprop-getprops.md)上打开的附件检索**PR_RENDERING_POSITION**属性。</span><span class="sxs-lookup"><span data-stu-id="10b38-109">[IMAPIProp::GetProps](imapiprop-getprops.md) on the open attachment to retrieve the **PR_RENDERING_POSITION** property.</span></span> 
    
- <span data-ttu-id="10b38-110">在打开的邮件，若要检索其附件表[IMessage::GetAttachmentTable](imessage-getattachmenttable.md) 。</span><span class="sxs-lookup"><span data-stu-id="10b38-110">[IMessage::GetAttachmentTable](imessage-getattachmenttable.md) on the open message to retrieve its attachment table.</span></span> <span data-ttu-id="10b38-111">**PR_RENDERING_POSITION**是所有附件表中所需的列。</span><span class="sxs-lookup"><span data-stu-id="10b38-111">**PR_RENDERING_POSITION** is a required column in all attachment tables.</span></span> <span data-ttu-id="10b38-112">这是首选的方法，因为它会导致更好的性能。</span><span class="sxs-lookup"><span data-stu-id="10b38-112">This is the preferred method because it results in better performance.</span></span> 
    
<span data-ttu-id="10b38-113">RTF 感知消息存储可以选择是否要为**PR_RENDERING_POSITION**返回准确或近似的值。</span><span class="sxs-lookup"><span data-stu-id="10b38-113">RTF-aware message stores can choose whether to return an accurate or approximate value for **PR_RENDERING_POSITION**.</span></span> <span data-ttu-id="10b38-114">因为邮件存储重新计算的附件**PR_RENDERING_POSITION**值当询问消息的**PR_BODY**属性时，某些 RTF 感知消息存储仅保证呈现位置的准确性时客户端要求首先**PR_BODY**。</span><span class="sxs-lookup"><span data-stu-id="10b38-114">Because message stores recalculate an attachment's **PR_RENDERING_POSITION** value when asked for the message's **PR_BODY** property, some RTF-aware message stores only guarantee the accuracy of rendering positions when a client asks first for **PR_BODY**.</span></span> <span data-ttu-id="10b38-115">RTF 感知消息存储被允许客户端提供近似呈现位置值，以提高性能。</span><span class="sxs-lookup"><span data-stu-id="10b38-115">RTF-aware message stores are allowed to provide clients with approximate rendering position values to enhance performance.</span></span> <span data-ttu-id="10b38-116">提供一个大概而不准确呈现位置节省时间并对大多数情况下已足够。</span><span class="sxs-lookup"><span data-stu-id="10b38-116">Providing an approximate rather than an accurate rendering position saves time and is sufficient for most situations.</span></span> 
  
<span data-ttu-id="10b38-117">RTF 感知消息存储应底其近似上指定由客户端负责创建附件的值。</span><span class="sxs-lookup"><span data-stu-id="10b38-117">RTF-aware message stores should base their approximation on the value specified by the client responsible for creating the attachment.</span></span> <span data-ttu-id="10b38-118">虽然所有客户端应设置**PR_RENDERING_POSITION**，消息存储提供程序应准备处理缺少的可能性。</span><span class="sxs-lookup"><span data-stu-id="10b38-118">Although all clients should set **PR_RENDERING_POSITION**, message store providers should be prepared to deal with the possibility of its absence.</span></span> <span data-ttu-id="10b38-119">当客户端不设置**PR_RENDERING_POSITION**时，消息存储可以将其设置为-1，以指示呈现位置不在消息文本。</span><span class="sxs-lookup"><span data-stu-id="10b38-119">When the client does not set **PR_RENDERING_POSITION**, a message store can set it to -1 to indicate that the rendering position is not within the message text.</span></span> <span data-ttu-id="10b38-120">可以在任何位置，具体取决于客户端在邮件内部显示具有为-1 呈现位置的附件。</span><span class="sxs-lookup"><span data-stu-id="10b38-120">Attachments with a rendering position of -1 can be displayed at any place within the message depending on the client.</span></span> <span data-ttu-id="10b38-121">客户端多位置这些类型的顶部的邮件的附件。</span><span class="sxs-lookup"><span data-stu-id="10b38-121">Many clients position these types of attachments at the top of the message.</span></span>
  
<span data-ttu-id="10b38-122">精确度**PR_RENDERING_POSITION**属性取决于是否的消息存储保存消息**PR_BODY** ([PidTagBody](pidtagbody-canonical-property.md)) 和**PR_RTF_COMPRESSED** ([PidTagRtfCompressed](pidtagrtfcompressed-canonical-property.md)) 属性或仅为**PR_RTF_COMPRESSED**。</span><span class="sxs-lookup"><span data-stu-id="10b38-122">The degree of accuracy for a **PR_RENDERING_POSITION** property depends on whether or not a message store saves both a message's **PR_BODY** ([PidTagBody](pidtagbody-canonical-property.md)) and **PR_RTF_COMPRESSED** ([PidTagRtfCompressed](pidtagrtfcompressed-canonical-property.md)) properties or only **PR_RTF_COMPRESSED**.</span></span> <span data-ttu-id="10b38-123">如果客户端将生成**PR_BODY** ，并且消息存储保存以及格式化文本，将准确的呈现位置。</span><span class="sxs-lookup"><span data-stu-id="10b38-123">If the client generates **PR_BODY** and the message store saves it along with the formatted text, the rendering positions will be accurate.</span></span> <span data-ttu-id="10b38-124">但是，如果消息存储库必须生成**PR_BODY**自己版本，因为它只保存**PR_RTF_COMPRESSED**，则可能将 ア ネ 较不准确的呈现位置。</span><span class="sxs-lookup"><span data-stu-id="10b38-124">However, if the message store must generate its own version of **PR_BODY** because it only saves **PR_RTF_COMPRESSED**, it is probable that the rendering positions will be somewhat inaccurate.</span></span> <span data-ttu-id="10b38-125">这是由于在客户端和消息存储提供程序生成的**PR_BODY**属性的方式的差异。</span><span class="sxs-lookup"><span data-stu-id="10b38-125">This is because of the differences in the way that clients and message store providers generate the **PR_BODY** property.</span></span> 
  
<span data-ttu-id="10b38-126">若要计算的准确**PR_RENDERING_POSITION**值，RTF 感知的存储，请使用带格式文本中嵌入的标记。</span><span class="sxs-lookup"><span data-stu-id="10b38-126">To calculate an accurate **PR_RENDERING_POSITION** value, an RTF-aware store uses a tag embedded in the formatted text.</span></span> <span data-ttu-id="10b38-127">**RTFSync**的实用工具函数可调用它以执行此计算并更新附件的呈现位置。</span><span class="sxs-lookup"><span data-stu-id="10b38-127">The utility function **RTFSync** can be called to perform this calculation and update an attachment's rendering position.</span></span> <span data-ttu-id="10b38-128">根据可用的状态信息量，消息存储库可以向[RTFSync](rtfsync.md)传递 RTF_SYNC_BODY_CHANGED、 RTF_SYNC_RTF_CHANGED 或二者的值。</span><span class="sxs-lookup"><span data-stu-id="10b38-128">Depending on the amount of state information available, the message store can pass either RTF_SYNC_BODY_CHANGED, RTF_SYNC_RTF_CHANGED, or both values to [RTFSync](rtfsync.md).</span></span>
  

