---
title: MAPI 自定义表单对象
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 306d62b1-d541-4039-9759-3903f62e0f26
description: 上次修改时间：2015 年 3 月 9 日
ms.openlocfilehash: 4c1c04e5b04be9bb67b050f5cf498be89d380410
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/23/2019
ms.locfileid: "32318242"
---
# <a name="mapi-custom-form-objects"></a>MAPI 自定义表单对象
  
**适用于**：Outlook 2013 | Outlook 2016 
  
自定义窗体的对象由三个不同的组件实现:
  
- 表单服务器。
    
- 表单库提供程序。
    
- 表单查看器。
    
表单服务器在功能上类似于 OLE 复合文档对象应用程序。 它是一个实现表单的可执行组件;它控制其显示和用户可以执行的操作。 当用户想要查看的邮件与使用窗体服务器支持的窗体显示的邮件类一起使用时, MAPI 将在请求时启动表单服务器。 表单服务器实现三个对象: 一个类似于标准 OLE 类工厂的窗体工厂对象、用于处理表单特定事件的窗体建议接收器以及窗体本身。 
  
表单库提供程序为客户端提供对表单属性集的访问权限, 并向其容器以及将特定类的邮件链接到可以打开该类的窗体的对象的对象。 表单库提供程序实现三个对象: 表单信息对象、表单容器和表单管理器, 用于根据邮件的类将邮件绑定到相应的表单服务器。
  
表单查看器是支持在其文件夹查看器中显示自定义窗体的客户端中包含的组件。 表单查看器不是独立的 MAPI 组件, 表单库提供程序和表单服务器。 表单查看器启动表单服务器并为其提供上下文。 表单查看器实现三个对象: 邮件网站、视图上下文和用于处理特定于视图的事件的通知接收器。
  
下表介绍了所有的自定义窗体对象。 
  
|**Form 对象**|**Description**|
|:-----|:-----|
|窗体  <br/> |控制用于查看特定类的邮件的自定义窗体的显示和操作。  <br/> |
|表单建议接收器  <br/> |处理来自表单查看器的通知。  <br/> |
|表单工厂  <br/> |创建窗体的实例, 并允许其服务器保留在内存中。  <br/> |
|表单容器  <br/> |包含窗体信息。  <br/> |
|表单信息  <br/> |包含邮件和其他消息容器。  <br/> |
|表单管理器  <br/> |提供对与所有已安装的表单相关的自定义表单信息的集成视图的访问。 还匹配具有相应窗体类标识符的邮件类。  <br/> |
|消息网站  <br/> |处理表单对象在客户端中的操作, 并提供对表单管理器对象的访问权限。  <br/> |
|查看上下文  <br/> |支持用于激活下一和上一封邮件以及保存或打印的表单命令。  <br/> |
|查看建议接收器  <br/> |处理来自表单服务器的通知。  <br/> |
   
下面的插图显示自定义窗体组件、它们实现的对象和接口以及对象的用户的组件之间的关系。 请注意, 与大多数其他 MAPI 对象不同的是, form 对象实现了与直接继承不相关的两个接口。 当对象公开多个独立接口时, 具有指向其中一个接口的指针的对象的用户可以检索指向任何其他接口的指针。 在对象的接口实现之间导航的这一能力是[IUnknown:: QueryInterface](https://msdn.microsoft.com/library/54d5ff80-18db-43f2-b636-f93ac053146d%28Office.15%29.aspx)方法的一项功能。 
  
**自定义表单组件**
  
![自定义窗体组件](media/amapi_67.gif "自定义窗体组件")
  
## <a name="see-also"></a>另请参阅

- [MAPI 对象和接口概述](mapi-object-and-interface-overview.md)

