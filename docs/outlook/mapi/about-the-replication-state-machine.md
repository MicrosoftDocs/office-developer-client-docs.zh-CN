---
title: 关于复制状态机
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
ms.assetid: cf36c6cb-57b4-7b2b-e23d-e0bc8696de96
description: 上次修改时间：2015 年 3 月 9 日
ms.openlocfilehash: a0644e4bf5c6847d61cc59e203d50f61ad142e84
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/23/2019
ms.locfileid: "32329748"
---
# <a name="about-the-replication-state-machine"></a><span data-ttu-id="fa5e4-103">关于复制状态机</span><span class="sxs-lookup"><span data-stu-id="fa5e4-103">About the Replication State Machine</span></span>

  
  
<span data-ttu-id="fa5e4-104">**适用于**：Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="fa5e4-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="fa5e4-105">本主题包含 microsoft outlook 2013 和 microsoft outlook 2010 数据复制的状态计算机的概述。</span><span class="sxs-lookup"><span data-stu-id="fa5e4-105">This topic contains an overview of the state machine for Microsoft Outlook 2013 and Microsoft Outlook 2010 data replication.</span></span>
  
> [!NOTE]
> <span data-ttu-id="fa5e4-106">必须按照本主题中的说明完全实现复制 API, 以便对其有用或受支持。</span><span class="sxs-lookup"><span data-stu-id="fa5e4-106">The Replication API must be fully implemented according to the instructions in this topic in order to be useful or supported.</span></span> <span data-ttu-id="fa5e4-107">复制 API 仅可用于从服务器复制 outlook 2013 或 outlook 2010 更改。</span><span class="sxs-lookup"><span data-stu-id="fa5e4-107">The Replication API is available exclusively to replicate Outlook 2013 or Outlook 2010 changes to and from a server.</span></span> 
  
## <a name="iostx-and-the-state-machine"></a><span data-ttu-id="fa5e4-108">IOSTX 和状态机</span><span class="sxs-lookup"><span data-stu-id="fa5e4-108">IOSTX and the State Machine</span></span>

<span data-ttu-id="fa5e4-109">客户端调用**[IOSTX:: SyncBeg](iostx-syncbeg.md)**, **[IOSTX:: SyncEnd](iostx-syncend.md)**, **[IOSTX:: SyncHdrBeg](iostx-synchdrbeg.md)**, and **[IOSTX:: SyncHdrEnd](iostx-synchdrend.md)** in sequence, 以在本地存储和服务器之间同步 outlook 2013 或 outlook 2010 文件夹和项目。</span><span class="sxs-lookup"><span data-stu-id="fa5e4-109">A client calls **[IOSTX::SyncBeg](iostx-syncbeg.md)**, **[IOSTX::SyncEnd](iostx-syncend.md)**, **[IOSTX::SyncHdrBeg](iostx-synchdrbeg.md)**, and **[IOSTX::SyncHdrEnd](iostx-synchdrend.md)** in a sequence to synchronize Outlook 2013 or Outlook 2010 folders and items between a local store and a server.</span></span> <span data-ttu-id="fa5e4-110">实际调用顺序取决于需要复制的数据 (例如, outlook 2013 或 outlook 2010 文件夹的层次结构、outlook 2013 或 outlook 2010 文件夹、邮件项目、日历项等) 以及同步的方向 (无论将本地存储中的上传到服务器, 或从服务器下载到本地存储区)。</span><span class="sxs-lookup"><span data-stu-id="fa5e4-110">The actual sequence of calls depends on the data that needs to be replicated (for example, a hierarchy of Outlook 2013 or Outlook 2010 folders, an Outlook 2013 or Outlook 2010 folder, mail items, calendar items, and so on) and the direction of synchronization (whether uploading from the local store to the server, or downloading from the server to the local store).</span></span> <span data-ttu-id="fa5e4-111">下面是典型的呼叫序列:</span><span class="sxs-lookup"><span data-stu-id="fa5e4-111">Here is a typical sequence of calls:</span></span> 
  
1. <span data-ttu-id="fa5e4-112">客户端调用**IOSTX:: SyncBeg**开始进行复制, 同时指定状态标识符和指向相应数据结构的地址的指针。</span><span class="sxs-lookup"><span data-stu-id="fa5e4-112">The client calls **IOSTX::SyncBeg** to begin replication, specifying a state identifier and a pointer to an address of a corresponding data structure.</span></span> 
    
2. <span data-ttu-id="fa5e4-113">outlook 2013 或 outlook 2010 分配数据结构, 并使用客户端所需的信息初始化数据结构。</span><span class="sxs-lookup"><span data-stu-id="fa5e4-113">Outlook 2013 or Outlook 2010 allocates the data structure and initializes the data structure with the necessary information for the client.</span></span> 
    
3. <span data-ttu-id="fa5e4-114">客户端执行复制, 更新数据结构以传达给本地存储有关复制的所有必要信息。</span><span class="sxs-lookup"><span data-stu-id="fa5e4-114">The client performs the replication, updating the data structure to convey to the local store any necessary information about the replication.</span></span>
    
4. <span data-ttu-id="fa5e4-115">在执行复制之后, 客户端会调用**[IOSTX:: SetSyncResult](iostx-setsyncresult.md)** 和**IOSTX:: SyncEnd** , 以通知本地存储完成特定复制。</span><span class="sxs-lookup"><span data-stu-id="fa5e4-115">After performing the replication, the client calls **[IOSTX::SetSyncResult](iostx-setsyncresult.md)** and **IOSTX::SyncEnd** to notify the local store of the completion of the specific replication.</span></span> 
    
> [!NOTE]
> <span data-ttu-id="fa5e4-116">客户端始终调用**IOSTX:: SyncEnd**结束客户端已在某个特定状态中开始的复制。</span><span class="sxs-lookup"><span data-stu-id="fa5e4-116">The client always calls **IOSTX::SyncEnd** to end a replication that the client has begun for a certain state.</span></span> <span data-ttu-id="fa5e4-117">根据客户端需要同步的总体数据, 客户端可以调用**IOSTX:: SyncBeg**和**IOSTX:: SyncEnd**多次的一对调用。</span><span class="sxs-lookup"><span data-stu-id="fa5e4-117">Depending on the overall data that the client needs to synchronize, the client may call the pair of calls **IOSTX::SyncBeg** and **IOSTX::SyncEnd** more than once.</span></span> 
  
## <a name="state-table"></a><span data-ttu-id="fa5e4-118">状态表</span><span class="sxs-lookup"><span data-stu-id="fa5e4-118">State Table</span></span>

> [!NOTE]
> <span data-ttu-id="fa5e4-119">下表列出了复制状态机中的所有有效状态, 以及相应的状态标识符和数据结构。</span><span class="sxs-lookup"><span data-stu-id="fa5e4-119">The following table lists all the valid states in the replication state machine, along with the corresponding state identifiers and data structures.</span></span> <span data-ttu-id="fa5e4-120">在 "**数据已复制**" 列中, "items" 一词包括邮件、日历、联系人、便笺、日记和任务项。</span><span class="sxs-lookup"><span data-stu-id="fa5e4-120">In the **Data Replicated** column, the term "items" includes mail, calendar, contact, note, journal, and task items.</span></span> <span data-ttu-id="fa5e4-121">将更改从本地存储复制到服务器时, 请使用状态标识符指定 "上传" 和带有 "UP" 前缀的数据结构 (例如, **LR_SYNC_UPLOAD_HIERARCHY**和**[UPHIER](uphier.md)** )。</span><span class="sxs-lookup"><span data-stu-id="fa5e4-121">When replicating changes from the local store to the server, use state identifiers specifying "UPLOAD" and data structures with the "UP" prefix (for example, **LR_SYNC_UPLOAD_HIERARCHY** and **[UPHIER](uphier.md)** ).</span></span> <span data-ttu-id="fa5e4-122">将更改从服务器复制到本地存储时, 请使用指定 "下载" 的状态标识符和包含 "DN" 前缀的数据结构 (例如, **LR_SYNC_DOWNLOAD_HIERARCHY**和**[DNHIER](dnhier.md)** )。</span><span class="sxs-lookup"><span data-stu-id="fa5e4-122">When replicating changes from the server to the local store, use state identifiers specifying "DOWNLOAD" and data structures with the "DN" prefix (for example, **LR_SYNC_DOWNLOAD_HIERARCHY** and **[DNHIER](dnhier.md)** ).</span></span> 
  
|||||
|:-----|:-----|:-----|:-----|
|<span data-ttu-id="fa5e4-123">**State**</span><span class="sxs-lookup"><span data-stu-id="fa5e4-123">**State**</span></span> <br/> |<span data-ttu-id="fa5e4-124">**复制的数据**</span><span class="sxs-lookup"><span data-stu-id="fa5e4-124">**Data Replicated**</span></span> <br/> |<span data-ttu-id="fa5e4-125">**状态标识符**</span><span class="sxs-lookup"><span data-stu-id="fa5e4-125">**State Identifier**</span></span> <br/> |<span data-ttu-id="fa5e4-126">**数据结构**</span><span class="sxs-lookup"><span data-stu-id="fa5e4-126">**Data Structure**</span></span> <br/> |
|[<span data-ttu-id="fa5e4-127">空闲状态</span><span class="sxs-lookup"><span data-stu-id="fa5e4-127">Idle state</span></span>](idle-state.md) <br/> | <span data-ttu-id="fa5e4-128">*None*</span><span class="sxs-lookup"><span data-stu-id="fa5e4-128">*None*</span></span>  <br/> |<span data-ttu-id="fa5e4-129">**LR_SYNC_IDLE**</span><span class="sxs-lookup"><span data-stu-id="fa5e4-129">**LR_SYNC_IDLE**</span></span> <br/> | <span data-ttu-id="fa5e4-130">*None*</span><span class="sxs-lookup"><span data-stu-id="fa5e4-130">*None*</span></span>  <br/> |
|[<span data-ttu-id="fa5e4-131">同步状态</span><span class="sxs-lookup"><span data-stu-id="fa5e4-131">Synchronize state</span></span>](synchronize-state.md) <br/> |<span data-ttu-id="fa5e4-132">文件夹或项目</span><span class="sxs-lookup"><span data-stu-id="fa5e4-132">Folders or items</span></span>  <br/> |<span data-ttu-id="fa5e4-133">**LR_SYNC**</span><span class="sxs-lookup"><span data-stu-id="fa5e4-133">**LR_SYNC**</span></span> <br/> |<span data-ttu-id="fa5e4-134">**[同步](sync.md)**</span><span class="sxs-lookup"><span data-stu-id="fa5e4-134">**[SYNC](sync.md)**</span></span> <br/> |
|[<span data-ttu-id="fa5e4-135">上传层次结构状态</span><span class="sxs-lookup"><span data-stu-id="fa5e4-135">Upload hierarchy state</span></span>](upload-hierarchy-state.md) <br/> |<span data-ttu-id="fa5e4-136">文件夹</span><span class="sxs-lookup"><span data-stu-id="fa5e4-136">Folders</span></span>  <br/> |<span data-ttu-id="fa5e4-137">**LR_SYNC_UPLOAD_HIERARCHY**</span><span class="sxs-lookup"><span data-stu-id="fa5e4-137">**LR_SYNC_UPLOAD_HIERARCHY**</span></span> <br/> |<span data-ttu-id="fa5e4-138">**[UPHIER](uphier.md)**</span><span class="sxs-lookup"><span data-stu-id="fa5e4-138">**[UPHIER](uphier.md)**</span></span> <br/> |
|[<span data-ttu-id="fa5e4-139">上传文件夹状态</span><span class="sxs-lookup"><span data-stu-id="fa5e4-139">Upload folder state</span></span>](upload-folder-state.md) <br/> |<span data-ttu-id="fa5e4-140">Folder</span><span class="sxs-lookup"><span data-stu-id="fa5e4-140">Folder</span></span>  <br/> |<span data-ttu-id="fa5e4-141">**LR_SYNC_UPLOAD_FOLDER**</span><span class="sxs-lookup"><span data-stu-id="fa5e4-141">**LR_SYNC_UPLOAD_FOLDER**</span></span> <br/> |<span data-ttu-id="fa5e4-142">**[UPFLD](upfld.md)**</span><span class="sxs-lookup"><span data-stu-id="fa5e4-142">**[UPFLD](upfld.md)**</span></span> <br/> |
|[<span data-ttu-id="fa5e4-143">同步内容状态</span><span class="sxs-lookup"><span data-stu-id="fa5e4-143">Synchronize contents state</span></span>](synchronize-contents-state.md) <br/> |<span data-ttu-id="fa5e4-144">项目数</span><span class="sxs-lookup"><span data-stu-id="fa5e4-144">Items</span></span>  <br/> |<span data-ttu-id="fa5e4-145">**LR_SYNC_CONTENTS**</span><span class="sxs-lookup"><span data-stu-id="fa5e4-145">**LR_SYNC_CONTENTS**</span></span> <br/> |<span data-ttu-id="fa5e4-146">**[SYNCCONT](synccont.md)**</span><span class="sxs-lookup"><span data-stu-id="fa5e4-146">**[SYNCCONT](synccont.md)**</span></span> <br/> |
|[<span data-ttu-id="fa5e4-147">上传表状态</span><span class="sxs-lookup"><span data-stu-id="fa5e4-147">Upload table state</span></span>](upload-table-state.md) <br/> |<span data-ttu-id="fa5e4-148">项目数</span><span class="sxs-lookup"><span data-stu-id="fa5e4-148">Items</span></span>  <br/> |<span data-ttu-id="fa5e4-149">**LR_SYNC_UPLOAD_TABLE**</span><span class="sxs-lookup"><span data-stu-id="fa5e4-149">**LR_SYNC_UPLOAD_TABLE**</span></span> <br/> |<span data-ttu-id="fa5e4-150">**[UPTBL](uptbl.md)**</span><span class="sxs-lookup"><span data-stu-id="fa5e4-150">**[UPTBL](uptbl.md)**</span></span> <br/> |
|[<span data-ttu-id="fa5e4-151">上传邮件状态</span><span class="sxs-lookup"><span data-stu-id="fa5e4-151">Upload message state</span></span>](upload-message-state.md) <br/> |<span data-ttu-id="fa5e4-152">Item</span><span class="sxs-lookup"><span data-stu-id="fa5e4-152">Item</span></span>  <br/> |<span data-ttu-id="fa5e4-153">**LR_SYNC_UPLOAD_MESSAGE**</span><span class="sxs-lookup"><span data-stu-id="fa5e4-153">**LR_SYNC_UPLOAD_MESSAGE**</span></span> <br/> |<span data-ttu-id="fa5e4-154">**[UPMSG](upmsg.md)**</span><span class="sxs-lookup"><span data-stu-id="fa5e4-154">**[UPMSG](upmsg.md)**</span></span> <br/> |
|[<span data-ttu-id="fa5e4-155">上载读取状态状态</span><span class="sxs-lookup"><span data-stu-id="fa5e4-155">Upload read status state</span></span>](upload-read-status-state.md) <br/> |<span data-ttu-id="fa5e4-156">项目数</span><span class="sxs-lookup"><span data-stu-id="fa5e4-156">Items</span></span>  <br/> |<span data-ttu-id="fa5e4-157">**LR_SYNC_UPLOAD_MESSAGE_READ**</span><span class="sxs-lookup"><span data-stu-id="fa5e4-157">**LR_SYNC_UPLOAD_MESSAGE_READ**</span></span> <br/> |<span data-ttu-id="fa5e4-158">**[UPREAD](upread.md)**</span><span class="sxs-lookup"><span data-stu-id="fa5e4-158">**[UPREAD](upread.md)**</span></span> <br/> |
|[<span data-ttu-id="fa5e4-159">上传删除状态状态</span><span class="sxs-lookup"><span data-stu-id="fa5e4-159">Upload delete status state</span></span>](upload-delete-status-state.md) <br/> |<span data-ttu-id="fa5e4-160">项目数</span><span class="sxs-lookup"><span data-stu-id="fa5e4-160">Items</span></span>  <br/> |<span data-ttu-id="fa5e4-161">**LR_SYNC_UPLOAD_MESSAGE_DEL**</span><span class="sxs-lookup"><span data-stu-id="fa5e4-161">**LR_SYNC_UPLOAD_MESSAGE_DEL**</span></span> <br/> |<span data-ttu-id="fa5e4-162">**[UPDEL](updel.md)**</span><span class="sxs-lookup"><span data-stu-id="fa5e4-162">**[UPDEL](updel.md)**</span></span> <br/> |
|[<span data-ttu-id="fa5e4-163">下载层次结构状态</span><span class="sxs-lookup"><span data-stu-id="fa5e4-163">Download hierarchy state</span></span>](download-hierarchy-state.md) <br/> |<span data-ttu-id="fa5e4-164">文件夹</span><span class="sxs-lookup"><span data-stu-id="fa5e4-164">Folders</span></span>  <br/> |<span data-ttu-id="fa5e4-165">**LR_SYNC_DOWNLOAD_HIERARCHY**</span><span class="sxs-lookup"><span data-stu-id="fa5e4-165">**LR_SYNC_DOWNLOAD_HIERARCHY**</span></span> <br/> |<span data-ttu-id="fa5e4-166">**[DNHIER](dnhier.md)**</span><span class="sxs-lookup"><span data-stu-id="fa5e4-166">**[DNHIER](dnhier.md)**</span></span> <br/> |
|[<span data-ttu-id="fa5e4-167">下载表状态</span><span class="sxs-lookup"><span data-stu-id="fa5e4-167">Download table state</span></span>](download-table-state.md) <br/> |<span data-ttu-id="fa5e4-168">项目数</span><span class="sxs-lookup"><span data-stu-id="fa5e4-168">Items</span></span>  <br/> |<span data-ttu-id="fa5e4-169">**LR_SYNC_DOWNLOAD_TABLE**</span><span class="sxs-lookup"><span data-stu-id="fa5e4-169">**LR_SYNC_DOWNLOAD_TABLE**</span></span> <br/> |<span data-ttu-id="fa5e4-170">**[DNTBL](dntbl.md)**</span><span class="sxs-lookup"><span data-stu-id="fa5e4-170">**[DNTBL](dntbl.md)**</span></span> <br/> |
|[<span data-ttu-id="fa5e4-171">下载邮件头状态</span><span class="sxs-lookup"><span data-stu-id="fa5e4-171">Download message header state</span></span>](download-message-header-state.md) <br/> |<span data-ttu-id="fa5e4-172">邮件头</span><span class="sxs-lookup"><span data-stu-id="fa5e4-172">Message header</span></span>  <br/> |<span data-ttu-id="fa5e4-173">**LR_SYNC_DOWNLOAD_HEADER**</span><span class="sxs-lookup"><span data-stu-id="fa5e4-173">**LR_SYNC_DOWNLOAD_HEADER**</span></span> <br/> |<span data-ttu-id="fa5e4-174">**[HDRSYNC](hdrsync.md)**</span><span class="sxs-lookup"><span data-stu-id="fa5e4-174">**[HDRSYNC](hdrsync.md)**</span></span> <br/> |
   
## <a name="state-transition-diagram"></a><span data-ttu-id="fa5e4-175">状态转换关系图</span><span class="sxs-lookup"><span data-stu-id="fa5e4-175">State Transition Diagram</span></span>

<span data-ttu-id="fa5e4-176">下图显示了上载或执行文件夹的完全同步 (下载后再上载) 文件夹或文件夹的内容 (邮件、日历、联系人、便笺、任务或日记项目) 时发生的状态转换。</span><span class="sxs-lookup"><span data-stu-id="fa5e4-176">The following diagram shows the state transitions that occur when uploading or performing a full synchronization (downloading followed by uploading) of folders or contents of folders (mail, calendar, contact, note, task, or journal items).</span></span> 
  
<span data-ttu-id="fa5e4-177">@ @ @ @ @NEED 在此处插入缺少 @ @ @ @ @ @ 的图稿</span><span class="sxs-lookup"><span data-stu-id="fa5e4-177">@@@@@NEED TO INSERT ART HERE THAT IS MISSING@@@@@@</span></span>
  
## <a name="example-uploading-a-folder-hierarchy"></a><span data-ttu-id="fa5e4-178">示例: 上传文件夹层次结构</span><span class="sxs-lookup"><span data-stu-id="fa5e4-178">Example: Uploading a Folder Hierarchy</span></span>

 <span data-ttu-id="fa5e4-179">上载文件夹层次结构时, 将发生以下步骤序列:</span><span class="sxs-lookup"><span data-stu-id="fa5e4-179">When uploading a hierarchy of folders, the following sequence of steps takes place:</span></span> 
  
|||||
|:-----|:-----|:-----|:-----|
|<span data-ttu-id="fa5e4-180">**步骤**</span><span class="sxs-lookup"><span data-stu-id="fa5e4-180">**Step**</span></span> <br/> |<span data-ttu-id="fa5e4-181">**操作**</span><span class="sxs-lookup"><span data-stu-id="fa5e4-181">**Action**</span></span> <br/> |<span data-ttu-id="fa5e4-182">**State**</span><span class="sxs-lookup"><span data-stu-id="fa5e4-182">**State**</span></span> <br/> |<span data-ttu-id="fa5e4-183">**相关数据结构**</span><span class="sxs-lookup"><span data-stu-id="fa5e4-183">**Related Data Structure**</span></span> <br/> |
|<span data-ttu-id="fa5e4-184">1.</span><span class="sxs-lookup"><span data-stu-id="fa5e4-184">1.</span></span>  <br/> |<span data-ttu-id="fa5e4-185">客户端启动使用**IOSTX:: SyncBeg**的层次结构上载。</span><span class="sxs-lookup"><span data-stu-id="fa5e4-185">The client initiates the hierarchy upload with **IOSTX::SyncBeg**.</span></span>  <br/> |<span data-ttu-id="fa5e4-186">**LR_SYNC_UPLOAD_HIERARCHY**</span><span class="sxs-lookup"><span data-stu-id="fa5e4-186">**LR_SYNC_UPLOAD_HIERARCHY**</span></span> <br/> |<span data-ttu-id="fa5e4-187">**UPHIER**</span><span class="sxs-lookup"><span data-stu-id="fa5e4-187">**UPHIER**</span></span> <br/> |
|<span data-ttu-id="fa5e4-188">2.</span><span class="sxs-lookup"><span data-stu-id="fa5e4-188">2.</span></span>  <br/> |<span data-ttu-id="fa5e4-189">outlook 2013 或 outlook 2010 使用客户端的信息填充**UPHIER** 。</span><span class="sxs-lookup"><span data-stu-id="fa5e4-189">Outlook 2013 or Outlook 2010 populates **UPHIER** with information for the client.</span></span> <span data-ttu-id="fa5e4-190">这包括初始化 [out] 参数: *iEnt*设置为 0, 并向层次结构中需要上载的文件夹数*美分*。</span><span class="sxs-lookup"><span data-stu-id="fa5e4-190">This includes initializing the [out] parameters:  *iEnt*  is set to 0, and  *cEnt*  to the number of folders in the hierarchy that needs uploading.</span></span>  <br/> |<span data-ttu-id="fa5e4-191">**LR_SYNC_UPLOAD_HIERARCHY**</span><span class="sxs-lookup"><span data-stu-id="fa5e4-191">**LR_SYNC_UPLOAD_HIERARCHY**</span></span> <br/> |<span data-ttu-id="fa5e4-192">**UPHIER**</span><span class="sxs-lookup"><span data-stu-id="fa5e4-192">**UPHIER**</span></span> <br/> |
|<span data-ttu-id="fa5e4-193">3.</span><span class="sxs-lookup"><span data-stu-id="fa5e4-193">3.</span></span>  <br/> |<span data-ttu-id="fa5e4-194">客户端执行实际的层次结构上载。</span><span class="sxs-lookup"><span data-stu-id="fa5e4-194">The client does the actual hierarchy upload.</span></span> <span data-ttu-id="fa5e4-195">举例来说, 如果*分币*为 10, 则对于10个文件夹中的每个文件夹, 客户端都会调用**IOSTX:: SyncBeg**, 并为上载文件夹指定相应的状态标识符和数据结构。</span><span class="sxs-lookup"><span data-stu-id="fa5e4-195">As an example, if  *cEnt*  is 10, for each of the 10 folders, the client calls **IOSTX::SyncBeg**, specifying the appropriate state identifier and data structure for uploading a folder.</span></span>  <br/> |<span data-ttu-id="fa5e4-196">**LR_SYNC_UPLOAD_FOLDER**</span><span class="sxs-lookup"><span data-stu-id="fa5e4-196">**LR_SYNC_UPLOAD_FOLDER**</span></span> <br/> |<span data-ttu-id="fa5e4-197">**UPFLD**</span><span class="sxs-lookup"><span data-stu-id="fa5e4-197">**UPFLD**</span></span> <br/> |
|<span data-ttu-id="fa5e4-198">4.</span><span class="sxs-lookup"><span data-stu-id="fa5e4-198">4.</span></span>  <br/> |<span data-ttu-id="fa5e4-199">outlook 2013 或 outlook 2010 通过初始化其 [out] 参数 (包括文件夹上载的原因、指向 folder 对象的指针以及文件夹的条目 ID) 来填充**UPFLD** 。</span><span class="sxs-lookup"><span data-stu-id="fa5e4-199">Outlook 2013 or Outlook 2010 populates **UPFLD** by initializing its [out] parameters, including the reason for the folder upload, the pointer to the folder object, and the entry ID for the folder.</span></span>  <br/> |<span data-ttu-id="fa5e4-200">**LR_SYNC_UPLOAD_FOLDER**</span><span class="sxs-lookup"><span data-stu-id="fa5e4-200">**LR_SYNC_UPLOAD_FOLDER**</span></span> <br/> |<span data-ttu-id="fa5e4-201">**UPFLD**</span><span class="sxs-lookup"><span data-stu-id="fa5e4-201">**UPFLD**</span></span> <br/> |
|<span data-ttu-id="fa5e4-202">5.</span><span class="sxs-lookup"><span data-stu-id="fa5e4-202">5.</span></span>  <br/> |<span data-ttu-id="fa5e4-203">客户端上传指定的文件夹。</span><span class="sxs-lookup"><span data-stu-id="fa5e4-203">The client uploads the specified folder.</span></span>  <br/> |<span data-ttu-id="fa5e4-204">**LR_SYNC_UPLOAD_FOLDER**</span><span class="sxs-lookup"><span data-stu-id="fa5e4-204">**LR_SYNC_UPLOAD_FOLDER**</span></span> <br/> |<span data-ttu-id="fa5e4-205">**UPFLD**</span><span class="sxs-lookup"><span data-stu-id="fa5e4-205">**UPFLD**</span></span> <br/> |
|<span data-ttu-id="fa5e4-206">6.</span><span class="sxs-lookup"><span data-stu-id="fa5e4-206">6.</span></span>  <br/> |<span data-ttu-id="fa5e4-207">客户端将完成文件夹上传的完成情况通知本地存储: 成功后, 客户端将**UPFLD**中的 [in] 参数*ulFlags*设置为**UPF_OK**, 然后调用**IOSTX:: SetSyncResult (S_OK)** 和**IOSTX:: SyncEnd**.</span><span class="sxs-lookup"><span data-stu-id="fa5e4-207">The client notifies the local store of the completion of the folder upload: Upon success, the client sets the [in] parameter  *ulFlags*  in **UPFLD** with **UPF_OK**, and then calls **IOSTX::SetSyncResult (S_OK)** and **IOSTX::SyncEnd**.</span></span> <span data-ttu-id="fa5e4-208">出现故障时, 客户端不会使用**UPF_OK**标志设置*ulFlags* 。</span><span class="sxs-lookup"><span data-stu-id="fa5e4-208">Upon failure, the client would not set  *ulFlags*  with the **UPF_OK** flag.</span></span> <span data-ttu-id="fa5e4-209">它调用**IOSTX:: SetSyncResult**, 并传入**HRESULT**值和**IOSTX:: SyncEnd**。</span><span class="sxs-lookup"><span data-stu-id="fa5e4-209">It calls **IOSTX::SetSyncResult**, passing in the **HRESULT** value, and **IOSTX::SyncEnd**.</span></span>  <br/> |<span data-ttu-id="fa5e4-210">**LR_SYNC_UPLOAD_FOLDER**</span><span class="sxs-lookup"><span data-stu-id="fa5e4-210">**LR_SYNC_UPLOAD_FOLDER**</span></span> <br/> |<span data-ttu-id="fa5e4-211">**UPFLD**</span><span class="sxs-lookup"><span data-stu-id="fa5e4-211">**UPFLD**</span></span> <br/> |
|<span data-ttu-id="fa5e4-212">7.</span><span class="sxs-lookup"><span data-stu-id="fa5e4-212">7.</span></span>  <br/> |<span data-ttu-id="fa5e4-213">如果设置了**UPF_OK** , outlook 2013 或 outlook 2010 将清除上传文件夹的内部请求。</span><span class="sxs-lookup"><span data-stu-id="fa5e4-213">If **UPF_OK** is set, Outlook 2013 or Outlook 2010 will clear the internal request for uploading the folder.</span></span> <span data-ttu-id="fa5e4-214">然后, 无论*ulFlags*的状态如何, 它都会清除任何内部簿记信息。</span><span class="sxs-lookup"><span data-stu-id="fa5e4-214">Then regardless of the state of  *ulFlags*  , it will clean up any internal bookkeeping information.</span></span> <span data-ttu-id="fa5e4-215">虽然要上载的层次结构中仍有一些文件夹 (*iEnt*仍小于*分币*), 但客户端和 outlook 2013 或 outlook 2010 重复步骤3到7。</span><span class="sxs-lookup"><span data-stu-id="fa5e4-215">While there are still folders in the hierarchy to upload (*iEnt*  is still less than  *cEnt*), the client and Outlook 2013 or Outlook 2010 repeat steps 3 through 7.</span></span>  <br/> |<span data-ttu-id="fa5e4-216">**LR_SYNC_UPLOAD_FOLDER**</span><span class="sxs-lookup"><span data-stu-id="fa5e4-216">**LR_SYNC_UPLOAD_FOLDER**</span></span> <br/> |<span data-ttu-id="fa5e4-217">**UPFLD**</span><span class="sxs-lookup"><span data-stu-id="fa5e4-217">**UPFLD**</span></span> <br/> |
|<span data-ttu-id="fa5e4-218">8.</span><span class="sxs-lookup"><span data-stu-id="fa5e4-218">8.</span></span>  <br/> |<span data-ttu-id="fa5e4-219">客户端将已完成的层次结构上载通知本地存储: 成功后, 客户端将**UPHIER**中的 [in] 标志设置为**UPH_OK**, 然后调用**IOSTX:: SetSyncResult (S_OK)** 和**IOSTX:: SyncEnd**。</span><span class="sxs-lookup"><span data-stu-id="fa5e4-219">The client notifies the local store of the completion of the hierarchy upload: Upon success, the client sets the [in] flag in **UPHIER** with **UPH_OK**, and then calls **IOSTX::SetSyncResult (S_OK)** and **IOSTX::SyncEnd**.</span></span> <span data-ttu-id="fa5e4-220">出现故障时, 客户端不会设置**UPH_OK**标志。</span><span class="sxs-lookup"><span data-stu-id="fa5e4-220">Upon failure, the client would not set the **UPH_OK** flag.</span></span> <span data-ttu-id="fa5e4-221">它调用**IOSTX:: SetSyncResult**, 并传入**HRESULT**值和**IOSTX:: SyncEnd**。</span><span class="sxs-lookup"><span data-stu-id="fa5e4-221">It calls **IOSTX::SetSyncResult**, passing in the **HRESULT** value, and **IOSTX::SyncEnd**.</span></span>  <br/> |<span data-ttu-id="fa5e4-222">**LR_SYNC_UPLOAD_HIERARCHY**</span><span class="sxs-lookup"><span data-stu-id="fa5e4-222">**LR_SYNC_UPLOAD_HIERARCHY**</span></span> <br/> |<span data-ttu-id="fa5e4-223">**UPHIER**</span><span class="sxs-lookup"><span data-stu-id="fa5e4-223">**UPHIER**</span></span> <br/> |
|<span data-ttu-id="fa5e4-224">9.</span><span class="sxs-lookup"><span data-stu-id="fa5e4-224">9.</span></span>  <br/> |<span data-ttu-id="fa5e4-225">如果设置了**UPH_OK** , outlook 2013 或 outlook 2010 将清除用于上载层次结构的内部请求。</span><span class="sxs-lookup"><span data-stu-id="fa5e4-225">If **UPH_OK** is set, Outlook 2013 or Outlook 2010 will clear the internal request for uploading the hierarchy.</span></span> <span data-ttu-id="fa5e4-226">然后, 无论*ulFlags*的状态如何, 它都会清除任何内部簿记信息。</span><span class="sxs-lookup"><span data-stu-id="fa5e4-226">Then regardless of the state of  *ulFlags*  , it will clean up any internal bookkeeping information.</span></span>  <br/> |<span data-ttu-id="fa5e4-227">**LR_SYNC_UPLOAD_HIERARCHY**</span><span class="sxs-lookup"><span data-stu-id="fa5e4-227">**LR_SYNC_UPLOAD_HIERARCHY**</span></span> <br/> |<span data-ttu-id="fa5e4-228">**UPHIER**</span><span class="sxs-lookup"><span data-stu-id="fa5e4-228">**UPHIER**</span></span> <br/> |
   
## <a name="see-also"></a><span data-ttu-id="fa5e4-229">另请参阅</span><span class="sxs-lookup"><span data-stu-id="fa5e4-229">See also</span></span>



[<span data-ttu-id="fa5e4-230">关于复制 API</span><span class="sxs-lookup"><span data-stu-id="fa5e4-230">About the Replication API</span></span>](about-the-replication-api.md)
  
[<span data-ttu-id="fa5e4-231">MAPI 常量</span><span class="sxs-lookup"><span data-stu-id="fa5e4-231">MAPI Constants</span></span>](mapi-constants.md)
  
[<span data-ttu-id="fa5e4-232">SYNCSTATE</span><span class="sxs-lookup"><span data-stu-id="fa5e4-232">SYNCSTATE</span></span>](syncstate.md)

