---
title: MAPI 消息存储提供程序概述
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: eae44469-b217-4d05-b47f-5a0b1fab7056
description: 上次修改时间： 2011 年 7 月 23 日
ms.openlocfilehash: 5cc8261dfee6803492ffcf62c182930e2ac6d425
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/11/2018
ms.locfileid: "19776275"
---
# <a name="mapi-message-store-provider-overview"></a><span data-ttu-id="56659-103">MAPI 消息存储提供程序概述</span><span class="sxs-lookup"><span data-stu-id="56659-103">MAPI message store provider overview</span></span>
  
<span data-ttu-id="56659-104">**适用于**： Outlook</span><span class="sxs-lookup"><span data-stu-id="56659-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="56659-105">消息存储提供程序处理对存储和检索的邮件和其他用户的客户端应用程序的信息。</span><span class="sxs-lookup"><span data-stu-id="56659-105">Message store providers handle the storage and retrieval of messages and other information for the users of client applications.</span></span> <span data-ttu-id="56659-106">使用称为的消息存储的分层系统，邮件信息的排列方式。</span><span class="sxs-lookup"><span data-stu-id="56659-106">The message information is organized by using a hierarchical system known as a message store.</span></span> <span data-ttu-id="56659-107">消息存储在多个级别实现与名为按住不同类型的邮件的文件夹的容器。</span><span class="sxs-lookup"><span data-stu-id="56659-107">The message store is implemented in multiple levels, with containers called folders holding messages of different types.</span></span> <span data-ttu-id="56659-108">没有为邮件存储区; 中的级别数限制文件夹可以包含很多子文件夹。</span><span class="sxs-lookup"><span data-stu-id="56659-108">There is no limit to the number of levels in a message store; folders can contain many subfolders.</span></span> 
  
<span data-ttu-id="56659-109">下图显示分层消息存储体系结构。</span><span class="sxs-lookup"><span data-stu-id="56659-109">The following illustration shows the hierarchical message store architecture.</span></span>
  
<span data-ttu-id="56659-110">**消息存储体系结构**</span><span class="sxs-lookup"><span data-stu-id="56659-110">**Message store architecture**</span></span>
  
<span data-ttu-id="56659-111">![消息存储体系结构](media/amapi_03.gif "消息存储体系结构")</span><span class="sxs-lookup"><span data-stu-id="56659-111">![Message store architecture](media/amapi_03.gif "Message store architecture")</span></span>
  
<span data-ttu-id="56659-112">下图显示了两个文件夹，其中用子文件夹。</span><span class="sxs-lookup"><span data-stu-id="56659-112">The figure shows two folders, one with a subfolder.</span></span> <span data-ttu-id="56659-113">客户端应用程序用户可以访问的每个文件夹中包含的邮件的摘要视图或单独查看与表单。</span><span class="sxs-lookup"><span data-stu-id="56659-113">Client application users can access a summary view of the messages contained in each folder or view them individually with a form.</span></span> <span data-ttu-id="56659-114">客户端显示 MAPI 提供对标准窗体或自定义窗体的窗体开发人员提供取决于类型或类的邮件。</span><span class="sxs-lookup"><span data-stu-id="56659-114">Whether the client displays a standard form that MAPI supplies or a custom form that a form developer supplies depends on the type, or class, of the message.</span></span> <span data-ttu-id="56659-115">第一个文件夹包含说明消息，并使用 MAPI 标准注意窗体。</span><span class="sxs-lookup"><span data-stu-id="56659-115">The first folder contains note messages and uses the MAPI standard note form.</span></span> <span data-ttu-id="56659-116">第二个文件夹包含库存请求消息，并使用自定义清单窗体。</span><span class="sxs-lookup"><span data-stu-id="56659-116">The second folder contains inventory request messages and uses a custom inventory form.</span></span> <span data-ttu-id="56659-117">两个窗体上的信息代表消息的属性。</span><span class="sxs-lookup"><span data-stu-id="56659-117">The information on both forms represents the properties of the message.</span></span>
  
<span data-ttu-id="56659-118">您可以使用多种方式中的消息存储数据。</span><span class="sxs-lookup"><span data-stu-id="56659-118">You can use message store data in a variety of ways.</span></span> <span data-ttu-id="56659-119">除了使用传统的电子邮件数据，可用于文件夹作为的论坛公共讨论，作为参考文档的库或容器的语音邮件、 日历、 联系人或任务，例如。</span><span class="sxs-lookup"><span data-stu-id="56659-119">In addition to using data for traditional electronic mail, you can use folders as a forum for public discussion, as a repository for reference documents, or as a container for voice mail, calendar, contacts, or tasks, for example.</span></span> <span data-ttu-id="56659-120">单个消息存储可以保留许多类型的信息。</span><span class="sxs-lookup"><span data-stu-id="56659-120">A single message store can hold many types of information.</span></span> <span data-ttu-id="56659-121">多个客户端可以安装相同的消息存储。</span><span class="sxs-lookup"><span data-stu-id="56659-121">Multiple clients can install the same message store.</span></span> <span data-ttu-id="56659-122">这样共享数据，轻松和快速。</span><span class="sxs-lookup"><span data-stu-id="56659-122">This makes the sharing of data easy and fast.</span></span> 
  
<span data-ttu-id="56659-123">消息存储文件夹使您能够进行排序和筛选消息和自定义用户界面中的消息显示。</span><span class="sxs-lookup"><span data-stu-id="56659-123">Message store folders enable you to sort and filter messages and to customize the message display in a user interface.</span></span> <span data-ttu-id="56659-124">指向筛选的邮件保存在名为搜索结果文件夹的特殊文件夹中。</span><span class="sxs-lookup"><span data-stu-id="56659-124">Links to filtered messages are held in special folders called search-results folders.</span></span> <span data-ttu-id="56659-125">客户端应用程序的用户输入筛选条件，其中 MAPI 指限制和条件应用于一个或多个文件夹中存储的消息。</span><span class="sxs-lookup"><span data-stu-id="56659-125">The user of a client application enters filtering criteria, which MAPI refers to as a restriction, and the criteria is applied to the messages stored in one or more folders.</span></span> <span data-ttu-id="56659-126">例如，用户可能想要查看的处理特定主题和已到达日期晚于上一周的邮件。</span><span class="sxs-lookup"><span data-stu-id="56659-126">For example, a user might want to view only those messages that deal with a particular subject and have arrival dates that are more recent than last week.</span></span> <span data-ttu-id="56659-127">在搜索文件夹中，列出引用符合条件的邮件和实际的邮件保留在其正则文件夹。</span><span class="sxs-lookup"><span data-stu-id="56659-127">References to the messages that match the criteria are listed in the search folder, and the real messages remain in their regular folders.</span></span>
  
<span data-ttu-id="56659-128">邮件是从一个用户或另一个用户或应用程序的应用程序传输的数据的单位。</span><span class="sxs-lookup"><span data-stu-id="56659-128">Messages are the units of data that are transferred from one user or application to another user or application.</span></span> <span data-ttu-id="56659-129">每个邮件包含一些消息文本，与简单或复杂格式和用于传输邮件信封信息。</span><span class="sxs-lookup"><span data-stu-id="56659-129">Every message contains some message text, with simple or complex formatting, and message envelope information that is used for transmission.</span></span> <span data-ttu-id="56659-130">某些消息包括一个或多个附件或其他数据与传输的文件，另一条消息或 OLE 对象形式一条消息。</span><span class="sxs-lookup"><span data-stu-id="56659-130">Some messages include one or more attachments, or additional data related to and transported with a message in the form of a file, another message, or an OLE object.</span></span> 
  
<span data-ttu-id="56659-131">根据邮件存储提供程序，用户可以保存当前的已发送或接收邮件此外编写的新消息。</span><span class="sxs-lookup"><span data-stu-id="56659-131">Depending on the message store provider, a user can save a new message currently being written in addition to messages that have been sent or received.</span></span> <span data-ttu-id="56659-132">消息可以复制或从一个文件夹移动到另一个用成为可复制、 删除或修改单独的单独消息每个副本。</span><span class="sxs-lookup"><span data-stu-id="56659-132">Messages can be copied or moved from one folder to another with each copy becoming a separate message that can be copied, deleted, or modified individually.</span></span> <span data-ttu-id="56659-133">某些消息存储提供程序启用另一个功能是已收到后更改一条消息，并将其存储在其文件夹返回的功能。</span><span class="sxs-lookup"><span data-stu-id="56659-133">Another feature that some message store providers enable is the ability to change a message after it has been received and to store it back in its folder.</span></span> <span data-ttu-id="56659-134">用户可能需要使用此功能的旋转，颠倒传入传真邮件。</span><span class="sxs-lookup"><span data-stu-id="56659-134">A user might take advantage of this feature for rotating a fax message that arrived upside down.</span></span> <span data-ttu-id="56659-135">用户可供以后查看的文件夹中存储的正确的视图。</span><span class="sxs-lookup"><span data-stu-id="56659-135">The user can store the correct view in the folder for later viewing.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="56659-136">另请参阅</span><span class="sxs-lookup"><span data-stu-id="56659-136">See also</span></span>

- [<span data-ttu-id="56659-137">MAPI 功能和体系结构</span><span class="sxs-lookup"><span data-stu-id="56659-137">MAPI Features and Architecture</span></span>](mapi-features-and-architecture.md)

