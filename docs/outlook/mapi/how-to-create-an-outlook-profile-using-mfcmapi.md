---
title: 使用 MFCMAPI 创建 Outlook 配置文件
ms.date: 05/18/2016
ms.audience: Developer
localization_priority: Normal
ms.assetid: 85581bc7-2d81-46af-8836-adef39c933fc
description: MFCMAPI 提供对 MAPI 存储以加快调查的 Exchange 和 Outlook 问题和开发人员提供支持的 MAPI 开发访问。
ms.openlocfilehash: 8df9a4c2783829b7f3540046daecb12ce0b6b86a
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/11/2018
ms.locfileid: "19775094"
---
# <a name="create-an-outlook-profile-using-mfcmapi"></a><span data-ttu-id="95867-103">使用 MFCMAPI 创建 Outlook 配置文件</span><span class="sxs-lookup"><span data-stu-id="95867-103">Create an Outlook profile using MFCMAPI</span></span>

<span data-ttu-id="95867-104">MFCMAPI 提供对 MAPI 存储以加快调查的 Exchange 和 Outlook 问题和开发人员提供支持的 MAPI 开发访问。</span><span class="sxs-lookup"><span data-stu-id="95867-104">MFCMAPI provides access to MAPI stores to facilitate investigation of Exchange and Outlook issues and to provide developers with support for MAPI development.</span></span>

<span data-ttu-id="95867-105">**适用于**：Office 365 | Outlook | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="95867-105">**Applies to**: Office 365 | Outlook | Outlook 2016</span></span> 
  
<span data-ttu-id="95867-106">对于非开发人员，建议使用 Outlook 用户界面创建 Exchange 2013 配置文件。</span><span class="sxs-lookup"><span data-stu-id="95867-106">For non-developers, it is recommended that you use the Outlook user interface to create profiles for Exchange 2013.</span></span>
  
## <a name="configure-an-outlook-profile-using-mfcmapi"></a><span data-ttu-id="95867-107">配置 Outlook 配置文件使用 MFCMAPI</span><span class="sxs-lookup"><span data-stu-id="95867-107">Configure an Outlook profile using MFCMAPI</span></span>

1. <span data-ttu-id="95867-108">打开[MFCMAPI](https://mfcmapi.codeplex.com/)，并在**配置文件**菜单上，单击**显示配置文件**。</span><span class="sxs-lookup"><span data-stu-id="95867-108">Open [MFCMAPI](https://mfcmapi.codeplex.com/), and on the **Profile** menu, click **Show Profiles**.</span></span> 
    
2. <span data-ttu-id="95867-109">在**操作**菜单中，单击**创建配置文件**。</span><span class="sxs-lookup"><span data-stu-id="95867-109">On the **Actions** menu, click **Create Profile**.</span></span> 
    
3. <span data-ttu-id="95867-110">创建配置文件的新名称，然后单击**确定**。</span><span class="sxs-lookup"><span data-stu-id="95867-110">Create a new name for the profile, and then click **OK**.</span></span> 
    
4. <span data-ttu-id="95867-111">右键单击新的配置文件，然后在**服务**菜单上，单击**添加服务**。</span><span class="sxs-lookup"><span data-stu-id="95867-111">Right-click the new profile, and then on the **Services** menu, click **Add Service**.</span></span> 
    
5. <span data-ttu-id="95867-112">取消选中"显示服务 UI"框中，，然后单击**确定**。</span><span class="sxs-lookup"><span data-stu-id="95867-112">Uncheck the"Display Service UI" box, and then click **OK**.</span></span> 
    
6. <span data-ttu-id="95867-113">双击新建配置文件，然后单击**MSEMS**服务。</span><span class="sxs-lookup"><span data-stu-id="95867-113">Double-click the newly created profile, and then click the **MSEMS** service.</span></span> 
    
7. <span data-ttu-id="95867-114">找到 Exchange 配置文件部分。</span><span class="sxs-lookup"><span data-stu-id="95867-114">Locate the Exchange Profile section.</span></span>
    
   <span data-ttu-id="95867-115">这在 Outlook 的 MAPI 中可能有困难，因为在 2010 及以上版本均不再设有全局配置文件部分。</span><span class="sxs-lookup"><span data-stu-id="95867-115">This can be difficult in Outlook's MAPI, since in 2010 and above there is no longer the global profile section.</span></span> <span data-ttu-id="95867-116">要找到配置文件部分，需找到属性 PR_EMSMDB_SECTION_UID (0x3D150102)。</span><span class="sxs-lookup"><span data-stu-id="95867-116">To find the Profile section, find the property PR_EMSMDB_SECTION_UID (0x3D150102).</span></span> <span data-ttu-id="95867-117">该值为配置文件部分的 GUID，采用二进制形式，后续步骤将使用该值。</span><span class="sxs-lookup"><span data-stu-id="95867-117">The value will be the GUID of the profile section persisted in binary form, which will be used in the subsequent steps.</span></span> <span data-ttu-id="95867-118">您将需要在步骤 9 中的此值。</span><span class="sxs-lookup"><span data-stu-id="95867-118">You will need this value in step 9.</span></span>
    
8. <span data-ttu-id="95867-119">双击**MSEMS**服务。</span><span class="sxs-lookup"><span data-stu-id="95867-119">Double-click the **MSEMS** service.</span></span> 
    
9. <span data-ttu-id="95867-120">使用步骤 7 中的 UID 查找**Exchange**配置文件部分，然后单并单击以选择该行。</span><span class="sxs-lookup"><span data-stu-id="95867-120">Find the **Exchange** profile section by using the UID from step 7, and then single-click to select the row.</span></span> 
    
10. <span data-ttu-id="95867-121">在属性菜单中，单击**其他属性**。</span><span class="sxs-lookup"><span data-stu-id="95867-121">On the Property menu, click **Additional Properties**.</span></span> 
    
11. <span data-ttu-id="95867-122">单击**添加**，然后添加以下属性：</span><span class="sxs-lookup"><span data-stu-id="95867-122">Click **Add**, and then add the following properties:</span></span> 
    
    <span data-ttu-id="95867-123">**为 Outlook 2016**:`PR_PROFILE_USER_SMTP_EMAIL_ADDRESS_W (0x6641001F)`和`PR_DISPLAY_NAME_W`</span><span class="sxs-lookup"><span data-stu-id="95867-123">**For Outlook 2016**: `PR_PROFILE_USER_SMTP_EMAIL_ADDRESS_W (0x6641001F)` and `PR_DISPLAY_NAME_W`</span></span>
    
    <span data-ttu-id="95867-124">**为 Outlook for Office 365**: `PR_PROFILE_UNRESOLVED_NAME`， `PR_PROFILE_UNRESOLVED_SERVER`， `PR_ROH_PROXY_SERVER`， `PR_ROH_FLAGS`， `PR_ROH_PROXY_AUTH_SCHEME`， `PR_PROFILE_AUTH_PACKAGE`，和`PR_ROH_PROXY_PRINCIPAL_NAME`</span><span class="sxs-lookup"><span data-stu-id="95867-124">**For Outlook for Office 365**: `PR_PROFILE_UNRESOLVED_NAME`, `PR_PROFILE_UNRESOLVED_SERVER`, `PR_ROH_PROXY_SERVER`, `PR_ROH_FLAGS`, `PR_ROH_PROXY_AUTH_SCHEME`, `PR_PROFILE_AUTH_PACKAGE`, and `PR_ROH_PROXY_PRINCIPAL_NAME`</span></span> 
    
    <span data-ttu-id="95867-125">**Exchange 2013**: `PR_PROFILE_UNRESOLVED_NAME`， `PR_PROFILE_UNRESOLVED_SERVER`， `PR_ROH_PROXY_SERVER`， `PR_ROH_FLAGS`， `PR_ROH_PROXY_AUTH_SCHEME`，和`PR_PROFILE_AUTH_PACKAGE`。</span><span class="sxs-lookup"><span data-stu-id="95867-125">**For Exchange 2013**: `PR_PROFILE_UNRESOLVED_NAME`, `PR_PROFILE_UNRESOLVED_SERVER`, `PR_ROH_PROXY_SERVER`, `PR_ROH_FLAGS`, `PR_ROH_PROXY_AUTH_SCHEME`, and `PR_PROFILE_AUTH_PACKAGE`.</span></span> 
    
12. <span data-ttu-id="95867-126">单击**确定**，然后配置根据下表根据您要连接到的版本的每个属性。</span><span class="sxs-lookup"><span data-stu-id="95867-126">Click **OK**, and then configure each property according to the table below, depending on the version you are connecting to.</span></span> 
    
13. <span data-ttu-id="95867-127">在**会话**菜单上，单击**登录和显示存储**和 （如果尚未选中），然后选择的配置文件。</span><span class="sxs-lookup"><span data-stu-id="95867-127">On the **Session** menu, click **Logon and Display Store**, and then select the profile (if it is not already selected).</span></span> 
    
### <a name="outlook-2016"></a><span data-ttu-id="95867-128">Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="95867-128">Outlook 2016</span></span>
  
||||
|:-----|:-----|:-----|
|<span data-ttu-id="95867-129">**属性**</span><span class="sxs-lookup"><span data-stu-id="95867-129">**Property**</span></span> <br/> |<span data-ttu-id="95867-130">**Tag**</span><span class="sxs-lookup"><span data-stu-id="95867-130">**Tag**</span></span> <br/> |<span data-ttu-id="95867-131">**说明**</span><span class="sxs-lookup"><span data-stu-id="95867-131">**Description**</span></span> <br/> |
| <span data-ttu-id="95867-132">PR_PROFILE_USER_SMTP_EMAIL_ADDRESS_W</span><span class="sxs-lookup"><span data-stu-id="95867-132">PR_PROFILE_USER_SMTP_EMAIL_ADDRESS_W</span></span>  <br/> |<span data-ttu-id="95867-133">0x6641001F</span><span class="sxs-lookup"><span data-stu-id="95867-133">0x6641001F</span></span>  <br/> |<span data-ttu-id="95867-134">用户的 SMTP 地址</span><span class="sxs-lookup"><span data-stu-id="95867-134">SMTP Address of the user</span></span>  <br/> |
|<span data-ttu-id="95867-135">PR_DISPLAY_NAME_W</span><span class="sxs-lookup"><span data-stu-id="95867-135">PR_DISPLAY_NAME_W</span></span>  <br/> |<span data-ttu-id="95867-136">0x3001001F</span><span class="sxs-lookup"><span data-stu-id="95867-136">0x3001001F</span></span>  <br/> |<span data-ttu-id="95867-137">用户的显示名称</span><span class="sxs-lookup"><span data-stu-id="95867-137">The display name of the user</span></span>  <br/> |
|<span data-ttu-id="95867-138">PR_STORE_PROVIDERS</span><span class="sxs-lookup"><span data-stu-id="95867-138">PR_STORE_PROVIDERS</span></span>  <br/> |<span data-ttu-id="95867-139">0x3D000102</span><span class="sxs-lookup"><span data-stu-id="95867-139">0x3D000102</span></span>  <br/> |<span data-ttu-id="95867-140">配置位于**EMSMDB**部分中，此属性的值和更新的匹配属性的相应 UID</span><span class="sxs-lookup"><span data-stu-id="95867-140">Configure the value of this property, located in the **EMSMDB** section, and update the corresponding UID for the matching property</span></span>  <br/> |
   
### <a name="outlook-for-office-365"></a><span data-ttu-id="95867-141">Office 365 的 outlook</span><span class="sxs-lookup"><span data-stu-id="95867-141">Outlook for Office 365</span></span>
  
||||
|:-----|:-----|:-----|
|<span data-ttu-id="95867-142">**属性**</span><span class="sxs-lookup"><span data-stu-id="95867-142">**Property**</span></span> <br/> |<span data-ttu-id="95867-143">**值**</span><span class="sxs-lookup"><span data-stu-id="95867-143">**Value**</span></span> <br/> |<span data-ttu-id="95867-144">**说明**</span><span class="sxs-lookup"><span data-stu-id="95867-144">**Description**</span></span> <br/> |
|<span data-ttu-id="95867-145">PR_PROFILE_UNRESOLVED_NAME<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="95867-145">PR_PROFILE_UNRESOLVED_NAME<sup>1</sup></span></span> <br/> |<span data-ttu-id="95867-146">邮箱别名</span><span class="sxs-lookup"><span data-stu-id="95867-146">mailbox alias</span></span>  <br/> |<span data-ttu-id="95867-147">目标邮箱中; 的别名例如，管理员</span><span class="sxs-lookup"><span data-stu-id="95867-147">The alias for the target mailbox; for example, Administrator</span></span>  <br/> |
|<span data-ttu-id="95867-148">PR_PROFILE_UNRESOLVED_SERVER<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="95867-148">PR_PROFILE_UNRESOLVED_SERVER<sup>1</sup></span></span> <br/> |<span data-ttu-id="95867-149">个性化的服务器 id</span><span class="sxs-lookup"><span data-stu-id="95867-149">personalized server id</span></span>  <br/> |<span data-ttu-id="95867-150">检索从**自动发现**的值。</span><span class="sxs-lookup"><span data-stu-id="95867-150">The value retrieved from **Autodiscover**.</span></span> <span data-ttu-id="95867-151">格式<guid>@tenant.onmicrosoft.com;例如，F5FA2827-5978-43cd-8FA8-E07BC3BB5591@contoso.onmicrosoft.com</span><span class="sxs-lookup"><span data-stu-id="95867-151">in the format <guid>@tenant.onmicrosoft.com; for example, F5FA2827-5978-43cd-8FA8-E07BC3BB5591@contoso.onmicrosoft.com</span></span>  <br/>  <span data-ttu-id="95867-152">*自动发现节点*： 响应/帐户/协议/服务器 (EXCH)</span><span class="sxs-lookup"><span data-stu-id="95867-152">*Autodiscover Node*  : Response/Account/Protocol/Server (EXCH)</span></span>  <br/> |
|<span data-ttu-id="95867-153">PR_ROH_PROXY_SERVER</span><span class="sxs-lookup"><span data-stu-id="95867-153">PR_ROH_PROXY_SERVER</span></span>  <br/> |<span data-ttu-id="95867-154">outlook.office365.com</span><span class="sxs-lookup"><span data-stu-id="95867-154">outlook.office365.com</span></span>  <br/> | <span data-ttu-id="95867-155">*自动发现节点*： 响应/帐户/协议/服务器 (EXPR) <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="95867-155">*Autodiscover Node*  : Response/Account/Protocol/Server (EXPR) <sup>2</sup></span></span> <br/> |
|<span data-ttu-id="95867-156">PR_ROH_FLAGS</span><span class="sxs-lookup"><span data-stu-id="95867-156">PR_ROH_FLAGS</span></span>  <br/> |<span data-ttu-id="95867-157">ROHFLAGS_USE_ROH (0X1)</span><span class="sxs-lookup"><span data-stu-id="95867-157">ROHFLAGS_USE_ROH (0x1)</span></span>  <br/> <span data-ttu-id="95867-158">ROH_FLAGS_USE_SSL (0X2)</span><span class="sxs-lookup"><span data-stu-id="95867-158">ROH_FLAGS_USE_SSL (0x2)</span></span>  <br/>  <span data-ttu-id="95867-159">ROHFLAGS_MUTUAL_AUTH (0X4)</span><span class="sxs-lookup"><span data-stu-id="95867-159">ROHFLAGS_MUTUAL_AUTH (0x4)</span></span>  <br/>  <span data-ttu-id="95867-160">ROHFLAGS_HTTP_FIRST_ON_FAST (0X8)</span><span class="sxs-lookup"><span data-stu-id="95867-160">ROHFLAGS_HTTP_FIRST_ON_FAST (0x8)</span></span>  <br/>  <span data-ttu-id="95867-161">ROHFLAGS_HTTP_FIRST_ON_SLOW (0X20)</span><span class="sxs-lookup"><span data-stu-id="95867-161">ROHFLAGS_HTTP_FIRST_ON_SLOW (0x20)</span></span>  <br/> |<span data-ttu-id="95867-162">包含 Outlook 用于使用远程过程调用 (RPC) 通过超文本传输协议 (HTTP) 连接到 Microsoft Exchange Server 配置文件中的设置。</span><span class="sxs-lookup"><span data-stu-id="95867-162">Contains the settings in a profile used by Outlook to connect to Microsoft Exchange Server by using a remote procedure call (RPC) over Hypertext Transfer Protocol (HTTP).</span></span> <span data-ttu-id="95867-163">*自动发现节点*： 响应/帐户/协议/SSL (EXPR) <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="95867-163">*Autodiscover Node*  : Response/Account/Protocol/SSL (EXPR) <sup>2</sup></span></span> <br/> |
| <span data-ttu-id="95867-164">PR_ROH_PROXY_AUTH_SCHEME</span><span class="sxs-lookup"><span data-stu-id="95867-164">PR_ROH_PROXY_AUTH_SCHEME</span></span>  <br/> | <span data-ttu-id="95867-165">RPC_C_HTTP_AUTHN_SCHEME_BASIC (0X1)</span><span class="sxs-lookup"><span data-stu-id="95867-165">RPC_C_HTTP_AUTHN_SCHEME_BASIC (0x1)</span></span>  <br/> |<span data-ttu-id="95867-166">代表要用于此配置文件*自动发现节点*的身份验证协议： 响应/帐户/协议/AuthPackage (EXPR) <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="95867-166">Represents the authentication protocol to be used for this profile *Autodiscover Node*  : Response/Account/Protocol/AuthPackage (EXPR) <sup>2</sup></span></span> <br/> |
|<span data-ttu-id="95867-167">PR_PROFILE_AUTH_PACKAGE</span><span class="sxs-lookup"><span data-stu-id="95867-167">PR_PROFILE_AUTH_PACKAGE</span></span>  <br/> |<span data-ttu-id="95867-168">RPC_C_AUTHN_NONE (0X0)</span><span class="sxs-lookup"><span data-stu-id="95867-168">RPC_C_AUTHN_NONE (0x0)</span></span>  <br/> |<span data-ttu-id="95867-169">介绍用于 RPC*自动发现节点*的身份验证方案： 响应/帐户/协议/AuthPackage (EXCH)) <sup>3</sup></span><span class="sxs-lookup"><span data-stu-id="95867-169">Describes the authentication scheme to use for the RPC *Autodiscover Node*  : Response/Account/Protocol/AuthPackage (EXCH) ) <sup>3</sup></span></span> <br/> |
|<span data-ttu-id="95867-170">PR_ROH_PROXY_PRINCIPAL_NAME</span><span class="sxs-lookup"><span data-stu-id="95867-170">PR_ROH_PROXY_PRINCIPAL_NAME</span></span>  <br/> |<span data-ttu-id="95867-171">CertPrincipalName 元素</span><span class="sxs-lookup"><span data-stu-id="95867-171">CertPrincipalName element</span></span>  <br/> |<span data-ttu-id="95867-172">使用支持相互身份验证;例如，msstd:outlook.com*自动发现节点*： 响应/帐户/协议/CertPrincipalName (EXPR)) <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="95867-172">Used to support mutual authentication; for example, msstd:outlook.com *Autodiscover Node*  : Response/Account/Protocol/CertPrincipalName (EXPR) ) <sup>2</sup></span></span> <br/> |
   
### <a name="exchange-2013"></a><span data-ttu-id="95867-173">Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="95867-173">Exchange 2013</span></span>
  
||||
|:-----|:-----|:-----|
|<span data-ttu-id="95867-174">**属性**</span><span class="sxs-lookup"><span data-stu-id="95867-174">**Property**</span></span> <br/> |<span data-ttu-id="95867-175">**值**</span><span class="sxs-lookup"><span data-stu-id="95867-175">**Value**</span></span> <br/> |<span data-ttu-id="95867-176">**说明**</span><span class="sxs-lookup"><span data-stu-id="95867-176">**Description**</span></span> <br/> |
|<span data-ttu-id="95867-177">PR_PROFILE_UNRESOLVED_NAME<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="95867-177">PR_PROFILE_UNRESOLVED_NAME<sup>1</sup></span></span> <br/> |<span data-ttu-id="95867-178">邮箱别名</span><span class="sxs-lookup"><span data-stu-id="95867-178">mailbox alias</span></span>  <br/> |<span data-ttu-id="95867-179">目标邮箱中; 的别名例如，管理员</span><span class="sxs-lookup"><span data-stu-id="95867-179">The alias for the target mailbox; for example, Administrator</span></span>  <br/> |
|<span data-ttu-id="95867-180">PR_PROFILE_UNRESOLVED_SERVER<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="95867-180">PR_PROFILE_UNRESOLVED_SERVER<sup>1</sup></span></span> <br/> |<span data-ttu-id="95867-181">个性化的服务器 id</span><span class="sxs-lookup"><span data-stu-id="95867-181">personalized server id</span></span>  <br/> |<span data-ttu-id="95867-182">检索从**自动发现**的值。</span><span class="sxs-lookup"><span data-stu-id="95867-182">The value retrieved from **Autodiscover**.</span></span> <span data-ttu-id="95867-183">格式<guid>@tenant.onmicrosoft.com;例如，F5FA2827-5978-43cd-8FA8-E07BC3BB5591@contoso.onmicrosoft.com</span><span class="sxs-lookup"><span data-stu-id="95867-183">in the format <guid>@tenant.onmicrosoft.com; for example, F5FA2827-5978-43cd-8FA8-E07BC3BB5591@contoso.onmicrosoft.com</span></span>  <br/>  <span data-ttu-id="95867-184">*自动发现节点*： 响应/帐户/协议/服务器 (EXCH)</span><span class="sxs-lookup"><span data-stu-id="95867-184">*Autodiscover Node*  : Response/Account/Protocol/Server (EXCH)</span></span>  <br/> |
|<span data-ttu-id="95867-185">PR_ROH_PROXY_SERVER</span><span class="sxs-lookup"><span data-stu-id="95867-185">PR_ROH_PROXY_SERVER</span></span>  <br/> | <span data-ttu-id="95867-186">客户端访问服务器的域名</span><span class="sxs-lookup"><span data-stu-id="95867-186">client access server domain name</span></span>  <br/> | <span data-ttu-id="95867-187">完全限定的域名 (FQDN);例如，e2013cas.contoso.com*自动发现节点*： 响应/帐户/协议/服务器 (EXPR) <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="95867-187">The fully qualified domain name (FQDN); for example, e2013cas.contoso.com  *Autodiscover Node*  : Response/Account/Protocol/Server (EXPR) <sup>2</sup></span></span> <br/> |
|<span data-ttu-id="95867-188">PR_ROH_FLAGS</span><span class="sxs-lookup"><span data-stu-id="95867-188">PR_ROH_FLAGS</span></span>  <br/> |<span data-ttu-id="95867-189">ROHFLAGS_USE_ROH (0X1)</span><span class="sxs-lookup"><span data-stu-id="95867-189">ROHFLAGS_USE_ROH (0x1)</span></span>  <br/>  <span data-ttu-id="95867-190">ROHFLAGS_HTTP_FIRST_ON_FAST (0X8)</span><span class="sxs-lookup"><span data-stu-id="95867-190">ROHFLAGS_HTTP_FIRST_ON_FAST (0x8)</span></span>  <br/> <span data-ttu-id="95867-191">ROHFLAGS_HTTP_FIRST_ON_SLOW (0X20))</span><span class="sxs-lookup"><span data-stu-id="95867-191">ROHFLAGS_HTTP_FIRST_ON_SLOW (0x20))</span></span>  <br/> |<span data-ttu-id="95867-192">包含由 Outlook*自动发现节点*的超文本传输协议 (HTTP) 通过使用远程过程调用 (RPC) 连接到 Microsoft Exchange Server 配置文件中的设置： 响应/帐户/协议/SSL (EXPR) <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="95867-192">Contains the settings in a profile used by Outlook to connect to Microsoft Exchange Server by using a remote procedure call (RPC) over Hypertext Transfer Protocol (HTTP) *Autodiscover Node*  : Response/Account/Protocol/SSL (EXPR) <sup>2</sup></span></span> <br/> |
| <span data-ttu-id="95867-193">PR_ROH_PROXY_AUTH_SCHEME</span><span class="sxs-lookup"><span data-stu-id="95867-193">PR_ROH_PROXY_AUTH_SCHEME</span></span>  <br/> | <span data-ttu-id="95867-194">RPC_C_HTTP_AUTHN_SCHEME_NTLM (0X2)</span><span class="sxs-lookup"><span data-stu-id="95867-194">RPC_C_HTTP_AUTHN_SCHEME_NTLM (0x2)</span></span>  <br/> |<span data-ttu-id="95867-195">代表要用于此配置文件*自动发现节点*的身份验证协议： 响应/帐户/协议/AuthPackage (EXPR) <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="95867-195">Represents the authentication protocol to be used for this profile *Autodiscover Node*  : Response/Account/Protocol/AuthPackage (EXPR) <sup>2</sup></span></span> <br/> |
|<span data-ttu-id="95867-196">PR_PROFILE_AUTH_PACKAGE</span><span class="sxs-lookup"><span data-stu-id="95867-196">PR_PROFILE_AUTH_PACKAGE</span></span>  <br/> |<span data-ttu-id="95867-197">RPC_C_AUTHN_WINNT (0XA)</span><span class="sxs-lookup"><span data-stu-id="95867-197">RPC_C_AUTHN_WINNT (0xA)</span></span>  <br/> |<span data-ttu-id="95867-198">介绍用于 RPC*自动发现节点*的身份验证方案： 响应/帐户/协议/AuthPackage (EXCH)) <sup>3</sup></span><span class="sxs-lookup"><span data-stu-id="95867-198">Describes the authentication scheme to use for RPC *Autodiscover Node*  : Response/Account/Protocol/AuthPackage (EXCH) ) <sup>3</sup></span></span> <br/> |
   
> [!NOTE] 
> - <span data-ttu-id="95867-199">为组织特定情况下，上面提到的所有属性值可能会都有所不同。</span><span class="sxs-lookup"><span data-stu-id="95867-199">All property values mentioned above may vary for your particular organization.</span></span> 
> - <span data-ttu-id="95867-200"><sup>1</sup>必须使用 Unicode 版本，而不是 ANSI 版本。</span><span class="sxs-lookup"><span data-stu-id="95867-200"><sup>1</sup> You must use the Unicode version, rather than the ANSI version.</span></span> 
> - <span data-ttu-id="95867-201">您必须使用普通旧 XML (POX) 基于自动发现。</span><span class="sxs-lookup"><span data-stu-id="95867-201">You must use the Plain Old XML (POX) based Autodiscover.</span></span> <span data-ttu-id="95867-202">这是唯一受支持自动发现配置 Outlook/Exchange 配置文件。</span><span class="sxs-lookup"><span data-stu-id="95867-202">This is the only supported Autodiscover for configuring Outlook/Exchange profiles.</span></span>
> - <span data-ttu-id="95867-203">您可以使用 Outlook 代表您发起右键 Outlook 图标在**系统任务栏**中，单击时按住 CTRL 并单击**测试电子邮件自动配置**的自动发现请求。</span><span class="sxs-lookup"><span data-stu-id="95867-203">You can use Outlook to make an Autodiscover request on your behalf by right-clicking the Outlook icon in the **System Tray**, while holding down CTRL and clicking **Test E-Mail Autoconfiguration**.</span></span> 
> - <span data-ttu-id="95867-204">PR_ROH_FLAGS，为您的环境可能需要标志 ROHFLAGS_SSL_ONLY (0x2) 以告知 MAPI 使用仅 SSL。</span><span class="sxs-lookup"><span data-stu-id="95867-204">For PR_ROH_FLAGS, your environment may require the flag ROHFLAGS_SSL_ONLY (0x2) to tell MAPI to use only SSL.</span></span> <span data-ttu-id="95867-205">如果您的环境所需的相互身份验证，您需要设置的标志以及 [ROHFLAGS_MUTUAL_AUTH (0x4)]。</span><span class="sxs-lookup"><span data-stu-id="95867-205">If your environment requires mutual authentication, you will need to set that flag as well [ROHFLAGS_MUTUAL_AUTH (0x4)].</span></span> <span data-ttu-id="95867-206">设置 ROHFLAGS_MUTUAL_AUTH (0x4) 将要求您还设置 PR_ROH_PROXY_PRINCIPAL_NAME 的属性。</span><span class="sxs-lookup"><span data-stu-id="95867-206">Setting ROHFLAGS_MUTUAL_AUTH (0x4) will require that you also set the property PR_ROH_PROXY_PRINCIPAL_NAME.</span></span> <span data-ttu-id="95867-207">应设置此服务器的主体名称。</span><span class="sxs-lookup"><span data-stu-id="95867-207">You should set this to be the principal name of the server.</span></span>
> - <span data-ttu-id="95867-208"><sup>2</sup>的 Outlook 2010 中，您将需要使用 EXPR 协议。</span><span class="sxs-lookup"><span data-stu-id="95867-208"><sup>2</sup> For Outlook 2010, you will need to use the EXPR protocol.</span></span> <span data-ttu-id="95867-209">Outlook 2013 使用 EXHTTP 协议。</span><span class="sxs-lookup"><span data-stu-id="95867-209">Outlook 2013 uses the EXHTTP protocol.</span></span> 
> - <span data-ttu-id="95867-210"><sup>3</sup>此值可能不自动发现响应中。</span><span class="sxs-lookup"><span data-stu-id="95867-210"><sup>3</sup> This value may not be in the Autodiscover response.</span></span> <span data-ttu-id="95867-211">如果未指定，客户应使用 Kerberos 或 NTLM。</span><span class="sxs-lookup"><span data-stu-id="95867-211">If not specified, the client should use Kerberos or NTLM.</span></span> 
    
<span data-ttu-id="95867-212">疑难解答提示，请参阅[如何配置使用 MFCMAPI Exchange 2013 的 Outlook 配置文件](https://blogs.msdn.microsoft.com/dvespa/2014/01/16/how-to-configure-an-outlook-profile-using-mfcmapi-for-exchange-2013)。</span><span class="sxs-lookup"><span data-stu-id="95867-212">For Troubleshooting tips, see [How to configure an Outlook profile using MFCMAPI for Exchange 2013](https://blogs.msdn.microsoft.com/dvespa/2014/01/16/how-to-configure-an-outlook-profile-using-mfcmapi-for-exchange-2013).</span></span>
  
## <a name="see-also"></a><span data-ttu-id="95867-213">另请参阅</span><span class="sxs-lookup"><span data-stu-id="95867-213">See also</span></span>

- [<span data-ttu-id="95867-214">Outlook MAPI 引用</span><span class="sxs-lookup"><span data-stu-id="95867-214">Outlook MAPI Reference</span></span>](https://msdn.microsoft.com/en-us/library/office/cc765775.aspx)  
- [<span data-ttu-id="95867-215">在 Outlook 中以编程方式创建一个配置文件</span><span class="sxs-lookup"><span data-stu-id="95867-215">Programmatically Create a Profile in Outlook</span></span>](https://msdn.microsoft.com/en-us/library/office/mt707568.aspx)
    

