---
title: 使用 MFCMAPI 创建 Outlook 配置文件
ms.date: 05/18/2016
ms.audience: Developer
localization_priority: Normal
ms.assetid: 85581bc7-2d81-46af-8836-adef39c933fc
description: MFCMAPI 提供对 mapi 存储的访问权限, 以促进 Exchange 和 Outlook 问题的调查, 并为开发人员提供对 mapi 开发的支持。
ms.openlocfilehash: 8a300ad53918b22cc3de5554a1e3c29289cd9365
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/23/2019
ms.locfileid: "32345988"
---
# <a name="create-an-outlook-profile-using-mfcmapi"></a><span data-ttu-id="a3c99-103">使用 MFCMAPI 创建 Outlook 配置文件</span><span class="sxs-lookup"><span data-stu-id="a3c99-103">Create an Outlook profile using MFCMAPI</span></span>

<span data-ttu-id="a3c99-104">MFCMAPI 提供对 mapi 存储的访问权限, 以促进 Exchange 和 Outlook 问题的调查, 并为开发人员提供对 mapi 开发的支持。</span><span class="sxs-lookup"><span data-stu-id="a3c99-104">MFCMAPI provides access to MAPI stores to facilitate investigation of Exchange and Outlook issues and to provide developers with support for MAPI development.</span></span>

<span data-ttu-id="a3c99-105">**适用于**：Office 365 | Outlook | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="a3c99-105">**Applies to**: Office 365 | Outlook | Outlook 2016</span></span> 
  
<span data-ttu-id="a3c99-106">对于非开发人员, 建议使用 Outlook 用户界面创建 Exchange 2013 的配置文件。</span><span class="sxs-lookup"><span data-stu-id="a3c99-106">For non-developers, it is recommended that you use the Outlook user interface to create profiles for Exchange 2013.</span></span>
  
## <a name="configure-an-outlook-profile-using-mfcmapi"></a><span data-ttu-id="a3c99-107">使用 MFCMAPI 配置 Outlook 配置文件</span><span class="sxs-lookup"><span data-stu-id="a3c99-107">Configure an Outlook profile using MFCMAPI</span></span>

1. <span data-ttu-id="a3c99-108">打开[MFCMAPI](https://mfcmapi.codeplex.com/), 在 "**配置文件**" 菜单上, 单击 "**显示配置文件**"。</span><span class="sxs-lookup"><span data-stu-id="a3c99-108">Open [MFCMAPI](https://mfcmapi.codeplex.com/), and on the **Profile** menu, click **Show Profiles**.</span></span> 
    
2. <span data-ttu-id="a3c99-109">在 "**操作**" 菜单上, 单击 "**创建配置文件**"。</span><span class="sxs-lookup"><span data-stu-id="a3c99-109">On the **Actions** menu, click **Create Profile**.</span></span> 
    
3. <span data-ttu-id="a3c99-110">为该配置文件创建一个新名称, 然后单击 **"确定"**。</span><span class="sxs-lookup"><span data-stu-id="a3c99-110">Create a new name for the profile, and then click **OK**.</span></span> 
    
4. <span data-ttu-id="a3c99-111">右键单击新的配置文件, 然后在 "**服务**" 菜单上单击 "**添加服务**"。</span><span class="sxs-lookup"><span data-stu-id="a3c99-111">Right-click the new profile, and then on the **Services** menu, click **Add Service**.</span></span> 
    
5. <span data-ttu-id="a3c99-112">取消选中 "显示服务 UI" 框, 然后单击 **"确定**"。</span><span class="sxs-lookup"><span data-stu-id="a3c99-112">Uncheck the"Display Service UI" box, and then click **OK**.</span></span> 
    
6. <span data-ttu-id="a3c99-113">双击新创建的配置文件, 然后单击**MSEMS**服务。</span><span class="sxs-lookup"><span data-stu-id="a3c99-113">Double-click the newly created profile, and then click the **MSEMS** service.</span></span> 
    
7. <span data-ttu-id="a3c99-114">找到 "Exchange 配置文件" 部分。</span><span class="sxs-lookup"><span data-stu-id="a3c99-114">Locate the Exchange Profile section.</span></span>
    
   <span data-ttu-id="a3c99-115">这在 Outlook 的 MAPI 中可能有困难，因为在 2010 及以上版本均不再设有全局配置文件部分。</span><span class="sxs-lookup"><span data-stu-id="a3c99-115">This can be difficult in Outlook's MAPI, since in 2010 and above there is no longer the global profile section.</span></span> <span data-ttu-id="a3c99-116">要找到配置文件部分，需找到属性 PR_EMSMDB_SECTION_UID (0x3D150102)。</span><span class="sxs-lookup"><span data-stu-id="a3c99-116">To find the Profile section, find the property PR_EMSMDB_SECTION_UID (0x3D150102).</span></span> <span data-ttu-id="a3c99-117">该值为配置文件部分的 GUID，采用二进制形式，后续步骤将使用该值。</span><span class="sxs-lookup"><span data-stu-id="a3c99-117">The value will be the GUID of the profile section persisted in binary form, which will be used in the subsequent steps.</span></span> <span data-ttu-id="a3c99-118">您将在步骤9中需要此值。</span><span class="sxs-lookup"><span data-stu-id="a3c99-118">You will need this value in step 9.</span></span>
    
8. <span data-ttu-id="a3c99-119">双击**MSEMS**服务。</span><span class="sxs-lookup"><span data-stu-id="a3c99-119">Double-click the **MSEMS** service.</span></span> 
    
9. <span data-ttu-id="a3c99-120">使用步骤7中的 UID 查找 " **Exchange**配置文件" 部分, 然后单击以选择该行。</span><span class="sxs-lookup"><span data-stu-id="a3c99-120">Find the **Exchange** profile section by using the UID from step 7, and then single-click to select the row.</span></span> 
    
10. <span data-ttu-id="a3c99-121">在 "属性" 菜单上, 单击 "**其他属性**"。</span><span class="sxs-lookup"><span data-stu-id="a3c99-121">On the Property menu, click **Additional Properties**.</span></span> 
    
11. <span data-ttu-id="a3c99-122">单击 "**添加**", 然后添加以下属性:</span><span class="sxs-lookup"><span data-stu-id="a3c99-122">Click **Add**, and then add the following properties:</span></span> 
    
    <span data-ttu-id="a3c99-123">**对于 Outlook 2016**: `PR_PROFILE_USER_SMTP_EMAIL_ADDRESS_W (0x6641001F)`和`PR_DISPLAY_NAME_W`</span><span class="sxs-lookup"><span data-stu-id="a3c99-123">**For Outlook 2016**: `PR_PROFILE_USER_SMTP_EMAIL_ADDRESS_W (0x6641001F)` and `PR_DISPLAY_NAME_W`</span></span>
    
    <span data-ttu-id="a3c99-124">**对于适用于 Office 的 Outlook 365** `PR_PROFILE_UNRESOLVED_NAME`: `PR_ROH_PROXY_SERVER`、 `PR_ROH_FLAGS` `PR_ROH_PROXY_AUTH_SCHEME` `PR_PROFILE_AUTH_PACKAGE` `PR_PROFILE_UNRESOLVED_SERVER`、、、、和`PR_ROH_PROXY_PRINCIPAL_NAME`</span><span class="sxs-lookup"><span data-stu-id="a3c99-124">**For Outlook for Office 365**: `PR_PROFILE_UNRESOLVED_NAME`, `PR_PROFILE_UNRESOLVED_SERVER`, `PR_ROH_PROXY_SERVER`, `PR_ROH_FLAGS`, `PR_ROH_PROXY_AUTH_SCHEME`, `PR_PROFILE_AUTH_PACKAGE`, and `PR_ROH_PROXY_PRINCIPAL_NAME`</span></span> 
    
    <span data-ttu-id="a3c99-125">**对于 Exchange 2013**: `PR_PROFILE_UNRESOLVED_NAME`、 `PR_PROFILE_UNRESOLVED_SERVER` `PR_ROH_PROXY_SERVER` `PR_ROH_FLAGS` `PR_ROH_PROXY_AUTH_SCHEME`、、、和`PR_PROFILE_AUTH_PACKAGE`。</span><span class="sxs-lookup"><span data-stu-id="a3c99-125">**For Exchange 2013**: `PR_PROFILE_UNRESOLVED_NAME`, `PR_PROFILE_UNRESOLVED_SERVER`, `PR_ROH_PROXY_SERVER`, `PR_ROH_FLAGS`, `PR_ROH_PROXY_AUTH_SCHEME`, and `PR_PROFILE_AUTH_PACKAGE`.</span></span> 
    
12. <span data-ttu-id="a3c99-126">单击 **"确定"**, 然后根据下表配置每个属性, 具体取决于要连接到的版本。</span><span class="sxs-lookup"><span data-stu-id="a3c99-126">Click **OK**, and then configure each property according to the table below, depending on the version you are connecting to.</span></span> 
    
13. <span data-ttu-id="a3c99-127">在 "**会话**" 菜单上, 单击 "**登录和显示存储**", 然后选择配置文件 (如果尚未选中)。</span><span class="sxs-lookup"><span data-stu-id="a3c99-127">On the **Session** menu, click **Logon and Display Store**, and then select the profile (if it is not already selected).</span></span> 
    
### <a name="outlook-2016"></a><span data-ttu-id="a3c99-128">Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="a3c99-128">Outlook 2016</span></span>
  
||||
|:-----|:-----|:-----|
|<span data-ttu-id="a3c99-129">**Property**</span><span class="sxs-lookup"><span data-stu-id="a3c99-129">**Property**</span></span> <br/> |<span data-ttu-id="a3c99-130">**Tag**</span><span class="sxs-lookup"><span data-stu-id="a3c99-130">**Tag**</span></span> <br/> |<span data-ttu-id="a3c99-131">**Description**</span><span class="sxs-lookup"><span data-stu-id="a3c99-131">**Description**</span></span> <br/> |
| <span data-ttu-id="a3c99-132">PR_PROFILE_USER_SMTP_EMAIL_ADDRESS_W</span><span class="sxs-lookup"><span data-stu-id="a3c99-132">PR_PROFILE_USER_SMTP_EMAIL_ADDRESS_W</span></span>  <br/> |<span data-ttu-id="a3c99-133">0x6641001F</span><span class="sxs-lookup"><span data-stu-id="a3c99-133">0x6641001F</span></span>  <br/> |<span data-ttu-id="a3c99-134">用户的 SMTP 地址</span><span class="sxs-lookup"><span data-stu-id="a3c99-134">SMTP Address of the user</span></span>  <br/> |
|<span data-ttu-id="a3c99-135">PR_DISPLAY_NAME_W</span><span class="sxs-lookup"><span data-stu-id="a3c99-135">PR_DISPLAY_NAME_W</span></span>  <br/> |<span data-ttu-id="a3c99-136">0x3001001F</span><span class="sxs-lookup"><span data-stu-id="a3c99-136">0x3001001F</span></span>  <br/> |<span data-ttu-id="a3c99-137">用户的显示名称</span><span class="sxs-lookup"><span data-stu-id="a3c99-137">The display name of the user</span></span>  <br/> |
|<span data-ttu-id="a3c99-138">PR_STORE_PROVIDERS</span><span class="sxs-lookup"><span data-stu-id="a3c99-138">PR_STORE_PROVIDERS</span></span>  <br/> |<span data-ttu-id="a3c99-139">0x3D000102</span><span class="sxs-lookup"><span data-stu-id="a3c99-139">0x3D000102</span></span>  <br/> |<span data-ttu-id="a3c99-140">配置此属性的值, 该属性位于 " **EMSMDB** " 部分, 并为匹配属性更新相应的 UID</span><span class="sxs-lookup"><span data-stu-id="a3c99-140">Configure the value of this property, located in the **EMSMDB** section, and update the corresponding UID for the matching property</span></span>  <br/> |
   
### <a name="outlook-for-office-365"></a><span data-ttu-id="a3c99-141">Outlook for Office 365</span><span class="sxs-lookup"><span data-stu-id="a3c99-141">Outlook for Office 365</span></span>
  
||||
|:-----|:-----|:-----|
|<span data-ttu-id="a3c99-142">**属性**</span><span class="sxs-lookup"><span data-stu-id="a3c99-142">**Property**</span></span> <br/> |<span data-ttu-id="a3c99-143">**Value**</span><span class="sxs-lookup"><span data-stu-id="a3c99-143">**Value**</span></span> <br/> |<span data-ttu-id="a3c99-144">**说明**</span><span class="sxs-lookup"><span data-stu-id="a3c99-144">**Description**</span></span> <br/> |
|<span data-ttu-id="a3c99-145">PR_PROFILE_UNRESOLVED_NAME<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="a3c99-145">PR_PROFILE_UNRESOLVED_NAME<sup>1</sup></span></span> <br/> |<span data-ttu-id="a3c99-146">邮箱别名</span><span class="sxs-lookup"><span data-stu-id="a3c99-146">mailbox alias</span></span>  <br/> |<span data-ttu-id="a3c99-147">目标邮箱的别名;例如, 管理员</span><span class="sxs-lookup"><span data-stu-id="a3c99-147">The alias for the target mailbox; for example, Administrator</span></span>  <br/> |
|<span data-ttu-id="a3c99-148">PR_PROFILE_UNRESOLVED_SERVER<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="a3c99-148">PR_PROFILE_UNRESOLVED_SERVER<sup>1</sup></span></span> <br/> |<span data-ttu-id="a3c99-149">个性化服务器 id</span><span class="sxs-lookup"><span data-stu-id="a3c99-149">personalized server id</span></span>  <br/> |<span data-ttu-id="a3c99-150">从**自动发现**中检索到的值。</span><span class="sxs-lookup"><span data-stu-id="a3c99-150">The value retrieved from **Autodiscover**.</span></span> <span data-ttu-id="a3c99-151">格式<guid>@tenant。 onmicrosoft.com;例如, F5FA2827-5978-43cd-8FA8-E07BC3BB5591@contoso.onmicrosoft.com</span><span class="sxs-lookup"><span data-stu-id="a3c99-151">in the format <guid>@tenant.onmicrosoft.com; for example, F5FA2827-5978-43cd-8FA8-E07BC3BB5591@contoso.onmicrosoft.com</span></span>  <br/>  <span data-ttu-id="a3c99-152">*自动发现节点*: 响应/帐户/协议/服务器 (EXCH)</span><span class="sxs-lookup"><span data-stu-id="a3c99-152">*Autodiscover Node*  : Response/Account/Protocol/Server (EXCH)</span></span>  <br/> |
|<span data-ttu-id="a3c99-153">PR_ROH_PROXY_SERVER</span><span class="sxs-lookup"><span data-stu-id="a3c99-153">PR_ROH_PROXY_SERVER</span></span>  <br/> |<span data-ttu-id="a3c99-154">outlook.office365.com</span><span class="sxs-lookup"><span data-stu-id="a3c99-154">outlook.office365.com</span></span>  <br/> | <span data-ttu-id="a3c99-155">*自动发现节点*: 响应/帐户/协议/服务器 (EXPR) <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="a3c99-155">*Autodiscover Node*  : Response/Account/Protocol/Server (EXPR) <sup>2</sup></span></span> <br/> |
|<span data-ttu-id="a3c99-156">PR_ROH_FLAGS</span><span class="sxs-lookup"><span data-stu-id="a3c99-156">PR_ROH_FLAGS</span></span>  <br/> |<span data-ttu-id="a3c99-157">ROHFLAGS_USE_ROH (0x1)</span><span class="sxs-lookup"><span data-stu-id="a3c99-157">ROHFLAGS_USE_ROH (0x1)</span></span>  <br/> <span data-ttu-id="a3c99-158">ROH_FLAGS_USE_SSL (0x2)</span><span class="sxs-lookup"><span data-stu-id="a3c99-158">ROH_FLAGS_USE_SSL (0x2)</span></span>  <br/>  <span data-ttu-id="a3c99-159">ROHFLAGS_MUTUAL_AUTH (0x4)</span><span class="sxs-lookup"><span data-stu-id="a3c99-159">ROHFLAGS_MUTUAL_AUTH (0x4)</span></span>  <br/>  <span data-ttu-id="a3c99-160">ROHFLAGS_HTTP_FIRST_ON_FAST (0x8)</span><span class="sxs-lookup"><span data-stu-id="a3c99-160">ROHFLAGS_HTTP_FIRST_ON_FAST (0x8)</span></span>  <br/>  <span data-ttu-id="a3c99-161">ROHFLAGS_HTTP_FIRST_ON_SLOW (0x20)</span><span class="sxs-lookup"><span data-stu-id="a3c99-161">ROHFLAGS_HTTP_FIRST_ON_SLOW (0x20)</span></span>  <br/> |<span data-ttu-id="a3c99-162">包含 Outlook 用于通过使用超文本传输协议 (HTTP) 上的远程过程调用 (RPC) 连接到 Microsoft Exchange Server 的配置文件中的设置。</span><span class="sxs-lookup"><span data-stu-id="a3c99-162">Contains the settings in a profile used by Outlook to connect to Microsoft Exchange Server by using a remote procedure call (RPC) over Hypertext Transfer Protocol (HTTP).</span></span> <span data-ttu-id="a3c99-163">*自动发现节点*: 响应/帐户/协议/SSL (EXPR) <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="a3c99-163">*Autodiscover Node*  : Response/Account/Protocol/SSL (EXPR) <sup>2</sup></span></span> <br/> |
| <span data-ttu-id="a3c99-164">PR_ROH_PROXY_AUTH_SCHEME</span><span class="sxs-lookup"><span data-stu-id="a3c99-164">PR_ROH_PROXY_AUTH_SCHEME</span></span>  <br/> | <span data-ttu-id="a3c99-165">RPC_C_HTTP_AUTHN_SCHEME_BASIC (0x1)</span><span class="sxs-lookup"><span data-stu-id="a3c99-165">RPC_C_HTTP_AUTHN_SCHEME_BASIC (0x1)</span></span>  <br/> |<span data-ttu-id="a3c99-166">表示要用于此配置文件*自动发现节点*的身份验证协议: Response/Account/protocol/AuthPackage (EXPR) <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="a3c99-166">Represents the authentication protocol to be used for this profile *Autodiscover Node*  : Response/Account/Protocol/AuthPackage (EXPR) <sup>2</sup></span></span> <br/> |
|<span data-ttu-id="a3c99-167">PR_PROFILE_AUTH_PACKAGE</span><span class="sxs-lookup"><span data-stu-id="a3c99-167">PR_PROFILE_AUTH_PACKAGE</span></span>  <br/> |<span data-ttu-id="a3c99-168">RPC_C_AUTHN_NONE (0x0)</span><span class="sxs-lookup"><span data-stu-id="a3c99-168">RPC_C_AUTHN_NONE (0x0)</span></span>  <br/> |<span data-ttu-id="a3c99-169">介绍用于 RPC*自动发现节点*的身份验证方案: Response/Account/Protocol/AuthPackage (EXCH)) <sup>3</sup></span><span class="sxs-lookup"><span data-stu-id="a3c99-169">Describes the authentication scheme to use for the RPC *Autodiscover Node*  : Response/Account/Protocol/AuthPackage (EXCH) ) <sup>3</sup></span></span> <br/> |
|<span data-ttu-id="a3c99-170">PR_ROH_PROXY_PRINCIPAL_NAME</span><span class="sxs-lookup"><span data-stu-id="a3c99-170">PR_ROH_PROXY_PRINCIPAL_NAME</span></span>  <br/> |<span data-ttu-id="a3c99-171">CertPrincipalName 元素</span><span class="sxs-lookup"><span data-stu-id="a3c99-171">CertPrincipalName element</span></span>  <br/> |<span data-ttu-id="a3c99-172">用于支持相互身份验证;例如, msstd:outlook "*自动发现" 节点*: Response/Account/Protocol/CertPrincipalName (EXPR)) <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="a3c99-172">Used to support mutual authentication; for example, msstd:outlook.com *Autodiscover Node*  : Response/Account/Protocol/CertPrincipalName (EXPR) ) <sup>2</sup></span></span> <br/> |
   
### <a name="exchange-2013"></a><span data-ttu-id="a3c99-173">Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="a3c99-173">Exchange 2013</span></span>
  
||||
|:-----|:-----|:-----|
|<span data-ttu-id="a3c99-174">**属性**</span><span class="sxs-lookup"><span data-stu-id="a3c99-174">**Property**</span></span> <br/> |<span data-ttu-id="a3c99-175">**Value**</span><span class="sxs-lookup"><span data-stu-id="a3c99-175">**Value**</span></span> <br/> |<span data-ttu-id="a3c99-176">**说明**</span><span class="sxs-lookup"><span data-stu-id="a3c99-176">**Description**</span></span> <br/> |
|<span data-ttu-id="a3c99-177">PR_PROFILE_UNRESOLVED_NAME<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="a3c99-177">PR_PROFILE_UNRESOLVED_NAME<sup>1</sup></span></span> <br/> |<span data-ttu-id="a3c99-178">邮箱别名</span><span class="sxs-lookup"><span data-stu-id="a3c99-178">mailbox alias</span></span>  <br/> |<span data-ttu-id="a3c99-179">目标邮箱的别名;例如, 管理员</span><span class="sxs-lookup"><span data-stu-id="a3c99-179">The alias for the target mailbox; for example, Administrator</span></span>  <br/> |
|<span data-ttu-id="a3c99-180">PR_PROFILE_UNRESOLVED_SERVER<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="a3c99-180">PR_PROFILE_UNRESOLVED_SERVER<sup>1</sup></span></span> <br/> |<span data-ttu-id="a3c99-181">个性化服务器 id</span><span class="sxs-lookup"><span data-stu-id="a3c99-181">personalized server id</span></span>  <br/> |<span data-ttu-id="a3c99-182">从**自动发现**中检索到的值。</span><span class="sxs-lookup"><span data-stu-id="a3c99-182">The value retrieved from **Autodiscover**.</span></span> <span data-ttu-id="a3c99-183">格式<guid>@tenant。 onmicrosoft.com;例如, F5FA2827-5978-43cd-8FA8-E07BC3BB5591@contoso.onmicrosoft.com</span><span class="sxs-lookup"><span data-stu-id="a3c99-183">in the format <guid>@tenant.onmicrosoft.com; for example, F5FA2827-5978-43cd-8FA8-E07BC3BB5591@contoso.onmicrosoft.com</span></span>  <br/>  <span data-ttu-id="a3c99-184">*自动发现节点*: 响应/帐户/协议/服务器 (EXCH)</span><span class="sxs-lookup"><span data-stu-id="a3c99-184">*Autodiscover Node*  : Response/Account/Protocol/Server (EXCH)</span></span>  <br/> |
|<span data-ttu-id="a3c99-185">PR_ROH_PROXY_SERVER</span><span class="sxs-lookup"><span data-stu-id="a3c99-185">PR_ROH_PROXY_SERVER</span></span>  <br/> | <span data-ttu-id="a3c99-186">客户端访问服务器域名称</span><span class="sxs-lookup"><span data-stu-id="a3c99-186">client access server domain name</span></span>  <br/> | <span data-ttu-id="a3c99-187">完全限定的域名 (FQDN);例如, e2013cas.contoso.com*自动发现节点*: 响应/帐户/协议/服务器 (EXPR) <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="a3c99-187">The fully qualified domain name (FQDN); for example, e2013cas.contoso.com  *Autodiscover Node*  : Response/Account/Protocol/Server (EXPR) <sup>2</sup></span></span> <br/> |
|<span data-ttu-id="a3c99-188">PR_ROH_FLAGS</span><span class="sxs-lookup"><span data-stu-id="a3c99-188">PR_ROH_FLAGS</span></span>  <br/> |<span data-ttu-id="a3c99-189">ROHFLAGS_USE_ROH (0x1)</span><span class="sxs-lookup"><span data-stu-id="a3c99-189">ROHFLAGS_USE_ROH (0x1)</span></span>  <br/>  <span data-ttu-id="a3c99-190">ROHFLAGS_HTTP_FIRST_ON_FAST (0x8)</span><span class="sxs-lookup"><span data-stu-id="a3c99-190">ROHFLAGS_HTTP_FIRST_ON_FAST (0x8)</span></span>  <br/> <span data-ttu-id="a3c99-191">ROHFLAGS_HTTP_FIRST_ON_SLOW (0x20))</span><span class="sxs-lookup"><span data-stu-id="a3c99-191">ROHFLAGS_HTTP_FIRST_ON_SLOW (0x20))</span></span>  <br/> |<span data-ttu-id="a3c99-192">包含 Outlook 使用远程过程调用 (RPC) 和超文本传输协议 (HTTP)*自动发现节点*连接到 Microsoft Exchange Server 时使用的配置文件中的设置: 响应/帐户/协议/SSL (EXPR) <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="a3c99-192">Contains the settings in a profile used by Outlook to connect to Microsoft Exchange Server by using a remote procedure call (RPC) over Hypertext Transfer Protocol (HTTP) *Autodiscover Node*  : Response/Account/Protocol/SSL (EXPR) <sup>2</sup></span></span> <br/> |
| <span data-ttu-id="a3c99-193">PR_ROH_PROXY_AUTH_SCHEME</span><span class="sxs-lookup"><span data-stu-id="a3c99-193">PR_ROH_PROXY_AUTH_SCHEME</span></span>  <br/> | <span data-ttu-id="a3c99-194">RPC_C_HTTP_AUTHN_SCHEME_NTLM (0x2)</span><span class="sxs-lookup"><span data-stu-id="a3c99-194">RPC_C_HTTP_AUTHN_SCHEME_NTLM (0x2)</span></span>  <br/> |<span data-ttu-id="a3c99-195">表示要用于此配置文件*自动发现节点*的身份验证协议: Response/Account/protocol/AuthPackage (EXPR) <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="a3c99-195">Represents the authentication protocol to be used for this profile *Autodiscover Node*  : Response/Account/Protocol/AuthPackage (EXPR) <sup>2</sup></span></span> <br/> |
|<span data-ttu-id="a3c99-196">PR_PROFILE_AUTH_PACKAGE</span><span class="sxs-lookup"><span data-stu-id="a3c99-196">PR_PROFILE_AUTH_PACKAGE</span></span>  <br/> |<span data-ttu-id="a3c99-197">RPC_C_AUTHN_WINNT (0xA)</span><span class="sxs-lookup"><span data-stu-id="a3c99-197">RPC_C_AUTHN_WINNT (0xA)</span></span>  <br/> |<span data-ttu-id="a3c99-198">介绍用于 RPC*自动发现节点*的身份验证方案: Response/Account/Protocol/AuthPackage (EXCH)) <sup>3</sup></span><span class="sxs-lookup"><span data-stu-id="a3c99-198">Describes the authentication scheme to use for RPC *Autodiscover Node*  : Response/Account/Protocol/AuthPackage (EXCH) ) <sup>3</sup></span></span> <br/> |
   
> [!NOTE] 
> - <span data-ttu-id="a3c99-199">以上提到的所有属性值可能因特定组织而异。</span><span class="sxs-lookup"><span data-stu-id="a3c99-199">All property values mentioned above may vary for your particular organization.</span></span> 
> - <span data-ttu-id="a3c99-200"><sup>1</sup>您必须使用 Unicode 版本, 而不是 ANSI 版本。</span><span class="sxs-lookup"><span data-stu-id="a3c99-200"><sup>1</sup> You must use the Unicode version, rather than the ANSI version.</span></span> 
> - <span data-ttu-id="a3c99-201">您必须使用基于旧 XML (POX) 的自动发现。</span><span class="sxs-lookup"><span data-stu-id="a3c99-201">You must use the Plain Old XML (POX) based Autodiscover.</span></span> <span data-ttu-id="a3c99-202">这是配置 Outlook/Exchange 配置文件的唯一受支持的自动发现。</span><span class="sxs-lookup"><span data-stu-id="a3c99-202">This is the only supported Autodiscover for configuring Outlook/Exchange profiles.</span></span>
> - <span data-ttu-id="a3c99-203">您可以通过右键单击**系统托盘**中的 Outlook 图标, 同时按住 CTRL 并单击 "**测试电子邮件自动配置**", 使用 Outlook 为您发出自动发现请求。</span><span class="sxs-lookup"><span data-stu-id="a3c99-203">You can use Outlook to make an Autodiscover request on your behalf by right-clicking the Outlook icon in the **System Tray**, while holding down CTRL and clicking **Test E-Mail Autoconfiguration**.</span></span> 
> - <span data-ttu-id="a3c99-204">对于 PR_ROH_FLAGS, 您的环境可能需要标志 ROHFLAGS_SSL_ONLY (0x2) 来通知 MAPI 仅使用 SSL。</span><span class="sxs-lookup"><span data-stu-id="a3c99-204">For PR_ROH_FLAGS, your environment may require the flag ROHFLAGS_SSL_ONLY (0x2) to tell MAPI to use only SSL.</span></span> <span data-ttu-id="a3c99-205">如果您的环境需要进行相互身份验证, 则需要将该标志设置为 [ROHFLAGS_MUTUAL_AUTH (0x4)]。</span><span class="sxs-lookup"><span data-stu-id="a3c99-205">If your environment requires mutual authentication, you will need to set that flag as well [ROHFLAGS_MUTUAL_AUTH (0x4)].</span></span> <span data-ttu-id="a3c99-206">设置 ROHFLAGS_MUTUAL_AUTH (0x4) 将要求您同时设置 PR_ROH_PROXY_PRINCIPAL_NAME 属性。</span><span class="sxs-lookup"><span data-stu-id="a3c99-206">Setting ROHFLAGS_MUTUAL_AUTH (0x4) will require that you also set the property PR_ROH_PROXY_PRINCIPAL_NAME.</span></span> <span data-ttu-id="a3c99-207">应将此设置为服务器的主体名称。</span><span class="sxs-lookup"><span data-stu-id="a3c99-207">You should set this to be the principal name of the server.</span></span>
> - <span data-ttu-id="a3c99-208"><sup>2</sup>对于 Outlook 2010, 您将需要使用 EXPR 协议。</span><span class="sxs-lookup"><span data-stu-id="a3c99-208"><sup>2</sup> For Outlook 2010, you will need to use the EXPR protocol.</span></span> <span data-ttu-id="a3c99-209">Outlook 2013 使用 EXHTTP 协议。</span><span class="sxs-lookup"><span data-stu-id="a3c99-209">Outlook 2013 uses the EXHTTP protocol.</span></span> 
> - <span data-ttu-id="a3c99-210"><sup>3</sup>此值可能不在自动发现响应中。</span><span class="sxs-lookup"><span data-stu-id="a3c99-210"><sup>3</sup> This value may not be in the Autodiscover response.</span></span> <span data-ttu-id="a3c99-211">如果未指定, 客户端应使用 Kerberos 或 NTLM。</span><span class="sxs-lookup"><span data-stu-id="a3c99-211">If not specified, the client should use Kerberos or NTLM.</span></span> 
    
<span data-ttu-id="a3c99-212">有关故障排除提示, 请参阅 how [to configure a Outlook profile using MFCMAPI for Exchange 2013](https://blogs.msdn.microsoft.com/dvespa/2014/01/16/how-to-configure-an-outlook-profile-using-mfcmapi-for-exchange-2013)。</span><span class="sxs-lookup"><span data-stu-id="a3c99-212">For Troubleshooting tips, see [How to configure an Outlook profile using MFCMAPI for Exchange 2013](https://blogs.msdn.microsoft.com/dvespa/2014/01/16/how-to-configure-an-outlook-profile-using-mfcmapi-for-exchange-2013).</span></span>
  
## <a name="see-also"></a><span data-ttu-id="a3c99-213">另请参阅</span><span class="sxs-lookup"><span data-stu-id="a3c99-213">See also</span></span>

- [<span data-ttu-id="a3c99-214">Outlook MAPI 引用</span><span class="sxs-lookup"><span data-stu-id="a3c99-214">Outlook MAPI Reference</span></span>](https://msdn.microsoft.com/library/office/cc765775.aspx)  
- [<span data-ttu-id="a3c99-215">在 Outlook 中以编程方式创建配置文件</span><span class="sxs-lookup"><span data-stu-id="a3c99-215">Programmatically Create a Profile in Outlook</span></span>](https://msdn.microsoft.com/library/office/mt707568.aspx)
    

