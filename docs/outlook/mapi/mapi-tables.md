---
title: MAPI 表
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 7974cae1-10f1-42e9-8be4-c02f2bd86714
description: 上次修改时间：2015 年 3 月 9 日
ms.openlocfilehash: 840c34a64cd0478be8f208799653b9916f50079d
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/28/2019
ms.locfileid: "33437082"
---
# <a name="mapi-tables"></a><span data-ttu-id="8ee7e-103">MAPI 表</span><span class="sxs-lookup"><span data-stu-id="8ee7e-103">MAPI tables</span></span>
  
<span data-ttu-id="8ee7e-104">**适用于**：Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="8ee7e-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="8ee7e-105">MAPI 表是一个 MAPI 对象，用于查看属于特定类型其他 MAPI 对象的属性的集合。</span><span class="sxs-lookup"><span data-stu-id="8ee7e-105">A MAPI table is a MAPI object that is used to view a collection of properties belonging to other MAPI objects of a particular type.</span></span> <span data-ttu-id="8ee7e-106">MAPI 表采用行和列格式进行构造，其中每一行代表一个对象，每一列代表对象的属性。</span><span class="sxs-lookup"><span data-stu-id="8ee7e-106">MAPI tables are structured in a row and column format with each row representing an object and each column representing a property of the object.</span></span> <span data-ttu-id="8ee7e-107">通常包含在每行中的属性之一是 PR_ENTRYID  ([PidTagEntryId](pidtagentryid-canonical-property.md)) 属性，一个可用于打开和修改对象的标识符。</span><span class="sxs-lookup"><span data-stu-id="8ee7e-107">One of the properties usually included in each row is the **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)) property, an identifier that can be used to open and modify the object.</span></span> 
  
<span data-ttu-id="8ee7e-108">由于行包含属性值，因此从表中检索行与直接从该行表示的对象获取一组属性相似。</span><span class="sxs-lookup"><span data-stu-id="8ee7e-108">Because rows contain property values, retrieving a row from a table is similar to getting a set of properties directly from the object that the row represents.</span></span> <span data-ttu-id="8ee7e-109">这两个操作都会导致检索属性值数组。</span><span class="sxs-lookup"><span data-stu-id="8ee7e-109">Both operations result in the retrieval of a property value array.</span></span> <span data-ttu-id="8ee7e-110">主要区别是处理长字符串和二进制属性。</span><span class="sxs-lookup"><span data-stu-id="8ee7e-110">The main difference is in the handling of long string and binary properties.</span></span> <span data-ttu-id="8ee7e-111">为了包含在表中，某些表实施者将这些属性截断为 255 个字节。</span><span class="sxs-lookup"><span data-stu-id="8ee7e-111">For inclusion in a table, some table implementers truncate these properties to 255 bytes.</span></span> <span data-ttu-id="8ee7e-112">直接从对象检索时，完整值始终可用。</span><span class="sxs-lookup"><span data-stu-id="8ee7e-112">When retrieved directly from the object, the full value is always available.</span></span>
  
<span data-ttu-id="8ee7e-113">表由通讯簿和邮件存储提供程序以及 MAPI 实现，具体取决于表的类型及其中的对象。</span><span class="sxs-lookup"><span data-stu-id="8ee7e-113">Tables are implemented by address book and message store providers and by MAPI, depending on the type of table and the objects within it.</span></span> <span data-ttu-id="8ee7e-114">邮件存储提供程序为包含有关文件夹中的邮件信息的每个文件夹实现文件夹和内容表。</span><span class="sxs-lookup"><span data-stu-id="8ee7e-114">A message store provider implements folders and a contents table for each folder that includes information about the messages in the folder.</span></span> <span data-ttu-id="8ee7e-115">通讯簿提供程序实现通讯簿容器和显示其组织的层次结构表。</span><span class="sxs-lookup"><span data-stu-id="8ee7e-115">An address book provider implements address book containers and a hierarchy table that shows their organization.</span></span> <span data-ttu-id="8ee7e-116">MAPI 实现了几个不同的表，一些表供客户端应用程序使用，一些表供服务提供商使用，另一些表供两者使用。</span><span class="sxs-lookup"><span data-stu-id="8ee7e-116">MAPI implements several different tables, some for use by client applications, some for use by service providers, and some for use by both.</span></span> <span data-ttu-id="8ee7e-117">状态表是唯一的，因为 MAPI 最终提供表，但这些行由所有类型的服务提供商除 MAPI 之外的贡献组成。</span><span class="sxs-lookup"><span data-stu-id="8ee7e-117">The status table is unique in that MAPI ultimately supplies the table, but the rows are comprised of contributions from all types of service providers in addition to MAPI.</span></span> 
  
<span data-ttu-id="8ee7e-118">下图显示了 MAPI 中频繁使用的表之一：显示文件夹的内容。</span><span class="sxs-lookup"><span data-stu-id="8ee7e-118">The following illustration shows one of the frequent uses of a table in MAPI: to display the contents of a folder.</span></span> <span data-ttu-id="8ee7e-119">右侧是两条消息的显示，这两条消息可能显示在典型的邮件客户端应用程序中。</span><span class="sxs-lookup"><span data-stu-id="8ee7e-119">On the right is a display of two messages as might appear in a typical messaging client application.</span></span> <span data-ttu-id="8ee7e-120">显示包含有关每封邮件的四条信息：发件人、收件人、主题和邮件文本。</span><span class="sxs-lookup"><span data-stu-id="8ee7e-120">The display contains four pieces of information about each message: the sender, the recipient, the subject, and the message text.</span></span> <span data-ttu-id="8ee7e-121">每段信息对应于邮件的一个属性。</span><span class="sxs-lookup"><span data-stu-id="8ee7e-121">Each piece of information corresponds to a property of the message.</span></span>
  
<span data-ttu-id="8ee7e-122">左侧是包含这两条消息的内容表的视图。</span><span class="sxs-lookup"><span data-stu-id="8ee7e-122">On the left is a view of the contents table that includes these two messages.</span></span> <span data-ttu-id="8ee7e-123">而 contents 表可能有十行，因为该文件夹包含十个邮件，每行包含三列以上，所以此特定视图只能包含两行和三列。</span><span class="sxs-lookup"><span data-stu-id="8ee7e-123">Whereas the contents table may have ten rows because the folder has ten messages, with each row containing many more than three columns, this particular view is limited to only two rows and three columns.</span></span>
  
<span data-ttu-id="8ee7e-124">下表显示了为表视图设置的列的属性。</span><span class="sxs-lookup"><span data-stu-id="8ee7e-124">The following table shows the properties that make up the column set for the table view.</span></span>
  
|<span data-ttu-id="8ee7e-125">**属性**</span><span class="sxs-lookup"><span data-stu-id="8ee7e-125">**Property**</span></span>|<span data-ttu-id="8ee7e-126">**说明**</span><span class="sxs-lookup"><span data-stu-id="8ee7e-126">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="8ee7e-127">**PR_SENDER_NAME (** [PidTagSenderName](pidtagsendername-canonical-property.md)) </span><span class="sxs-lookup"><span data-stu-id="8ee7e-127">**PR_SENDER_NAME** ([PidTagSenderName](pidtagsendername-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="8ee7e-128">发件人名称</span><span class="sxs-lookup"><span data-stu-id="8ee7e-128">Sender name</span></span>  <br/> |
|<span data-ttu-id="8ee7e-129">**PR_ORIGINAL_DELIVERY_TIME (** [PidTagOriginalDeliveryTime](pidtagoriginaldeliverytime-canonical-property.md)) </span><span class="sxs-lookup"><span data-stu-id="8ee7e-129">**PR_ORIGINAL_DELIVERY_TIME** ([PidTagOriginalDeliveryTime](pidtagoriginaldeliverytime-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="8ee7e-130">邮件发送的日期和时间</span><span class="sxs-lookup"><span data-stu-id="8ee7e-130">Date and time when the message was sent</span></span>  <br/> |
|<span data-ttu-id="8ee7e-131">**PR_SUBJECT (** [PidTagSubject)](pidtagsubject-canonical-property.md)</span><span class="sxs-lookup"><span data-stu-id="8ee7e-131">**PR_SUBJECT** ([PidTagSubject](pidtagsubject-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="8ee7e-132">邮件主题行</span><span class="sxs-lookup"><span data-stu-id="8ee7e-132">Message subject line</span></span>  <br/> |
   
<span data-ttu-id="8ee7e-133">请注意，邮件中显示的属性集与表中显示的列集不同。</span><span class="sxs-lookup"><span data-stu-id="8ee7e-133">Notice that the set of properties displayed in the message are not the same as the set of columns displayed in the table.</span></span> <span data-ttu-id="8ee7e-134">表的实现程序（本例中为邮件存储提供程序）按默认顺序提供一组默认列。</span><span class="sxs-lookup"><span data-stu-id="8ee7e-134">The implementer of the table, in this case a message store provider, supplies a default set of columns in a default order.</span></span> <span data-ttu-id="8ee7e-135">客户端可以修改此列集，请求其他列或拒绝默认列，并请求以特定方式对列进行排序。</span><span class="sxs-lookup"><span data-stu-id="8ee7e-135">The client can modify this column set, requesting additional columns or rejecting default ones, and ask that they be ordered in a specific way.</span></span> <span data-ttu-id="8ee7e-136">客户端还可以对行进行排序，根据一列或多列的值对行进行排序。</span><span class="sxs-lookup"><span data-stu-id="8ee7e-136">The client can also order the rows, sorting them according to the value of one or more columns.</span></span>
  
<span data-ttu-id="8ee7e-137">**使用表格显示文件夹内容**</span><span class="sxs-lookup"><span data-stu-id="8ee7e-137">**Using a table to display folder contents**</span></span>
  
<span data-ttu-id="8ee7e-138">![使用表显示文件夹]使用(media/amapi_54.gif "表来显示文件夹内容")</span><span class="sxs-lookup"><span data-stu-id="8ee7e-138">![Using a table to display folder contents](media/amapi_54.gif "Using a table to display folder contents")</span></span>
  
<span data-ttu-id="8ee7e-139">有两个接口用于处理表：</span><span class="sxs-lookup"><span data-stu-id="8ee7e-139">There are two interfaces for working with tables:</span></span>
  
- <span data-ttu-id="8ee7e-140">[IMAPITable ：IUnknown](imapitableiunknown.md) 为客户端和服务提供商提供表基础数据的只读视图，从而允许他们仅查看和更改演示文稿。</span><span class="sxs-lookup"><span data-stu-id="8ee7e-140">[IMAPITable : IUnknown](imapitableiunknown.md) gives clients and service providers a read-only view of the underlying data of the table, allowing them to view and change only the presentation.</span></span> <span data-ttu-id="8ee7e-141">多个用户可以使用 **IMAPITable** 同时访问相同的数据。</span><span class="sxs-lookup"><span data-stu-id="8ee7e-141">Multiple users can access the same data concurrently with **IMAPITable**.</span></span> <span data-ttu-id="8ee7e-142">**IMAPITable** 由 MAPI 和服务提供商实现。</span><span class="sxs-lookup"><span data-stu-id="8ee7e-142">**IMAPITable** is implemented by MAPI and by service providers.</span></span> 
    
- <span data-ttu-id="8ee7e-143">[ITableData ：IUnknown](itabledataiunknown.md) 为客户端和服务提供商提供对表的基础数据的读/写访问权限，从而允许它们进行永久性更改。</span><span class="sxs-lookup"><span data-stu-id="8ee7e-143">[ITableData : IUnknown](itabledataiunknown.md) gives clients and service providers read/write access to the underlying data of the table, allowing them to make permanent changes.</span></span> <span data-ttu-id="8ee7e-144">**IMAPITable** 由 MAPI 实现，主要由通过调用 [CreateTable](createtable.md) 函数访问它的服务提供商使用。</span><span class="sxs-lookup"><span data-stu-id="8ee7e-144">**IMAPITable** is implemented by MAPI and used primarily by service providers who access it by calling the [CreateTable](createtable.md) function.</span></span> <span data-ttu-id="8ee7e-145">**ITableData** 实现在内存中保留表的所有数据和任何关联的限制，从而不适合用于非常大的表。</span><span class="sxs-lookup"><span data-stu-id="8ee7e-145">The **ITableData** implementation holds all the data for the table and any associated restrictions in memory, making it unsuitable for use with very large tables.</span></span> <span data-ttu-id="8ee7e-146">复合限制和复杂操作（如分类）不受支持。</span><span class="sxs-lookup"><span data-stu-id="8ee7e-146">Compound restrictions and complex operations such as categorization are unsupported.</span></span> 
    
## <a name="see-also"></a><span data-ttu-id="8ee7e-147">另请参阅</span><span class="sxs-lookup"><span data-stu-id="8ee7e-147">See also</span></span>

- [<span data-ttu-id="8ee7e-148">MAPI 概念</span><span class="sxs-lookup"><span data-stu-id="8ee7e-148">MAPI Concepts</span></span>](mapi-concepts.md)

