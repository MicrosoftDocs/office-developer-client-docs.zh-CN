---
title: MAPI 表
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 7974cae1-10f1-42e9-8be4-c02f2bd86714
description: 上次修改时间：2015 年 3 月 9 日
ms.openlocfilehash: 7c3c4479cd401a163e34c819ecd44e86d1d01965
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/11/2018
ms.locfileid: "19776346"
---
# <a name="mapi-tables"></a><span data-ttu-id="bebf8-103">MAPI 表</span><span class="sxs-lookup"><span data-stu-id="bebf8-103">MAPI tables</span></span>
  
<span data-ttu-id="bebf8-104">**适用于**： Outlook</span><span class="sxs-lookup"><span data-stu-id="bebf8-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="bebf8-105">MAPI 表是一个 MAPI 对象，用于查看属于特定类型的其他 MAPI 对象的属性的集合。</span><span class="sxs-lookup"><span data-stu-id="bebf8-105">A MAPI table is a MAPI object that is used to view a collection of properties belonging to other MAPI objects of a particular type.</span></span> <span data-ttu-id="bebf8-106">MAPI 表行和列的格式结构化表示对象和代表对象的属性的每个列的每个行。</span><span class="sxs-lookup"><span data-stu-id="bebf8-106">MAPI tables are structured in a row and column format with each row representing an object and each column representing a property of the object.</span></span> <span data-ttu-id="bebf8-107">通常在每行中包含的属性之一是**PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)) 属性，可用于打开和修改该对象的标识符。</span><span class="sxs-lookup"><span data-stu-id="bebf8-107">One of the properties usually included in each row is the **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)) property, an identifier that can be used to open and modify the object.</span></span> 
  
<span data-ttu-id="bebf8-108">由于行包含属性值，从表中检索行是类似于直接从行代表的对象中获取一组属性。</span><span class="sxs-lookup"><span data-stu-id="bebf8-108">Because rows contain property values, retrieving a row from a table is similar to getting a set of properties directly from the object that the row represents.</span></span> <span data-ttu-id="bebf8-109">这两种操作导致的检索属性值数组中。</span><span class="sxs-lookup"><span data-stu-id="bebf8-109">Both operations result in the retrieval of a property value array.</span></span> <span data-ttu-id="bebf8-110">主要区别在于处理的长字符串和二进制文件的属性。</span><span class="sxs-lookup"><span data-stu-id="bebf8-110">The main difference is in the handling of long string and binary properties.</span></span> <span data-ttu-id="bebf8-111">以包含在表中，某些表实施截断为 255 个字节这些属性。</span><span class="sxs-lookup"><span data-stu-id="bebf8-111">For inclusion in a table, some table implementers truncate these properties to 255 bytes.</span></span> <span data-ttu-id="bebf8-112">直接从对象中检索，完整的值时始终可用。</span><span class="sxs-lookup"><span data-stu-id="bebf8-112">When retrieved directly from the object, the full value is always available.</span></span>
  
<span data-ttu-id="bebf8-113">表被实现的地址簿和消息存储提供程序和 MAPI，具体取决于表和其中的对象类型。</span><span class="sxs-lookup"><span data-stu-id="bebf8-113">Tables are implemented by address book and message store providers and by MAPI, depending on the type of table and the objects within it.</span></span> <span data-ttu-id="bebf8-114">消息存储提供程序实现文件夹和邮件的信息包括文件夹中每个文件夹内容表。</span><span class="sxs-lookup"><span data-stu-id="bebf8-114">A message store provider implements folders and a contents table for each folder that includes information about the messages in the folder.</span></span> <span data-ttu-id="bebf8-115">通讯簿提供程序实现通讯簿容器和显示其组织的层次结构表。</span><span class="sxs-lookup"><span data-stu-id="bebf8-115">An address book provider implements address book containers and a hierarchy table that shows their organization.</span></span> <span data-ttu-id="bebf8-116">MAPI 实现多个不同的表、 一些以供客户端应用程序、 一些由服务提供程序，使用和一些用于这二者。</span><span class="sxs-lookup"><span data-stu-id="bebf8-116">MAPI implements several different tables, some for use by client applications, some for use by service providers, and some for use by both.</span></span> <span data-ttu-id="bebf8-117">状态表是唯一的 MAPI 最终提供表中，但行组成除了 MAPI 服务提供商的所有类型的贡献。</span><span class="sxs-lookup"><span data-stu-id="bebf8-117">The status table is unique in that MAPI ultimately supplies the table, but the rows are comprised of contributions from all types of service providers in addition to MAPI.</span></span> 
  
<span data-ttu-id="bebf8-118">下图显示一个表的常见用途之一 MAPI 中： 显示文件夹的内容。</span><span class="sxs-lookup"><span data-stu-id="bebf8-118">The following illustration shows one of the frequent uses of a table in MAPI: to display the contents of a folder.</span></span> <span data-ttu-id="bebf8-119">在右侧显示的是两个邮件可能显示典型消息客户端应用程序中。</span><span class="sxs-lookup"><span data-stu-id="bebf8-119">On the right is a display of two messages as might appear in a typical messaging client application.</span></span> <span data-ttu-id="bebf8-120">显示包含四个部分有关每个邮件的信息： 发件人、 收件人、 主题和消息文本。</span><span class="sxs-lookup"><span data-stu-id="bebf8-120">The display contains four pieces of information about each message: the sender, the recipient, the subject, and the message text.</span></span> <span data-ttu-id="bebf8-121">每条信息对应于邮件的属性。</span><span class="sxs-lookup"><span data-stu-id="bebf8-121">Each piece of information corresponds to a property of the message.</span></span>
  
<span data-ttu-id="bebf8-122">在左侧是包含这两个消息的内容表的视图。</span><span class="sxs-lookup"><span data-stu-id="bebf8-122">On the left is a view of the contents table that includes these two messages.</span></span> <span data-ttu-id="bebf8-123">而内容表可能具有十行，因为该文件夹具有十个邮件，其中每一行包含三个以上列多，则此特定视图仅限于只有两个行和三列。</span><span class="sxs-lookup"><span data-stu-id="bebf8-123">Whereas the contents table may have ten rows because the folder has ten messages, with each row containing many more than three columns, this particular view is limited to only two rows and three columns.</span></span>
  
<span data-ttu-id="bebf8-124">下表显示为表视图设置的列组成的属性。</span><span class="sxs-lookup"><span data-stu-id="bebf8-124">The following table shows the properties that make up the column set for the table view.</span></span>
  
|<span data-ttu-id="bebf8-125">**属性**</span><span class="sxs-lookup"><span data-stu-id="bebf8-125">**Property**</span></span>|<span data-ttu-id="bebf8-126">**说明**</span><span class="sxs-lookup"><span data-stu-id="bebf8-126">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="bebf8-127">**PR_SENDER_NAME**([PidTagSenderName](pidtagsendername-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="bebf8-127">**PR_SENDER_NAME** ([PidTagSenderName](pidtagsendername-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="bebf8-128">发件人姓名</span><span class="sxs-lookup"><span data-stu-id="bebf8-128">Sender name</span></span>  <br/> |
|<span data-ttu-id="bebf8-129">**PR_ORIGINAL_DELIVERY_TIME**([PidTagOriginalDeliveryTime](pidtagoriginaldeliverytime-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="bebf8-129">**PR_ORIGINAL_DELIVERY_TIME** ([PidTagOriginalDeliveryTime](pidtagoriginaldeliverytime-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="bebf8-130">日期和时间发送邮件时</span><span class="sxs-lookup"><span data-stu-id="bebf8-130">Date and time when the message was sent</span></span>  <br/> |
|<span data-ttu-id="bebf8-131">**PR_SUBJECT**([PidTagSubject](pidtagsubject-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="bebf8-131">**PR_SUBJECT** ([PidTagSubject](pidtagsubject-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="bebf8-132">邮件主题行</span><span class="sxs-lookup"><span data-stu-id="bebf8-132">Message subject line</span></span>  <br/> |
   
<span data-ttu-id="bebf8-133">请注意的消息中显示的属性集不是表中显示的列集相同。</span><span class="sxs-lookup"><span data-stu-id="bebf8-133">Notice that the set of properties displayed in the message are not the same as the set of columns displayed in the table.</span></span> <span data-ttu-id="bebf8-134">表的实施，在这种情况下一条消息存储提供程序，默认顺序中的列的供应品默认设置。</span><span class="sxs-lookup"><span data-stu-id="bebf8-134">The implementer of the table, in this case a message store provider, supplies a default set of columns in a default order.</span></span> <span data-ttu-id="bebf8-135">客户端可以请求其他列或拒绝默认模板，修改此列集，并要求，它们订购特定方式。</span><span class="sxs-lookup"><span data-stu-id="bebf8-135">The client can modify this column set, requesting additional columns or rejecting default ones, and ask that they be ordered in a specific way.</span></span> <span data-ttu-id="bebf8-136">客户端也可以订购行中，根据的一个或多个列的值对它们进行排序。</span><span class="sxs-lookup"><span data-stu-id="bebf8-136">The client can also order the rows, sorting them according to the value of one or more columns.</span></span>
  
<span data-ttu-id="bebf8-137">**使用表格显示文件夹内容**</span><span class="sxs-lookup"><span data-stu-id="bebf8-137">**Using a table to display folder contents**</span></span>
  
<span data-ttu-id="bebf8-138">![使用表以显示文件夹内容](media/amapi_54.gif "使用表以显示文件夹内容")</span><span class="sxs-lookup"><span data-stu-id="bebf8-138">![Using a table to display folder contents](media/amapi_54.gif "Using a table to display folder contents")</span></span>
  
<span data-ttu-id="bebf8-139">有两个接口用于处理表：</span><span class="sxs-lookup"><span data-stu-id="bebf8-139">There are two interfaces for working with tables:</span></span>
  
- <span data-ttu-id="bebf8-140">[IMAPITable: IUnknown](imapitableiunknown.md)提供客户端和服务提供商的基础数据的表中，使他们能够查看和更改仅在演示文稿只读的视图。</span><span class="sxs-lookup"><span data-stu-id="bebf8-140">[IMAPITable : IUnknown](imapitableiunknown.md) gives clients and service providers a read-only view of the underlying data of the table, allowing them to view and change only the presentation.</span></span> <span data-ttu-id="bebf8-141">多个用户可以访问同时**IMAPITable**相同的数据。</span><span class="sxs-lookup"><span data-stu-id="bebf8-141">Multiple users can access the same data concurrently with **IMAPITable**.</span></span> <span data-ttu-id="bebf8-142">通过 MAPI 和服务提供商实现**IMAPITable** 。</span><span class="sxs-lookup"><span data-stu-id="bebf8-142">**IMAPITable** is implemented by MAPI and by service providers.</span></span> 
    
- <span data-ttu-id="bebf8-143">[ITableData: IUnknown](itabledataiunknown.md)提供客户端和服务提供商读/写访问的基础数据的表中，从而允许进行永久更改。</span><span class="sxs-lookup"><span data-stu-id="bebf8-143">[ITableData : IUnknown](itabledataiunknown.md) gives clients and service providers read/write access to the underlying data of the table, allowing them to make permanent changes.</span></span> <span data-ttu-id="bebf8-144">**IMAPITable**是由 MAPI 实现，主要由服务提供商访问通过调用[CreateTable](createtable.md)函数。</span><span class="sxs-lookup"><span data-stu-id="bebf8-144">**IMAPITable** is implemented by MAPI and used primarily by service providers who access it by calling the [CreateTable](createtable.md) function.</span></span> <span data-ttu-id="bebf8-145">**ITableData**实现包含表格的所有数据和任何相关限制在内存中，使其适合使用非常大的表。</span><span class="sxs-lookup"><span data-stu-id="bebf8-145">The **ITableData** implementation holds all the data for the table and any associated restrictions in memory, making it unsuitable for use with very large tables.</span></span> <span data-ttu-id="bebf8-146">复合限制和复杂操作，例如分类不受支持。</span><span class="sxs-lookup"><span data-stu-id="bebf8-146">Compound restrictions and complex operations such as categorization are unsupported.</span></span> 
    
## <a name="see-also"></a><span data-ttu-id="bebf8-147">另请参阅</span><span class="sxs-lookup"><span data-stu-id="bebf8-147">See also</span></span>

- [<span data-ttu-id="bebf8-148">MAPI 概念</span><span class="sxs-lookup"><span data-stu-id="bebf8-148">MAPI Concepts</span></span>](mapi-concepts.md)

