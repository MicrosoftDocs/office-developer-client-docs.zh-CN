---
title: 通讯簿标识符
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 40f6c699-86aa-4324-a30d-12c8f1e2de9c
description: 上次修改时间：2011 年 7 月 23 日
ms.openlocfilehash: 822d83c4b77d06c2e000b391c7e229985470ccd3
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/28/2019
ms.locfileid: "33421569"
---
# <a name="address-book-identifiers"></a><span data-ttu-id="5d9f8-103">通讯簿标识符</span><span class="sxs-lookup"><span data-stu-id="5d9f8-103">Address Book Identifiers</span></span>

  
  
<span data-ttu-id="5d9f8-104">**适用于**：Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="5d9f8-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="5d9f8-105">所有通讯簿提供程序使用**PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)) 属性为其邮件用户和通讯组列表对象分配条目标识符。</span><span class="sxs-lookup"><span data-stu-id="5d9f8-105">All address book providers assign entry identifiers using the **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)) property to their messaging user and distribution list objects.</span></span> <span data-ttu-id="5d9f8-106">客户端应用程序使用这些条目标识符打开和访问分配给它们的对象。</span><span class="sxs-lookup"><span data-stu-id="5d9f8-106">Client applications use these entry identifiers to open and access the objects to which they are assigned.</span></span>
  
<span data-ttu-id="5d9f8-107">通讯簿使用了三种其他类型的标识符来表示对象:</span><span class="sxs-lookup"><span data-stu-id="5d9f8-107">The address book makes use of three other types of identifiers to represent objects:</span></span>
  
- <span data-ttu-id="5d9f8-108">一次性条目标识符</span><span class="sxs-lookup"><span data-stu-id="5d9f8-108">One-off entry identifiers</span></span>
    
- <span data-ttu-id="5d9f8-109">一次性模板条目标识符</span><span class="sxs-lookup"><span data-stu-id="5d9f8-109">One-off template entry identifiers</span></span>
    
- <span data-ttu-id="5d9f8-110">模板标识符</span><span class="sxs-lookup"><span data-stu-id="5d9f8-110">Template identifiers</span></span>
    
<span data-ttu-id="5d9f8-111">由于条目标识符的种类不同以及它们的命名相似之处, 因此很容易对每种类型的使用和创建方式感到困惑。</span><span class="sxs-lookup"><span data-stu-id="5d9f8-111">Because of the variety of entry identifiers and the similarity with which they are named, it is easy to become confused about how each type is used and created.</span></span> 
  
<span data-ttu-id="5d9f8-112">一次性条目标识符是一个条目标识符, 用于打开和访问称为 "一次性" 或 "自定义收件人" 的收件人类型。</span><span class="sxs-lookup"><span data-stu-id="5d9f8-112">A one-off entry identifier is an entry identifier that is used to open and access the type of recipient known as a one-off, or custom recipient.</span></span> <span data-ttu-id="5d9f8-113">一项操作是不属于配置文件中的任何通讯簿提供程序的收件人。</span><span class="sxs-lookup"><span data-stu-id="5d9f8-113">One-offs are recipients that do not belong to any of the address book providers in the profile.</span></span> <span data-ttu-id="5d9f8-114">分配给一次性的条目标识符使用专为一次性收件人保留的格式。</span><span class="sxs-lookup"><span data-stu-id="5d9f8-114">The entry identifiers assigned to one-offs use a format specifically reserved for one-off recipients.</span></span> <span data-ttu-id="5d9f8-115">由于一次性条目标识符用于打开和访问对象, 因此它们存储在 PR_ENTRYID 属性中。</span><span class="sxs-lookup"><span data-stu-id="5d9f8-115">Because one-off entry identifiers are used to open and access objects, they are stored in the PR_ENTRYID property.</span></span>
  
<span data-ttu-id="5d9f8-116">创建一次性条目标识符和一次性条目标识符:</span><span class="sxs-lookup"><span data-stu-id="5d9f8-116">One-offs and one-off entry identifiers are created:</span></span>
  
- <span data-ttu-id="5d9f8-117">当客户端应用程序的用户选择将不表示通讯簿中任何条目的收件人添加到邮件的收件人列表中时。</span><span class="sxs-lookup"><span data-stu-id="5d9f8-117">When users of a client application elect to add a recipient that does not represent any entry in the address book to a message's recipient list.</span></span>
    
- <span data-ttu-id="5d9f8-118">当客户端应用程序的用户选择将不表示通讯簿中任何条目的收件人添加到可修改的通讯簿容器中时。</span><span class="sxs-lookup"><span data-stu-id="5d9f8-118">When users of a client application elect to add a recipient that does not represent any entry in the address book to a modifiable address book container.</span></span>
    
- <span data-ttu-id="5d9f8-119">当传输提供程序接收到地址不能由其相关通讯簿提供程序处理的邮件时。</span><span class="sxs-lookup"><span data-stu-id="5d9f8-119">When a transport provider receives a message with an address that cannot be handled by its related address book provider.</span></span>
    
- <span data-ttu-id="5d9f8-120">传输提供程序接收到地址属于网关的邮件时。</span><span class="sxs-lookup"><span data-stu-id="5d9f8-120">When a transport provider receives a message with an address that belongs to a gateway.</span></span>
    
<span data-ttu-id="5d9f8-121">在前两种情况下, 客户端调用**IAddrBook:: CreateOneOff**将一次性条目标识符与新创建的一次性收件人相关联。</span><span class="sxs-lookup"><span data-stu-id="5d9f8-121">In the first two situations, the client calls **IAddrBook::CreateOneOff** to associate a one-off entry identifier with the newly created one-off recipient.</span></span> <span data-ttu-id="5d9f8-122">在这两种情况下, 传输提供程序调用**IMAPISupport:: CreateOneOff**将一次性条目标识符与外部地址关联。</span><span class="sxs-lookup"><span data-stu-id="5d9f8-122">In the second two situations, the transport provider calls **IMAPISupport::CreateOneOff** to associate a one-off entry identifier with the foreign address.</span></span> <span data-ttu-id="5d9f8-123">有关详细信息, 请参阅[IAddrBook:: CreateOneOff](iaddrbook-createoneoff.md)和[IMAPISupport:: CreateOneOff](imapisupport-createoneoff.md)。</span><span class="sxs-lookup"><span data-stu-id="5d9f8-123">For more information, see [IAddrBook::CreateOneOff](iaddrbook-createoneoff.md) and [IMAPISupport::CreateOneOff](imapisupport-createoneoff.md).</span></span>
  
<span data-ttu-id="5d9f8-124">一次性模板条目标识符是一个短期条目标识符, 用于打开和访问用于创建一次性的模板。</span><span class="sxs-lookup"><span data-stu-id="5d9f8-124">A one-off template entry identifier is a short-term entry identifier that is used to open and access a template for creating one-offs.</span></span> <span data-ttu-id="5d9f8-125">通讯簿提供程序和 MAPI 提供模板, 用于输入创建特定类型的收件人所需的信息。</span><span class="sxs-lookup"><span data-stu-id="5d9f8-125">Both address book providers and MAPI supply templates for entering the information that is required to create a recipient of a particular type.</span></span> <span data-ttu-id="5d9f8-126">有关这些模板的信息 (包括其条目标识符) 在一次性表中发布。</span><span class="sxs-lookup"><span data-stu-id="5d9f8-126">Information about these templates, including their entry identifiers, is published in the one-off table.</span></span> <span data-ttu-id="5d9f8-127">当 MAPI 调用**IABLogon:: GetOneOffTable**方法或通讯簿容器的**IMAPIProp:: OpenProperty**方法以请求**PR_CREATE_TEMPLATES** ([PidTagCreateTemplates](pidtagcreatetemplates-canonical-property.md)) 时, 将显示一次性表属性或提供程序调用**IMAPISupport:: GetOneOffTable**时。</span><span class="sxs-lookup"><span data-stu-id="5d9f8-127">One-off tables are displayed when MAPI calls either the **IABLogon::GetOneOffTable** method or an address book container's **IMAPIProp::OpenProperty** method to request the **PR_CREATE_TEMPLATES** ([PidTagCreateTemplates](pidtagcreatetemplates-canonical-property.md)) property or when a provider calls **IMAPISupport::GetOneOffTable**.</span></span> <span data-ttu-id="5d9f8-128">有关详细信息, 请参阅[IABLogon:: GetOneOffTable](iablogon-getoneofftable.md)、 [IMAPIProp:: OpenProperty](imapiprop-openproperty.md)和[IMAPISupport:: GetOneOffTable](imapisupport-getoneofftable.md)。</span><span class="sxs-lookup"><span data-stu-id="5d9f8-128">For more information, see [IABLogon::GetOneOffTable](iablogon-getoneofftable.md), [IMAPIProp::OpenProperty](imapiprop-openproperty.md), and [IMAPISupport::GetOneOffTable](imapisupport-getoneofftable.md).</span></span>
  
<span data-ttu-id="5d9f8-129">若要创建新的一次性注销, 用户可以选择一次性表中列出的模板之一。</span><span class="sxs-lookup"><span data-stu-id="5d9f8-129">To create a new one-off, a user selects one of the templates listed in the one-off table.</span></span> <span data-ttu-id="5d9f8-130">客户端将 PR_ENTRYID 列从选定的行 (所选模板的一次性模板条目标识符) 传递到_lpEIDNewEntryTpl_参数中的**IAddrBook:: NewEntry** 。</span><span class="sxs-lookup"><span data-stu-id="5d9f8-130">The client passes the PR_ENTRYID column from the selected row, which is the one-off template entry identifier of the selected template, to **IAddrBook::NewEntry** in the  _lpEIDNewEntryTpl_ parameter.</span></span> <span data-ttu-id="5d9f8-131">有关详细信息, 请参阅[IAddrBook:: NewEntry](iaddrbook-newentry.md)。</span><span class="sxs-lookup"><span data-stu-id="5d9f8-131">For more information, see [IAddrBook::NewEntry](iaddrbook-newentry.md).</span></span> <span data-ttu-id="5d9f8-132">MAPI 使用一次性模板条目标识符来显示模板, 并允许用户输入创建收件人所需的信息。</span><span class="sxs-lookup"><span data-stu-id="5d9f8-132">MAPI uses the one-off template entry identifier to display the template and to allow the user to enter the information needed to create the recipient.</span></span> 
  
<span data-ttu-id="5d9f8-133">模板标识符是一个条目标识符, 除了 PR_ENTRYID 属性中保留的条目标识符外, 某些通讯簿提供程序会将其分配给收件人。</span><span class="sxs-lookup"><span data-stu-id="5d9f8-133">A template identifier is an entry identifier that some address book providers assign to their recipients in addition to the entry identifier that is kept in the PR_ENTRYID property.</span></span> <span data-ttu-id="5d9f8-134">提供程序设置收件人的**PR_TEMPLATEID** ([PidTagTemplateid](pidtagtemplateid-canonical-property.md)) 属性以存储其模板标识符。</span><span class="sxs-lookup"><span data-stu-id="5d9f8-134">Providers set a recipient's **PR_TEMPLATEID** ([PidTagTemplateid](pidtagtemplateid-canonical-property.md)) property to store its template identifier.</span></span> <span data-ttu-id="5d9f8-135">某些通讯簿提供程序为收件人的模板标识符和条目标识符属性分配相同的值。</span><span class="sxs-lookup"><span data-stu-id="5d9f8-135">Some address book providers assign the same value for a recipient's template identifier and entry identifier properties.</span></span>
  
<span data-ttu-id="5d9f8-136">模板标识符仅由通讯簿提供程序和 MAPI 用于将一个提供程序 (称为主机提供程序) 中的收件人数据绑定到另一个提供程序中的收件人代码 (称为外部提供程序)。</span><span class="sxs-lookup"><span data-stu-id="5d9f8-136">Template identifiers are used only by address book providers and by MAPI to bind recipient data in one provider, referred to as the host provider, to code for the recipient in another provider, referred to as the foreign provider.</span></span> <span data-ttu-id="5d9f8-137">主机提供程序为收件人提供存储空间;外部提供程序提供逻辑。</span><span class="sxs-lookup"><span data-stu-id="5d9f8-137">The host provider supplies the storage for the recipient; the foreign provider supplies the logic.</span></span> <span data-ttu-id="5d9f8-138">绑定过程使主机提供程序能够使用外部提供程序的代码更新其存储的收件人的数据。</span><span class="sxs-lookup"><span data-stu-id="5d9f8-138">The binding process enables a host provider to update the data of a recipient that it stores using the code of a foreign provider.</span></span>
  
<span data-ttu-id="5d9f8-139">当主机提供程序准备好修改其收件人时, 它会在对**IMAPISupport:: OpenTemplateID**方法的调用中传递 PR_TEMPLATEID 属性以启动绑定过程。</span><span class="sxs-lookup"><span data-stu-id="5d9f8-139">When the host provider is ready to modify its recipient, it passes the PR_TEMPLATEID property in a call to the **IMAPISupport::OpenTemplateID** method to initiate the binding process.</span></span> <span data-ttu-id="5d9f8-140">MAPI 通过对其**IABLogon:: OpenTemplateID**方法的调用, 将模板标识符传输给适当的外部提供程序, 从而继续执行此过程。</span><span class="sxs-lookup"><span data-stu-id="5d9f8-140">MAPI continues the process by transferring the template identifier to the appropriate foreign provider through a call to its **IABLogon::OpenTemplateID** method.</span></span> <span data-ttu-id="5d9f8-141">有关详细信息, 请参阅[IMAPISupport:: OpenTemplateID](imapisupport-opentemplateid.md)和[IABLogon:: OpenTemplateID](iablogon-opentemplateid.md)。</span><span class="sxs-lookup"><span data-stu-id="5d9f8-141">For more information, see [IMAPISupport::OpenTemplateID](imapisupport-opentemplateid.md) and [IABLogon::OpenTemplateID](iablogon-opentemplateid.md).</span></span> <span data-ttu-id="5d9f8-142">外部提供程序返回指向其**IMAPIProp**实现的指针, 宿主提供程序可以使用它来取代自己的实现。</span><span class="sxs-lookup"><span data-stu-id="5d9f8-142">The foreign provider returns a pointer to its **IMAPIProp** implementation for the recipient, which the host provider can use in place of its own implementation.</span></span> 
  

