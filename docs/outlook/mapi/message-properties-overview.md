---
title: 邮件属性概述
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 447f54de-9f0d-4f73-89b6-bed9cfea9c15
description: 上次修改时间： 2011 年 7 月 23 日
ms.openlocfilehash: edbc833b411e56e2efb26631362dd25ea42c3c9f
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/23/2018
ms.locfileid: "22571407"
---
# <a name="message-properties-overview"></a><span data-ttu-id="fe12f-103">邮件属性概述</span><span class="sxs-lookup"><span data-stu-id="fe12f-103">Message Properties Overview</span></span>

  
  
<span data-ttu-id="fe12f-104">**适用于**： Outlook 2013 |Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="fe12f-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="fe12f-105">MAPI 将分为三种类型的邮件属性：</span><span class="sxs-lookup"><span data-stu-id="fe12f-105">MAPI divides message properties into three types:</span></span>
  
- <span data-ttu-id="fe12f-106">消息内容的属性。</span><span class="sxs-lookup"><span data-stu-id="fe12f-106">Message content properties.</span></span>
    
- <span data-ttu-id="fe12f-107">邮件传输或信封，属性。</span><span class="sxs-lookup"><span data-stu-id="fe12f-107">Message transmission, or envelope, properties.</span></span>
    
- <span data-ttu-id="fe12f-108">邮件收件人属性。</span><span class="sxs-lookup"><span data-stu-id="fe12f-108">Message recipient properties.</span></span>
    
<span data-ttu-id="fe12f-109">消息内容属性描述了一条消息的文本。</span><span class="sxs-lookup"><span data-stu-id="fe12f-109">Message content properties describe the text of a message.</span></span> <span data-ttu-id="fe12f-110">每个邮件类都有其自己的内容的属性集。</span><span class="sxs-lookup"><span data-stu-id="fe12f-110">Every message class has its own set of content properties.</span></span> <span data-ttu-id="fe12f-111">MAPI 定义内容注释和报告消息; 属性由客户端和消息存储提供程序用来处理这些类的消息，以设置其实现适当的属性。</span><span class="sxs-lookup"><span data-stu-id="fe12f-111">MAPI defines content properties for note and report messages; it is up to the clients and message store providers that handle these classes of messages to set the properties appropriately for their implementations.</span></span> <span data-ttu-id="fe12f-112">**PR_BODY**([PidTagBody](pidtagbody-canonical-property.md)) 和**PR_RTF_COMPRESSED** ([PidTagRtfCompressed](pidtagrtfcompressed-canonical-property.md)) 是注释消息的内容属性的示例。</span><span class="sxs-lookup"><span data-stu-id="fe12f-112">**PR_BODY** ([PidTagBody](pidtagbody-canonical-property.md)) and **PR_RTF_COMPRESSED** ([PidTagRtfCompressed](pidtagrtfcompressed-canonical-property.md)) are examples of content properties for note messages.</span></span> <span data-ttu-id="fe12f-113">**PR_BODY** **PR_RTF_COMPRESSED**包含一条注释的格式化内容的压缩的版本时包含的一条注释，无格式的内容。</span><span class="sxs-lookup"><span data-stu-id="fe12f-113">**PR_BODY** contains the unformatted contents of a note, while **PR_RTF_COMPRESSED** contains the compressed version of a note's formatted contents.</span></span> <span data-ttu-id="fe12f-114">有关属性标识符范围的详细信息，请参阅[属性标识符范围](property-identifier-ranges.md)。</span><span class="sxs-lookup"><span data-stu-id="fe12f-114">For more information about property identifier ranges, see [Property Identifier Ranges](property-identifier-ranges.md).</span></span>
  
<span data-ttu-id="fe12f-115">对于新的邮件类，客户端可以通过两种方式之一定义特定于内容的属性：</span><span class="sxs-lookup"><span data-stu-id="fe12f-115">For new message classes, clients can define content-specific properties in one of two ways:</span></span>
  
- <span data-ttu-id="fe12f-116">使用自定义消息类内容属性范围内属性标识符： 通过 0x7BFF 0x6800。</span><span class="sxs-lookup"><span data-stu-id="fe12f-116">By using property identifiers in the custom message class content properties range: 0x6800 through 0x7BFF.</span></span>
    
- <span data-ttu-id="fe12f-117">通过使用名为具有属于中通过 0xFFFE 范围 0x8000 的标识符的属性。</span><span class="sxs-lookup"><span data-stu-id="fe12f-117">By using named properties that have identifiers that fall in the 0x8000 through 0xFFFE range.</span></span>
    
<span data-ttu-id="fe12f-118">创建自定义邮件类别的任何客户端可用的自定义消息类内容属性标识符的范围。</span><span class="sxs-lookup"><span data-stu-id="fe12f-118">The identifier range for custom message class content properties is available to any client that creates a custom message class.</span></span> <span data-ttu-id="fe12f-119">因此，在此范围内的一个属性标识符可用于多个邮件类。</span><span class="sxs-lookup"><span data-stu-id="fe12f-119">Therefore, one property identifier in this range can be used for multiple message classes.</span></span> <span data-ttu-id="fe12f-120">此范围中的属性的用户无法进行假设来对行为的属性。</span><span class="sxs-lookup"><span data-stu-id="fe12f-120">Users of properties in this range cannot make assumptions as to the behavior of the properties.</span></span> 
  
<span data-ttu-id="fe12f-121">对于命名属性，客户端创建指定属性集和一个字符的字符串或数值的每个新属性的名称。</span><span class="sxs-lookup"><span data-stu-id="fe12f-121">For named properties, clients create a name that specifies a property set and either a character string or a numeric value for each new property.</span></span> <span data-ttu-id="fe12f-122">然后，客户端将属性关联命名的属性区域中的标识符。</span><span class="sxs-lookup"><span data-stu-id="fe12f-122">Clients then associate the property with an identifier in the named property range.</span></span> <span data-ttu-id="fe12f-123">用户的命名属性访问它们通过名称或标识符通过[IMAPIProp::GetIDsFromNames](imapiprop-getidsfromnames.md)和[IMAPIProp::GetNamesFromIDs](imapiprop-getnamesfromids.md)方法。</span><span class="sxs-lookup"><span data-stu-id="fe12f-123">Users of named properties access them by name or identifier through the [IMAPIProp::GetIDsFromNames](imapiprop-getidsfromnames.md) and [IMAPIProp::GetNamesFromIDs](imapiprop-getnamesfromids.md) methods.</span></span> 
  
<span data-ttu-id="fe12f-124">信封属性提供了用于传输到另一条消息从一个收件人的信息。</span><span class="sxs-lookup"><span data-stu-id="fe12f-124">Envelope properties provide information that is used to transmit a message from one recipient to another.</span></span> <span data-ttu-id="fe12f-125">与邮件内容属性，则可能客户端或服务提供商定义自己的信封属性，来补充那些 MAPI 定义。</span><span class="sxs-lookup"><span data-stu-id="fe12f-125">As with message content properties, it is possible for clients or service providers to define their own envelope properties to supplement those that MAPI defines.</span></span> <span data-ttu-id="fe12f-126">客户端和传输提供程序设置信封属性 MAPI 定义基于 MAPI 提供定义。</span><span class="sxs-lookup"><span data-stu-id="fe12f-126">Clients and transport providers set the envelope properties that MAPI defines based on the definition that MAPI provides.</span></span> <span data-ttu-id="fe12f-127">传输提供程序实现特殊功能可以定义自己的信封属性公开这些客户端功能。</span><span class="sxs-lookup"><span data-stu-id="fe12f-127">Transport providers that implement special features can define their own envelope properties to expose those features to clients.</span></span> <span data-ttu-id="fe12f-128">MAPI 留出设置各种属性可用于这些提供程序定义的特殊属性的标识符。</span><span class="sxs-lookup"><span data-stu-id="fe12f-128">MAPI sets aside a range of property identifiers that can be used for these special provider-defined properties.</span></span> <span data-ttu-id="fe12f-129">传输提供程序通常实现一个特殊的属性页面来显示这些属性，使客户端可以更改它们。</span><span class="sxs-lookup"><span data-stu-id="fe12f-129">Transport providers typically implement a special property page to display these properties and enable clients to change them.</span></span> <span data-ttu-id="fe12f-130">**PR_SUBJECT**([PidTagSubject](pidtagsubject-canonical-property.md)) 和**PR_MESSAGE_CLASS** ([PidTagMessageClass](pidtagmessageclass-canonical-property.md)) 是信封属性的示例。</span><span class="sxs-lookup"><span data-stu-id="fe12f-130">**PR_SUBJECT** ([PidTagSubject](pidtagsubject-canonical-property.md)) and **PR_MESSAGE_CLASS** ([PidTagMessageClass](pidtagmessageclass-canonical-property.md)) are examples of envelope properties.</span></span> <span data-ttu-id="fe12f-131">有关详细信息，请参阅[属性标识符范围](property-identifier-ranges.md)。</span><span class="sxs-lookup"><span data-stu-id="fe12f-131">For more information, see [Property Identifier Ranges](property-identifier-ranges.md).</span></span>
  
<span data-ttu-id="fe12f-132">收件人属性描述发送消息的目标。</span><span class="sxs-lookup"><span data-stu-id="fe12f-132">Recipient properties describe the destination for a sent message.</span></span> <span data-ttu-id="fe12f-133">收件人可以是邮件用户、 通讯组列表或计算机。</span><span class="sxs-lookup"><span data-stu-id="fe12f-133">A recipient can be a messaging user, distribution list, or a computer.</span></span> <span data-ttu-id="fe12f-134">收件人属性通过 MAPI 定义和设置服务提供商。</span><span class="sxs-lookup"><span data-stu-id="fe12f-134">Recipient properties are defined by MAPI and set by service providers.</span></span> <span data-ttu-id="fe12f-135">通讯簿提供程序为其消息的用户和通讯组列表对象; 支持某些收件人属性通过客户端、 消息存储提供程序或传输提供程序支持其他收件人的属性。</span><span class="sxs-lookup"><span data-stu-id="fe12f-135">Some recipient properties are supported by address book providers for their messaging user and distribution list objects; other recipient properties are supported by clients, message store providers, or transport providers.</span></span> <span data-ttu-id="fe12f-136">例如，所有收件人都需要一个地址和地址类型;这些是当收件人存储及其容器之一时，由通讯簿提供程序维护的属性。</span><span class="sxs-lookup"><span data-stu-id="fe12f-136">For example, all recipients require an address and an address type; these are properties maintained by an address book provider when the recipient is stored in one of its containers.</span></span> <span data-ttu-id="fe12f-137">收件人还有类型， **PR_RECIPIENT_TYPE** ([PidTagRecipientType](pidtagrecipienttype-canonical-property.md))，其中将收件人标识为主、 抄送副本或密件抄送副本收件人。</span><span class="sxs-lookup"><span data-stu-id="fe12f-137">Recipients also have a type, **PR_RECIPIENT_TYPE** ([PidTagRecipientType](pidtagrecipienttype-canonical-property.md)), which identifies a recipient as either a primary, carbon copy, or blind carbon copy recipient.</span></span>
  
<span data-ttu-id="fe12f-138">许多消息属性是可选的这意味着客户端无法期望它们是可用或设置为有效的值。</span><span class="sxs-lookup"><span data-stu-id="fe12f-138">Many message properties are optional, meaning that clients cannot expect them to be available or set to valid values.</span></span> <span data-ttu-id="fe12f-139">某些消息属性是必需的但提供，仅当邮件中的特定状态。</span><span class="sxs-lookup"><span data-stu-id="fe12f-139">Some message properties are required but available only when a message is in a particular state.</span></span> <span data-ttu-id="fe12f-140">例如，新创建的消息不需要后已保存消息，且不需要具有消息之前准备要提交的邮件类具有直到条目标识符。</span><span class="sxs-lookup"><span data-stu-id="fe12f-140">For example, a newly created message is not required to have an entry identifier until after the message has been saved, and it is not required to have a message class until the message is ready to be submitted.</span></span> <span data-ttu-id="fe12f-141">客户端应始终检查其[IMAPIProp::GetProps](imapiprop-getprops.md)和[IMAPIProp::OpenProperty](imapiprop-openproperty.md)调用的结果，并具有默认值作为备份准备好，以防请求的属性不可用。</span><span class="sxs-lookup"><span data-stu-id="fe12f-141">Clients should always check the results of their [IMAPIProp::GetProps](imapiprop-getprops.md) and [IMAPIProp::OpenProperty](imapiprop-openproperty.md) calls and have default values ready as a backup in case a requested property is unavailable.</span></span> 
  
<span data-ttu-id="fe12f-142">大多数服务提供商设置的邮件属性是只读的客户端。</span><span class="sxs-lookup"><span data-stu-id="fe12f-142">Most message properties that service providers set are read-only to clients.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="fe12f-143">另请参阅</span><span class="sxs-lookup"><span data-stu-id="fe12f-143">See also</span></span>



[<span data-ttu-id="fe12f-144">MAPI 邮件</span><span class="sxs-lookup"><span data-stu-id="fe12f-144">MAPI Messages</span></span>](mapi-messages.md)

