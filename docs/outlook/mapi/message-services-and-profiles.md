---
title: 邮件服务和配置文件
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: df0db1e4-69c8-44ec-bb2a-d31fc8a564b9
description: 上次修改时间：2011 年 7 月 23 日
ms.openlocfilehash: 78a13bacf13b019bbf9436830ad66db7fdfaf425
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/28/2019
ms.locfileid: "33415465"
---
# <a name="message-services-and-profiles"></a>邮件服务和配置文件
  
**适用于**：Outlook 2013 | Outlook 2016 
  
某些用户需要多个邮件系统（每个都有一个或多个服务提供商）的服务。 由于单独安装和配置其中每个服务提供程序比较麻烦，并且邮件服务器通常需要一组相关提供程序来公开其所有功能，因此 MAPI 包含邮件服务的概念。 邮件服务可帮助用户安装和配置其服务提供程序。
  
若要创建邮件服务，开发人员编写邮件服务入口点程序来处理服务中每个提供程序的配置，并编写安装程序以执行以下操作：
  
- 安装服务中的每个提供程序。
    
- 创建注册表和初始化文件条目。
    
- 在 MAPI 配置文件 Mapisvc.inf 中创建条目。
    
Mapisvc.inf 文件包含与计算机上安装的所有邮件服务和服务提供程序的配置有关的信息。 它按层次结构分区进行组织，每个级别链接到下一个级别。 顶部的三个部分包含以下内容： 
  
- 邮件服务帮助文件的列表。
    
- 最重要的（或默认）邮件服务的列表。
    
- 计算机上所有服务的列表。
    
下一个级别包含每个邮件服务的节，最后一个级别包含服务中每个服务提供程序的节。 MAPI 要求服务提供商和邮件服务的开发人员将某些条目添加到 Mapisvc.inf;开发人员可以自行决定添加其他条目。 Mapisvc.inf 中的大部分信息最终在一个或多个配置文件中，即用户的首选邮件服务集的配置信息集合。 由于一台计算机可以有多个用户，并且一个用户可以具有多组首选项，因此计算机上可以存在许多配置文件。 每个配置文件描述一组不同的邮件服务。 通过拥有多个配置文件，用户可以在家使用一组邮件服务，在办公室使用一组不同的邮件服务。
  
配置文件是在邮件服务安装时或登录时由提供配置支持的客户端应用程序创建的。 MAPI 提供两个此类客户端应用程序：控制面板项和配置文件向导。 "控制面板"项是一个全服务配置应用程序，用户可以使用该应用程序创建、删除、编辑和复制配置文件，以及修改配置文件中的条目。 配置文件向导是一个简单的应用程序，旨在尽可能轻松地向配置文件添加邮件服务。 配置文件向导由一系列对话框（称为属性页）组成，这些对话框将提示用户完成安装和配置服务的过程。 系统仅提示用户输入最重要的设置的值;所有其他设置继承默认值。 创建配置文件后，不允许用户进行更改。 
  
"控制面板"项始终通过"控制面板"调用，但有多种方案可能导致调用配置文件向导。 客户端应用程序可以调用配置文件向导，以在尚未创建配置文件时在登录时创建默认配置文件。 控制面板项或其他客户端应用程序可以依赖配置文件向导中已有的功能，而不是重新实现代码来添加配置文件。 当需要将服务添加到默认配置文件时，邮件服务在其入口点功能中可以调用配置文件向导。 使用配置文件向导的邮件服务必须编写一个额外的入口点函数和一个标准 Windows对话框过程。 配置文件向导调用入口点函数以检索服务的配置对话框，而对话框过程处理使用此对话框时生成的消息。 
  
配置文件的组织方式与 Mapisvc.inf 文件类似。 配置文件具有链接的分层分区;服务提供商在最低级别拥有分区，邮件服务在中间级别拥有分区，MAPI 拥有最高级别的分区。 每个部分都用一个称为 [MAPIUID 的唯一标识符进行标识](mapiuid.md)。 MAPI 部分包含 MAPI 内部的信息，例如所有邮件服务配置文件节的标识符以及指向其他每个部分的链接。 每个邮件服务节存储指向其提供程序分区的链接，而每个提供程序节存储指向其服务节的链接。 
  
下图显示了两个典型配置文件的内容。 Sam 的计算机上有两个配置文件，一个供家庭使用，一个供办公室使用。 主配置文件包含三个邮件服务。 邮件服务 X 是一种用于通讯簿管理的提供程序服务。 邮件服务 Y 和 Z 有三个提供程序 — 通讯簿提供程序、邮件存储提供程序和传输提供程序。 Sam 的工作配置文件包含两个不同的邮件服务，每个服务都有一个通讯簿提供程序、一个邮件存储提供程序和一个传输提供程序。 
  
**配置文件示例**
  
![配置文件示例](media/amapi_56.gif "配置文件示例")
  
下图显示了包含两个邮件服务的配置文件。 用于安装和配置属于邮件服务的服务提供程序的代码与提供程序的代码驻留在同一 DLL 中。 此代码在登录时从配置文件中读取信息以配置服务提供程序，并在必要时提示用户缺少信息。 来自客户端的查看或更改任何提供程序的配置设置的请求也由此通用代码处理。
  
**安装和配置服务提供程序**
  
![安装和配置服务提供程序](media/amapi_55.gif "安装和配置服务提供程序")
  
## <a name="see-also"></a>另请参阅

- [MAPIUID](mapiuid.md)
- [MAPI 编程概述](mapi-programming-overview.md)

