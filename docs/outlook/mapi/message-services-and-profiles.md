---
title: 邮件服务和配置文件
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: df0db1e4-69c8-44ec-bb2a-d31fc8a564b9
description: 上次修改时间：2011 年 7 月 23 日
ms.openlocfilehash: 78a13bacf13b019bbf9436830ad66db7fdfaf425
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/28/2019
ms.locfileid: "33415465"
---
# <a name="message-services-and-profiles"></a>邮件服务和配置文件
  
**适用于**：Outlook 2013 | Outlook 2016 
  
有些用户需要多个邮件系统的服务, 每个系统都有一个或多个服务提供商。 由于需要单独安装和配置每个服务提供程序, 因此, 如果邮件服务器通常需要一组相关提供程序来公开其所有功能, 则 MAPI 包括邮件服务的概念, 这一点非常麻烦。 邮件服务可帮助用户安装和配置其服务提供商。
  
若要创建邮件服务, 开发人员需要编写消息服务入口点程序来处理服务中的每个提供程序的配置和安装程序, 以执行以下操作:
  
- 在服务中安装每个提供程序。
    
- 创建注册表和初始化文件项。
    
- 在 MAPI 配置文件 mapisvc.inf 中创建条目。
    
mapisvc.inf 文件包含与计算机上安装的所有邮件服务和服务提供程序的配置相关的信息。 它在层次结构部分中进行组织, 每个级别都链接到下一个。 顶部包括三个部分, 其中包含以下内容: 
  
- 邮件服务帮助文件的列表。
    
- 最重要的或默认的邮件服务的列表。
    
- 计算机上所有服务的列表。
    
下一个级别包含每个邮件服务的部分, 最后一个级别包含服务中每个服务提供程序的部分。 MAPI 要求服务提供商和邮件服务的开发人员向 mapisvc.inf 中添加某些项;开发人员可以自行决定添加其他项。 mapisvc.inf 中的大多数信息在一个或多个配置文件中结束, 后者是用户首选的一组邮件服务的配置信息集合。 由于计算机可以拥有多个用户, 并且一个用户可以有多个首选项集, 因此计算机上可能存在许多配置文件。 每个配置文件描述一组不同的邮件服务。 通过使用多个配置文件, 用户可以在家庭中使用一组邮件服务, 并在办公室上使用不同的组来工作。
  
配置文件是通过提供配置支持的客户端应用程序在邮件服务安装或登录时创建的。 MAPI 提供了两种客户端应用程序: "控制面板" 项和 "配置文件向导"。 "控制面板" 项是一个完整的服务配置应用程序, 用户可以在其中创建、删除、编辑和复制配置文件, 还可以对配置文件中的条目进行修改。 配置文件向导是一个简单的应用程序, 旨在尽可能简化将邮件服务添加到配置文件中的工作。 [! 注意] 配置文件向导包含一系列称为 "属性页" 的对话框, 提示用户完成安装和配置服务的过程。 系统仅提示用户输入最关键设置的值;所有其他设置都会继承默认值。 创建配置文件后, 不允许用户进行更改。 
  
尽管 "控制面板" 项总是通过 "控制面板" 调用, 但有多种可能会导致调用配置文件向导的方案。 客户端应用程序可以调用配置文件向导在登录时创建默认配置文件 (如果尚未创建的话)。 "控制面板" 项或其他客户端应用程序可以依赖于 "配置文件向导" 中已有的功能, 而不是 reimplementing 代码来添加配置文件。 如果需要将服务添加到默认配置文件中, 则在其入口点函数中的邮件服务可以调用配置文件向导。 使用 "配置文件向导" 的邮件服务必须编写额外的入口点函数和标准 Windows 对话框过程。 [! 注意] 配置文件向导调用入口点函数来检索服务的配置对话框, 而对话框过程将处理在使用此对话框时生成的消息。 
  
配置文件的组织方式类似于 mapisvc.inf 文件。 配置文件具有链接的层次结构部分;服务提供商拥有最低级别的部分, 邮件服务拥有中间级别的部分, MAPI 在最高级别中拥有部分。 每个部分都用称为 " [MAPIUID](mapiuid.md)" 的唯一标识符标识。 mapi 部分包含 mapi 的内部信息, 如所有邮件服务配置文件部分的标识符以及指向每个其他部分的链接。 每个邮件服务部分将链接存储到其提供程序部分, 每个提供程序部分存储指向其服务部分的链接。 
  
下图显示了两个典型配置文件的内容。 Sam 在自己的计算机上有两个配置文件, 一个供家庭使用, 一个用于办公室使用。 主配置文件包含三种邮件服务。 邮件服务 X 是通讯簿管理的单个提供程序服务。 邮件服务 Y 和 Z 具有三个提供程序: 一个通讯簿提供程序、一个邮件存储提供程序和一个传输提供程序。 Sam 的工作配置文件包含两个不同的邮件服务, 每个服务都有一个通讯簿提供程序、一个邮件存储提供程序和一个传输提供程序。 
  
**配置文件示例**
  
![配置文件示例](media/amapi_56.gif "配置文件示例")
  
下图显示了包含两个邮件服务的配置文件。 安装和配置属于邮件服务的服务提供程序的代码与提供程序的代码驻留在同一 DLL 中。 此代码在登录时读取配置文件中的信息以配置服务提供程序, 并在必要时向用户提示缺少的信息 (如果可能)。 来自客户端的请求, 以查看或更改任何提供程序的配置设置也由此通用代码处理。
  
**安装和配置服务提供程序**
  
![安装和配置服务提供程序](media/amapi_55.gif "安装和配置服务提供程序")
  
## <a name="see-also"></a>另请参阅

- [MAPIUID](mapiuid.md)
- [MAPI 编程概述](mapi-programming-overview.md)

