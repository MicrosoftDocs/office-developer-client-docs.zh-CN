---
title: 消息服务和配置文件
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: df0db1e4-69c8-44ec-bb2a-d31fc8a564b9
description: 上次修改时间： 2011 年 7 月 23 日
ms.openlocfilehash: 60a102a68ee11cd6002be9edf47d0cee93ed2e15
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/23/2018
ms.locfileid: "22581431"
---
# <a name="message-services-and-profiles"></a>消息服务和配置文件
  
**适用于**： Outlook 2013 |Outlook 2016 
  
某些用户需要多个邮件系统，每个都与一个或多个服务提供商的服务。 由于麻烦安装和配置这些服务提供商的每个单独，且 MAPI 因为消息服务器通常需要一组相关的提供程序公开其所有功能，包括消息服务的概念。 消息服务帮助用户在安装和配置其服务提供商。
  
若要创建的消息服务，开发人员编写的消息服务项点程序处理服务中的每个提供程序的配置和安装程序执行下列操作：
  
- 安装服务中的每个提供程序。
    
- 创建注册表和初始化文件项。
    
- MAPI 配置文件，Mapisvc.inf 中创建项。
    
Mapisvc.inf 文件包含与所有消息服务和服务提供商的计算机上安装的配置信息。 它是与链接到下每个级别组织层次结构的各节中。 在顶部是包含以下三个部分： 
  
- 消息服务帮助文件的列表。
    
- 最重要的是，或者默认情况下，消息服务的列表。
    
- 在计算机上的所有服务的列表。
    
下一级包含为每个邮件服务，各节，最后一个级别的每个服务提供商服务中包括几节。 MAPI 需要的服务提供商和消息服务的开发人员将某些条目添加到 Mapisvc.inf;开发人员可以自己决定添加其他项。 大多数最终 Mapisvc.inf 之一中的信息或多个配置文件的用户的配置信息的集合首选的消息服务的设置。 因为一台计算机可以有多个用户，单个用户可以有多组的首选项，可以计算机上存在许多配置文件。 每个配置文件介绍一组不同的消息服务。 具有多个配置文件允许用户使用，例如，在家里与一组不同的一组的消息服务和办公室。
  
通过提供配置支持的客户端应用程序，在消息服务安装或登录时创建配置文件。 MAPI 提供两个此类的客户端应用程序： 某个控制面板项目和配置文件向导。 控制面板项目是一个全面服务的配置应用程序与用户可以创建、 删除、 编辑和复制配置文件，以及配置文件中进行修改的项。 配置文件向导是一个简单的应用程序，旨在使邮件服务向尽可能轻松地配置文件。 配置文件向导包含的对话框中，调用属性页面，提示用户安装和配置服务的过程通过一系列。 只需为值的最重要的设置; 提示用户所有其他设置继承默认值。 一旦创建配置文件，不允许用户进行更改。 
  
通过控制面板始终调用控制面板项目，而有多种可能会导致配置文件向导来调用的方案。 客户端应用程序可以调用配置文件向导以创建在当一个具有尚未创建登录时的默认配置文件。 而不是重新实现代码添加配置文件，控制面板项目或另一个客户端应用程序可以利用已在配置文件向导的功能。 消息服务，在其入口点函数，可以调用配置文件向导时需要添加到默认配置文件服务。 使用配置文件向导的消息服务必须编写额外的入口点函数和标准 Windows 对话框过程。 配置文件向导调用入口点函数检索服务的配置对话框时的对话框过程处理在使用此对话框时生成的消息。 
  
Mapisvc.inf 文件以类似方式组织配置文件。 配置文件具有链接分层部分;中的最低级别的服务提供程序自己节，消息服务拥有各节中的中间级和 MAPI 主管最高级别中的部分。 每节用称为[MAPIUID](mapiuid.md)的唯一标识符标识。 MAPI 各节包含内部到 MAPI，例如的所有消息服务配置文件部分和指向其他各节的标识符信息。 消息服务的每一部分存储链接到其提供程序部分中，并提供程序的每一部分将存储到其服务部分的链接。 
  
下图显示了两个典型的配置文件的内容。 Sam 对其计算机，供家庭使用的一个，一个用于 office 使用两个配置文件。 主页的配置文件包含三个消息服务。 消息服务 X 是用于通讯簿管理的单个提供程序服务。 消息服务 Y 和 Z 有三种提供商 — 通讯簿提供程序、 消息存储提供程序，和传输提供程序。 Sam 的工作配置文件包含两个不同的消息服务，其中每个具有通讯簿提供程序、 消息存储提供程序，和传输提供程序。 
  
**配置文件示例**
  
![配置文件示例](media/amapi_56.gif "配置文件示例")
  
下图显示了包含两个消息服务的配置文件。 安装和配置属于邮件服务的服务提供程序的代码位于同一个 DLL 的代码中的提供程序。 此代码中读取信息从配置文件在登录时配置服务提供程序，并提示用户，如果可能并根据需要，查找丢失的信息。 通过此常见的代码还处理来自客户端可以查看或更改的任何提供程序的配置设置的请求。
  
**安装和配置服务提供程序**
  
![安装和配置服务提供程序](media/amapi_55.gif "安装和配置服务提供程序")
  
## <a name="see-also"></a>另请参阅

- [MAPIUID](mapiuid.md)
- [MAPI 编程概述](mapi-programming-overview.md)

