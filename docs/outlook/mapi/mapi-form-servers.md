---
title: MAPI 表单服务器
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 855292b8-028e-4c1e-87ed-3f20b9ba584a
description: 上次修改时间：2011 年 7 月 23 日
ms.openlocfilehash: 3c95f6a1d4d50dd6552c6e786d17c40da14f3f3c
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/23/2019
ms.locfileid: "32351483"
---
# <a name="mapi-form-servers"></a>MAPI 表单服务器

  
  
**适用于**：Outlook 2013 | Outlook 2016 
  
从用户的角度来看, 窗体通常是邮件或数据输入窗体的属性表, 使用户能够输入结构化信息。 但是, 它可以是与邮件类关联的任何用户界面。 从程序员的角度来看, 表单包含以下内容:
  
- 一种 MAPI 邮件, 其中包含其自己的邮件类和 OLE 标识符。
    
- 实现表单服务器的可执行文件。
    
- 表单服务器使用的 MAPI 属性 (自定义或其他) 的集合。 其中的部分或全部可供邮件客户端使用。
    
- 描述表单并由表单管理器使用的配置文件。
    
由于表单是[IMessage](imessageimapiprop.md)对象, 因此它们展示了与 MAPI 邮件对象一致的属性和行为。 但是, 由于表单可以具有特定于应用程序的自定义属性、控件和显示呈现, 因此表单使用的 MAPI 接口具有足够通用的功能, 以允许所需的任何类型的接口。 表单的实际定义存储在表单库中, 本节后面将对此进行讨论。 
  
> [!NOTE]
> 更准确地说, 所有邮件都是 MAPI 表单的实例。 但是, 由于用于撰写和阅读典型电子邮件的表单是最常用的窗体, 因此将自定义窗体视为邮件的特殊情况通常更易于使用。 所有邮件实际上只是表单, 自定义窗体的状态与 MAPI 系统中的任何其他邮件相同。 
  
每个表单都有一组属性, 其中一些属性在表单的用户界面中可见。 通常情况下, 属性与表单用户界面中的域相匹配。 例如, 采购订单窗体可能具有字段 "项"、"说明"、"价格"、"税金" 和 "小计"。 这些字段只是直观呈现来的窗体属性的名称。 客户端通过[IMAPIFormInfo:: CalcFormPropSet](imapiforminfo-calcformpropset.md)方法 (由 MAPI 表单管理器实现) 确定特定邮件类支持哪些属性。 
  
与基本邮件一样, MAPI 表单可以包含所有标准邮件属性, 如发件人、预期收件人和邮件发送时间。 窗体还可以包含任意数量的窗体特有的自定义属性。 例如, "bug 报告" 表单可能包含 bug 类型、bug 严重性和产品版本的自定义属性。
  
若要创建窗体, 您必须实现窗体服务器。 表单服务器是邮件客户端需要显示表单服务器支持的类型的邮件时加载的可执行文件。 然后, 表单服务器将根据需要创建表单对象, 以显示特定邮件并处理用户与这些邮件的交互。
  
每个窗体服务器都有一个与之关联的配置文件。 此文件包含为表单管理器的优势描述表单服务器的信息。 在表单库中安装表单服务器时, 表单管理器将使用此信息。
  
有关创建窗体的各个部分的详细信息, 请参阅[开发 MAPI 表单服务器](developing-mapi-form-servers.md)。
  
表单服务器遵循组件对象模型 (COM)。 表单服务器作为独立可执行文件运行, 而不是作为进程内服务器运行。 有关详细信息, 请参阅 Windows SDK 中的 COM 和 ActiveX 对象服务部分。
  
唯一的类标识符 (CLSID) 标识每个表单服务器。 类标识符和它的邮件类之间始终存在一次一对一映射。 但是, 这并不意味着窗体服务器只能处理一个邮件类别的邮件。 如果没有可用于为特定类的邮件提供服务的表单服务器, 则使用的表单管理器应尝试在邮件类层次结构中更高的邮件类中查找窗体服务器;由 Windows SDK 提供的默认表单管理器将执行此工作。 这样的窗体服务器可能只会呈现邮件属性 (超类支持的) 的子集, 但其效果将会更好。 如果 "完全找不到匹配的表单服务器" 是特定于所使用的表单管理器的实现详细信息, 会发生什么情况;在这种情况下, 默认表单管理器不会打开邮件。
  
有关详细信息, 请参阅[MAPI 邮件类别](mapi-message-classes.md)。
  
## <a name="see-also"></a>另请参阅



[MAPI 表单](mapi-forms.md)

