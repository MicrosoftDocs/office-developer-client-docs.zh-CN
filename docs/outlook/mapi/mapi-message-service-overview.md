---
title: MAPI 邮件服务概述
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 58f36a6b-bcc5-4ebb-9761-6f420a718d97
description: 上次修改时间：2011 年 7 月 23 日
ms.openlocfilehash: 8973cdcee2b10346d0ba07033357b50f7e9a6a27
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/28/2019
ms.locfileid: "33406253"
---
# <a name="mapi-message-service-overview"></a>MAPI 邮件服务概述
  
**适用于**：Outlook 2013 | Outlook 2016 
  
邮件服务定义一组相关的服务提供商，通常是使用同一邮件系统的服务提供商。 服务提供商执行邮件系统和 MAPI 子系统之间的通信工作，而邮件服务执行用户与使用公共邮件系统的服务提供商之间的互操作。  
  
邮件服务的存在使用户更容易安装和配置服务提供程序。 用户从不直接安装或配置服务提供商;邮件服务完全处理属于该服务的每个服务提供商的安装和配置。 由于此功能，用户无需熟悉特定的服务提供商配置要求。 
  
下图显示了基于邮件的客户端应用程序和两个邮件服务之间的关系。
  
**消息服务安装和配置**
  
![邮件服务安装和配置](media/amapi_44.gif "邮件服务安装和配置")
  
用户调用每个邮件服务的安装代码，以将服务及其服务提供程序添加到配置文件中。 在图中显示的邮件服务之一中，有三个服务提供程序;在其他邮件服务中，有两个服务提供程序。 在安装完成后的一段时间（通常在登录时）配置每个邮件服务中的服务提供程序。 每个邮件服务中的配置代码处理服务中提供程序的配置。
  
安装邮件服务后，其安装程序将必要的文件从安装源复制到用户的本地磁盘，并更新配置文件 Mapisvc.inf。 Mapisvc.inf 文件包含计算机上可以安装的所有邮件服务和服务提供商的配置设置。 它按层次结构分区进行组织，每个级别各部分之间都有链接。 顶层部分包含与 MAPI 子系统相关的信息，如所有可用邮件服务的列表以及联机帮助安装。 下一个级别包含每个邮件服务的分区，其中的信息包括邮件服务的 DLL 文件名及其配置入口点函数的名称。 第三个级别包含包含邮件服务中每个服务提供程序的配置数据的分区。 
  
为了处理配置，邮件服务实现了一个符合 MAPI 定义的原型的入口点函数，以及一个称为"属性表"选项卡式对话框。 MAPI 调用入口点函数，以调用与邮件服务中的配置文件管理和服务提供商管理相关的服务客户端请求。 属性表用于查看和更改邮件服务和服务提供程序配置属性。 
  
## <a name="see-also"></a>另请参阅

- [MAPI 功能和体系结构](mapi-features-and-architecture.md)

