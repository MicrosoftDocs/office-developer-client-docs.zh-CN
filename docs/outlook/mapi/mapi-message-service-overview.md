---
title: MAPI 邮件服务概述
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 58f36a6b-bcc5-4ebb-9761-6f420a718d97
description: 上次修改时间：2011 年 7 月 23 日
ms.openlocfilehash: 8973cdcee2b10346d0ba07033357b50f7e9a6a27
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/23/2019
ms.locfileid: "32345976"
---
# <a name="mapi-message-service-overview"></a>MAPI 邮件服务概述
  
**适用于**：Outlook 2013 | Outlook 2016 
  
邮件服务定义一组相关的服务提供程序, 通常是使用同一个邮件系统的服务提供程序。 服务提供商执行在邮件系统和 MAPI 子系统之间进行通信的工作, 邮件服务执行在与公用邮件系统配合使用的用户和服务提供程序之间进行通信的工作。  
  
存在的邮件服务可使用户更容易地安装和配置服务提供程序。 用户永远不直接安装或配置服务提供商;邮件服务完全处理属于该服务的每个服务提供程序的安装和配置。 由于此功能, 用户无需熟悉特定的服务提供程序配置要求。 
  
下图显示了基于邮件的客户端应用程序和两个邮件服务之间的关系。
  
**消息服务安装和配置**
  
![邮件服务的安装和配置](media/amapi_44.gif "邮件服务的安装和配置")
  
用户调用每个邮件服务的安装代码, 将该服务及其服务提供程序添加到配置文件中。 在图所示的某个邮件服务中, 有三个服务提供商;在其他邮件服务中, 有两个服务提供商。 在安装完成后的一些后续时间, 通常在登录时配置每个邮件服务中的服务提供程序。 每个邮件服务中的配置代码处理服务中的提供程序的配置。
  
安装邮件服务时, 其安装程序会将所需的文件从安装源复制到用户的本地磁盘, 并更新配置文件 mapisvc.inf。 mapisvc.inf 文件包含可在计算机上安装的所有邮件服务和服务提供程序的配置设置。 它在分层部分中进行组织, 其中每个级别的各节之间都有链接。 顶层的部分包含与 MAPI 子系统相关的信息, 如所有可用邮件服务的列表和联机帮助安装。 下一级别包含每个邮件服务的各个部分, 其中包含邮件服务的 DLL 文件名和其配置入口点函数的名称等信息。 第三个级别包含邮件服务中每个服务提供程序的配置数据的节。 
  
若要处理配置, 邮件服务将实现符合 MAPI 定义的原型的入口点函数, 以及称为属性表的选项卡式对话框。 MAPI 调用入口点函数, 以服务于与配置文件管理和邮件服务中的服务提供程序管理相关的客户端请求。 属性表用于查看和更改邮件服务和服务提供程序配置属性。 
  
## <a name="see-also"></a>另请参阅

- [MAPI 功能和体系结构](mapi-features-and-architecture.md)

