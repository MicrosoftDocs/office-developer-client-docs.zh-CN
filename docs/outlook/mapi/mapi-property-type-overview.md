---
title: MAPI 属性类型概述
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: b762f5fb-7c2c-4303-96f7-0b6e657146c9
description: 上次修改时间： 2011 年 7 月 23 日
ms.openlocfilehash: ce3cd37247f37c4e70adb07769f00b2df07307a3
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/11/2018
ms.locfileid: "19776297"
---
# <a name="mapi-property-type-overview"></a><span data-ttu-id="6f3f9-103">MAPI 属性类型概述</span><span class="sxs-lookup"><span data-stu-id="6f3f9-103">MAPI property type overview</span></span>
  
<span data-ttu-id="6f3f9-104">**适用于**： Outlook</span><span class="sxs-lookup"><span data-stu-id="6f3f9-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="6f3f9-105">属性类型都是通过 MAPI MAPIDEFS 中定义的常量。指示属性值的基础数据类型的 H 头文件。</span><span class="sxs-lookup"><span data-stu-id="6f3f9-105">Property types are constants defined by MAPI in the MAPIDEFS.H header file that indicate the underlying data type of a property value.</span></span> <span data-ttu-id="6f3f9-106">所有属性，通过 MAPI、 客户端应用程序或服务提供商定义它们是否都使用这些类型之一。</span><span class="sxs-lookup"><span data-stu-id="6f3f9-106">All properties, whether they are defined by MAPI, by client applications, or by service providers, use one of these types.</span></span> 
  
<span data-ttu-id="6f3f9-107">属性类型是用于属性标记为按照类似的命名约定。</span><span class="sxs-lookup"><span data-stu-id="6f3f9-107">Property types follow a similar naming convention to the one used for property tags.</span></span> <span data-ttu-id="6f3f9-108">许多属性类型具有一个单值和多值版本。</span><span class="sxs-lookup"><span data-stu-id="6f3f9-108">Many property types have both a single-value and multiple-value version.</span></span> <span data-ttu-id="6f3f9-109">单值的属性包含一个其类型如单个整数或字符的字符串值。</span><span class="sxs-lookup"><span data-stu-id="6f3f9-109">Single valued properties contain one value of its type such as a single integer or character string.</span></span> <span data-ttu-id="6f3f9-110">常量，用于表示的单值属性包含两个部分： 前缀 PT_ 和描述的实际类型，如 LONG 或 STRING8 的字符串。</span><span class="sxs-lookup"><span data-stu-id="6f3f9-110">The constant used to represent a single value property has two parts: the prefix PT_ and a string describing the actual type, such as LONG or STRING8.</span></span> 
  
<span data-ttu-id="6f3f9-111">多值属性包含多个与其类型的值。</span><span class="sxs-lookup"><span data-stu-id="6f3f9-111">Multiple-value properties contain more than one value of its type.</span></span> <span data-ttu-id="6f3f9-112">与 OLE variant 数组，不同多值属性中的每个值都属于同一字段类型。</span><span class="sxs-lookup"><span data-stu-id="6f3f9-112">Unlike OLE variant arrays, every value in a multivalued property is of the same type.</span></span> <span data-ttu-id="6f3f9-113">通过将 MV_FLAG 标志组合与相应的单个值常量表示的基类型创建常量，用于表示多值的属性。</span><span class="sxs-lookup"><span data-stu-id="6f3f9-113">The constant used to represent multivalued properties is created by combining the MV_FLAG flag with the corresponding single value constant representing the base type.</span></span> <span data-ttu-id="6f3f9-114">有三个部分： 前缀 PT_ 跟 MV_ 后跟描述类型的字符串。</span><span class="sxs-lookup"><span data-stu-id="6f3f9-114">There are three parts: the prefix PT_ followed by MV_ followed by a string that describes the type.</span></span> <span data-ttu-id="6f3f9-115">例如，包含多个包含整数的属性的类型是 PT_MV_LONG，针对多个字符串 PT_MV_STRING8。</span><span class="sxs-lookup"><span data-stu-id="6f3f9-115">For example, the type for a property containing multiple integers is PT_MV_LONG and for multiple character strings is PT_MV_STRING8.</span></span>
  
<span data-ttu-id="6f3f9-116">下图显示了[SPropValue](spropvalue.md)结构来描述的多值整数，PT_MV_LONG 类型的属性的结构。</span><span class="sxs-lookup"><span data-stu-id="6f3f9-116">The following illustration shows the structure of an [SPropValue](spropvalue.md) structure to describe a multiple-value integer, a property of type PT_MV_LONG.</span></span> <span data-ttu-id="6f3f9-117">展开**值**成员时要包含的属性和一个指向这些值的数组中的整数值的数目。</span><span class="sxs-lookup"><span data-stu-id="6f3f9-117">The **Value** member is expanded to include a count of the number of integer values in the property and a pointer to an array of those values.</span></span> 
  
<span data-ttu-id="6f3f9-118">**多值属性**</span><span class="sxs-lookup"><span data-stu-id="6f3f9-118">**Multiple-value properties**</span></span>
  
<span data-ttu-id="6f3f9-119">![多值属性](media/amapi_12.gif "多值属性")</span><span class="sxs-lookup"><span data-stu-id="6f3f9-119">![Multiple-value properties](media/amapi_12.gif "Multiple-value properties")</span></span>
  
<span data-ttu-id="6f3f9-120">尽管支持多值属性是可选的 MAPI 建议的客户端和服务提供商支持两种类型的属性因为执行操作是允许更大 MAPI 兼容的组件之间的交互。</span><span class="sxs-lookup"><span data-stu-id="6f3f9-120">Although support for multiple-value properties is optional, MAPI recommends that clients and service providers support both types of properties because doing so enables greater interaction between MAPI-compliant components.</span></span>
  
<span data-ttu-id="6f3f9-121">下图列出所有显示它们**SPropValue**结构中的存储位置的不同的属性类型常量。</span><span class="sxs-lookup"><span data-stu-id="6f3f9-121">The following illustration lists all of the different property type constants, showing where they are stored in an **SPropValue** structure.</span></span> <span data-ttu-id="6f3f9-122">取决于特定类型的**值**成员的大小。</span><span class="sxs-lookup"><span data-stu-id="6f3f9-122">The size of the **Value** member is dependent on the particular type.</span></span> <span data-ttu-id="6f3f9-123">注意，不是所有的单值类型有多个值的等效项。</span><span class="sxs-lookup"><span data-stu-id="6f3f9-123">Notice that not all of the single-value types have multiple-value equivalents.</span></span> 
  
<span data-ttu-id="6f3f9-124">**属性类型常量**</span><span class="sxs-lookup"><span data-stu-id="6f3f9-124">**Property type constants**</span></span>
  
<span data-ttu-id="6f3f9-125">![属性类型常量](media/amapi_11.gif "属性类型常量")</span><span class="sxs-lookup"><span data-stu-id="6f3f9-125">![Property type constants](media/amapi_11.gif "Property type constants")</span></span>
  
<span data-ttu-id="6f3f9-126">客户端和使用属性的服务提供商需要执行两个步骤：</span><span class="sxs-lookup"><span data-stu-id="6f3f9-126">Clients and service providers working with a property need to follow two steps:</span></span>
  
1. <span data-ttu-id="6f3f9-127">确定属性是否可用或不可用。</span><span class="sxs-lookup"><span data-stu-id="6f3f9-127">Determine if the property is available or unavailable.</span></span>
    
2. <span data-ttu-id="6f3f9-128">如果可供，检索该属性的值。</span><span class="sxs-lookup"><span data-stu-id="6f3f9-128">If available, retrieve the property's value.</span></span>
    
<span data-ttu-id="6f3f9-129">有时客户端或服务提供程序只需要检查存在属性;其他需要的特定值检查的时间。</span><span class="sxs-lookup"><span data-stu-id="6f3f9-129">Sometimes a client or service provider need only check for the existence of a property; other times it is necessary to check for a specific value.</span></span> <span data-ttu-id="6f3f9-130">例如，传输提供程序必须处理的操作的三个不同的课程**PR\_SEND_RICH_INFO** ([PidTagSendRichInfo](pidtagsendrichinfo-canonical-property.md)) 属性，一个布尔值，该值指示是否应与传输邮件带格式的文本。</span><span class="sxs-lookup"><span data-stu-id="6f3f9-130">For example, transport providers have three different courses of action for processing the **PR\_SEND_RICH_INFO** ([PidTagSendRichInfo](pidtagsendrichinfo-canonical-property.md)) property, a Boolean value that indicates whether or not a message should be transmitted with formatted text.</span></span> <span data-ttu-id="6f3f9-131">如果**PR\_SEND_RICH_INFO**是设置为 TRUE，传输提供程序发送带格式的文本。</span><span class="sxs-lookup"><span data-stu-id="6f3f9-131">If **PR\_SEND_RICH_INFO** is set to TRUE, the transport provider transmits the formatted text.</span></span> <span data-ttu-id="6f3f9-132">如果设置为 FALSE，传输前的格式化的文本将被丢弃。</span><span class="sxs-lookup"><span data-stu-id="6f3f9-132">If it is set to FALSE, the formatted text is discarded before transmission.</span></span> <span data-ttu-id="6f3f9-133">传输提供程序如果**PR_SEND_RICH_INFO**不可用，即遵循其默认采取的操作，任何特定提供程序。</span><span class="sxs-lookup"><span data-stu-id="6f3f9-133">If **PR_SEND_RICH_INFO** is unavailable, the transport provider follows its default course of action, whatever that is for the particular provider.</span></span> 
  
<span data-ttu-id="6f3f9-134">MAPI 定义的特殊属性类型，PT_UNSPECIFIED，客户端或服务提供程序可用于检索属性时的属性类型是未知。若要检索其类型的高级不知情的情况下一个属性，客户端或服务提供程序调用对象的[IMAPIProp::GetProps](imapiprop-getprops.md)方法，并传递该属性的标识符和 PT_UNSPECIFIED 属性类型组成的属性标记。</span><span class="sxs-lookup"><span data-stu-id="6f3f9-134">MAPI defines a special property type, PT_UNSPECIFIED, that a client or service provider can use to retrieve a property when the property type is unknown.To retrieve a property without advance knowledge of its type, a client or service provider calls an object's [IMAPIProp::GetProps](imapiprop-getprops.md) method and passes a property tag made up of the property's identifier and the PT_UNSPECIFIED property type.</span></span> <span data-ttu-id="6f3f9-135">**GetProps**返回为属性[SPropValue](spropvalue.md)结构 PT_UNSPECIFIED 替换为相应的类型。</span><span class="sxs-lookup"><span data-stu-id="6f3f9-135">**GetProps** returns an [SPropValue](spropvalue.md) structure for the property, replacing PT_UNSPECIFIED with the appropriate type.</span></span> <span data-ttu-id="6f3f9-136">支持 PT_UNSPECIFIED 所需服务提供商实现**GetProps** 。</span><span class="sxs-lookup"><span data-stu-id="6f3f9-136">Service providers implementing **GetProps** are required to support PT_UNSPECIFIED.</span></span> 
  
<span data-ttu-id="6f3f9-137">某些 MAPI 对象支持属性的对象。</span><span class="sxs-lookup"><span data-stu-id="6f3f9-137">Some MAPI objects support properties that are themselves objects.</span></span> <span data-ttu-id="6f3f9-138">对象属性具有 PT_OBJECT 的类型。</span><span class="sxs-lookup"><span data-stu-id="6f3f9-138">Object properties have the type PT_OBJECT.</span></span> <span data-ttu-id="6f3f9-139">而不是使用**IMAPIProp::GetProps**通常访问这些属性、 客户端和服务提供商用户的[IMAPIProp::OpenProperty](imapiprop-openproperty.md)方法在对象上指定相应的接口访问，或方法支持的属性。</span><span class="sxs-lookup"><span data-stu-id="6f3f9-139">Instead of using **IMAPIProp::GetProps** to access these properties, clients and service providers typically user either the [IMAPIProp::OpenProperty](imapiprop-openproperty.md) method, specifying the appropriate interface for access, or a method on the object supporting the property.</span></span> 
  
<span data-ttu-id="6f3f9-140">因为访问对象属性的值涉及使用的接口之一对象， **GetProps**不正确。</span><span class="sxs-lookup"><span data-stu-id="6f3f9-140">Because accessing the value of an object property involves using one of the interfaces for the object, **GetProps** is inappropriate.</span></span> <span data-ttu-id="6f3f9-141">与**GetProps**，呼叫者通过**SPropValue**结构访问属性的值。</span><span class="sxs-lookup"><span data-stu-id="6f3f9-141">With **GetProps**, the caller accesses a property's value through an **SPropValue** structure.</span></span> <span data-ttu-id="6f3f9-142">使用**IMAPIProp::OpenProperty**，呼叫者会检索可以访问的对象的接口的指针。</span><span class="sxs-lookup"><span data-stu-id="6f3f9-142">With **IMAPIProp::OpenProperty**, the caller retrieves a pointer to an interface that can access the object.</span></span> <span data-ttu-id="6f3f9-143">**OpenProperty**始终可用于检索的对象属性。</span><span class="sxs-lookup"><span data-stu-id="6f3f9-143">**OpenProperty** can always be used to retrieve an object property.</span></span> <span data-ttu-id="6f3f9-144">其他选项，该对象，调用方法不可用与每个对象属性。</span><span class="sxs-lookup"><span data-stu-id="6f3f9-144">The other option, calling a method on the object, is not available with every object property.</span></span> 
  
<span data-ttu-id="6f3f9-145">例如，每个文件夹支持两个表、 层次结构表和内容表。</span><span class="sxs-lookup"><span data-stu-id="6f3f9-145">For example, every folder supports two tables, a hierarchy table and a contents table.</span></span> <span data-ttu-id="6f3f9-146">这些表是属性文件夹中。其属性标记为**PR_CONTAINER_HIERARCHY** ([PidTagContainerHierarchy](pidtagcontainerhierarchy-canonical-property.md)) 和**PR_CONTAINER_CONTENTS** ([PidTagContainerContents](pidtagcontainercontents-canonical-property.md))。</span><span class="sxs-lookup"><span data-stu-id="6f3f9-146">These tables are properties of the folder; their property tags are **PR_CONTAINER_HIERARCHY** ([PidTagContainerHierarchy](pidtagcontainerhierarchy-canonical-property.md)) and **PR_CONTAINER_CONTENTS** ([PidTagContainerContents](pidtagcontainercontents-canonical-property.md)).</span></span> <span data-ttu-id="6f3f9-147">表是需要访问**IMAPITable**接口的对象。</span><span class="sxs-lookup"><span data-stu-id="6f3f9-147">Tables are objects that require the **IMAPITable** interface for access.</span></span> <span data-ttu-id="6f3f9-148">客户端可以调用该文件夹的[IMAPIContainer::GetHierarchyTable](imapicontainer-gethierarchytable.md)方法来访问层次结构表，该文件夹的[IMAPIContainer::GetContentsTable](imapicontainer-getcontentstable.md)方法可访问的内容表或该文件夹的[IMAPIProp::OpenProperty](imapiprop-openproperty.md)方法来访问任意一个表。</span><span class="sxs-lookup"><span data-stu-id="6f3f9-148">A client can call the folder's [IMAPIContainer::GetHierarchyTable](imapicontainer-gethierarchytable.md) method to access the hierarchy table, the folder's [IMAPIContainer::GetContentsTable](imapicontainer-getcontentstable.md) method to access the contents table, or the folder's [IMAPIProp::OpenProperty](imapiprop-openproperty.md) method to access either table.</span></span> <span data-ttu-id="6f3f9-149">若要调用**OpenProperty**，客户端将作为第一个参数和接口标识符的接口，用于访问作为第二个参数传递属性的属性标记。</span><span class="sxs-lookup"><span data-stu-id="6f3f9-149">To call **OpenProperty**, a client passes the property tag for the property as the first parameter and an interface identifier for the interface to be used for access as the second parameter.</span></span> <span data-ttu-id="6f3f9-150">这些参数将为**PR_CONTAINER_HIERARCHY**或**PR_CONTAINER_CONTENTS**和**IID_IMAPITable**。</span><span class="sxs-lookup"><span data-stu-id="6f3f9-150">These parameters would be **PR_CONTAINER_HIERARCHY** or **PR_CONTAINER_CONTENTS** and **IID_IMAPITable**.</span></span>
  
<span data-ttu-id="6f3f9-151">单值和多值属性类型的完整列表，请参阅[属性类型](property-types.md)。</span><span class="sxs-lookup"><span data-stu-id="6f3f9-151">For a complete list of the single-value and multiple-value property types, see [Property Types](property-types.md).</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="6f3f9-152">另请参阅</span><span class="sxs-lookup"><span data-stu-id="6f3f9-152">See also</span></span>

- [<span data-ttu-id="6f3f9-153">MAPI 属性概述</span><span class="sxs-lookup"><span data-stu-id="6f3f9-153">MAPI Property Overview</span></span>](mapi-property-overview.md)

