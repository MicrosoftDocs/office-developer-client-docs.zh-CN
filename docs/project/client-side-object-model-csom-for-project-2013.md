---
title: Project 2013 的客户端对象模型 (CSOM)
manager: soliver
ms.date: 08/10/2016
ms.audience: Developer
localization_priority: Normal
ms.assetid: 716325eb-b092-4934-921f-84129d0a1f5f
description: Project Server 2013 客户端对象模型 (CSOM) 实现常见的服务器功能。 Project Server CSOM 包括 Microsoft.NET CSOM、 Microsoft Silverlight CSOM、 Windows Phone 8 CSOM 和 JavaScript 对象模型 (JSOM)。 此外，CSOM 包括启用 REST 接口的 OData 服务。 在 REST 界面主要用于开发 iOS 和 Android 如非 Windows 平台上的应用程序。
ms.openlocfilehash: a17dc816cd2033ff0057821ef029f0163881f9ac
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/11/2018
ms.locfileid: "19779410"
---
# <a name="client-side-object-model-csom-for-project-2013"></a><span data-ttu-id="8f2b5-106">Project 2013 的客户端对象模型 (CSOM)</span><span class="sxs-lookup"><span data-stu-id="8f2b5-106">Client-side object model (CSOM) for Project 2013</span></span>

<span data-ttu-id="8f2b5-107">Project Server 2013 客户端对象模型 (CSOM) 实现常见的服务器功能。</span><span class="sxs-lookup"><span data-stu-id="8f2b5-107">The Project Server 2013 client-side object model (CSOM) implements common server functionality.</span></span> <span data-ttu-id="8f2b5-108">Project Server CSOM 包括 Microsoft.NET CSOM、 Microsoft Silverlight CSOM、 Windows Phone 8 CSOM 和 JavaScript 对象模型 (JSOM)。</span><span class="sxs-lookup"><span data-stu-id="8f2b5-108">The Project Server CSOM includes a Microsoft .NET CSOM, a Microsoft Silverlight CSOM, a Windows Phone 8 CSOM, and a JavaScript object model (JSOM).</span></span> <span data-ttu-id="8f2b5-109">此外，CSOM 包括启用 REST 接口的 OData 服务。</span><span class="sxs-lookup"><span data-stu-id="8f2b5-109">In addition, the CSOM includes an OData service that enables a REST interface.</span></span> <span data-ttu-id="8f2b5-110">在 REST 界面主要用于开发 iOS 和 Android 如非 Windows 平台上的应用程序。</span><span class="sxs-lookup"><span data-stu-id="8f2b5-110">The REST interface is intended primarily for development of apps on non-Windows platforms such as iOS and Android.</span></span>
  
> [!NOTE]
> <span data-ttu-id="8f2b5-111">For Project Online 中的解决方案必须使用 CSOM。</span><span class="sxs-lookup"><span data-stu-id="8f2b5-111">Solutions for Project Online must use the CSOM.</span></span> <span data-ttu-id="8f2b5-112">但是，本地应用程序可以使用 CSOM 或 Project Server 接口 (PSI)。</span><span class="sxs-lookup"><span data-stu-id="8f2b5-112">However, on-premises apps can use either the CSOM or the Project Server Interface (PSI).</span></span> <span data-ttu-id="8f2b5-113">如果 CSOM 包括您打算使用的功能，我们建议您对新的应用程序使用 CSOM。</span><span class="sxs-lookup"><span data-stu-id="8f2b5-113">If the CSOM includes the functionality you plan to use, we recommend that you use the CSOM for new apps.</span></span> 
  
<span data-ttu-id="8f2b5-114">在 CSOM 扩展**ProjectContext**对象提供对服务器内容和功能的入口点。</span><span class="sxs-lookup"><span data-stu-id="8f2b5-114">In CSOM extensions, the **ProjectContext** object provides the entry point to server content and functionality.</span></span> <span data-ttu-id="8f2b5-115">.NET CSOM 和 Silverlight CSOM，Windows Phone CSOM 使用[Microsoft.ProjectServer.Client.ProjectContext](https://msdn.microsoft.com/library/Microsoft.ProjectServer.Client.ProjectContext.aspx)对象，并 JSOM 使用**PS.ProjectContext**对象。</span><span class="sxs-lookup"><span data-stu-id="8f2b5-115">The .NET CSOM, the Silverlight CSOM, and the Windows Phone CSOM use the [Microsoft.ProjectServer.Client.ProjectContext](https://msdn.microsoft.com/library/Microsoft.ProjectServer.Client.ProjectContext.aspx) object, and the JSOM uses the **PS.ProjectContext** object.</span></span> <span data-ttu-id="8f2b5-116">**ProjectContext**属性提供直接访问 Project Web App 网站集中当前的核心 Project Server 对象。</span><span class="sxs-lookup"><span data-stu-id="8f2b5-116">**ProjectContext** properties provide direct access to core Project Server objects in the current Project Web App site collection.</span></span> <span data-ttu-id="8f2b5-117">有关 CSOM 程序集和 JavaScript 文件的位置，请参阅[Microsoft.ProjectServer.Client](https://msdn.microsoft.com/library/Microsoft.ProjectServer.Client.aspx) 。</span><span class="sxs-lookup"><span data-stu-id="8f2b5-117">For information about the location of the CSOM assemblies and the JavaScript file, see [Microsoft.ProjectServer.Client](https://msdn.microsoft.com/library/Microsoft.ProjectServer.Client.aspx) .</span></span> 
  
 <span data-ttu-id="8f2b5-118">**应用程序和安全模型**应用程序必须为 CRUD 使用 CSOM （创建、 读取、 更新、 删除） 与 Project Server 2013 和 Project Online 的操作。</span><span class="sxs-lookup"><span data-stu-id="8f2b5-118">**Apps and the security model** Apps must use the CSOM for CRUD (create, read, update, delete) operations with Project Server 2013 and Project Online.</span></span> <span data-ttu-id="8f2b5-119">Project 应用程序在 SharePoint 2013 中不使用仅应用程序身份验证模型。</span><span class="sxs-lookup"><span data-stu-id="8f2b5-119">Project apps do not use the app-only authentication model in SharePoint 2013.</span></span> <span data-ttu-id="8f2b5-120">Project Server 应用程序需要指定命令正在运行的名义特定的权限请求范围。</span><span class="sxs-lookup"><span data-stu-id="8f2b5-120">A Project Server app requires a specific permission request scope that specifies on whose behalf commands are being run.</span></span> 
  
 <span data-ttu-id="8f2b5-121">**REST 查询**不使用元数据，可以创建 REST 查询的 CSOM OData 服务。</span><span class="sxs-lookup"><span data-stu-id="8f2b5-121">**REST queries** You can create REST queries of the CSOM OData service without consuming the metadata.</span></span> <span data-ttu-id="8f2b5-122">某些第三方工具启用使用 CSOM 的.NET 程序集开发应用程序其他设备。</span><span class="sxs-lookup"><span data-stu-id="8f2b5-122">Some third-party tools enable using the .NET assemblies for the CSOM to develop apps for other devices.</span></span> <span data-ttu-id="8f2b5-123">例如，搜索 Internet 上的"跨平台.NET 开发工具的 iOS 或 Android。"</span><span class="sxs-lookup"><span data-stu-id="8f2b5-123">For example, search the Internet for "cross-platform .NET development tools for iOS or Android."</span></span> 
  
> [!NOTE]
> <span data-ttu-id="8f2b5-124">尽管`$metadata` **ProjectData**报告服务有效的选项 ( `http://ServerName/pwaName/_api/ProjectData/$metadata`)，则`$metadata`选项的 CSOM 的**ProjectServer**服务已在 Project Server 2013 的发行版。</span><span class="sxs-lookup"><span data-stu-id="8f2b5-124">Although the  `$metadata` option for the **ProjectData** reporting service is valid (  `http://ServerName/pwaName/_api/ProjectData/$metadata`), the  `$metadata` option for the **ProjectServer** service of the CSOM is removed in the released version of Project Server 2013.</span></span> <span data-ttu-id="8f2b5-125">若要查找的 CSOM 对象和成员可用作 REST 终结点，请参阅[JavaScript 库和 REST 参考 （英文） Project Server 2013](javascript-library-and-rest-reference-for-project-server-2013.md)。</span><span class="sxs-lookup"><span data-stu-id="8f2b5-125">To find the CSOM objects and members that are available as REST endpoints, see the [JavaScript library and REST reference for Project Server 2013](javascript-library-and-rest-reference-for-project-server-2013.md).</span></span> 
  
<span data-ttu-id="8f2b5-126">若要查看通过 REST 界面 CSOM 中可用的实体，您可以使用`http://ServerName/pwaName/_api/ProjectServer`查询。</span><span class="sxs-lookup"><span data-stu-id="8f2b5-126">To see the entities available in the CSOM through the REST interface, you can use the  `http://ServerName/pwaName/_api/ProjectServer` query.</span></span> <span data-ttu-id="8f2b5-127">对于 REST 查询， **ProjectServer**实体清楚地反映了在托管的 Microsoft.ProjectServer.Client.dll 程序和[PS. [ProjectContext](https://msdn.microsoft.com/library/Microsoft.ProjectServer.Client.ProjectContext.aspx)对象的属性ProjectContext](http://msdn.microsoft.com/library/a490b675-a845-ee94-3877-b99ada9bf2b0%28Office.15%29.aspx)中 JSOM 对象。</span><span class="sxs-lookup"><span data-stu-id="8f2b5-127">For REST queries, the **ProjectServer** entity closely mirrors properties of the [ProjectContext](https://msdn.microsoft.com/library/Microsoft.ProjectServer.Client.ProjectContext.aspx) object in the Microsoft.ProjectServer.Client.dll managed assembly and the [PS.ProjectContext](http://msdn.microsoft.com/library/a490b675-a845-ee94-3877-b99ada9bf2b0%28Office.15%29.aspx) object in the JSOM.</span></span> <span data-ttu-id="8f2b5-128">例如，使用您的浏览器，用于通过使用下面的查询从 Project Web App，中分配一个指定的项目，并指定资源，指定工作分配的任务名称中的项目有关 CSOM 获取信息 (每个查询使用同一`http://ServerName/pwaName/_api`URL 前缀)。</span><span class="sxs-lookup"><span data-stu-id="8f2b5-128">For example, you can use your browser to get information from the CSOM about projects in Project Web App, the assignments in a specified project, and the task name of a specified assignment for a specified resource, by using the following queries (each query uses the same  `http://ServerName/pwaName/_api` URL prefix).</span></span> <span data-ttu-id="8f2b5-129">Guid 是**Project.Id**、 **EnterpriseResource.Id**，和**Assignment.Id**示例值。</span><span class="sxs-lookup"><span data-stu-id="8f2b5-129">The GUIDs are sample values for **Project.Id**, **EnterpriseResource.Id**, and **Assignment.Id**.</span></span>
  
```HTML
/ProjectServer/Projects
/ProjectServer/Projects('263fc8d7-427c-e111-92fc-00155d3ba208')/Assignments
/ProjectServer/EnterpriseResources('28eeb2b5-fe74-4efc-aa35-6a64514d1526')/Assignments('a2eafeb5-437c-e111-92fc-00155d3ba208')/Task?$select=Name
```

<span data-ttu-id="8f2b5-130">与不同的 OData 接口用于**ProjectData**服务，它是只读的报告，您可以使用**ProjectServer**服务的 REST 查询的 CRUD 操作。</span><span class="sxs-lookup"><span data-stu-id="8f2b5-130">Unlike the OData interface for the **ProjectData** service, which is read-only for reporting, you can do CRUD operations using REST queries with the **ProjectServer** service.</span></span> <span data-ttu-id="8f2b5-131">Project Server CSOM 的 REST 查询主要用于 Windows 桌面上，如 Windows RT、 iOS 和 Android 之外的平台。</span><span class="sxs-lookup"><span data-stu-id="8f2b5-131">REST queries for the Project Server CSOM are designed primarily for platforms other than the Windows desktop, such as Windows RT, iOS, and Android.</span></span> <span data-ttu-id="8f2b5-132">对于 Windows 台式机和服务器平台，如 Windows 7、 Windows 8 和 Windows Server 2008 R2，您可以使用 CSOM 托管程序集。</span><span class="sxs-lookup"><span data-stu-id="8f2b5-132">For Windows desktop and server platforms, such as Windows 7, Windows 8, and Windows Server 2008 R2, you can use the CSOM managed assemblies.</span></span> <span data-ttu-id="8f2b5-133">对于 web 应用程序，您可以用于 PS.js JavaScript。</span><span class="sxs-lookup"><span data-stu-id="8f2b5-133">For web apps, you can use PS.js for JavaScript.</span></span> <span data-ttu-id="8f2b5-134">有关执行 CRUD 操作使用 REST 查询的信息，请参阅 SharePoint 2013 SDK 中的[SharePoint REST 请求中的使用 OData 查询操作](http://msdn.microsoft.com/library/d4b5c277-ed50-420c-8a9b-860342284b72%28Office.15%29.aspx)主题。</span><span class="sxs-lookup"><span data-stu-id="8f2b5-134">For information about doing CRUD operations using REST queries, see the [Use OData query operations in SharePoint REST requests](http://msdn.microsoft.com/library/d4b5c277-ed50-420c-8a9b-860342284b72%28Office.15%29.aspx) topic in the SharePoint 2013 SDK.</span></span> <span data-ttu-id="8f2b5-135">有关使用**ProjectData**服务的信息，请参阅[查询 OData 源的报告数据的项目](https://msdn.microsoft.com/en-us/library/office/jj163048.aspx)。</span><span class="sxs-lookup"><span data-stu-id="8f2b5-135">For information about using the **ProjectData** service, see [Querying OData feeds for Project reporting data](https://msdn.microsoft.com/en-us/library/office/jj163048.aspx).</span></span>
  
<span data-ttu-id="8f2b5-136">表 1 列出**ProjectContext**属性表示 Project Server 对象。</span><span class="sxs-lookup"><span data-stu-id="8f2b5-136">Table 1 lists the **ProjectContext** properties that represent Project Server objects.</span></span> <span data-ttu-id="8f2b5-137">您可以使用这些对象来检索其他 Project Server 2013 实体，如工作分配和任务。</span><span class="sxs-lookup"><span data-stu-id="8f2b5-137">You can use these objects to retrieve other Project Server 2013 entities, such as assignments and tasks.</span></span> 
  
<span data-ttu-id="8f2b5-138">**表 1. 提供对 CSOM 和 JSOM 中的 Project Server 对象的访问权的 ProjectContext 属性**</span><span class="sxs-lookup"><span data-stu-id="8f2b5-138">**Table 1. ProjectContext properties that provide access to Project Server objects in the CSOM and JSOM**</span></span>

|<span data-ttu-id="8f2b5-139">**CSOM（.NET、Silverlight 和 Windows Phone）**</span><span class="sxs-lookup"><span data-stu-id="8f2b5-139">**CSOM (.NET, Silverlight, and Windows Phone)**</span></span>|<span data-ttu-id="8f2b5-140">**JSOM**</span><span class="sxs-lookup"><span data-stu-id="8f2b5-140">**JSOM**</span></span>|
|:-----|:-----|
|[<span data-ttu-id="8f2b5-141">CustomFields</span><span class="sxs-lookup"><span data-stu-id="8f2b5-141">CustomFields</span></span>](https://msdn.microsoft.com/library/Microsoft.ProjectServer.Client.ProjectContext.CustomFields.aspx) <br/> |<span data-ttu-id="8f2b5-142">customFields</span><span class="sxs-lookup"><span data-stu-id="8f2b5-142">customFields</span></span>  <br/> |
|[<span data-ttu-id="8f2b5-143">EnterpriseProjectTypes</span><span class="sxs-lookup"><span data-stu-id="8f2b5-143">EnterpriseProjectTypes</span></span>](https://msdn.microsoft.com/library/Microsoft.ProjectServer.Client.ProjectContext.EnterpriseProjectTypes.aspx) <br/> |<span data-ttu-id="8f2b5-144">enterpriseProjectTypes</span><span class="sxs-lookup"><span data-stu-id="8f2b5-144">enterpriseProjectTypes</span></span>  <br/> |
|[<span data-ttu-id="8f2b5-145">EnterpriseResources</span><span class="sxs-lookup"><span data-stu-id="8f2b5-145">EnterpriseResources</span></span>](https://msdn.microsoft.com/library/Microsoft.ProjectServer.Client.ProjectContext.EnterpriseResources.aspx) <br/> |<span data-ttu-id="8f2b5-146">enterpriseResources</span><span class="sxs-lookup"><span data-stu-id="8f2b5-146">enterpriseResources</span></span>  <br/> |
|[<span data-ttu-id="8f2b5-147">EntityTypes</span><span class="sxs-lookup"><span data-stu-id="8f2b5-147">EntityTypes</span></span>](https://msdn.microsoft.com/library/Microsoft.ProjectServer.Client.ProjectContext.EntityTypes.aspx) <br/> |<span data-ttu-id="8f2b5-148">entityTypes</span><span class="sxs-lookup"><span data-stu-id="8f2b5-148">entityTypes</span></span>  <br/> |
|[<span data-ttu-id="8f2b5-149">事件处理</span><span class="sxs-lookup"><span data-stu-id="8f2b5-149">EventHandlers</span></span>](https://msdn.microsoft.com/library/Microsoft.ProjectServer.Client.ProjectContext.EventHandlers.aspx) <br/> |<span data-ttu-id="8f2b5-150">事件处理</span><span class="sxs-lookup"><span data-stu-id="8f2b5-150">eventHandlers</span></span>  <br/> |
|[<span data-ttu-id="8f2b5-151">事件</span><span class="sxs-lookup"><span data-stu-id="8f2b5-151">Events</span></span>](https://msdn.microsoft.com/library/Microsoft.ProjectServer.Client.ProjectContext.Events.aspx) <br/> |<span data-ttu-id="8f2b5-152">events</span><span class="sxs-lookup"><span data-stu-id="8f2b5-152">events</span></span>  <br/> |
|[<span data-ttu-id="8f2b5-153">将查找表</span><span class="sxs-lookup"><span data-stu-id="8f2b5-153">LookupTables</span></span>](https://msdn.microsoft.com/library/Microsoft.ProjectServer.Client.ProjectContext.LookupTables.aspx) <br/> |<span data-ttu-id="8f2b5-154">将查找表</span><span class="sxs-lookup"><span data-stu-id="8f2b5-154">lookupTables</span></span>  <br/> |
|[<span data-ttu-id="8f2b5-155">阶段</span><span class="sxs-lookup"><span data-stu-id="8f2b5-155">Phases</span></span>](https://msdn.microsoft.com/library/Microsoft.ProjectServer.Client.ProjectContext.Phases.aspx) <br/> |<span data-ttu-id="8f2b5-156">phases</span><span class="sxs-lookup"><span data-stu-id="8f2b5-156">phases</span></span>  <br/> |
|[<span data-ttu-id="8f2b5-157">Projects</span><span class="sxs-lookup"><span data-stu-id="8f2b5-157">Projects</span></span>](https://msdn.microsoft.com/library/Microsoft.ProjectServer.Client.ProjectContext.Projects.aspx) <br/> |<span data-ttu-id="8f2b5-158">projects</span><span class="sxs-lookup"><span data-stu-id="8f2b5-158">projects</span></span>  <br/> |
|[<span data-ttu-id="8f2b5-159">阶段</span><span class="sxs-lookup"><span data-stu-id="8f2b5-159">Stages</span></span>](https://msdn.microsoft.com/library/Microsoft.ProjectServer.Client.ProjectContext.Stages.aspx) <br/> |<span data-ttu-id="8f2b5-160">stages</span><span class="sxs-lookup"><span data-stu-id="8f2b5-160">stages</span></span>  <br/> |
|[<span data-ttu-id="8f2b5-161">WorkflowActivities</span><span class="sxs-lookup"><span data-stu-id="8f2b5-161">WorkflowActivities</span></span>](https://msdn.microsoft.com/library/Microsoft.ProjectServer.Client.ProjectContext.WorkflowActivities.aspx) <br/> |<span data-ttu-id="8f2b5-162">workflowActivities</span><span class="sxs-lookup"><span data-stu-id="8f2b5-162">workflowActivities</span></span>  <br/> |
|[<span data-ttu-id="8f2b5-163">WorkflowDesigner</span><span class="sxs-lookup"><span data-stu-id="8f2b5-163">WorkflowDesigner</span></span>](https://msdn.microsoft.com/library/Microsoft.ProjectServer.Client.ProjectContext.WorkflowDesigner.aspx) <br/> |<span data-ttu-id="8f2b5-164">workflowDesigner</span><span class="sxs-lookup"><span data-stu-id="8f2b5-164">workflowDesigner</span></span>  <br/> |
   
## <a name="in-this-section"></a><span data-ttu-id="8f2b5-165">本节内容</span><span class="sxs-lookup"><span data-stu-id="8f2b5-165">In this section</span></span>

<span data-ttu-id="8f2b5-166">[与 Project Server CSOM 和.NET 入门](getting-started-with-the-project-server-csom-and-net.md)提供了有关 Project Server CSOM 和.NET，说明有关如何在 Visual Studio 2012 和支持的代码示例中创建简单.NET CSOM 扩展的概述信息。</span><span class="sxs-lookup"><span data-stu-id="8f2b5-166">[Getting started with the Project Server CSOM and .NET](getting-started-with-the-project-server-csom-and-net.md) provides overview information about the Project Server CSOM and .NET, instructions about how to create a simple .NET CSOM extension in Visual Studio 2012, and supporting code examples.</span></span> 
  
<span data-ttu-id="8f2b5-167">[Getting started 与 Project Server 2013 JavaScript 对象模型](getting-started-with-the-project-server-2013-javascript-object-model.md)提供了有关 Project Server JSOM，说明有关如何在 Visual Studio 2012 和支持的代码示例中创建简单 JSOM 扩展的概述信息。</span><span class="sxs-lookup"><span data-stu-id="8f2b5-167">[Getting started with the Project Server 2013 JavaScript object model](getting-started-with-the-project-server-2013-javascript-object-model.md) provides overview information about the Project Server JSOM, instructions about how to create a simple JSOM extension in Visual Studio 2012, and supporting code examples.</span></span> 
  
<span data-ttu-id="8f2b5-168">此外，查看这些介绍如何使用 CSOM 的文章：</span><span class="sxs-lookup"><span data-stu-id="8f2b5-168">Also, check out these articles that show how to use the CSOM:</span></span>
  
- [<span data-ttu-id="8f2b5-169">批量更新自定义字段并从 Project Online 中的工作流创建项目网站</span><span class="sxs-lookup"><span data-stu-id="8f2b5-169">Bulk update custom fields and create project sites from a workflow in Project Online</span></span>](bulk-update-custom-fields-and-create-project-sites-from-workflow-in-project.md)
    
- [<span data-ttu-id="8f2b5-170">使用 JavaScript 对象模型处理项目</span><span class="sxs-lookup"><span data-stu-id="8f2b5-170">Work with projects by using the JavaScript object model</span></span>](create-retrieve-update-delete-projects-using-project-server-javascript.md)
    
> [!NOTE]
> <span data-ttu-id="8f2b5-171">您还可以使用.NET Framework 4 CSOM 开发的 Visual Studio 2010。</span><span class="sxs-lookup"><span data-stu-id="8f2b5-171">You can also use Visual Studio 2010 for .NET Framework 4 development with the CSOM.</span></span> 
  
## <a name="reference"></a><span data-ttu-id="8f2b5-172">参考</span><span class="sxs-lookup"><span data-stu-id="8f2b5-172">Reference</span></span>

[<span data-ttu-id="8f2b5-173">Microsoft.ProjectServer.Client</span><span class="sxs-lookup"><span data-stu-id="8f2b5-173">Microsoft.ProjectServer.Client</span></span>](https://msdn.microsoft.com/library/Microsoft.ProjectServer.Client.aspx)
  
## <a name="see-also"></a><span data-ttu-id="8f2b5-174">另请参阅</span><span class="sxs-lookup"><span data-stu-id="8f2b5-174">See also</span></span>



[<span data-ttu-id="8f2b5-175">Project Server 2013 体系结构</span><span class="sxs-lookup"><span data-stu-id="8f2b5-175">Project Server 2013 architecture</span></span>](project-server-2013-architecture.md)


[<span data-ttu-id="8f2b5-176">在 SharePoint 2013 中选择正确的 API 集</span><span class="sxs-lookup"><span data-stu-id="8f2b5-176">Choose the right API set in SharePoint 2013</span></span>](http://msdn.microsoft.com/library/f36645da-77c5-47f1-a2ca-13d4b62b320d%28Office.15%29.aspx)

