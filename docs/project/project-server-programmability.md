---
title: Project Server 可编程性
manager: soliver
ms.date: 09/17/2015
ms.audience: Developer
f1_keywords:
- events
- PDS
- PDS compatibility
- Project Server databases
- Project Server events
- Project Server Interface
- Project Server workflow
- Project workflow
- PSI
- PSI limitations
- PSI uses
- SharePoint Services
- WF
- workflow
- Workflow Foundation
- WSS
keywords:
- project 2013、 体系结构和可编程性，PSI、 项目版本可编程性 （英文）、 Project Server PSI，限制，Project Server 接口不受支持的功能，Project Server 接口 PDS 兼容性，Project Server 接口，一般，Project Server、 project 版本，版本，项目 Project Server、 数据库、 Project 2013 平台，Project Server 接口，使用方案，Project Server 事件，Project Server、 Project 数据服务、 与 PSI，Project Server 的兼容性接口
localization_priority: Normal
ms.assetid: a93d2153-5132-4289-af51-69350471e248
description: 了解 Project Server 2013 中的主要可编程性功能。 本文包含有关移植为 Project Server 的早期版本构建的应用程序的信息。
ms.openlocfilehash: c2c03da1e0b7c010d4cad8801f98c0c0cf0b1883
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/11/2018
ms.locfileid: "19779556"
---
# <a name="project-server-programmability"></a><span data-ttu-id="c35a0-105">Project Server 可编程性</span><span class="sxs-lookup"><span data-stu-id="c35a0-105">Project Server programmability</span></span>

<span data-ttu-id="c35a0-106">了解 Project Server 2013 中的主要可编程性功能。</span><span class="sxs-lookup"><span data-stu-id="c35a0-106">Learn about the major programmability features in Project Server 2013.</span></span> <span data-ttu-id="c35a0-107">本文包含有关移植为 Project Server 的早期版本构建的应用程序的信息。</span><span class="sxs-lookup"><span data-stu-id="c35a0-107">This article includes information about porting applications that were built for previous versions of Project Server.</span></span>

<span data-ttu-id="c35a0-108">Project Server 2013 旨在支持大多数开发的应用程序的 Project Server 2010 和新解决方案的多个平台，其中应用程序可以访问两者在线和本地 Project Server 安装。</span><span class="sxs-lookup"><span data-stu-id="c35a0-108">Project Server 2013 is designed to support most applications that were developed for Project Server 2010 and new solutions for multiple platforms, where apps can access both online and on-premises Project Server installations.</span></span> <span data-ttu-id="c35a0-109">应用程序和扩展而开发的 Project Server 2003 或更早版本的必须经过重新设计以使用客户端对象模型 (CSOM) 或 Project Server 接口 (PSI)。</span><span class="sxs-lookup"><span data-stu-id="c35a0-109">Applications and extensions that were developed for Project Server 2003 or earlier must be redesigned to use the client-side object model (CSOM) or the Project Server Interface (PSI).</span></span> <span data-ttu-id="c35a0-110">Office Project Server 2007 或 Project Server 2010 开发的应用程序可能需要一些更改和重新编译使用 PSI;若要使用 CSOM，这些应用程序需要重新设计。</span><span class="sxs-lookup"><span data-stu-id="c35a0-110">Applications that were developed for Office Project Server 2007 or Project Server 2010 may require some changes and recompiling to use the PSI; to use the CSOM, those applications require a redesign.</span></span>
  
<span data-ttu-id="c35a0-111">Project Server 平台通过构建在 SharePoint Server 2013、.NET Framework 4 和通过 CSOM OData 协议来启用程序员的工作效率的高的级别。</span><span class="sxs-lookup"><span data-stu-id="c35a0-111">The Project Server platform enables high levels of programmer productivity by building on SharePoint Server 2013, .NET Framework 4, and the OData protocol with the CSOM.</span></span> <span data-ttu-id="c35a0-112">开发人员可以扩展 Project Web App 的应用程序、 应用程序部件和 Web 部件、 使用 SharePoint Designer 2013 中定义的工作流和通过 Project Server 事件中使用远程事件接收器来强制实施业务规则。</span><span class="sxs-lookup"><span data-stu-id="c35a0-112">Developers can extend Project Web App with apps, app parts, and Web Parts, define workflows by using SharePoint Designer 2013, and enforce business rules by using remote event receivers for Project Server events.</span></span>
  
## <a name="project-server-and-sharepoint-server"></a><span data-ttu-id="c35a0-113">Project Server 和 SharePoint Server</span><span class="sxs-lookup"><span data-stu-id="c35a0-113">Project Server and SharePoint Server</span></span>
<span data-ttu-id="c35a0-114"><a name="pj15_Programmability_MOSS"> </a></span><span class="sxs-lookup"><span data-stu-id="c35a0-114"></span></span>

<span data-ttu-id="c35a0-115">Project Web App 基于 SharePoint Server 2013，并使用母版页和 Web 部件更加轻松地构建自定义应用程序和 Project Web App 解决方案。</span><span class="sxs-lookup"><span data-stu-id="c35a0-115">Project Web App is built upon SharePoint Server 2013, and uses master pages and Web Parts to make it easier to build custom apps and Project Web App solutions.</span></span> <span data-ttu-id="c35a0-116">Project Server 2013 深与集成 SharePoint Server 2013 作为平台的项目协作、 报告、 网站管理、 安全性和工作流管理。</span><span class="sxs-lookup"><span data-stu-id="c35a0-116">Project Server 2013 integrates deeply with SharePoint Server 2013 as the platform for project collaboration, reporting, site administration, security, and workflow management.</span></span>
  
<span data-ttu-id="c35a0-117">项目网站包括详细信息和协作选项工作组成员，您可以在其中添加包含摘要、 专用 SharePoint 列表的任务时间线、 跟踪问题、 风险某个项目的默认应用程序，项目可交付结果和团队日历，以及文档库和团队讨论。</span><span class="sxs-lookup"><span data-stu-id="c35a0-117">The project sites include more information and collaboration options for team members, where you can add default apps that include a project summary, specialized SharePoint lists for tasks with a timeline, tracking issues, risks, project deliverables, and the team calendar, along with the document library and team discussions.</span></span> <span data-ttu-id="c35a0-118">Project Server 2013 的自定义应用程序提供扩展和团队协作的灵活性。</span><span class="sxs-lookup"><span data-stu-id="c35a0-118">Custom apps for Project Server 2013 provide extensions and flexibility for team collaboration.</span></span> <span data-ttu-id="c35a0-119">您还可以添加应用程序部件以使用相同的机制来添加和编辑页面时编辑 Web 部件自定义应用程序。</span><span class="sxs-lookup"><span data-stu-id="c35a0-119">You can also add app parts to customize an app, by using the same mechanism to add and edit Web Parts when you edit a page.</span></span> <span data-ttu-id="c35a0-120">您可以找到 SharePoint 服务器场安装 Project Server 中的任意位置的项目网站。</span><span class="sxs-lookup"><span data-stu-id="c35a0-120">You can locate project sites anywhere within the SharePoint farm where Project Server is installed.</span></span> <span data-ttu-id="c35a0-121">使用 SharePoint Server 2013，如 Excel Services 和企业级搜索的其他核心服务管理员可以启用和配置服务。</span><span class="sxs-lookup"><span data-stu-id="c35a0-121">To use other core services of SharePoint Server 2013, such as Excel Services and Enterprise Search, an administrator can enable and configure the services.</span></span> 
  
<span data-ttu-id="c35a0-122">在安装 Project Server 2013 时，您可以设置 Project Service 应用程序中的 SharePoint Web Services 网站。</span><span class="sxs-lookup"><span data-stu-id="c35a0-122">When you install Project Server 2013, you provision the Project Service Application in the SharePoint Web Services site.</span></span> <span data-ttu-id="c35a0-123">Project Service 应用程序包括本地 Windows Communication Foundation (WCF) 服务和 PSI 的 ASMX web 服务。</span><span class="sxs-lookup"><span data-stu-id="c35a0-123">The Project Service Application includes the local Windows Communication Foundation (WCF) services and ASMX web services for the PSI.</span></span> <span data-ttu-id="c35a0-124">服务应用程序的其他示例包括 SharePoint 搜索和 SharePoint 文档管理。</span><span class="sxs-lookup"><span data-stu-id="c35a0-124">Other examples of service applications include SharePoint Search and SharePoint Document Management.</span></span> <span data-ttu-id="c35a0-125">有关详细信息，请参阅 SharePoint Server 2013 开发人员文档。</span><span class="sxs-lookup"><span data-stu-id="c35a0-125">For more information, see the SharePoint Server 2013 developer documentation.</span></span>
  
<span data-ttu-id="c35a0-126">Project Service 应用程序是逻辑服务提供程序可以管理 Project Web App 的多个实例。</span><span class="sxs-lookup"><span data-stu-id="c35a0-126">The Project Service Application is a logical service provider that can manage multiple instances of Project Web App.</span></span> <span data-ttu-id="c35a0-127">Project Server 设置创建 SharePoint web 应用程序内的特定 Project Web App 网站。</span><span class="sxs-lookup"><span data-stu-id="c35a0-127">Project Server provisioning creates a specific Project Web App site within a SharePoint web application.</span></span> <span data-ttu-id="c35a0-128">Project Web App 主页包含项目中心页、 资源中心页和商业智能中心页上的报告，以及包含其他标准的应用程序的列表的页面的链接。</span><span class="sxs-lookup"><span data-stu-id="c35a0-128">The Home page of Project Web App contains links to the Project Center page, Resource Center page, and the Business Intelligence Center page for reporting, plus a page that contains a list of additional standard apps.</span></span> <span data-ttu-id="c35a0-129">图 1 显示了在主页上的 Project Web App，以便您可以添加或编辑 Web 部件**设置**下拉列表中的**编辑页面**命令。</span><span class="sxs-lookup"><span data-stu-id="c35a0-129">Figure 1 shows the **Edit Page** command in the **Setttings** drop-down list on the Home page of Project Web App, which allows you to add or edit Web Parts.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="c35a0-130">Project Web App 中的某些管理页 — 例如，PWA 设置页 — 不是编辑，而不显示**编辑页面**命令。</span><span class="sxs-lookup"><span data-stu-id="c35a0-130">Some administrative pages in Project Web App—such as the PWA Settings page—are not editable, and do not show the **Edit Page** command.</span></span> <span data-ttu-id="c35a0-131">Project Web App 不允许您使用 SharePoint Designer 2013 中编辑页面。</span><span class="sxs-lookup"><span data-stu-id="c35a0-131">Project Web App does not allow you to edit pages by using SharePoint Designer 2013.</span></span> <span data-ttu-id="c35a0-132">您可以编辑项目网站页面使用 SharePoint Designer 2013。</span><span class="sxs-lookup"><span data-stu-id="c35a0-132">You can edit project site pages with SharePoint Designer 2013.</span></span> 
  
<span data-ttu-id="c35a0-133">**图 1。使用 Project Web App 中的编辑页面菜单**</span><span class="sxs-lookup"><span data-stu-id="c35a0-133">**Figure 1. Using the Edit Page menu in Project Web App**</span></span>

<span data-ttu-id="c35a0-134">![编辑 Project Web Access 主页](media/pj15_Programmability_PWAHome.gif "编辑 Project Web Access 主页")</span><span class="sxs-lookup"><span data-stu-id="c35a0-134">![Editing the Home page in Project Web Access](media/pj15_Programmability_PWAHome.gif "Editing the Home page in Project Web Access")</span></span>
  
<span data-ttu-id="c35a0-135">若要访问 Project Web App 中的网站设置页上，选择页面的右上角的**设置**图标。</span><span class="sxs-lookup"><span data-stu-id="c35a0-135">To access the Site Settings page in Project Web App, choose the **Settings** icon in the top-right corner of the page.</span></span> <span data-ttu-id="c35a0-136">网站设置页 ( `http://ServerName/ProjectServerName/_layouts/15/settings.aspx`) 允许更改外观和网站主题，添加自定义 Web 部件，并修改或创建母版页的项目网站。</span><span class="sxs-lookup"><span data-stu-id="c35a0-136">The Site Settings page (  `http://ServerName/ProjectServerName/_layouts/15/settings.aspx`) enables changing the look and feel and the site theme, adding custom Web Parts, and modifying or creating master pages for project sites.</span></span>
  
<span data-ttu-id="c35a0-137">不支持自定义 ASPX 页中的代码或自定义 Project Web App 母版页使用 SharePoint Designer 2013。</span><span class="sxs-lookup"><span data-stu-id="c35a0-137">Customization of the code in ASPX pages, or customization of Project Web App master pages with SharePoint Designer 2013, is not supported.</span></span> <span data-ttu-id="c35a0-138">Project Web App 页中的代码的自定义项可能会导致问题 Project Server 更新和 service pack。</span><span class="sxs-lookup"><span data-stu-id="c35a0-138">Customization of the code in Project Web App pages can cause problems with Project Server updates and service packs.</span></span> 
  
### <a name="customization-of-project-web-app-with-sharepoint-packages"></a><span data-ttu-id="c35a0-139">使用 SharePoint 包自定义 Project Web App</span><span class="sxs-lookup"><span data-stu-id="c35a0-139">Customization of Project Web App with SharePoint packages</span></span>
<span data-ttu-id="c35a0-140"><a name="pj15_Programmability_CustomizationOfPWA"> </a></span><span class="sxs-lookup"><span data-stu-id="c35a0-140"></span></span>

<span data-ttu-id="c35a0-141">由于 Project Web App 的 SharePoint 应用程序，且项目网站的 SharePoint 网站，您可以通过使用 SharePoint 包 （.wsp 文件） 或 SharePoint 应用程序 （.spapp 文件） 中添加自定义应用程序、 Web 部件、 事件处理程序、 自定义域和其他功能。</span><span class="sxs-lookup"><span data-stu-id="c35a0-141">Because Project Web App is a SharePoint application, and project sites are SharePoint sites, you can add custom apps, Web Parts, event handlers, custom fields, and other features by using SharePoint packages (.wsp files) or SharePoint apps (.spapp files).</span></span> <span data-ttu-id="c35a0-142">SharePoint 包或应用程序包可以包括多个 Project Server 实体，其中的包中的 elements.xml 文件中指定实体定义。</span><span class="sxs-lookup"><span data-stu-id="c35a0-142">A SharePoint package or an app package can include multiple Project Server entities, where entity definitions are specified in an elements.xml file within the package.</span></span>
  
<span data-ttu-id="c35a0-143">For Project Online 中，您可以将按钮添加到 Project Web App 功能区中，您不能删除或重命名现有产品按钮，但不能创建新的功能区选项卡。</span><span class="sxs-lookup"><span data-stu-id="c35a0-143">For Project Online, you can add buttons to the Project Web App ribbon, but you can't remove or rename existing product buttons, and you can't create new ribbon tabs.</span></span> <span data-ttu-id="c35a0-144">有关详细信息，请参阅[创建自定义操作，以部署 SharePoint 相关应用程序](http://msdn.microsoft.com/en-us/library/office/apps/jj163954%28v=office.15%29.aspx)。</span><span class="sxs-lookup"><span data-stu-id="c35a0-144">For more information, see [Create custom actions to deploy with apps for SharePoint](http://msdn.microsoft.com/en-us/library/office/apps/jj163954%28v=office.15%29.aspx).</span></span>
  
> [!CAUTION]
> <span data-ttu-id="c35a0-145">在安装 SharePoint 包或应用程序包时，Project Server 实体的类型必须以 PSEntityProvision.xsd 架构所指定的顺序显示，否则包的架构验证将失败且安装不会完成。</span><span class="sxs-lookup"><span data-stu-id="c35a0-145">When you install a SharePoint package or an app package, the types of Project Server entities must appear in the order that the PSEntityProvision.xsd schema specifies or schema validation of the package fails and installation is not completed.</span></span> 
  
<span data-ttu-id="c35a0-146">PSEntityProvision.xsd 架构文件位于 Project 2013 SDK 下载中，在`Documentation\Schemas\AppProvisioning`子目录。</span><span class="sxs-lookup"><span data-stu-id="c35a0-146">The PSEntityProvision.xsd schema file is available in the Project 2013 SDK download, in the  `Documentation\Schemas\AppProvisioning` subdirectory.</span></span> <span data-ttu-id="c35a0-147">图 2 显示了在 Visual Studio 中展开**LookupTable**序列所在的**PSEntityProvision**架构的 XML 架构浏览器视图。</span><span class="sxs-lookup"><span data-stu-id="c35a0-147">Figure 2 shows the XML Schema Explorer view in Visual Studio of the **PSEntityProvision** schema, where the **LookupTable** sequence is expanded.</span></span> 
  
<span data-ttu-id="c35a0-148">**图 2。Project Server 实体架构设置 visual Studio 视图**</span><span class="sxs-lookup"><span data-stu-id="c35a0-148">**Figure 2. Visual Studio view of the Project Server entity provisioning schema**</span></span>

<span data-ttu-id="c35a0-149">![Project Server 实体架构视图](media/pj15_Programmability_EntitySchema.gif "Project Server 实体架构视图")</span><span class="sxs-lookup"><span data-stu-id="c35a0-149">![View of the Project Server entity schema](media/pj15_Programmability_EntitySchema.gif "View of the Project Server entity schema")</span></span>
  
<span data-ttu-id="c35a0-150">为 Project Server 安装功能的 SharePoint 包可以包含一个或多个遵循**PSEntityProvision**架构的 elements.xml 文件。</span><span class="sxs-lookup"><span data-stu-id="c35a0-150">SharePoint packages that install features for Project Server can contain one or more elements.xml files that follow the **PSEntityProvision** schema.</span></span> <span data-ttu-id="c35a0-151">一个 XML 文件中的 Project Server 实体必须按以下顺序出现：</span><span class="sxs-lookup"><span data-stu-id="c35a0-151">The Project Server entities in a single XML file must appear in the following order:</span></span> 
  
1. <span data-ttu-id="c35a0-152">工作流阶段</span><span class="sxs-lookup"><span data-stu-id="c35a0-152">Workflow phases</span></span>
    
2. <span data-ttu-id="c35a0-153">查阅表格</span><span class="sxs-lookup"><span data-stu-id="c35a0-153">Lookup tables</span></span>
    
3. <span data-ttu-id="c35a0-154">自定义域</span><span class="sxs-lookup"><span data-stu-id="c35a0-154">Custom fields</span></span>
    
4. <span data-ttu-id="c35a0-155">工作流容器</span><span class="sxs-lookup"><span data-stu-id="c35a0-155">Workflow stages</span></span>
    
5. <span data-ttu-id="c35a0-156">企业项目类型</span><span class="sxs-lookup"><span data-stu-id="c35a0-156">Enterprise project types</span></span>
    
6. <span data-ttu-id="c35a0-157">事件处理程序</span><span class="sxs-lookup"><span data-stu-id="c35a0-157">Event handlers</span></span>
    
<span data-ttu-id="c35a0-p116">在创建包含 Project Server 实体的 SharePoint 包时，可以将实体定义置于多个 elements.xml 文件中。每个 XML 文件均可传递架构验证，但整个包中的实体的顺序可能不正确。例如，第一个 XML 文件中的自定义域实体会引用第二个 XML 文件中的查阅表格。在安装过程中，无法创建自定义域，因为尚未创建查阅表格。</span><span class="sxs-lookup"><span data-stu-id="c35a0-p116">When you create a SharePoint package that contains Project Server entities, it is possible to put the entity definitions in multiple elements.xml files. Each XML file could pass the schema validation, but the entities in the whole package might not be in the correct order. For example, a custom field entity in the first XML file could refer to a lookup table in the second XML file. During installation, the custom field cannot be created because the lookup table has not yet been created.</span></span>
  
<span data-ttu-id="c35a0-162">如果软件包安装失败，已创建的对象保留在 Project Web App，但不会完全安装包。</span><span class="sxs-lookup"><span data-stu-id="c35a0-162">If a package installation fails, objects that have been created remain in Project Web App, but the package does not install completely.</span></span> <span data-ttu-id="c35a0-163">重新安装包可以工作，但不是客户好的体验。</span><span class="sxs-lookup"><span data-stu-id="c35a0-163">Reinstalling the package can work, but that is not a good experience for customers.</span></span> <span data-ttu-id="c35a0-164">当实体定义跨越多个 elements.xml 文件时，组织中要确保安装按照正确的顺序的整个 SharePoint 包的 Project Server 实体。</span><span class="sxs-lookup"><span data-stu-id="c35a0-164">When the entity definitions span multiple elements.xml files, organize the Project Server entities in the entire SharePoint package to ensure that installation follows the correct order.</span></span> <span data-ttu-id="c35a0-165">Project 2013 SDK 下载中的 PSEntityProvision.xsd 架构，它是可以开发的实体的 XML 文件中的规定的顺序检查工具。</span><span class="sxs-lookup"><span data-stu-id="c35a0-165">With the PSEntityProvision.xsd schema in the Project 2013 SDK download, it is possible to develop a tool that checks for the prescribed order of entities in the XML files.</span></span>
  
## <a name="upgrading-applications-with-the-project-server-apis"></a><span data-ttu-id="c35a0-166">使用 Project Server API 升级应用程序</span><span class="sxs-lookup"><span data-stu-id="c35a0-166">Upgrading applications with the Project Server APIs</span></span>
<span data-ttu-id="c35a0-167"><a name="pj15_Programmability_APIs"> </a></span><span class="sxs-lookup"><span data-stu-id="c35a0-167"></span></span>

<span data-ttu-id="c35a0-168">升级以前版本的 Project Server 的已开发的应用程序时，您可以选择使用 CSOM 或 PSI 编程接口，包含要创建、 读取、 更新和删除项目实体 （CRUD 操作） 的方法。</span><span class="sxs-lookup"><span data-stu-id="c35a0-168">When you upgrade an application that was developed for a previous version of Project Server, you can choose to use either the CSOM or the PSI for a programmatic interface that includes methods to create, read, update, and delete project entities (the CRUD operations).</span></span> <span data-ttu-id="c35a0-169">尽管 CSOM 内部调用 PSI，但它不完全替换所有 PSI 方法。</span><span class="sxs-lookup"><span data-stu-id="c35a0-169">Although the CSOM internally calls the PSI, it does not fully replace all PSI methods.</span></span> <span data-ttu-id="c35a0-170">对于方案和 PSI 和 CSOM 的限制，请参阅[What the PSI does and 不执行](what-the-psi-does-and-does-not-do.md)并[什么 CSOM 执行和不可实现的操作](what-the-csom-does-and-does-not-do.md)。</span><span class="sxs-lookup"><span data-stu-id="c35a0-170">For scenarios and limitations of the PSI and of the CSOM, see [What the PSI does and does not do](what-the-psi-does-and-does-not-do.md) and [What the CSOM does and does not do](what-the-csom-does-and-does-not-do.md).</span></span>
  
> [!NOTE]
> <span data-ttu-id="c35a0-171">如果 CSOM 包括所需的功能，我们建议您升级应用程序使用 CSOM。</span><span class="sxs-lookup"><span data-stu-id="c35a0-171">If the CSOM includes the functionality you require, we recommend that you upgrade applications to use the CSOM.</span></span> <span data-ttu-id="c35a0-172">CSOM 使应用程序可用于在本地和联机 Project Server 2013 的安装。</span><span class="sxs-lookup"><span data-stu-id="c35a0-172">The CSOM enables applications to be used for both on-premises and online installations of Project Server 2013.</span></span> 
  
<span data-ttu-id="c35a0-173">如果您的应用程序主要从 Project Server 中读取数据，您可以使用报告的表和视图 Project Server 数据库中的内部部署方案。</span><span class="sxs-lookup"><span data-stu-id="c35a0-173">If your application primarily reads data from Project Server, you can use the reporting tables and views in the Project Server database for an on-premises scenario.</span></span> <span data-ttu-id="c35a0-174">如果打算与 Project Online 中使用应用程序，可将 OData 协议用于**ProjectData**服务，它提供在本地和联机访问的报表数据。</span><span class="sxs-lookup"><span data-stu-id="c35a0-174">If you intend to use the application with Project Online, you can use the OData protocol for the **ProjectData** service, which provides both on-premises and online access to the reporting data.</span></span> <span data-ttu-id="c35a0-175">有关详细信息，请参阅[ProjectData-Project OData 服务引用](https://msdn.microsoft.com/en-us/library/office/jj163015.aspx)</span><span class="sxs-lookup"><span data-stu-id="c35a0-175">For more information, see [ProjectData - Project OData service reference](https://msdn.microsoft.com/en-us/library/office/jj163015.aspx)</span></span>
  
### <a name="using-the-psi"></a><span data-ttu-id="c35a0-176">使用 PSI</span><span class="sxs-lookup"><span data-stu-id="c35a0-176">Using the PSI</span></span>
<span data-ttu-id="c35a0-177"><a name="pj15_Programmability_PSI"> </a></span><span class="sxs-lookup"><span data-stu-id="c35a0-177"></span></span>

<span data-ttu-id="c35a0-178">PSI 使完全信任客户端应用程序，包括 Project Professional 2013、 Project Web App 和 LOB 应用程序，以访问 SharePoint 服务器场中的 Project Server 数据。</span><span class="sxs-lookup"><span data-stu-id="c35a0-178">The PSI enables full-trust client applications, including Project Professional 2013, Project Web App, and LOB applications, to access Project Server data within a SharePoint farm.</span></span> <span data-ttu-id="c35a0-179">生成和用于.NET Framework 4 PSI 和提供内置安全性、 错误处理和垃圾回收如已知的开发环境的优点。</span><span class="sxs-lookup"><span data-stu-id="c35a0-179">The PSI is built and used with .NET Framework 4 and provides advantages such as a well-known development environment with built-in security, error handling, and garbage collection.</span></span>
  
<span data-ttu-id="c35a0-180">PSI 可为通过 WCF 服务或 ASMX web 服务的访问。</span><span class="sxs-lookup"><span data-stu-id="c35a0-180">The PSI is accessed through WCF services or ASMX web services.</span></span> <span data-ttu-id="c35a0-181">WCF 基于 ASMX 接口。</span><span class="sxs-lookup"><span data-stu-id="c35a0-181">The ASMX interface is based on WCF.</span></span> <span data-ttu-id="c35a0-182">每个 PSI 服务使用的类中的项目的 CRUD 方法通常包含一个基类。</span><span class="sxs-lookup"><span data-stu-id="c35a0-182">Each PSI service typically contains a base class with CRUD methods for items within that class.</span></span> <span data-ttu-id="c35a0-183">相关的**数据集**类由指定项目。</span><span class="sxs-lookup"><span data-stu-id="c35a0-183">Items are specified by related **DataSet** classes.</span></span> <span data-ttu-id="c35a0-184">例如， **CustomFields**服务使用如[CreateCustomFields2](https://msdn.microsoft.com/library/WebSvcCustomFields.CustomFields.CreateCustomFields2.aspx)方法包含**CustomFields**类。</span><span class="sxs-lookup"><span data-stu-id="c35a0-184">For example, the **CustomFields** service contains the **CustomFields** class with methods such as [CreateCustomFields2](https://msdn.microsoft.com/library/WebSvcCustomFields.CustomFields.CreateCustomFields2.aspx) .</span></span> <span data-ttu-id="c35a0-185">**CustomFieldDataSet**中指定了一个或多个企业自定义域的数据。</span><span class="sxs-lookup"><span data-stu-id="c35a0-185">Data for one or more enterprise custom fields are specified in the **CustomFieldDataSet**.</span></span>
  
> [!NOTE]
> <span data-ttu-id="c35a0-186">Project Server 2013 中已弃用 PSI 的 ASMX web 服务接口。</span><span class="sxs-lookup"><span data-stu-id="c35a0-186">The ASMX web services interface of the PSI is deprecated in Project Server 2013.</span></span> <span data-ttu-id="c35a0-187">尽管 ASMX 接口仍然可用，但使用 PSI 的新应用程序应使用 WCF 接口，或新的应用程序如果可能，应使用 CSOM 而非 PSI。</span><span class="sxs-lookup"><span data-stu-id="c35a0-187">Although the ASMX interface is still available, new applications that use the PSI should use the WCF interface, or if possible, new applications should use the CSOM instead of the PSI.</span></span> <span data-ttu-id="c35a0-188">Project Server 的未来版本将需要升级的现有基于 ASMX 的应用程序使用 PSI 的 WCF 接口还是使用 CSOM。</span><span class="sxs-lookup"><span data-stu-id="c35a0-188">Future versions of Project Server will require an upgrade of existing ASMX-based applications to use the WCF interface of the PSI or to use the CSOM.</span></span> 
  
<span data-ttu-id="c35a0-189">有 22 public 记录重复的 WCF 接口和 ASMX 接口中的 PSI 服务。</span><span class="sxs-lookup"><span data-stu-id="c35a0-189">There are 22 public, documented PSI services, which are duplicated in the WCF interface and the ASMX interface.</span></span> <span data-ttu-id="c35a0-190">PSI 还包括八个私有、 未记录服务。</span><span class="sxs-lookup"><span data-stu-id="c35a0-190">The PSI also includes eight private, undocumented services.</span></span> <span data-ttu-id="c35a0-191">Project Web App 和 Project Professional 使用 PSI 服务公用和专用的 PSI 服务。</span><span class="sxs-lookup"><span data-stu-id="c35a0-191">Project Web App and Project Professional use the public PSI services and the private PSI services.</span></span> <span data-ttu-id="c35a0-192">PSI 通常分解匹配的业务对象。</span><span class="sxs-lookup"><span data-stu-id="c35a0-192">The PSI is generally factored to match the business objects.</span></span> <span data-ttu-id="c35a0-193">即，每个 PSI 方法是与业务对象，如**日历**或**资源**关联。</span><span class="sxs-lookup"><span data-stu-id="c35a0-193">That is, each PSI method is associated with a business object such as **Calendar** or **Resource**.</span></span> <span data-ttu-id="c35a0-194">PSI 的业务对象的主要接口。</span><span class="sxs-lookup"><span data-stu-id="c35a0-194">The PSI is the primary interface to the business objects.</span></span> <span data-ttu-id="c35a0-195">业务层提供可重用的业务逻辑组件，因为不同与 Project Server 数据进行交互的应用程序将使用相同的业务逻辑。</span><span class="sxs-lookup"><span data-stu-id="c35a0-195">Because the business layer provides reusable business logic components, different applications that interact with Project Server data use the same business logic.</span></span>
  
<span data-ttu-id="c35a0-196">与 Project Server 异步交互的 PSI 方法具有开头**队列**的名称。</span><span class="sxs-lookup"><span data-stu-id="c35a0-196">PSI methods that asynchronously interact with Project Server have names that begin with **Queue**.</span></span> <span data-ttu-id="c35a0-197">每个 PSI 方法实现与单独的接口使用强类型数据。</span><span class="sxs-lookup"><span data-stu-id="c35a0-197">Each PSI method is implemented with a separate interface that uses strongly typed data.</span></span> <span data-ttu-id="c35a0-198">例如， **Project**服务中的**QueueCreateProject**方法接受类型**ProjectDataSet**的_数据集_参数。</span><span class="sxs-lookup"><span data-stu-id="c35a0-198">For example, the **QueueCreateProject** method in the **Project** service accepts the  _dataset_ parameter of type **ProjectDataSet**.</span></span> <span data-ttu-id="c35a0-199">**ProjectDataSet**类派生的**数据集**类型。</span><span class="sxs-lookup"><span data-stu-id="c35a0-199">The **ProjectDataSet** class is derived from the **DataSet** type.</span></span> <span data-ttu-id="c35a0-200">键入签入以减少中使用 PSI 进行开发的错误的 Visual Studio 帮助中的.NET Framework 和 IntelliSense 完成。</span><span class="sxs-lookup"><span data-stu-id="c35a0-200">Type checking in the .NET Framework and IntelliSense completion in Visual Studio help to reduce errors in development with the PSI.</span></span> <span data-ttu-id="c35a0-201">PSI 命名空间、 类、 方法、 属性、 事件和相关程序集的详细引用的简介，请参阅[Project PSI 参考概述](project-psi-reference-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="c35a0-201">For an introduction to the detailed reference for PSI namespaces, classes, methods, properties, events, and related assemblies, see [Project PSI reference overview](project-psi-reference-overview.md).</span></span>
  
<span data-ttu-id="c35a0-202">Project Server 2013 使用.NET Framework 的异常处理。</span><span class="sxs-lookup"><span data-stu-id="c35a0-202">Project Server 2013 uses the exception handling of the .NET Framework.</span></span> <span data-ttu-id="c35a0-203">在服务器顶部的 PSI 堆栈将记录所有错误。</span><span class="sxs-lookup"><span data-stu-id="c35a0-203">All errors are logged in the server, at the top of the PSI stack.</span></span> <span data-ttu-id="c35a0-204">一些错误的简单报告发送到客户端，例如 ASMX 接口**SoapException**对象或**FaultException**对象的 WCF 接口。</span><span class="sxs-lookup"><span data-stu-id="c35a0-204">Some errors send a simple report to the client, such as a **SoapException** object for the ASMX interface or a **FaultException** object for the WCF interface.</span></span> <span data-ttu-id="c35a0-205">可以在应用程序事件日志中，记录异常和一些错误也统一日志记录服务 (ULS) 跟踪日志中记录服务器上的详细的报告。</span><span class="sxs-lookup"><span data-stu-id="c35a0-205">Exceptions can be recorded in the application event log, and some errors also record a detailed report on the server in the Unified Logging Service (ULS) trace logs.</span></span> 
  
<span data-ttu-id="c35a0-p127">此外，可以为本地完全信任应用程序扩展 PSI。可以将 .NET 程序集与服务一起添加，该服务提供了新功能、使用相同的 Project Server 安全基础结构并调用其他 PSI 方法或从 PSI 类继承。PSI 扩展还可提供新功能所需的业务逻辑和数据库访问权。</span><span class="sxs-lookup"><span data-stu-id="c35a0-p127">For local full-trust applications, the PSI is also extensible. You can add a .NET assembly with a service that provides new functionality, uses the same Project Server security infrastructure, and calls other PSI methods or inherits from PSI classes. A PSI extension can also provide the business logic and database access required for new functionality.</span></span>
  
### <a name="using-the-csom"></a><span data-ttu-id="c35a0-209">使用 CSOM</span><span class="sxs-lookup"><span data-stu-id="c35a0-209">Using the CSOM</span></span>
<span data-ttu-id="c35a0-210"><a name="pj15_Programmability_CSOM"> </a></span><span class="sxs-lookup"><span data-stu-id="c35a0-210"></span></span>

<span data-ttu-id="c35a0-211">使用 CSOM，您可以开发访问 Project Online 或内部部署 Project Server 2013 安装的应用程序。</span><span class="sxs-lookup"><span data-stu-id="c35a0-211">With the CSOM, you can develop apps that access Project Online or an on-premises Project Server 2013 installation.</span></span> <span data-ttu-id="c35a0-212">可以将应用程序分发公共的 Office 商店或专用应用程序目录中。</span><span class="sxs-lookup"><span data-stu-id="c35a0-212">Apps can be distributed in a public Office Store or a private app catalog.</span></span> <span data-ttu-id="c35a0-213">CSOM 可易于使用 API 直接使用或通过使用 LINQ 查询的名称，而不是通过传递数据集和构造_changeXml_参数或 XML_筛选器_参数提供数据。</span><span class="sxs-lookup"><span data-stu-id="c35a0-213">The CSOM is designed to be an easy-to-use API that directly consumes or provides data by name with LINQ queries, rather than by passing datasets and constructing  _changeXml_ parameters or XML  _filter_ parameters.</span></span> <span data-ttu-id="c35a0-214">CSOM 可实现的主要功能的主实体，如**项目**、**任务**、 **EnterpriseResource**和**工作分配**的 Project Server 接口 (PSI)。</span><span class="sxs-lookup"><span data-stu-id="c35a0-214">The CSOM implements the main functionality of the Project Server Interface (PSI) for the primary entities such as **Project**, **Task**, **EnterpriseResource**, and **Assignment**.</span></span> <span data-ttu-id="c35a0-215">CSOM 包括许多其他实体，如**CustomField**、 **LookupTable**、 **WorkflowActivities**、**事件处理程序**和**QueueJob**，支持其他常见的 Project Server 功能。</span><span class="sxs-lookup"><span data-stu-id="c35a0-215">The CSOM includes many additional entities such as **CustomField**, **LookupTable**, **WorkflowActivities**, **EventHandler**, and **QueueJob**, which support other common Project Server functionality.</span></span>
  
<span data-ttu-id="c35a0-216">可通过将以下资源复制到本地开发计算机来使用 CSOM：</span><span class="sxs-lookup"><span data-stu-id="c35a0-216">The CSOM can be used by copying the following resources to your local development computer:</span></span>
  
- <span data-ttu-id="c35a0-217">对于.NET Framework 4 开发，复制`%ProgramFiles%\Common Files\Microsoft Shared\Web Server Extensions\15\ISAPI\Microsoft.ProjectServer.Client.dll`程序集。</span><span class="sxs-lookup"><span data-stu-id="c35a0-217">For .NET Framework 4 development, copy the  `%ProgramFiles%\Common Files\Microsoft Shared\Web Server Extensions\15\ISAPI\Microsoft.ProjectServer.Client.dll` assembly.</span></span> 
    
  <span data-ttu-id="c35a0-218">有关 CSOM 类和成员的文档，请参阅[Microsoft.ProjectServer.Client](https://msdn.microsoft.com/library/Microsoft.ProjectServer.Client.aspx)命名空间。</span><span class="sxs-lookup"><span data-stu-id="c35a0-218">For documentation of the CSOM classes and members, see the [Microsoft.ProjectServer.Client](https://msdn.microsoft.com/library/Microsoft.ProjectServer.Client.aspx) namespace.</span></span> <span data-ttu-id="c35a0-219">示例应用程序，请参阅[Getting started with CSOM 和.NET](getting-started-with-the-project-server-csom-and-net.md)。</span><span class="sxs-lookup"><span data-stu-id="c35a0-219">For an example application, see [Getting started with the CSOM and .NET](getting-started-with-the-project-server-csom-and-net.md).</span></span>
    
- <span data-ttu-id="c35a0-220">对于 Microsoft Silverlight 开发，复制`%ProgramFiles%\Common Files\Microsoft Shared\Web Server Extensions\15\TEMPLATE\LAYOUTS\ClientBin\Microsoft.ProjectServer.Client.Silverlight.dll`程序集。</span><span class="sxs-lookup"><span data-stu-id="c35a0-220">For Microsoft Silverlight development, copy the  `%ProgramFiles%\Common Files\Microsoft Shared\Web Server Extensions\15\TEMPLATE\LAYOUTS\ClientBin\Microsoft.ProjectServer.Client.Silverlight.dll` assembly.</span></span> 
    
- <span data-ttu-id="c35a0-221">若要开发面向 Windows Phone 8 应用程序，复制`%ProgramFiles%\Common Files\Microsoft Shared\Web Server Extensions\15\TEMPLATE\LAYOUTS\ClientBin\Microsoft.ProjectServer.Client.Phone.dll`程序集。</span><span class="sxs-lookup"><span data-stu-id="c35a0-221">To develop apps for Windows Phone 8, copy the  `%ProgramFiles%\Common Files\Microsoft Shared\Web Server Extensions\15\TEMPLATE\LAYOUTS\ClientBin\Microsoft.ProjectServer.Client.Phone.dll` assembly.</span></span> 
    
- <span data-ttu-id="c35a0-222">若要使用 JavaScript 开发 web 应用程序和其他设备应用程序，复制`%ProgramFiles%\Common Files\Microsoft Shared\Web Server Extensions\15\TEMPLATE\LAYOUTS\PS.js`文件和`PS.debug.js`文件。</span><span class="sxs-lookup"><span data-stu-id="c35a0-222">To use JavaScript for developing web apps and apps for other devices, copy the  `%ProgramFiles%\Common Files\Microsoft Shared\Web Server Extensions\15\TEMPLATE\LAYOUTS\PS.js` file and the  `PS.debug.js` file.</span></span> <span data-ttu-id="c35a0-223">示例 web 应用程序，请参阅[Getting started with Project Server 2013 JavaScript 对象模型](getting-started-with-the-project-server-2013-javascript-object-model.md)。</span><span class="sxs-lookup"><span data-stu-id="c35a0-223">For an example web app, see [Getting started with the Project Server 2013 JavaScript object model](getting-started-with-the-project-server-2013-javascript-object-model.md).</span></span>
    
<span data-ttu-id="c35a0-224">CSOM 内部调用 PSI;因此，如果 PSI 不能实现作业的操作，也不可以 CSOM。</span><span class="sxs-lookup"><span data-stu-id="c35a0-224">The CSOM internally calls the PSI; therefore, if the PSI cannot do a job, neither can the CSOM.</span></span> <span data-ttu-id="c35a0-225">有关 CSOM 的限制，请参阅[What the CSOM does and 不执行](what-the-csom-does-and-does-not-do.md)并[What the PSI 执行和不可实现的操作](what-the-psi-does-and-does-not-do.md)。</span><span class="sxs-lookup"><span data-stu-id="c35a0-225">For limitations of the CSOM, see [What the CSOM does and does not do](what-the-csom-does-and-does-not-do.md) and [What the PSI does and does not do](what-the-psi-does-and-does-not-do.md).</span></span> <span data-ttu-id="c35a0-226">有关使用 CSOM 进行开发的详细信息，请参阅[Project 2013 中面向开发人员的更新](updates-for-developers-in-project-2013.md)和[客户端对象模型 (CSOM) for Project 2013](client-side-object-model-csom-for-project-2013.md)。</span><span class="sxs-lookup"><span data-stu-id="c35a0-226">For more information about developing with the CSOM, see [Updates for developers in Project 2013](updates-for-developers-in-project-2013.md) and [Client-side object model (CSOM) for Project 2013](client-side-object-model-csom-for-project-2013.md).</span></span>
  
### <a name="porting-applications-built-for-project-server-2003"></a><span data-ttu-id="c35a0-227">移植为 Project Server 2003 生成的应用程序</span><span class="sxs-lookup"><span data-stu-id="c35a0-227">Porting applications built for Project Server 2003</span></span>
<span data-ttu-id="c35a0-228"><a name="pj15_Programmability_Porting2003"> </a></span><span class="sxs-lookup"><span data-stu-id="c35a0-228"></span></span>

<span data-ttu-id="c35a0-p132">在 Project Server 2003 中，许多数据和功能仅适用于 Project Professional 2003 或通过直接数据库访问使用。Project Server 2007 中引入的 PSI 在很大程度上消除了此限制。与 Project Server 2003 中的 Project Data Service (PDS) 不同，PSI 和 CSOM 为 Project Server 中的业务对象提供了全面的接口。</span><span class="sxs-lookup"><span data-stu-id="c35a0-p132">In Project Server 2003, much data and functionality is available only with Project Professional 2003 or by direct database access. The PSI, introduced in Project Server 2007, removes much of that restriction. Unlike the Project Data Service (PDS) in Project Server 2003, the PSI and the CSOM provide comprehensive interfaces to business objects in Project Server.</span></span>
  
<span data-ttu-id="c35a0-p133">为 PDS 开发的应用程序与更新版本的 Project Server 不兼容。CSOM 和 PSI 为 PDS 提供了功能奇偶校验位，但与 PDS 方法或参数不匹配。</span><span class="sxs-lookup"><span data-stu-id="c35a0-p133">Applications developed for the PDS are not compatible with later versions of Project Server. The CSOM and the PSI provide functional parity for the PDS, but do not match PDS methods or parameters.</span></span>
  
> [!NOTE]
> <span data-ttu-id="c35a0-234">由于必须完全重新 PDS 应用程序设计，Project Server 2013，我们建议您使用 CSOM。</span><span class="sxs-lookup"><span data-stu-id="c35a0-234">Because PDS applications must be completely redesigned for Project Server 2013, we recommend that you use the CSOM.</span></span> 
  
<span data-ttu-id="c35a0-235">有关 PDS 兼容性和 PDS 扩展移植到 PSI 的指南的详细信息，请参阅[PDS Parity in PSI Web 服务](http://msdn.microsoft.com/library/61a0b0c7-9b74-46d1-87ed-66ffdd8017f8%28Office.15%29.aspx)。</span><span class="sxs-lookup"><span data-stu-id="c35a0-235">For more information about PDS compatibility and guidelines for porting PDS extensions to the PSI, see [PDS Parity in PSI Web Services](http://msdn.microsoft.com/library/61a0b0c7-9b74-46d1-87ed-66ffdd8017f8%28Office.15%29.aspx).</span></span>
  
### <a name="porting-applications-built-for-project-server-2007-and-project-server-2010"></a><span data-ttu-id="c35a0-236">移植为 Project Server 2007 和 Project Server 2010 生成的应用程序</span><span class="sxs-lookup"><span data-stu-id="c35a0-236">Porting applications built for Project Server 2007 and Project Server 2010</span></span>
<span data-ttu-id="c35a0-237"><a name="pj15_Programmability_Porting2007"> </a></span><span class="sxs-lookup"><span data-stu-id="c35a0-237"></span></span>

<span data-ttu-id="c35a0-238">Project Server 2013 中的 PSI 是 Office Project Server 2007 和 Project Server 2010 中的 PSI 对象模型超集。</span><span class="sxs-lookup"><span data-stu-id="c35a0-238">The PSI in Project Server 2013 is a superset of the PSI object model in Office Project Server 2007 and Project Server 2010.</span></span> <span data-ttu-id="c35a0-239">为 Project Server 的两个早期版本构建的多个应用程序继续在本地完全信任的本地安装的 Project Server 2013 中工作。</span><span class="sxs-lookup"><span data-stu-id="c35a0-239">Many applications built for the two previous versions of Project Server continue to work in local full-trust, on-premises installations of Project Server 2013.</span></span> <span data-ttu-id="c35a0-240">但是，以下类型的应用程序需要更新或重新设计：</span><span class="sxs-lookup"><span data-stu-id="c35a0-240">However, the following kinds of applications require updates or redesign:</span></span>
  
- <span data-ttu-id="c35a0-241">对修改为与 Project Online 一起使用的应用程序使用 CSOM。</span><span class="sxs-lookup"><span data-stu-id="c35a0-241">Use the CSOM for applications that are adapted for use with Project Online.</span></span>
    
- <span data-ttu-id="c35a0-242">对修改为在移动设备和 Tablet 计算机上使用的应用程序使用 CSOM。</span><span class="sxs-lookup"><span data-stu-id="c35a0-242">Use the CSOM for applications that are adapted for use on mobile devices and tablet computers.</span></span>
    
- <span data-ttu-id="c35a0-243">可在 Office 商店或专用应用程序目录中的应用程序的应用程序使用 CSOM。</span><span class="sxs-lookup"><span data-stu-id="c35a0-243">Use the CSOM for applications that are available as apps in the Office Store or a private app catalog.</span></span>
    
- <span data-ttu-id="c35a0-244">对于修改项目计划的应用程序，使用 CSOM，或更改应用程序使用[QueueUpdateProject2](https://msdn.microsoft.com/library/WebSvcProject.Project.QueueUpdateProject2.aspx) PSI 方法。</span><span class="sxs-lookup"><span data-stu-id="c35a0-244">For applications that modify project scheduling, use the CSOM, or change the application to use the [QueueUpdateProject2](https://msdn.microsoft.com/library/WebSvcProject.Project.QueueUpdateProject2.aspx) PSI method.</span></span> 
    
- <span data-ttu-id="c35a0-245">本地或 web 应用程序登录到 Project Web App 的不同实例的用户应使用 CSOM 或 PSI 的 WCF 终结点的编程式设置。</span><span class="sxs-lookup"><span data-stu-id="c35a0-245">Local or web applications that log on users to different instances of Project Web App should use programmatic settings for WCF endpoints of the CSOM or the PSI.</span></span> <span data-ttu-id="c35a0-246">方法已被弃用。</span><span class="sxs-lookup"><span data-stu-id="c35a0-246">The methods are deprecated.</span></span> <span data-ttu-id="c35a0-247">应用程序应使用 OAuth 身份验证来代替表单身份验证和用于 Project Online。</span><span class="sxs-lookup"><span data-stu-id="c35a0-247">Apps should use OAuth authentication in place of Forms authentication and for use with Project Online.</span></span> <span data-ttu-id="c35a0-248">有关详细信息，请参阅[Authorization and SharePoint 2013 中应用程序的身份验证](http://msdn.microsoft.com/en-us/library/fp142384%28office.15%29.aspx#FileName_uniquekeyword1)。</span><span class="sxs-lookup"><span data-stu-id="c35a0-248">For more information, see [Authorization and authentication for apps in SharePoint 2013](http://msdn.microsoft.com/en-us/library/fp142384%28office.15%29.aspx#FileName_uniquekeyword1).</span></span>
    
- <span data-ttu-id="c35a0-249">依赖或修改特定 Project Server 安全设置的应用程序。</span><span class="sxs-lookup"><span data-stu-id="c35a0-249">Applications that rely on or modify specific Project Server security settings.</span></span>
    
  > [!NOTE]
  > <span data-ttu-id="c35a0-250">默认的本地安装的 Project Server 2013 使用 SharePoint 权限模式中，不通过 PSI 访问 Project Server 安全设置。</span><span class="sxs-lookup"><span data-stu-id="c35a0-250">A default on-premises installation of Project Server 2013 uses the SharePoint permission mode, where Project Server security settings are not accessible through the PSI.</span></span> <span data-ttu-id="c35a0-251">若要将更改为 Project 权限模式，请参阅中[What's new for Project Server 2013 中的 IT 专业人员](http://technet.microsoft.com/en-us/library/ff631142%28office.15%29.aspx#section13)的*SharePoint 权限模式下*一节。</span><span class="sxs-lookup"><span data-stu-id="c35a0-251">To change to the Project permission mode, see the  *SharePoint Permission Mode*  section in [What's new for IT pros in Project Server 2013](http://technet.microsoft.com/en-us/library/ff631142%28office.15%29.aspx#section13).</span></span> 
  
- <span data-ttu-id="c35a0-252">对于许多自定义 Project Server 工作流，您可以使用 SharePoint Designer 2013 创建声明性工作流。</span><span class="sxs-lookup"><span data-stu-id="c35a0-252">For many custom Project Server workflows, you can use SharePoint Designer 2013 to create declarative workflows.</span></span> <span data-ttu-id="c35a0-253">对于需要其他编程的自定义工作流，您应该*直接使用的类或成员**Microsoft.Office.Project.Server.Workflow**命名空间中*。</span><span class="sxs-lookup"><span data-stu-id="c35a0-253">For custom workflows that require additional programming, you should  *not*  directly use classes or members in the **Microsoft.Office.Project.Server.Workflow** namespace.</span></span> <span data-ttu-id="c35a0-254">请改用[Microsoft.ProjectServer.Client.WorkflowActivities](https://msdn.microsoft.com/library/Microsoft.ProjectServer.Client.WorkflowActivities.aspx)类中 CSOM。</span><span class="sxs-lookup"><span data-stu-id="c35a0-254">Instead, use the [Microsoft.ProjectServer.Client.WorkflowActivities](https://msdn.microsoft.com/library/Microsoft.ProjectServer.Client.WorkflowActivities.aspx) class in the CSOM.</span></span> 
    
- <span data-ttu-id="c35a0-255">一般情况下，使用模拟的应用程序应重写以使用 PSI 的 WCF 接口。</span><span class="sxs-lookup"><span data-stu-id="c35a0-255">In general, applications that use impersonation should be rewritten to use the WCF interface of the PSI.</span></span> <span data-ttu-id="c35a0-256">为其他用户执行简单的状态更新的应用程序不需要模拟。</span><span class="sxs-lookup"><span data-stu-id="c35a0-256">Applications that do simple status updates for other users do not require impersonation.</span></span> <span data-ttu-id="c35a0-257">这些用户可以使用 CSOM 中的[StatusAssignment.SubmitStatusUpdates](https://msdn.microsoft.com/library/Microsoft.ProjectServer.Client.StatusAssignment.SubmitStatusUpdates.aspx)方法或 PSI 中的[Statusing.SubmitStatusForResource](https://msdn.microsoft.com/library/WebSvcStatusing.Statusing.SubmitStatusForResource.aspx)方法。</span><span class="sxs-lookup"><span data-stu-id="c35a0-257">They can use the [StatusAssignment.SubmitStatusUpdates](https://msdn.microsoft.com/library/Microsoft.ProjectServer.Client.StatusAssignment.SubmitStatusUpdates.aspx) method in the CSOM or the [Statusing.SubmitStatusForResource](https://msdn.microsoft.com/library/WebSvcStatusing.Statusing.SubmitStatusForResource.aspx) method in the PSI.</span></span> 
    
- <span data-ttu-id="c35a0-258">在 Project Server 计算机运行的中间件组件可以安装仅供内部使用，并且必须使用 PSI 的 WCF 接口。</span><span class="sxs-lookup"><span data-stu-id="c35a0-258">Middleware components that run on the Project Server computer can be installed only for on-premises use, and must use the WCF interface of the PSI.</span></span> <span data-ttu-id="c35a0-259">例如，使用 ASMX 的中间件组件部署 Project Web App 之间交换数据的接口和外部时间表应用程序需要重写以使用 PSI 的 WCF 接口。</span><span class="sxs-lookup"><span data-stu-id="c35a0-259">For example, a middleware component that uses the ASMX interface to exchange data between Project Web App on-premises and an external timesheet application would have to be rewritten to use the WCF interface of the PSI.</span></span> <span data-ttu-id="c35a0-260">若要使用 Project Online，组件必须重新设计为应用程序并使用 CSOM。</span><span class="sxs-lookup"><span data-stu-id="c35a0-260">To work with Project Online, the component would have to be redesigned as an app and use the CSOM.</span></span>
    
### <a name="migration-and-compatibility-of-custom-solutions"></a><span data-ttu-id="c35a0-261">自定义解决方案的迁移和兼容性</span><span class="sxs-lookup"><span data-stu-id="c35a0-261">Migration and compatibility of custom solutions</span></span>
<span data-ttu-id="c35a0-262"><a name="pj15_Programmability_CustomSolutions"> </a></span><span class="sxs-lookup"><span data-stu-id="c35a0-262"></span></span>

<span data-ttu-id="c35a0-263">PSI 的公共 ASMX 和 WCF 接口中类和成员是相同的。</span><span class="sxs-lookup"><span data-stu-id="c35a0-263">Classes and members in the public ASMX and WCF interfaces of the PSI are identical.</span></span> <span data-ttu-id="c35a0-264">但是，可以不同 Project Server 2013 和两个早期 Project Server 版本之间的列数和数据表或使用 PSI 方法返回的大小。</span><span class="sxs-lookup"><span data-stu-id="c35a0-264">But, the number of columns and size of datatables used or returned by PSI methods can be different between Project Server 2013 and the two previous Project Server versions.</span></span> <span data-ttu-id="c35a0-265">还有报告的表和视图，与早期版本中报告数据库中的差异。</span><span class="sxs-lookup"><span data-stu-id="c35a0-265">There are also differences in the reporting tables and views, compared with the Reporting database in previous versions.</span></span>
  
> [!IMPORTANT]
> <span data-ttu-id="c35a0-266">我们强烈建议您全面测试 Project Server 2013 的非生产安装之前将它们部署到生产服务器上的解决方案。</span><span class="sxs-lookup"><span data-stu-id="c35a0-266">We strongly recommend that you thoroughly test solutions on a non-production installation of Project Server 2013 before deploying them to a production server.</span></span> 
  
<span data-ttu-id="c35a0-267">将解决方案迁移到 Project Server 2013，或如果解决方案未按预期，您应至少时执行以下操作：</span><span class="sxs-lookup"><span data-stu-id="c35a0-267">When you migrate a solution to Project Server 2013, or if a solution does not work as expected, you should at a minimum do the following:</span></span>
  
- <span data-ttu-id="c35a0-268">通过在 Visual Studio 2012 中打开更新解决方案。</span><span class="sxs-lookup"><span data-stu-id="c35a0-268">Update the solution by opening it in Visual Studio 2012.</span></span> <span data-ttu-id="c35a0-269">某些解决方案还可以使用 Visual Studio 2010。</span><span class="sxs-lookup"><span data-stu-id="c35a0-269">Some solutions can also use Visual Studio 2010.</span></span>
    
- <span data-ttu-id="c35a0-270">将目标更改为.NET Framework 4。</span><span class="sxs-lookup"><span data-stu-id="c35a0-270">Change the target to .NET Framework 4.</span></span>
    
- <span data-ttu-id="c35a0-271">更改程序集引用以使用 Project Server 2013 程序集，如 Microsoft.Office.Project.Server.Library.dll 和 Microsoft.Office.Project.Server.Events.Receivers.dll。</span><span class="sxs-lookup"><span data-stu-id="c35a0-271">Change assembly references to use the Project Server 2013 assemblies, such as Microsoft.Office.Project.Server.Library.dll and Microsoft.Office.Project.Server.Events.Receivers.dll.</span></span>
    
- <span data-ttu-id="c35a0-272">列出 ASMX Web 引用或 WCF 服务引用和命名空间名称，然后删除 Project Server 引用。</span><span class="sxs-lookup"><span data-stu-id="c35a0-272">Make a list of the ASMX web references or the WCF service references and namespace names, and then delete the Project Server references.</span></span>
    
- <span data-ttu-id="c35a0-273">添加 ProjectServerServices.dll 代理程序集，可以从 Project 2013 SDK 下载中的 WCF 代理源文件构建或添加所需的 WCF 服务的代理源文件。</span><span class="sxs-lookup"><span data-stu-id="c35a0-273">Add the ProjectServerServices.dll proxy assembly that you can build from the WCF proxy source files in the Project 2013 SDK download, or add the proxy source files for the required WCF services.</span></span> <span data-ttu-id="c35a0-274">ASMX 服务的前端的 ASMX web 服务引用再次添加，使用相同的命名空间名称;或添加您可以从 Project 2013 SDK 下载中的 WSDL 源生成 ProjectServerServices.dll 代理程序集。</span><span class="sxs-lookup"><span data-stu-id="c35a0-274">For ASMX services, add the front-end ASMX web service references again, by using the same namespace names; or add the ProjectServerServices.dll proxy assembly that you can build from the WSDL sources in the Project 2013 SDK download.</span></span>
    
  > [!NOTE]
  > <span data-ttu-id="c35a0-275">在 Project 2013 SDK 下载中，代理源中的命名空间文件所有*Svc*开始。</span><span class="sxs-lookup"><span data-stu-id="c35a0-275">In the Project 2013 SDK download, the namespaces in the proxy source files all start with  *Svc*  .</span></span> <span data-ttu-id="c35a0-276">例如，**资源**服务命名空间和 ASMX 代理文件中的 WCF 代理文件为**SvcResource**。</span><span class="sxs-lookup"><span data-stu-id="c35a0-276">For example, the **Resource** service namespace in the WCF proxy file and in the ASMX proxy file is **SvcResource**.</span></span> <span data-ttu-id="c35a0-277">> 如果您的应用程序使用不同的命名空间名称，您可以重新编译代理程序集，用于命名空间，或更改您的应用程序中的 PSI 命名空间。</span><span class="sxs-lookup"><span data-stu-id="c35a0-277">> If your application uses different namespace names, you can either recompile the proxy assembly to use your namespaces, or change the PSI namespaces in your application.</span></span> <span data-ttu-id="c35a0-278">例如，您可以修改 CompileWCFProxyAssembly.cmd 脚本和重新编译 ProjectServerServices.dll SDK 下载中的代理源文件。</span><span class="sxs-lookup"><span data-stu-id="c35a0-278">For example, you can modify the CompileWCFProxyAssembly.cmd script and recompile ProjectServerServices.dll from the proxy source files in the SDK download.</span></span> 
  
- <span data-ttu-id="c35a0-279">如果更改到的 WCF 接口使用 PSI 的 ASMX 接口，可以通过编程方式或通过使用 app.config 中的 WCF 端点初始化的客户端类。当您需要快速切换到 Project Web App 的不同实例或开发使用 PSI 的 web 部件时，请使用编程初始化。</span><span class="sxs-lookup"><span data-stu-id="c35a0-279">If you change from using the ASMX interface of the PSI to the WCF interface, you can initialize the client classes either programmatically or by using WCF endpoints in app.config. Use programmatic initialization when you have to quickly switch to different instances of Project Web App, or when you are developing a web part that uses the PSI.</span></span>
    
- <span data-ttu-id="c35a0-280">有几种新方法，并且在 Project Server 2013 和一些**DataRow**类中的 PSI 服务中的数据集包含新属性。</span><span class="sxs-lookup"><span data-stu-id="c35a0-280">There are several new methods and datasets in the PSI services in Project Server 2013 and some **DataRow** classes contain new properties.</span></span> <span data-ttu-id="c35a0-281">例如，PSI 中的[QueueUpdateProject2](https://msdn.microsoft.com/library/WebSvcProject.Project.QueueUpdateProject2.aspx)方法使用 Project Server 计划引擎进行重新更新的项目，而无需在 Project Professional 2013 中打开项目，还允许添加或删除项目中的实体在同一呼叫。</span><span class="sxs-lookup"><span data-stu-id="c35a0-281">For example, the [QueueUpdateProject2](https://msdn.microsoft.com/library/WebSvcProject.Project.QueueUpdateProject2.aspx) method in the PSI uses the Project Server scheduling engine to reschedule an updated project without you having to open the project in Project Professional 2013, and also allows adding or deleting project entities in the same call.</span></span> 
    
- <span data-ttu-id="c35a0-282">编译和测试解决方案。</span><span class="sxs-lookup"><span data-stu-id="c35a0-282">Compile and test the solution.</span></span>
    
## <a name="project-scheduling-on-the-server"></a><span data-ttu-id="c35a0-283">服务器上的项目计划</span><span class="sxs-lookup"><span data-stu-id="c35a0-283">Project scheduling on the server</span></span>
<span data-ttu-id="c35a0-284"><a name="pj15_Programmability_Scheduling"> </a></span><span class="sxs-lookup"><span data-stu-id="c35a0-284"></span></span>

<span data-ttu-id="c35a0-285">Project Server 2013 具有两个的计划引擎。</span><span class="sxs-lookup"><span data-stu-id="c35a0-285">Project Server 2013 has two scheduling engines.</span></span> <span data-ttu-id="c35a0-286">Project Professional 2013 中的计划引擎相同较新的计划引擎。</span><span class="sxs-lookup"><span data-stu-id="c35a0-286">The newer scheduling engine is the same as the scheduling engine in Project Professional 2013.</span></span> <span data-ttu-id="c35a0-287">计划更改，然后发布更改，在 Project Web App 或项目网站，使用计划 web 部件 （项目详细信息页） 或使用 CSOM、 日期、 成本、 持续时间的计算时剩余工时、 比较基准，以及相关的其他更改要安排是相同的如同您进行更改，并使用 Project Professional 2013 中发布项目。</span><span class="sxs-lookup"><span data-stu-id="c35a0-287">When you make scheduling changes and publish the changes by using the Scheduling web part (Project Details page) in Project Web App or a project site, or by using the CSOM, the calculation of dates, costs, duration, remaining work, baselines, and other changes related to scheduling are the same as if you made the changes and published the project by using Project Professional 2013.</span></span> <span data-ttu-id="c35a0-288">但是， [QueueUpdateProject2](https://msdn.microsoft.com/library/WebSvcProject.Project.QueueUpdateProject2.aspx)方法，除 PSI 方法使用已从 Project Server 2010 迁移的旧的计划引擎。</span><span class="sxs-lookup"><span data-stu-id="c35a0-288">However, except for the [QueueUpdateProject2](https://msdn.microsoft.com/library/WebSvcProject.Project.QueueUpdateProject2.aspx) method, PSI methods use the older scheduling engine that was migrated from Project Server 2010.</span></span> <span data-ttu-id="c35a0-289">原因是以确保像以前那样，旧应用程序行为 Project Server 2013 中相同。</span><span class="sxs-lookup"><span data-stu-id="c35a0-289">The reason is to ensure that legacy applications behave the same in Project Server 2013 as they previously did.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="c35a0-290">若要在 Project Server 2013 中使用更新的计划引擎，应用程序可以使用 CSOM。</span><span class="sxs-lookup"><span data-stu-id="c35a0-290">To use the updated scheduling engine in Project Server 2013, applications can use the CSOM.</span></span> 
  
<span data-ttu-id="c35a0-291">较旧的计划引擎和较新的计划引擎都具有以下限制：</span><span class="sxs-lookup"><span data-stu-id="c35a0-291">Both the older and the newer scheduling engines have the following limitations:</span></span>
  
- <span data-ttu-id="c35a0-292">**单个项目仅计划**通过任务状态更新与 PSI 或 CSOM，或与 Project Web App 进行更改时，计划影响仅在当前项目。</span><span class="sxs-lookup"><span data-stu-id="c35a0-292">**Single project scheduling only** Scheduling affects only the current project, when changes are made through task status updates with the PSI or the CSOM, or with Project Web App.</span></span> <span data-ttu-id="c35a0-293">如果当前项目链接到其他项目、 子项目或主项目，不会更改链接的项目。</span><span class="sxs-lookup"><span data-stu-id="c35a0-293">If the current project has links to other projects, subprojects, or master projects, the linked projects are not changed.</span></span> 
    
- <span data-ttu-id="c35a0-294">**摘要任务**摘要任务是通常只读的 Project Server 上。</span><span class="sxs-lookup"><span data-stu-id="c35a0-294">**Summary tasks** Summary tasks are generally read-only on Project Server.</span></span> <span data-ttu-id="c35a0-295">例如，无法创建分配摘要任务，并且不能修改百分比完成。</span><span class="sxs-lookup"><span data-stu-id="c35a0-295">For example, assignments for summary tasks cannot be created, and percent completion cannot be modified.</span></span> <span data-ttu-id="c35a0-296">然而，Project Server 支持编辑的日期和持续时间手动计划的摘要任务。</span><span class="sxs-lookup"><span data-stu-id="c35a0-296">However, Project Server does support editing the dates and duration of manually scheduled summary tasks.</span></span> 
    
    <span data-ttu-id="c35a0-p148">Project Server 上的实际数据不会自动添加到摘要任务工作分配，因为这可能绕过 Project Server 中的审批流程。在 Project Professional 中，当您向子任务添加实际数据时，也会为摘要任务的工作分配添加这些实际值。用户可能会混淆行为上的差异。</span><span class="sxs-lookup"><span data-stu-id="c35a0-p148">Actuals on Project Server are not added automatically to a summary task assignment, because that would bypass the approval process in Project Server. In Project Professional, when you add actuals to a subtask, the actuals are also added for an assignment on the summary task. The difference in behavior can be confusing for a user.</span></span>
    
    <span data-ttu-id="c35a0-300">如果子任务工期缩短或完成日期发生更改，则 Project Server 会删除摘要任务工作分配的实际值。</span><span class="sxs-lookup"><span data-stu-id="c35a0-300">Project Server deletes actuals on a summary task assignment if the subtask duration shortens or the finish date is changed.</span></span>
    
    > [!CAUTION]
    > <span data-ttu-id="c35a0-301">虽然 Project Professional 可执行此操作，但建议您不要对摘要任务进行工作分配。</span><span class="sxs-lookup"><span data-stu-id="c35a0-301">Although Project Professional can do it, we recommend that you do not make assignments on summary tasks.</span></span> 
  
<span data-ttu-id="c35a0-302">以下是使用旧的 Project Server 计划引擎进行 PSI 编程的问题和限制：</span><span class="sxs-lookup"><span data-stu-id="c35a0-302">Following are issues and limitations of PSI programming with the older Project Server scheduling engine:</span></span>
  
- <span data-ttu-id="c35a0-303">**更改活动任务的状态**较旧的 Project Server 计划引擎可以显示不一致的开始或结束的时间使用[QueueUpdateProject](https://msdn.microsoft.com/library/WebSvcProject.Project.QueueUpdateProject.aspx)方法时更改活动状态的任务中，如果_的**ProjectDataSet**对象中有多个更改数据集_参数。</span><span class="sxs-lookup"><span data-stu-id="c35a0-303">**Changing the active status of a task** The older Project Server scheduling engine can show inconsistent start or finish times when you use the [QueueUpdateProject](https://msdn.microsoft.com/library/WebSvcProject.Project.QueueUpdateProject.aspx) method to change the active status of a task, if there are multiple changes in the **ProjectDataSet** object for the  _dataset_ parameter.</span></span> <span data-ttu-id="c35a0-304">如果**TASK_IS_ACTIVE**属性为**QueueUpdateProject**的_数据集_参数中的唯一更改，您可以更新项目。</span><span class="sxs-lookup"><span data-stu-id="c35a0-304">If the **TASK_IS_ACTIVE** property is the only change in the  _dataset_ parameter of **QueueUpdateProject**, you can update the project.</span></span>
    
    <span data-ttu-id="c35a0-305">有关非活动任务和旧的计划引擎的详细信息，请参阅博客文章[Project 2010 中的介绍非活动任务](http://blogs.msdn.com/b/project/archive/2010/06/10/introducing-inactive-tasks-in-project-2010.aspx)和[Project Server 2010： 计划在网站上，PSI 和 Project Professional](http://blogs.msdn.com/b/brismith/archive/2010/09/10/project-server-2010-scheduling-on-the-web-the-psi-and-project-professional.aspx?wa=wsignin1.0)。</span><span class="sxs-lookup"><span data-stu-id="c35a0-305">For more information about inactive tasks and the older scheduling engine, see the blog articles [Introducing inactive tasks in Project 2010](http://blogs.msdn.com/b/project/archive/2010/06/10/introducing-inactive-tasks-in-project-2010.aspx) and [Project Server 2010: Scheduling on the web, the PSI and Project Professional](http://blogs.msdn.com/b/brismith/archive/2010/09/10/project-server-2010-scheduling-on-the-web-the-psi-and-project-professional.aspx?wa=wsignin1.0).</span></span> <span data-ttu-id="c35a0-306">Project Professional 2010 和 Project Server 2010 中的 Project Web App 中安排的比较，请参阅[基于 Web 的计划管理比较](http://www.microsoft.com/project/en/us/project-server-2010-editions.aspx)。</span><span class="sxs-lookup"><span data-stu-id="c35a0-306">For a comparison of scheduling in Project Professional 2010 and Project Web App in Project Server 2010, see [Web-based schedule management comparison](http://www.microsoft.com/project/en/us/project-server-2010-editions.aspx).</span></span>
    
- <span data-ttu-id="c35a0-307">**盈余不计算**较旧的计划引擎没有计算挣值域： ACWP，BAC、 BCWP、 BCWS、 CPI、 CV、 CV %、 EAC、 SPI、 SV、 SV %、 TCPI、 VAC、 工期差异，开始时间差异，完成时间差异、 成本差异和工时差异。</span><span class="sxs-lookup"><span data-stu-id="c35a0-307">**Earned value not calculated** The older scheduling engine does not calculate the earned value fields: ACWP, BAC, BCWP, BCWS, CPI, CV, CV%, EAC, SPI, SV, SV%, TCPI, VAC, Duration Variance, Start Variance, Finish Variance, Cost Variance, and Work Variance.</span></span> <span data-ttu-id="c35a0-308">如果项目具有这些字段的值，并且该项目已更新使用**QueueUpdateProject**方法，则不要更改的字段值。</span><span class="sxs-lookup"><span data-stu-id="c35a0-308">If a project has values for these fields and the project is updated by using the **QueueUpdateProject** method, the field values do not change.</span></span> <span data-ttu-id="c35a0-309">若要避免此问题，请使用**QueueUpdateProject2**方法。</span><span class="sxs-lookup"><span data-stu-id="c35a0-309">To avoid the problem, use the **QueueUpdateProject2** method.</span></span> 
    
<span data-ttu-id="c35a0-310">可通过以下方式处理 PSI 计划限制：</span><span class="sxs-lookup"><span data-stu-id="c35a0-310">You can handle the PSI scheduling limitations in the following ways:</span></span>
  
- <span data-ttu-id="c35a0-311">如果 CSOM 具有应用程序所需的方法，则使用 CSOM 而非 PSI。</span><span class="sxs-lookup"><span data-stu-id="c35a0-311">If the CSOM has the methods the application requires, use the CSOM instead of the PSI.</span></span>
    
- <span data-ttu-id="c35a0-312">在 Project Professional 中打开项目，并将这些项目保存回 Project Server。</span><span class="sxs-lookup"><span data-stu-id="c35a0-312">Open projects in Project Professional and save them back to Project Server.</span></span>
    
- <span data-ttu-id="c35a0-313">在报表中，不要包括 PSI 未更新的域。</span><span class="sxs-lookup"><span data-stu-id="c35a0-313">In reports, do not include fields that the PSI does not update.</span></span>
    
- <span data-ttu-id="c35a0-314">在报表中添加有关数据可能过时的说明。</span><span class="sxs-lookup"><span data-stu-id="c35a0-314">Add a note in reports about data that may be stale.</span></span>
    
<span data-ttu-id="c35a0-p152">报告表和多维数据集中存在可帮助您检测某些项目数据未更新的情况的标记。MSP_EpmProject 表和 MSP_EpmProject_UserView 中的报表数据包括以下域：</span><span class="sxs-lookup"><span data-stu-id="c35a0-p152">There are flags in the reporting tables and the cubes that help you detect when some project data is not updated. The reporting data in the MSP_EpmProject table and in MSP_EpmProject_UserView includes the following fields:</span></span> 
  
-  <span data-ttu-id="c35a0-317">_ProjectWbsIsStale_&ndash;指示工作分解结构 （任务大纲层次结构） 是否过期。</span><span class="sxs-lookup"><span data-stu-id="c35a0-317">_ProjectWbsIsStale_ &ndash; Indicates whether the work breakdown structure (task outline hierarchy) is stale.</span></span> 
    
-  <span data-ttu-id="c35a0-318">_ProjectEarnedValueIsStale_&ndash;指示挣值域已过时。</span><span class="sxs-lookup"><span data-stu-id="c35a0-318">_ProjectEarnedValueIsStale_ &ndash; Indicates the earned value fields are stale.</span></span> 
    
-  <span data-ttu-id="c35a0-319">_ProjectRollupsAreStale_&ndash;指示子项目更新中的草稿数据库，但不是更新主项目。</span><span class="sxs-lookup"><span data-stu-id="c35a0-319">_ProjectRollupsAreStale_ &ndash; Indicates that a subproject is updated in the draft database, but the master project is not updated.</span></span> <span data-ttu-id="c35a0-320">子项目的汇总的值已过期。</span><span class="sxs-lookup"><span data-stu-id="c35a0-320">The rolled-up values from the subproject are stale.</span></span> 
    
-  <span data-ttu-id="c35a0-321">_ProjectHierarchyNotSynchronized_&ndash;与其子不同步主项目。</span><span class="sxs-lookup"><span data-stu-id="c35a0-321">_ProjectHierarchyNotSynchronized_ &ndash; The master project is not synchronized with its children.</span></span> <span data-ttu-id="c35a0-322">不是主项目发布的一部分显式，发布子项目时，将发生这种情况。</span><span class="sxs-lookup"><span data-stu-id="c35a0-322">This happens when the child projects are published explicitly, not as part of the master project publishing.</span></span> 
    
-  <span data-ttu-id="c35a0-323">_ProjectCalculationsAreStale_&ndash; Project Professional 保存项目没有计算计划 （即，计算模式设置为**手动**在**项目选项**对话框的**日程**选项卡）。</span><span class="sxs-lookup"><span data-stu-id="c35a0-323">_ProjectCalculationsAreStale_ &ndash; Project Professional saved a project without calculating the schedule (that is, the calculation mode is set to **Manual** on the **Schedule** tab in the **Project Options** dialog box).</span></span> 
    
-  <span data-ttu-id="c35a0-324">_ProjectGhostTaskAreStale_&ndash;类似_ProjectHierarchyNotSynchronized_，但警告跨项目链接数据。</span><span class="sxs-lookup"><span data-stu-id="c35a0-324">_ProjectGhostTaskAreStale_ &ndash; Similar to  _ProjectHierarchyNotSynchronized_, but warns on cross-project link data.</span></span> <span data-ttu-id="c35a0-325">则可能没有主项目存在，但一侧的链接的项目数据的另一端更高。</span><span class="sxs-lookup"><span data-stu-id="c35a0-325">It is possible that no master project exists, but the project data on one side of the link is newer than on the other side.</span></span>
    
## <a name="about-accessing-the-project-server-database"></a><span data-ttu-id="c35a0-326">关于访问 Project Server 数据库</span><span class="sxs-lookup"><span data-stu-id="c35a0-326">About accessing the Project Server database</span></span>
<span data-ttu-id="c35a0-327"><a name="pj15_Programmability_Databases"> </a></span><span class="sxs-lookup"><span data-stu-id="c35a0-327"></span></span>

<span data-ttu-id="c35a0-328">如果您在 Microsoft SQL Server 访问 Project Server 数据库中具有权限，您可以阅读报告表和视图。</span><span class="sxs-lookup"><span data-stu-id="c35a0-328">If you have permissions in Microsoft SQL Server to access the Project Server database, you can read the reporting tables and views.</span></span> <span data-ttu-id="c35a0-329">如果您拥有所需的 Project Server 权限，您还可以阅读数据报告表中使用 OData 查询。</span><span class="sxs-lookup"><span data-stu-id="c35a0-329">If you have the necessary Project Server permissions, you can also read data from the reporting tables by using OData queries.</span></span> <span data-ttu-id="c35a0-330">开发人员是直接访问草稿、 已发布，强烈建议您不要或存档通过 Project Server 数据库中的 SQL Server 查询表。</span><span class="sxs-lookup"><span data-stu-id="c35a0-330">Developers are strongly discouraged from directly accessing the draft, published, or archive tables through SQL Server queries in the Project Server database.</span></span> <span data-ttu-id="c35a0-331">直接更改任意 Project Server 数据库中的表中可以损坏参照完整性，而且干扰通过 Project Server 队列服务的数据库访问。</span><span class="sxs-lookup"><span data-stu-id="c35a0-331">Making direct changes in any of the tables in the Project Server database can damage referential integrity and interfere with database access through the Project Server Queuing Service.</span></span>
  
> [!IMPORTANT]
> <span data-ttu-id="c35a0-p157">任何项目都不会主动阻止您使用直接编程数据库访问来更新数据。您应知道，Project Professional 缓存、已发布的表和报告表都依赖于可由直接数据编辑中断的缓存同步协议。在此警告您，如果您由于使用直接访问更改数据而破坏了 Project Server 数据库或损坏了 Project Professional 客户端缓存，产品支持将无法提供帮助！</span><span class="sxs-lookup"><span data-stu-id="c35a0-p157">There is nothing to actively prevent you from using direct programmatic database access to update data. You should be aware that the Project Professional cache, the published tables, and the reporting tables all rely on a cache synchronization protocol that can be disrupted by direct data editing. If you damage your Project Server database or corrupt Project Professional client-side caches by using direct access to change data, be warned that product support won't be able to help!</span></span> 
  
<span data-ttu-id="c35a0-335">应用程序直接访问草稿、 发布，或存档表视图，而且还依赖于在 service pack 或更高版本的 Project Server 2013 中可以更改数据库架构。</span><span class="sxs-lookup"><span data-stu-id="c35a0-335">Applications that directly access the draft, published, or archive tables and views are also dependent on the database schemas, which can change in service packs or later versions of Project Server 2013.</span></span> <span data-ttu-id="c35a0-336">内置的 Project Server 安全性、 常见业务逻辑、 跟踪、 审核、 错误检查、 报告、 工作流和其他功能，还会丢失直接访问数据库的应用程序。</span><span class="sxs-lookup"><span data-stu-id="c35a0-336">Applications that directly access the databases also lose the built-in Project Server security, common business logic, tracking, audits, error checking, reporting, workflow, and other features.</span></span> <span data-ttu-id="c35a0-337">您可能需要重写这样的应用程序后更新 Project Server 2013。</span><span class="sxs-lookup"><span data-stu-id="c35a0-337">You would likely have to rewrite such an application after Project Server 2013 updates.</span></span> 
  
<span data-ttu-id="c35a0-338">对于所有这些原因，Project Professional 和 Project Web App 不直接调用草稿、 已发布，或存档表;也不应与 Project Server 集成的任何其他应用程序。</span><span class="sxs-lookup"><span data-stu-id="c35a0-338">For all of these reasons, Project Professional and Project Web App do not make direct calls to the draft, published, or archive tables; neither should any other application that integrates with Project Server.</span></span>
  
<span data-ttu-id="c35a0-339">草稿、 已发布、 架构和存档表且未进行归档。</span><span class="sxs-lookup"><span data-stu-id="c35a0-339">The schemas for the draft, published, and archive tables are not documented.</span></span> <span data-ttu-id="c35a0-340">您可以使用报告表来帮助生成报告，并记录的报告的表和视图的架构 Project 2013 SDK 下载中。</span><span class="sxs-lookup"><span data-stu-id="c35a0-340">You can use the reporting tables to help generate reports, and the schema for the reporting tables and views is documented in the Project 2013 SDK download.</span></span> <span data-ttu-id="c35a0-341">使用的报表数据的 OData 架构，请参阅[ProjectData-Project OData 服务引用](https://msdn.microsoft.com/en-us/library/office/jj163015.aspx)。</span><span class="sxs-lookup"><span data-stu-id="c35a0-341">For the OData schema of the reporting data, see [ProjectData - Project OData service reference](https://msdn.microsoft.com/en-us/library/office/jj163015.aspx).</span></span>
  
## <a name="see-also"></a><span data-ttu-id="c35a0-342">另请参阅</span><span class="sxs-lookup"><span data-stu-id="c35a0-342">See also</span></span>

- [<span data-ttu-id="c35a0-343">Project 2013 中面向开发人员的更新</span><span class="sxs-lookup"><span data-stu-id="c35a0-343">Updates for developers in Project 2013</span></span>](updates-for-developers-in-project-2013.md)    
- [<span data-ttu-id="c35a0-344">Project Server 2013 体系结构</span><span class="sxs-lookup"><span data-stu-id="c35a0-344">Project Server 2013 architecture</span></span>](project-server-2013-architecture.md)    
- [<span data-ttu-id="c35a0-345">PSI 支持和不执行</span><span class="sxs-lookup"><span data-stu-id="c35a0-345">What the PSI does and does not do</span></span>](what-the-psi-does-and-does-not-do.md)   
- [<span data-ttu-id="c35a0-346">CSOM 支持和不执行</span><span class="sxs-lookup"><span data-stu-id="c35a0-346">What the CSOM does and does not do</span></span>](what-the-csom-does-and-does-not-do.md)    
- [<span data-ttu-id="c35a0-347">客户端对象模型 (CSOM) for Project 2013</span><span class="sxs-lookup"><span data-stu-id="c35a0-347">Client-side object model (CSOM) for Project 2013</span></span>](client-side-object-model-csom-for-project-2013.md)    
- [<span data-ttu-id="c35a0-348">开发 Project Server 工作流入门</span><span class="sxs-lookup"><span data-stu-id="c35a0-348">Getting started developing Project Server workflows</span></span>](getting-started-developing-project-server-workflows.md)    
- [<span data-ttu-id="c35a0-349">Project 2013 编程参考文档</span><span class="sxs-lookup"><span data-stu-id="c35a0-349">Project 2013 programming references</span></span>](project-2013-programming-references.md)    
- [<span data-ttu-id="c35a0-350">项目 PSI 参考概述</span><span class="sxs-lookup"><span data-stu-id="c35a0-350">Project PSI reference overview</span></span>](project-psi-reference-overview.md)    
- [<span data-ttu-id="c35a0-351">创建自定义操作的 SharePoint 相关应用程序部署</span><span class="sxs-lookup"><span data-stu-id="c35a0-351">Create custom actions to deploy with apps for SharePoint</span></span>](http://msdn.microsoft.com/en-us/library/office/apps/jj163954%28v=office.15%29.aspx)    
- [<span data-ttu-id="c35a0-352">Project 2010 中引入非活动任务</span><span class="sxs-lookup"><span data-stu-id="c35a0-352">Introducing Inactive Tasks in Project 2010</span></span>](http://blogs.msdn.com/b/project/archive/2010/06/10/introducing-inactive-tasks-in-project-2010.aspx)    
- [<span data-ttu-id="c35a0-353">Project Server 2010: Web 2010:WEB、PSI 和 Project Professional 上的计划</span><span class="sxs-lookup"><span data-stu-id="c35a0-353">Project Server 2010: Scheduling on the Web, the PSI and Project Professional</span></span>](http://blogs.msdn.com/b/brismith/archive/2010/09/10/project-server-2010-scheduling-on-the-web-the-psi-and-project-professional.aspx?wa=wsignin1.0)
- [<span data-ttu-id="c35a0-354">基于 web 的计划管理比较</span><span class="sxs-lookup"><span data-stu-id="c35a0-354">Web-Based Schedule Management Comparison</span></span>](http://www.microsoft.com/project/en/us/project-server-2010-editions.aspx)
    

