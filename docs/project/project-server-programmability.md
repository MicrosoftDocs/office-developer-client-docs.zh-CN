---
title: Project Server 可编程性
manager: lindalu
ms.date: 12/03/2019
ms.audience: Developer
f1_keywords:
- events
- PDS
- PDS compatibility
- Project Server databases
- Project Server events
- Project Server Interface
- Project Server workflow
- Project workflow
- PSI
- PSI limitations
- PSI uses
- SharePoint Services
- WF
- workflow
- Workflow Foundation
- WSS
keywords:
- Project 2013, 体系结构和可编程性, PSI, 项目, 版本, 可编程性, Project Server, PSI, 限制, Project Server 接口, 不支持的功能, Project Server 接口, PDS 兼容性, Project Server 接口, 通用, Project Server, Project 版本, 版本, 项目, Project Server, 数据库, Project 2013, 平台, Project Server 接口, 使用方案, Project Server, 事件, Project Server, Project 数据服务, 与 PSI 的兼容性, Project Server 接口
ms.assetid: a93d2153-5132-4289-af51-69350471e248
description: 了解 Project Server 2013 中的主要可编程性功能。 本文包括有关移植为早期版本的 Project Server 构建的应用程序的信息。
localization_priority: Priority
ms.openlocfilehash: e6991712b87291e90c6b4f277db84686aab384e7
ms.sourcegitcommit: 31b0a7373ff74fe1d6383c30bc67d7675b73d283
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 02/05/2020
ms.locfileid: "41773727"
---
# <a name="project-server-programmability"></a><span data-ttu-id="44202-105">Project Server 可编程性</span><span class="sxs-lookup"><span data-stu-id="44202-105">Project Server programmability</span></span>

<span data-ttu-id="44202-106">了解 Project Server 2013 中的主要可编程性功能。</span><span class="sxs-lookup"><span data-stu-id="44202-106">Learn about the major programmability features in Project Server 2013.</span></span> <span data-ttu-id="44202-107">本文包括有关移植为早期版本的 Project Server 构建的应用程序的信息。</span><span class="sxs-lookup"><span data-stu-id="44202-107">This article includes information about porting applications that were built for previous versions of Project Server.</span></span>

<span data-ttu-id="44202-108">Project Server 2013 旨在支持为 Project Server 2010 开发的大部分应用程序以及为多个平台开发的新解决方案，其中应用程序可以访问在线和本地 Project Server 安装。</span><span class="sxs-lookup"><span data-stu-id="44202-108">Project Server 2013 is designed to support most applications that were developed for Project Server 2010 and new solutions for multiple platforms, where apps can access both online and on-premises Project Server installations.</span></span> <span data-ttu-id="44202-109">必须重新设计为 Project Server 2003 或更早版本开发的应用程序和扩展，这样才能使用客户端对象模型 (CSOM) 或 Project Server 接口 (PSI)。</span><span class="sxs-lookup"><span data-stu-id="44202-109">Applications and extensions that were developed for Project Server 2003 or earlier must be redesigned to use the client-side object model (CSOM) or the Project Server Interface (PSI).</span></span> <span data-ttu-id="44202-110">为 Office Project Server 2007 或 Project Server 2010 开发的应用程序可能需要进行一些更改并重新编译才能使用 PSI；要使用 CSOM，需要重新设计这些应用程序。</span><span class="sxs-lookup"><span data-stu-id="44202-110">Applications that were developed for Office Project Server 2007 or Project Server 2010 may require some changes and recompiling to use the PSI; to use the CSOM, those applications require a redesign.</span></span>
  
<span data-ttu-id="44202-111">Project Server 平台通过构建 SharePoint Server 2013、.NET Framework 4 和具有 CSOM 的 OData 协议，提高了程序员的生产力水平。</span><span class="sxs-lookup"><span data-stu-id="44202-111">The Project Server platform enables high levels of programmer productivity by building on SharePoint Server 2013, .NET Framework 4, and the OData protocol with the CSOM.</span></span> <span data-ttu-id="44202-112">开发人员可以使用应用程序、应用程序部件和 Web 部件来扩展 Project Web App，使用 SharePoint Designer 2013 定义工作流，并通过使用 Project Server 事件的远程事件接收器来实施业务规则。</span><span class="sxs-lookup"><span data-stu-id="44202-112">Developers can extend Project Web App with apps, app parts, and Web Parts, define workflows by using SharePoint Designer 2013, and enforce business rules by using remote event receivers for Project Server events.</span></span>
  
## <a name="project-server-and-sharepoint-server"></a><span data-ttu-id="44202-113">Project Server 和 SharePoint Server</span><span class="sxs-lookup"><span data-stu-id="44202-113">Project Server and SharePoint Server</span></span>
<span data-ttu-id="44202-114"><a name="pj15_Programmability_MOSS"> </a></span><span class="sxs-lookup"><span data-stu-id="44202-114"><a name="pj15_Programmability_MOSS"> </a></span></span>

<span data-ttu-id="44202-115">Project Web App 构建于 SharePoint Server 2013 之上，可使用母版页和 Web 部件更轻松地构建自定义应用程序和 Project Web App 解决方案。</span><span class="sxs-lookup"><span data-stu-id="44202-115">Project Web App is built upon SharePoint Server 2013, and uses master pages and Web Parts to make it easier to build custom apps and Project Web App solutions.</span></span> <span data-ttu-id="44202-116">Project Server 2013 与 SharePoint Server 2013 深度集成，可用作项目协作、报告、网站管理、安全性和工作流管理的平台。</span><span class="sxs-lookup"><span data-stu-id="44202-116">Project Server 2013 integrates deeply with SharePoint Server 2013 as the platform for project collaboration, reporting, site administration, security, and workflow management.</span></span>
  
<span data-ttu-id="44202-117">项目网站包括面向团队成员提供的更多信息和协作选项，你可以在其中添加包含项目摘要的默认应用程序、具有日程表的专用 SharePoint 任务列表、跟踪的问题、风险、项目、可交付结果和团队日历，以及文档库和团队讨论。</span><span class="sxs-lookup"><span data-stu-id="44202-117">The project sites include more information and collaboration options for team members, where you can add default apps that include a project summary, specialized SharePoint lists for tasks with a timeline, tracking issues, risks, project deliverables, and the team calendar, along with the document library and team discussions.</span></span> <span data-ttu-id="44202-118">Project Server 2013 的自定义应用程序为团队协作提供了扩展和灵活性。</span><span class="sxs-lookup"><span data-stu-id="44202-118">Custom apps for Project Server 2013 provide extensions and flexibility for team collaboration.</span></span> <span data-ttu-id="44202-119">通过使用相同的机制在编辑页面时添加和编辑 Web 部件，你还可以添加应用程序部件以自定义应用程序。</span><span class="sxs-lookup"><span data-stu-id="44202-119">You can also add app parts to customize an app, by using the same mechanism to add and edit Web Parts when you edit a page.</span></span> <span data-ttu-id="44202-120">你可以在安装了 Project Server 的 SharePoint 场中的任何位置找到项目网站。</span><span class="sxs-lookup"><span data-stu-id="44202-120">You can locate project sites anywhere within the SharePoint farm where Project Server is installed.</span></span> <span data-ttu-id="44202-121">若要使用 SharePoint Server 2013 的其他核心服务（如 Excel Services 和企业级搜索），管理员可以启用和配置这些服务。</span><span class="sxs-lookup"><span data-stu-id="44202-121">To use other core services of SharePoint Server 2013, such as Excel Services and Enterprise Search, an administrator can enable and configure the services.</span></span> 
  
<span data-ttu-id="44202-122">安装 Project Server 2013 时，可以在 SharePoint Web 服务网站中设置 Project Service Application。</span><span class="sxs-lookup"><span data-stu-id="44202-122">When you install Project Server 2013, you provision the Project Service Application in the SharePoint Web Services site.</span></span> <span data-ttu-id="44202-123">Project Service Application 包含本地 Windows Communication Foundation (WCF) 和 PSI 的 ASMX Web 服务。</span><span class="sxs-lookup"><span data-stu-id="44202-123">The Project Service Application includes the local Windows Communication Foundation (WCF) services and ASMX web services for the PSI.</span></span> <span data-ttu-id="44202-124">服务应用程序的其他示例包括 SharePoint 搜索和 SharePoint 文档管理。</span><span class="sxs-lookup"><span data-stu-id="44202-124">Other examples of service applications include SharePoint Search and SharePoint Document Management.</span></span> <span data-ttu-id="44202-125">有关详细信息，请参阅 SharePoint Server 2013 开发人员文档。</span><span class="sxs-lookup"><span data-stu-id="44202-125">For more information, see the SharePoint Server 2013 developer documentation.</span></span>
  
<span data-ttu-id="44202-126">Project Service Application 是一个逻辑服务提供程序，可以管理 Project Web App 的多个实例。</span><span class="sxs-lookup"><span data-stu-id="44202-126">The Project Service Application is a logical service provider that can manage multiple instances of Project Web App.</span></span> <span data-ttu-id="44202-127">Project Server 设置可在 SharePoint Web 应用程序中创建特定的 Project Web App 网站。</span><span class="sxs-lookup"><span data-stu-id="44202-127">Project Server provisioning creates a specific Project Web App site within a SharePoint web application.</span></span> <span data-ttu-id="44202-128">Project Web App 主页包含指向项目中心页面、资源中心页面、用于报告的商业智能中心页面以及包含其他标准应用程序列表的页面的链接。</span><span class="sxs-lookup"><span data-stu-id="44202-128">The Home page of Project Web App contains links to the Project Center page, Resource Center page, and the Business Intelligence Center page for reporting, plus a page that contains a list of additional standard apps.</span></span> <span data-ttu-id="44202-129">图 1 显示 Project Web App 主页上“**设置**”下拉列表中的“**编辑页面**”命令，它允许你添加或编辑 Web 部件。</span><span class="sxs-lookup"><span data-stu-id="44202-129">Figure 1 shows the **Edit Page** command in the **Setttings** drop-down list on the Home page of Project Web App, which allows you to add or edit Web Parts.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="44202-130">Project Web App 中的某些管理页面（如“PWA 设置”页面）不可编辑，并且不会显示“**编辑页面**”命令。</span><span class="sxs-lookup"><span data-stu-id="44202-130">Some administrative pages in Project Web App—such as the PWA Settings page—are not editable, and do not show the **Edit Page** command.</span></span> <span data-ttu-id="44202-131">Project Web App 不允许你使用 SharePoint Designer 2013 编辑页面。</span><span class="sxs-lookup"><span data-stu-id="44202-131">Project Web App does not allow you to edit pages by using SharePoint Designer 2013.</span></span> <span data-ttu-id="44202-132">你可以使用 SharePoint Designer 2013 编辑项目网站页面。</span><span class="sxs-lookup"><span data-stu-id="44202-132">You can edit project site pages with SharePoint Designer 2013.</span></span> 
  
<span data-ttu-id="44202-133">**图 1. 使用 Project Web App 中的“编辑页面”菜单**</span><span class="sxs-lookup"><span data-stu-id="44202-133">**Figure 1. Using the Edit Page menu in Project Web App**</span></span>

<span data-ttu-id="44202-134">![在 Project Web Access 中编辑主页](media/pj15_Programmability_PWAHome.gif "在 Project Web Access 中编辑主页")</span><span class="sxs-lookup"><span data-stu-id="44202-134">![Editing the Home page in Project Web Access](media/pj15_Programmability_PWAHome.gif "Editing the Home page in Project Web Access")</span></span>
  
<span data-ttu-id="44202-135">若要访问 Project Web App 中的“网站设置”页面，请在页面右上角选择“**设置**”图标。</span><span class="sxs-lookup"><span data-stu-id="44202-135">To access the Site Settings page in Project Web App, choose the **Settings** icon in the top-right corner of the page.</span></span> <span data-ttu-id="44202-136">“网站设置”页面 (  `https://ServerName/ProjectServerName/_layouts/15/settings.aspx`) 允许你更改外观和网站主题、添加自定义 Web 部件以及修改或创建项目网站的母版页。</span><span class="sxs-lookup"><span data-stu-id="44202-136">The Site Settings page (  `https://ServerName/ProjectServerName/_layouts/15/settings.aspx`) enables changing the look and feel and the site theme, adding custom Web Parts, and modifying or creating master pages for project sites.</span></span>
  
<span data-ttu-id="44202-137">不支持在 ASPX 页面中自定义代码，也不支持使用 SharePoint Designer 2013 自定义 Project Web App 母版页。</span><span class="sxs-lookup"><span data-stu-id="44202-137">Customization of the code in ASPX pages, or customization of Project Web App master pages with SharePoint Designer 2013, is not supported.</span></span> <span data-ttu-id="44202-138">在 Project Web App 页面中自定义代码可能会导致 Project Server 更新和服务包出现问题。</span><span class="sxs-lookup"><span data-stu-id="44202-138">Customization of the code in Project Web App pages can cause problems with Project Server updates and service packs.</span></span> 
  
### <a name="customization-of-project-web-app-with-sharepoint-packages"></a><span data-ttu-id="44202-139">使用 SharePoint 包自定义 Project Web App</span><span class="sxs-lookup"><span data-stu-id="44202-139">Customization of Project Web App with SharePoint packages</span></span>
<span data-ttu-id="44202-140"><a name="pj15_Programmability_CustomizationOfPWA"> </a></span><span class="sxs-lookup"><span data-stu-id="44202-140"><a name="pj15_Programmability_CustomizationOfPWA"> </a></span></span>

<span data-ttu-id="44202-141">由于 Project Web App 是 SharePoint 应用程序，而项目网站是 SharePoint 网站，因此你可以使用 SharePoint 包（.wsp 文件）或 SharePoint 应用程序（.spapp 文件）添加自定义应用程序、Web 部件、事件处理程序、自定义字段和其他功能。</span><span class="sxs-lookup"><span data-stu-id="44202-141">Because Project Web App is a SharePoint application, and project sites are SharePoint sites, you can add custom apps, Web Parts, event handlers, custom fields, and other features by using SharePoint packages (.wsp files) or SharePoint apps (.spapp files).</span></span> <span data-ttu-id="44202-142">SharePoint 包或应用程序包可能包含多个 Project Server 实体，其中实体定义已在程序包的 elements.xml 文件中指定。</span><span class="sxs-lookup"><span data-stu-id="44202-142">A SharePoint package or an app package can include multiple Project Server entities, where entity definitions are specified in an elements.xml file within the package.</span></span>
  
<span data-ttu-id="44202-143">对于 Project Online，你可以向 Project Web App 功能区添加按钮，但无法删除或重命名现有产品按钮，也无法创建新的功能区选项卡。</span><span class="sxs-lookup"><span data-stu-id="44202-143">For Project Online, you can add buttons to the Project Web App ribbon, but you can't remove or rename existing product buttons, and you can't create new ribbon tabs.</span></span> <span data-ttu-id="44202-144">有关详细信息，请参阅[创建自定义操作以部署 SharePoint 应用程序](https://docs.microsoft.com/sharepoint/dev/sp-add-ins/create-custom-actions-to-deploy-with-sharepoint-add-ins)。</span><span class="sxs-lookup"><span data-stu-id="44202-144">For more information, see [Create custom actions to deploy with apps for SharePoint](https://docs.microsoft.com/sharepoint/dev/sp-add-ins/create-custom-actions-to-deploy-with-sharepoint-add-ins).</span></span>
  
> [!CAUTION]
> <span data-ttu-id="44202-145">在安装 SharePoint 包或应用程序包时，Project Server 实体的类型必须以 PSEntityProvision.xsd 架构所指定的顺序显示，否则包的架构验证将失败且安装不会完成。</span><span class="sxs-lookup"><span data-stu-id="44202-145">When you install a SharePoint package or an app package, the types of Project Server entities must appear in the order that the PSEntityProvision.xsd schema specifies or schema validation of the package fails and installation is not completed.</span></span> 
  
<span data-ttu-id="44202-146">PSEntityProvision.xsd 架构文件位于 Project 2013 SDK 下载的 `Documentation\Schemas\AppProvisioning` 子目录中。</span><span class="sxs-lookup"><span data-stu-id="44202-146">The PSEntityProvision.xsd schema file is available in the Project 2013 SDK download, in the  `Documentation\Schemas\AppProvisioning` subdirectory.</span></span> <span data-ttu-id="44202-147">图 2 显示 **PSEntityProvision** 架构的 Visual Studio 中的 XML 架构资源管理器视图，其中展开了 **LookupTable** 序列。</span><span class="sxs-lookup"><span data-stu-id="44202-147">Figure 2 shows the XML Schema Explorer view in Visual Studio of the **PSEntityProvision** schema, where the **LookupTable** sequence is expanded.</span></span> 
  
<span data-ttu-id="44202-148">**图 2. Project Server 实体设置架构的 Visual Studio 视图**</span><span class="sxs-lookup"><span data-stu-id="44202-148">**Figure 2. Visual Studio view of the Project Server entity provisioning schema**</span></span>

<span data-ttu-id="44202-149">![Project Server 实体架构的视图](media/pj15_Programmability_EntitySchema.gif "Project Server 实体架构的视图")</span><span class="sxs-lookup"><span data-stu-id="44202-149">![View of the Project Server entity schema](media/pj15_Programmability_EntitySchema.gif "View of the Project Server entity schema")</span></span>
  
<span data-ttu-id="44202-p115">安装 Project Server 的功能的 SharePoint 包可包含遵循 **PSEntityProvision** 架构的一个或多个 elements.xml 文件。单个 XML 文件中的 Project Server 实体必须按以下顺序显示：</span><span class="sxs-lookup"><span data-stu-id="44202-p115">SharePoint packages that install features for Project Server can contain one or more elements.xml files that follow the **PSEntityProvision** schema. The Project Server entities in a single XML file must appear in the following order:</span></span> 
  
1. <span data-ttu-id="44202-152">工作流阶段</span><span class="sxs-lookup"><span data-stu-id="44202-152">Workflow phases</span></span>
    
2. <span data-ttu-id="44202-153">查阅表格</span><span class="sxs-lookup"><span data-stu-id="44202-153">Lookup tables</span></span>
    
3. <span data-ttu-id="44202-154">自定义域</span><span class="sxs-lookup"><span data-stu-id="44202-154">Custom fields</span></span>
    
4. <span data-ttu-id="44202-155">工作流容器</span><span class="sxs-lookup"><span data-stu-id="44202-155">Workflow stages</span></span>
    
5. <span data-ttu-id="44202-156">企业项目类型</span><span class="sxs-lookup"><span data-stu-id="44202-156">Enterprise project types</span></span>
    
6. <span data-ttu-id="44202-157">事件处理程序</span><span class="sxs-lookup"><span data-stu-id="44202-157">Event handlers</span></span>
    
<span data-ttu-id="44202-p116">在创建包含 Project Server 实体的 SharePoint 包时，可以将实体定义置于多个 elements.xml 文件中。每个 XML 文件均可传递架构验证，但整个包中的实体的顺序可能不正确。例如，第一个 XML 文件中的自定义域实体会引用第二个 XML 文件中的查阅表格。在安装过程中，无法创建自定义域，因为尚未创建查阅表格。</span><span class="sxs-lookup"><span data-stu-id="44202-p116">When you create a SharePoint package that contains Project Server entities, it is possible to put the entity definitions in multiple elements.xml files. Each XML file could pass the schema validation, but the entities in the whole package might not be in the correct order. For example, a custom field entity in the first XML file could refer to a lookup table in the second XML file. During installation, the custom field cannot be created because the lookup table has not yet been created.</span></span>
  
<span data-ttu-id="44202-162">如果程序包安装失败，则已创建的对象仍将保留在 Project Web App 中，但该程序包无法完全安装。</span><span class="sxs-lookup"><span data-stu-id="44202-162">If a package installation fails, objects that have been created remain in Project Web App, but the package does not install completely.</span></span> <span data-ttu-id="44202-163">重新安装程序包可以解决问题，但这对客户来说不是一个好的体验。</span><span class="sxs-lookup"><span data-stu-id="44202-163">Reinstalling the package can work, but that is not a good experience for customers.</span></span> <span data-ttu-id="44202-164">如果实体定义跨多个 elements.xml 文件，请在整个 SharePoint 包中整理 Project Server 实体，以确保按照正确的顺序进行安装。</span><span class="sxs-lookup"><span data-stu-id="44202-164">When the entity definitions span multiple elements.xml files, organize the Project Server entities in the entire SharePoint package to ensure that installation follows the correct order.</span></span> <span data-ttu-id="44202-165">使用 Project 2013 SDK 下载中的 PSEntityProvision.xsd 架构，可以开发一种工具来检查 XML 文件中规定的实体顺序。</span><span class="sxs-lookup"><span data-stu-id="44202-165">With the PSEntityProvision.xsd schema in the Project 2013 SDK download, it is possible to develop a tool that checks for the prescribed order of entities in the XML files.</span></span>
  
## <a name="upgrading-applications-with-the-project-server-apis"></a><span data-ttu-id="44202-166">使用 Project Server API 升级应用程序</span><span class="sxs-lookup"><span data-stu-id="44202-166">Upgrading applications with the Project Server APIs</span></span>
<span data-ttu-id="44202-167"><a name="pj15_Programmability_APIs"> </a></span><span class="sxs-lookup"><span data-stu-id="44202-167"><a name="pj15_Programmability_APIs"> </a></span></span>

<span data-ttu-id="44202-p118">在升级已为早期版本的 Project Server 开发的应用程序时，可以选择对包含用于创建、读取、更新和删除项目实体（CRUD 操作）的方法的编程接口使用 CSOM 或 PSI。虽然 CSOM 将内部调用 PSI，但无法完全取代所有 PSI 方法。有关 PSI 和 CSOM 的方案和限制，请参阅 [What the PSI does and does not do](what-the-psi-does-and-does-not-do.md)和 [What the CSOM does and does not do](what-the-csom-does-and-does-not-do.md)。</span><span class="sxs-lookup"><span data-stu-id="44202-p118">When you upgrade an application that was developed for a previous version of Project Server, you can choose to use either the CSOM or the PSI for a programmatic interface that includes methods to create, read, update, and delete project entities (the CRUD operations). Although the CSOM internally calls the PSI, it does not fully replace all PSI methods. For scenarios and limitations of the PSI and of the CSOM, see [What the PSI does and does not do](what-the-psi-does-and-does-not-do.md) and [What the CSOM does and does not do](what-the-csom-does-and-does-not-do.md).</span></span>
  
> [!NOTE]
> <span data-ttu-id="44202-171">如果 CSOM 包含你所需的功能，我们建议你升级应用程序以使用 CSOM。</span><span class="sxs-lookup"><span data-stu-id="44202-171">If the CSOM includes the functionality you require, we recommend that you upgrade applications to use the CSOM.</span></span> <span data-ttu-id="44202-172">CSOM 允许在本地和在线安装的 Project Server 2013 中使用应用程序。</span><span class="sxs-lookup"><span data-stu-id="44202-172">The CSOM enables applications to be used for both on-premises and online installations of Project Server 2013.</span></span> 
  
<span data-ttu-id="44202-173">如果你的应用程序主要用于从 Project Server 读取数据，则对于本地方案，可以使用 Project Server 数据库中的报告表和视图。</span><span class="sxs-lookup"><span data-stu-id="44202-173">If your application primarily reads data from Project Server, you can use the reporting tables and views in the Project Server database for an on-premises scenario.</span></span> <span data-ttu-id="44202-174">如果你打算将该应用程序与 Project Online 一起使用，则可以将 OData 协议用于 **ProjectData** 服务，该服务提供对报告数据的本地访问和在线访问。</span><span class="sxs-lookup"><span data-stu-id="44202-174">If you intend to use the application with Project Online, you can use the OData protocol for the **ProjectData** service, which provides both on-premises and online access to the reporting data.</span></span> <span data-ttu-id="44202-175">有关详细信息，请参阅 [ProjectData - Project OData 服务引用](https://docs.microsoft.com/previous-versions/office/project-odata/jj163015(v=office.15))</span><span class="sxs-lookup"><span data-stu-id="44202-175">For more information, see [ProjectData - Project OData service reference](https://docs.microsoft.com/previous-versions/office/project-odata/jj163015(v=office.15))</span></span>
  
### <a name="using-the-psi"></a><span data-ttu-id="44202-176">使用 PSI</span><span class="sxs-lookup"><span data-stu-id="44202-176">Using the PSI</span></span>
<span data-ttu-id="44202-177"><a name="pj15_Programmability_PSI"> </a></span><span class="sxs-lookup"><span data-stu-id="44202-177"><a name="pj15_Programmability_PSI"> </a></span></span>

<span data-ttu-id="44202-178">PSI 允许完全信任的客户端应用程序（包括Project Professional 2013、Project Web App 和 LOB 应用程序）访问 SharePoint 场中的 Project Server 数据。</span><span class="sxs-lookup"><span data-stu-id="44202-178">The PSI enables full-trust client applications, including Project Professional 2013, Project Web App, and LOB applications, to access Project Server data within a SharePoint farm.</span></span> <span data-ttu-id="44202-179">PSI 与 .NET Framework 4 一起构建和使用，并且具有优势，例如包含内置安全性的已知开发环境、错误处理和垃圾收集。</span><span class="sxs-lookup"><span data-stu-id="44202-179">The PSI is built and used with .NET Framework 4 and provides advantages such as a well-known development environment with built-in security, error handling, and garbage collection.</span></span>
  
<span data-ttu-id="44202-180">可通过 WCF 服务或 ASMX Web 服务来访问 PSI。</span><span class="sxs-lookup"><span data-stu-id="44202-180">The PSI is accessed through WCF services or ASMX web services.</span></span> <span data-ttu-id="44202-181">ASMX 接口基于 WCF。</span><span class="sxs-lookup"><span data-stu-id="44202-181">The ASMX interface is based on WCF.</span></span> <span data-ttu-id="44202-182">每个 PSI 服务通常都包含一个基类，它为该类中的项目使用 CRUD 方法。</span><span class="sxs-lookup"><span data-stu-id="44202-182">Each PSI service typically contains a base class with CRUD methods for items within that class.</span></span> <span data-ttu-id="44202-183">这些项目由相关的 **DataSet** 类指定。</span><span class="sxs-lookup"><span data-stu-id="44202-183">Items are specified by related **DataSet** classes.</span></span> <span data-ttu-id="44202-184">例如，**CustomFields** 服务包含 **CustomFields** 类，其中包含 [CreateCustomFields2](https://docs.microsoft.com/previous-versions/office/ee767959(v=office.14)) 等方法。</span><span class="sxs-lookup"><span data-stu-id="44202-184">For example, the **CustomFields** service contains the **CustomFields** class with methods such as [CreateCustomFields2](https://docs.microsoft.com/previous-versions/office/ee767959(v=office.14)) .</span></span> <span data-ttu-id="44202-185">一个或多个企业自定义字段的数据在 **CustomFieldDataSet** 中指定。</span><span class="sxs-lookup"><span data-stu-id="44202-185">Data for one or more enterprise custom fields are specified in the **CustomFieldDataSet**.</span></span>
  
> [!NOTE]
> <span data-ttu-id="44202-186">在 Project Server 2013 中，已弃用 PSI 的 ASMX Web 服务接口。</span><span class="sxs-lookup"><span data-stu-id="44202-186">The ASMX web services interface of the PSI is deprecated in Project Server 2013.</span></span> <span data-ttu-id="44202-187">尽管 ASMX 接口仍然可用，但使用 PSI 的新应用程序应该使用 WCF 接口，或者如果可能，新应用程序应该使用 CSOM 而不是 PSI。</span><span class="sxs-lookup"><span data-stu-id="44202-187">Although the ASMX interface is still available, new applications that use the PSI should use the WCF interface, or if possible, new applications should use the CSOM instead of the PSI.</span></span> <span data-ttu-id="44202-188">未来的 Project Server 版本将要求升级基于 ASMX 的现有应用程序，以便使用 PSI 的 WCF 接口或使用 CSOM。</span><span class="sxs-lookup"><span data-stu-id="44202-188">Future versions of Project Server will require an upgrade of existing ASMX-based applications to use the WCF interface of the PSI or to use the CSOM.</span></span> 
  
<span data-ttu-id="44202-189">在 WCF 接口和 ASMX 接口中，有 22 个重复的已记录的公共 PSI 服务。</span><span class="sxs-lookup"><span data-stu-id="44202-189">There are 22 public, documented PSI services, which are duplicated in the WCF interface and the ASMX interface.</span></span> <span data-ttu-id="44202-190">PSI 还包含 8 个未记录的私有服务。</span><span class="sxs-lookup"><span data-stu-id="44202-190">The PSI also includes eight private, undocumented services.</span></span> <span data-ttu-id="44202-191">Project Web App 和 Project Professional 使用公共 PSI 服务和私有 PSI 服务。</span><span class="sxs-lookup"><span data-stu-id="44202-191">Project Web App and Project Professional use the public PSI services and the private PSI services.</span></span> <span data-ttu-id="44202-192">PSI 通常用于匹配业务对象。</span><span class="sxs-lookup"><span data-stu-id="44202-192">The PSI is generally factored to match the business objects.</span></span> <span data-ttu-id="44202-193">也就是说，每种 PSI 方法都与业务对象相关联，例如**日历**或**资源**。</span><span class="sxs-lookup"><span data-stu-id="44202-193">That is, each PSI method is associated with a business object such as **Calendar** or **Resource**.</span></span> <span data-ttu-id="44202-194">PSI 是业务对象的主要接口。</span><span class="sxs-lookup"><span data-stu-id="44202-194">The PSI is the primary interface to the business objects.</span></span> <span data-ttu-id="44202-195">由于业务层提供可重用的业务逻辑组件，因此与 Project Server 数据交互的不同应用程序可以使用相同的业务逻辑。</span><span class="sxs-lookup"><span data-stu-id="44202-195">Because the business layer provides reusable business logic components, different applications that interact with Project Server data use the same business logic.</span></span>
  
<span data-ttu-id="44202-196">与 Project Server 异步交互的 PSI 方法具有以 **Queue** 开头的名称。</span><span class="sxs-lookup"><span data-stu-id="44202-196">PSI methods that asynchronously interact with Project Server have names that begin with **Queue**.</span></span> <span data-ttu-id="44202-197">每种 PSI 方法都通过一个独立接口来实现，该接口使用强键入的数据。</span><span class="sxs-lookup"><span data-stu-id="44202-197">Each PSI method is implemented with a separate interface that uses strongly typed data.</span></span> <span data-ttu-id="44202-198">例如，**Project** 服务中的 **QueueCreateProject** 方法接受 **ProjectDataSet** 类型的 _dataset_ 参数。</span><span class="sxs-lookup"><span data-stu-id="44202-198">For example, the **QueueCreateProject** method in the **Project** service accepts the  _dataset_ parameter of type **ProjectDataSet**.</span></span> <span data-ttu-id="44202-199">**ProjectDataSet** 类派生自 **DataSet** 类型。</span><span class="sxs-lookup"><span data-stu-id="44202-199">The **ProjectDataSet** class is derived from the **DataSet** type.</span></span> <span data-ttu-id="44202-200">在 Visual Studio 中完成 .NET Framework 和 IntelliSense 的类型检查有助于减少 PSI 开发中的错误。</span><span class="sxs-lookup"><span data-stu-id="44202-200">Type checking in the .NET Framework and IntelliSense completion in Visual Studio help to reduce errors in development with the PSI.</span></span> <span data-ttu-id="44202-201">有关 PSI 命名空间、类、方法、属性、事件和相关程序集的详细参考的说明，请参阅 [Project PSI 参考概述](project-psi-reference-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="44202-201">For an introduction to the detailed reference for PSI namespaces, classes, methods, properties, events, and related assemblies, see [Project PSI reference overview](project-psi-reference-overview.md).</span></span>
  
<span data-ttu-id="44202-202">Project Server 2013 使用 .NET Framework 的异常处理。</span><span class="sxs-lookup"><span data-stu-id="44202-202">Project Server 2013 uses the exception handling of the .NET Framework.</span></span> <span data-ttu-id="44202-203">所有错误都记录在位于 PSI 堆栈顶部的服务器上。</span><span class="sxs-lookup"><span data-stu-id="44202-203">All errors are logged in the server, at the top of the PSI stack.</span></span> <span data-ttu-id="44202-204">某些错误会向客户端发送一个简单的报告，例如 ASMX 接口的 **SoapException** 对象或 WCF 接口的 **FaultException** 对象。</span><span class="sxs-lookup"><span data-stu-id="44202-204">Some errors send a simple report to the client, such as a **SoapException** object for the ASMX interface or a **FaultException** object for the WCF interface.</span></span> <span data-ttu-id="44202-205">可能会在应用程序事件日志中记录异常，并且某些错误还会在统一日志记录服务 (ULS) 跟踪日志中记录服务器上的详细报告。</span><span class="sxs-lookup"><span data-stu-id="44202-205">Exceptions can be recorded in the application event log, and some errors also record a detailed report on the server in the Unified Logging Service (ULS) trace logs.</span></span> 
  
<span data-ttu-id="44202-p127">此外，可以为本地完全信任应用程序扩展 PSI。可以将 .NET 程序集与服务一起添加，该服务提供了新功能、使用相同的 Project Server 安全基础结构并调用其他 PSI 方法或从 PSI 类继承。PSI 扩展还可提供新功能所需的业务逻辑和数据库访问权。</span><span class="sxs-lookup"><span data-stu-id="44202-p127">For local full-trust applications, the PSI is also extensible. You can add a .NET assembly with a service that provides new functionality, uses the same Project Server security infrastructure, and calls other PSI methods or inherits from PSI classes. A PSI extension can also provide the business logic and database access required for new functionality.</span></span>
  
### <a name="using-the-csom"></a><span data-ttu-id="44202-209">使用 CSOM</span><span class="sxs-lookup"><span data-stu-id="44202-209">Using the CSOM</span></span>
<span data-ttu-id="44202-210"><a name="pj15_Programmability_CSOM"> </a></span><span class="sxs-lookup"><span data-stu-id="44202-210"><a name="pj15_Programmability_CSOM"> </a></span></span>

<span data-ttu-id="44202-211">使用 CSOM，你可以开发访问 Project Online 或本地 Project Server 2013 安装的应用程序。</span><span class="sxs-lookup"><span data-stu-id="44202-211">With the CSOM, you can develop apps that access Project Online or an on-premises Project Server 2013 installation.</span></span> <span data-ttu-id="44202-212">可以在公共 Office 商店或私有应用程序目录中分发应用程序。</span><span class="sxs-lookup"><span data-stu-id="44202-212">Apps can be distributed in a public Office Store or a private app catalog.</span></span> <span data-ttu-id="44202-213">CSOM 是易于使用的 API，它通过 LINQ 查询按名称直接使用或提供数据，而不是通过传递数据集和构建 _changeXml_ 参数或 XM _filter_ 参数来提供。</span><span class="sxs-lookup"><span data-stu-id="44202-213">The CSOM is designed to be an easy-to-use API that directly consumes or provides data by name with LINQ queries, rather than by passing datasets and constructing  _changeXml_ parameters or XML  _filter_ parameters.</span></span> <span data-ttu-id="44202-214">CSOM 为主要实体（如 **Project**、**Task**、**EnterpriseResource** 和 **Assignment**）实现 Project Server 接口 (PSI) 的主要功能。</span><span class="sxs-lookup"><span data-stu-id="44202-214">The CSOM implements the main functionality of the Project Server Interface (PSI) for the primary entities such as **Project**, **Task**, **EnterpriseResource**, and **Assignment**.</span></span> <span data-ttu-id="44202-215">CSOM 包含许多其他实体，例如 **CustomField**、**LookupTable**、**WorkflowActivities**、**EventHandler** 和 **QueueJob**，它们支持其他常见的 Project Server 功能。</span><span class="sxs-lookup"><span data-stu-id="44202-215">The CSOM includes many additional entities such as **CustomField**, **LookupTable**, **WorkflowActivities**, **EventHandler**, and **QueueJob**, which support other common Project Server functionality.</span></span>
  
<span data-ttu-id="44202-216">可以通过将以下资源复制到本地开发计算机来使用 CSOM：</span><span class="sxs-lookup"><span data-stu-id="44202-216">The CSOM can be used by copying the following resources to your local development computer:</span></span>
  
- <span data-ttu-id="44202-217">对于 .NET Framework 4 开发，请复制 `%ProgramFiles%\Common Files\Microsoft Shared\Web Server Extensions\15\ISAPI\Microsoft.ProjectServer.Client.dll` 程序集。</span><span class="sxs-lookup"><span data-stu-id="44202-217">For .NET Framework 4 development, copy the  `%ProgramFiles%\Common Files\Microsoft Shared\Web Server Extensions\15\ISAPI\Microsoft.ProjectServer.Client.dll` assembly.</span></span> 
    
  <span data-ttu-id="44202-218">有关 CSOM 类和成员的文档，请参阅 [Microsoft.ProjectServer.Client](https://docs.microsoft.com/previous-versions/office/dn529530(v=office.15)) 命名空间。</span><span class="sxs-lookup"><span data-stu-id="44202-218">For documentation of the CSOM classes and members, see the [Microsoft.ProjectServer.Client](https://docs.microsoft.com/previous-versions/office/dn529530(v=office.15)) namespace.</span></span> <span data-ttu-id="44202-219">有关示例应用程序，请参阅 [CSOM 和 .NET 入门](getting-started-with-the-project-server-csom-and-net.md)。</span><span class="sxs-lookup"><span data-stu-id="44202-219">For an example application, see [Getting started with the CSOM and .NET](getting-started-with-the-project-server-csom-and-net.md).</span></span>
    
- <span data-ttu-id="44202-220">对于 Microsoft Silverlight 开发，请复制 `%ProgramFiles%\Common Files\Microsoft Shared\Web Server Extensions\15\TEMPLATE\LAYOUTS\ClientBin\Microsoft.ProjectServer.Client.Silverlight.dll` 程序集。</span><span class="sxs-lookup"><span data-stu-id="44202-220">For Microsoft Silverlight development, copy the  `%ProgramFiles%\Common Files\Microsoft Shared\Web Server Extensions\15\TEMPLATE\LAYOUTS\ClientBin\Microsoft.ProjectServer.Client.Silverlight.dll` assembly.</span></span> 
    
- <span data-ttu-id="44202-221">若要为 Windows Phone 8 开发应用程序，请复制 `%ProgramFiles%\Common Files\Microsoft Shared\Web Server Extensions\15\TEMPLATE\LAYOUTS\ClientBin\Microsoft.ProjectServer.Client.Phone.dll` 程序集。</span><span class="sxs-lookup"><span data-stu-id="44202-221">To develop apps for Windows Phone 8, copy the  `%ProgramFiles%\Common Files\Microsoft Shared\Web Server Extensions\15\TEMPLATE\LAYOUTS\ClientBin\Microsoft.ProjectServer.Client.Phone.dll` assembly.</span></span> 
    
- <span data-ttu-id="44202-222">若要使用 JavaScript 为其他设备开发 Web 应用程序和应用程序，请复制 `%ProgramFiles%\Common Files\Microsoft Shared\Web Server Extensions\15\TEMPLATE\LAYOUTS\PS.js` 文件和 `PS.debug.js` 文件。</span><span class="sxs-lookup"><span data-stu-id="44202-222">To use JavaScript for developing web apps and apps for other devices, copy the  `%ProgramFiles%\Common Files\Microsoft Shared\Web Server Extensions\15\TEMPLATE\LAYOUTS\PS.js` file and the  `PS.debug.js` file.</span></span> <span data-ttu-id="44202-223">有关示例 Web 应用程序，请参阅 [Project Server 2013 JavaScript 对象模型入门](getting-started-with-the-project-server-2013-javascript-object-model.md)。</span><span class="sxs-lookup"><span data-stu-id="44202-223">For an example web app, see [Getting started with the Project Server 2013 JavaScript object model](getting-started-with-the-project-server-2013-javascript-object-model.md).</span></span>
    
<span data-ttu-id="44202-224">CSOM 在内部调用 PSI；因此，如果 PSI 无法工作，则 CSOM 也不能工作。</span><span class="sxs-lookup"><span data-stu-id="44202-224">The CSOM internally calls the PSI; therefore, if the PSI cannot do a job, neither can the CSOM.</span></span> <span data-ttu-id="44202-225">有关 CSOM 的限制，请参阅 [CSOM 执行和不执行的操作](what-the-csom-does-and-does-not-do.md)和 [PSI 执行和不执行的操作](what-the-psi-does-and-does-not-do.md)。</span><span class="sxs-lookup"><span data-stu-id="44202-225">For limitations of the CSOM, see [What the CSOM does and does not do](what-the-csom-does-and-does-not-do.md) and [What the PSI does and does not do](what-the-psi-does-and-does-not-do.md).</span></span> <span data-ttu-id="44202-226">有关使用 CSOM 进行开发的详细信息，请参阅 [Project 2013 中面向开发人员的更新](updates-for-developers-in-project-2013.md)和 [Project 2013 的客户端对象模型 (CSOM)](client-side-object-model-csom-for-project-2013.md)。</span><span class="sxs-lookup"><span data-stu-id="44202-226">For more information about developing with the CSOM, see [Updates for developers in Project 2013](updates-for-developers-in-project-2013.md) and [Client-side object model (CSOM) for Project 2013](client-side-object-model-csom-for-project-2013.md).</span></span>
  
### <a name="porting-applications-built-for-project-server-2003"></a><span data-ttu-id="44202-227">移植为 Project Server 2003 构建的应用程序</span><span class="sxs-lookup"><span data-stu-id="44202-227">Porting applications built for Project Server 2003</span></span>
<span data-ttu-id="44202-228"><a name="pj15_Programmability_Porting2003"> </a></span><span class="sxs-lookup"><span data-stu-id="44202-228"><a name="pj15_Programmability_Porting2003"> </a></span></span>

<span data-ttu-id="44202-p132">在 Project Server 2003 中，许多数据和功能仅适用于 Project Professional 2003 或通过直接数据库访问使用。Project Server 2007 中引入的 PSI 在很大程度上消除了此限制。与 Project Server 2003 中的 Project Data Service (PDS) 不同，PSI 和 CSOM 为 Project Server 中的业务对象提供了全面的接口。</span><span class="sxs-lookup"><span data-stu-id="44202-p132">In Project Server 2003, much data and functionality is available only with Project Professional 2003 or by direct database access. The PSI, introduced in Project Server 2007, removes much of that restriction. Unlike the Project Data Service (PDS) in Project Server 2003, the PSI and the CSOM provide comprehensive interfaces to business objects in Project Server.</span></span>
  
<span data-ttu-id="44202-p133">为 PDS 开发的应用程序与更新版本的 Project Server 不兼容。CSOM 和 PSI 为 PDS 提供了功能奇偶校验位，但与 PDS 方法或参数不匹配。</span><span class="sxs-lookup"><span data-stu-id="44202-p133">Applications developed for the PDS are not compatible with later versions of Project Server. The CSOM and the PSI provide functional parity for the PDS, but do not match PDS methods or parameters.</span></span>
  
> [!NOTE]
> <span data-ttu-id="44202-234">由于必须为 Project Server 2013 完全重新设计 PDS 应用程序，因此我们建议你使用 CSOM。</span><span class="sxs-lookup"><span data-stu-id="44202-234">Because PDS applications must be completely redesigned for Project Server 2013, we recommend that you use the CSOM.</span></span> 
  
<span data-ttu-id="44202-235">有关 PDS 兼容性的详细信息以及将 PDS 扩展移植到 PSI 的指南，请参阅 [PSI Web 服务中的 PDS 奇偶校验](https://docs.microsoft.com/previous-versions/office/developer/office-2007/ms197081(v=office.12))。</span><span class="sxs-lookup"><span data-stu-id="44202-235">For more information about PDS compatibility and guidelines for porting PDS extensions to the PSI, see [PDS Parity in PSI Web Services](https://docs.microsoft.com/previous-versions/office/developer/office-2007/ms197081(v=office.12)).</span></span>
  
### <a name="porting-applications-built-for-project-server-2007-and-project-server-2010"></a><span data-ttu-id="44202-236">移植为 Project Server 2007 和 Project Server 2010 构建的应用程序</span><span class="sxs-lookup"><span data-stu-id="44202-236">Porting applications built for Project Server 2007 and Project Server 2010</span></span>
<span data-ttu-id="44202-237"><a name="pj15_Programmability_Porting2007"> </a></span><span class="sxs-lookup"><span data-stu-id="44202-237"><a name="pj15_Programmability_Porting2007"> </a></span></span>

<span data-ttu-id="44202-238">Project Server 2013 中的 PSI 是 Office Project Server 2007 和 Project Server 2010 中的 PSI 对象模型的超集。</span><span class="sxs-lookup"><span data-stu-id="44202-238">The PSI in Project Server 2013 is a superset of the PSI object model in Office Project Server 2007 and Project Server 2010.</span></span> <span data-ttu-id="44202-239">为 Project Server 的两个先前版本构建的许多应用程序都可继续在完全信任的本地安装的 Project Server 2013 中工作。</span><span class="sxs-lookup"><span data-stu-id="44202-239">Many applications built for the two previous versions of Project Server continue to work in local full-trust, on-premises installations of Project Server 2013.</span></span> <span data-ttu-id="44202-240">但是，以下类型的应用程序需要更新或重新设计：</span><span class="sxs-lookup"><span data-stu-id="44202-240">However, the following kinds of applications require updates or redesign:</span></span>
  
- <span data-ttu-id="44202-241">对修改为与 Project Online 一起使用的应用程序使用 CSOM。</span><span class="sxs-lookup"><span data-stu-id="44202-241">Use the CSOM for applications that are adapted for use with Project Online.</span></span>
    
- <span data-ttu-id="44202-242">对修改为在移动设备和平板电脑上使用的应用程序使用 CSOM。</span><span class="sxs-lookup"><span data-stu-id="44202-242">Use the CSOM for applications that are adapted for use on mobile devices and tablet computers.</span></span>
    
- <span data-ttu-id="44202-243">对 Office 商店或私有应用程序目录中的可用应用程序使用 CSOM。</span><span class="sxs-lookup"><span data-stu-id="44202-243">Use the CSOM for applications that are available as apps in the Office Store or a private app catalog.</span></span>
    
- <span data-ttu-id="44202-244">对于修改项目计划的应用程序，请使用 CSOM，或将应用程序更改为使用 [QueueUpdateProject2](https://docs.microsoft.com/previous-versions/office/project-class/jj236245(v=office.15)) PSI 方法。</span><span class="sxs-lookup"><span data-stu-id="44202-244">For applications that modify project scheduling, use the CSOM, or change the application to use the [QueueUpdateProject2](https://docs.microsoft.com/previous-versions/office/project-class/jj236245(v=office.15)) PSI method.</span></span> 
    
- <span data-ttu-id="44202-245">将用户登录到 Project Web App 的不同实例的本地或 Web 应用程序应使用 CSOM 或 PSI 的 WCF 终结点编程设置。</span><span class="sxs-lookup"><span data-stu-id="44202-245">Local or web applications that log on users to different instances of Project Web App should use programmatic settings for WCF endpoints of the CSOM or the PSI.</span></span> <span data-ttu-id="44202-246">这些方法已弃用。</span><span class="sxs-lookup"><span data-stu-id="44202-246">The methods are deprecated.</span></span> <span data-ttu-id="44202-247">应用程序应使用 OAuth 身份验证代替窗体身份验证，并与 Project Online 一起使用。</span><span class="sxs-lookup"><span data-stu-id="44202-247">Apps should use OAuth authentication in place of Forms authentication and for use with Project Online.</span></span> <span data-ttu-id="44202-248">有关详细信息，请参阅 [SharePoint 2013 中应用程序的授权和身份验证](https://docs.microsoft.com/sharepoint/dev/sp-add-ins/authorization-and-authentication-of-sharepoint-add-ins)。</span><span class="sxs-lookup"><span data-stu-id="44202-248">For more information, see [Authorization and authentication for apps in SharePoint 2013](https://docs.microsoft.com/sharepoint/dev/sp-add-ins/authorization-and-authentication-of-sharepoint-add-ins).</span></span>
    
- <span data-ttu-id="44202-249">依赖于或修改特定 Project Server 安全设置的应用程序。</span><span class="sxs-lookup"><span data-stu-id="44202-249">Applications that rely on or modify specific Project Server security settings.</span></span>
    
  > [!NOTE]
  > <span data-ttu-id="44202-250">Project Server 2013 的默认本地安装使用 SharePoint 权限模式，其中无法通过 PSI 访问 Project Server 安全设置。</span><span class="sxs-lookup"><span data-stu-id="44202-250">A default on-premises installation of Project Server 2013 uses the SharePoint permission mode, where Project Server security settings are not accessible through the PSI.</span></span> <span data-ttu-id="44202-251">若要更改 Project 权限模式，请参阅 [Project Server 2013 中面向 IT 专业人员的新增功能](https://docs.microsoft.com/project/what-s-new-for-it-pros-in-project-server-2016)中的 *SharePoint 权限模式*部分。</span><span class="sxs-lookup"><span data-stu-id="44202-251">To change to the Project permission mode, see the  *SharePoint Permission Mode*  section in [What's new for IT pros in Project Server 2013](https://docs.microsoft.com/project/what-s-new-for-it-pros-in-project-server-2016).</span></span> 
  
- <span data-ttu-id="44202-252">对于许多自定义 Project Server 工作流，你可以使用 SharePoint Designer 2013 创建声明性工作流。</span><span class="sxs-lookup"><span data-stu-id="44202-252">For many custom Project Server workflows, you can use SharePoint Designer 2013 to create declarative workflows.</span></span> <span data-ttu-id="44202-253">对于需要额外编程的自定义工作流，你*不应该*直接使用 **Microsoft.Office.Project.Server.Workflow** 命名空间中的类或成员。</span><span class="sxs-lookup"><span data-stu-id="44202-253">For custom workflows that require additional programming, you should  *not*  directly use classes or members in the **Microsoft.Office.Project.Server.Workflow** namespace.</span></span> <span data-ttu-id="44202-254">请改用 CSOM 中的 [Microsoft.ProjectServer.Client.WorkflowActivities](https://docs.microsoft.com/previous-versions/office/mt780562(v=office.15)) 类。</span><span class="sxs-lookup"><span data-stu-id="44202-254">Instead, use the [Microsoft.ProjectServer.Client.WorkflowActivities](https://docs.microsoft.com/previous-versions/office/mt780562(v=office.15)) class in the CSOM.</span></span> 
    
- <span data-ttu-id="44202-255">通常，应该将使用模拟的应用程序重写为使用 PSI 的 WCF 接口。</span><span class="sxs-lookup"><span data-stu-id="44202-255">In general, applications that use impersonation should be rewritten to use the WCF interface of the PSI.</span></span> <span data-ttu-id="44202-256">为其他用户执行简单状态更新的应用程序不需要模拟。</span><span class="sxs-lookup"><span data-stu-id="44202-256">Applications that do simple status updates for other users do not require impersonation.</span></span> <span data-ttu-id="44202-257">它们可以使用 CSOM 中的 [StatusAssignment.SubmitStatusUpdates](https://docs.microsoft.com/previous-versions/office/project-class/jj235883(v=office.15)) 方法或 PSI 中的 [Statusing.SubmitStatusForResource](https://docs.microsoft.com/previous-versions/office/ee755393(v=office.14)) 方法。</span><span class="sxs-lookup"><span data-stu-id="44202-257">They can use the [StatusAssignment.SubmitStatusUpdates](https://docs.microsoft.com/previous-versions/office/project-class/jj235883(v=office.15)) method in the CSOM or the [Statusing.SubmitStatusForResource](https://docs.microsoft.com/previous-versions/office/ee755393(v=office.14)) method in the PSI.</span></span> 
    
- <span data-ttu-id="44202-258">在 Project Server 计算机上运行的中间件组件只能在本地安装使用，并且必须使用 PSI 的 WCF 接口。</span><span class="sxs-lookup"><span data-stu-id="44202-258">Middleware components that run on the Project Server computer can be installed only for on-premises use, and must use the WCF interface of the PSI.</span></span> <span data-ttu-id="44202-259">例如，使用 ASMX 接口在本地 Project Web App 和外部时间表应用程序之间交换数据的中间件组件必须重写为使用 PSI 的 WCF 接口。</span><span class="sxs-lookup"><span data-stu-id="44202-259">For example, a middleware component that uses the ASMX interface to exchange data between Project Web App on-premises and an external timesheet application would have to be rewritten to use the WCF interface of the PSI.</span></span> <span data-ttu-id="44202-260">若要使用 Project Online，必须将组件重新设计为应用程序并使用 CSOM。</span><span class="sxs-lookup"><span data-stu-id="44202-260">To work with Project Online, the component would have to be redesigned as an app and use the CSOM.</span></span>
    
### <a name="migration-and-compatibility-of-custom-solutions"></a><span data-ttu-id="44202-261">自定义解决方案的迁移和兼容性</span><span class="sxs-lookup"><span data-stu-id="44202-261">Migration and compatibility of custom solutions</span></span>
<span data-ttu-id="44202-262"><a name="pj15_Programmability_CustomSolutions"> </a></span><span class="sxs-lookup"><span data-stu-id="44202-262"><a name="pj15_Programmability_CustomSolutions"> </a></span></span>

<span data-ttu-id="44202-263">PSI 的公共 ASMX 和 WCF 接口中的类和成员是相同的。</span><span class="sxs-lookup"><span data-stu-id="44202-263">Classes and members in the public ASMX and WCF interfaces of the PSI are identical.</span></span> <span data-ttu-id="44202-264">但是，在 Project Server 2013 和 Project Server 的两个先前版本之间，PSI 方法使用或返回的数据表列数和大小可能不同。</span><span class="sxs-lookup"><span data-stu-id="44202-264">But, the number of columns and size of datatables used or returned by PSI methods can be different between Project Server 2013 and the two previous Project Server versions.</span></span> <span data-ttu-id="44202-265">此外，与先前版本中的报告数据库相比，报告表和视图也存在差异。</span><span class="sxs-lookup"><span data-stu-id="44202-265">There are also differences in the reporting tables and views, compared with the Reporting database in previous versions.</span></span>
  
> [!IMPORTANT]
> <span data-ttu-id="44202-266">强烈建议你先在 Project Server 2013 的非生产安装中全面测试解决方案，然后再将其部署到生产服务器。</span><span class="sxs-lookup"><span data-stu-id="44202-266">We strongly recommend that you thoroughly test solutions on a non-production installation of Project Server 2013 before deploying them to a production server.</span></span> 
  
<span data-ttu-id="44202-267">在将解决方案迁移到 Project Server 2013 时，或在解决方案未按预期运行的情况下，你至少应执行以下操作：</span><span class="sxs-lookup"><span data-stu-id="44202-267">When you migrate a solution to Project Server 2013, or if a solution does not work as expected, you should at a minimum do the following:</span></span>
  
- <span data-ttu-id="44202-268">通过在 Visual Studio 2012 中打开解决方案来进行更新。</span><span class="sxs-lookup"><span data-stu-id="44202-268">Update the solution by opening it in Visual Studio 2012.</span></span> <span data-ttu-id="44202-269">某些解决方案还可以使用 Visual Studio 2010。</span><span class="sxs-lookup"><span data-stu-id="44202-269">Some solutions can also use Visual Studio 2010.</span></span>
    
- <span data-ttu-id="44202-270">将目标更改为 .NET Framework 4。</span><span class="sxs-lookup"><span data-stu-id="44202-270">Change the target to .NET Framework 4.</span></span>
    
- <span data-ttu-id="44202-271">更改程序集引用以使用 Project Server 2013 程序集，如 Microsoft.Office.Project.Server.Library.dll 和 Microsoft.Office.Project.Server.Events.Receivers.dll。</span><span class="sxs-lookup"><span data-stu-id="44202-271">Change assembly references to use the Project Server 2013 assemblies, such as Microsoft.Office.Project.Server.Library.dll and Microsoft.Office.Project.Server.Events.Receivers.dll.</span></span>
    
- <span data-ttu-id="44202-272">列出 ASMX Web 引用或 WCF 服务引用和命名空间名称，然后删除 Project Server 引用。</span><span class="sxs-lookup"><span data-stu-id="44202-272">Make a list of the ASMX web references or the WCF service references and namespace names, and then delete the Project Server references.</span></span>
    
- <span data-ttu-id="44202-273">添加可以从 Project 2013 SDK 下载的 WCF 代理源文件构建的 ProjectServerServices.dll 代理程序集，或者为所需的 WCF 服务添加代理源文件。</span><span class="sxs-lookup"><span data-stu-id="44202-273">Add the ProjectServerServices.dll proxy assembly that you can build from the WCF proxy source files in the Project 2013 SDK download, or add the proxy source files for the required WCF services.</span></span> <span data-ttu-id="44202-274">对于 ASMX 服务，请使用相同的命名空间名称再次添加前端 ASMX Web 服务引用；或者添加可以从 Project 2013 SDK 下载的 WSDL 源构建的 ProjectServerServices.dll 代理程序集。</span><span class="sxs-lookup"><span data-stu-id="44202-274">For ASMX services, add the front-end ASMX web service references again, by using the same namespace names; or add the ProjectServerServices.dll proxy assembly that you can build from the WSDL sources in the Project 2013 SDK download.</span></span>
    
  > [!NOTE]
  > <span data-ttu-id="44202-275">在 Project 2013 SDK 下载中，代理源文件中的命名空间均以 *Svc* 开头。</span><span class="sxs-lookup"><span data-stu-id="44202-275">In the Project 2013 SDK download, the namespaces in the proxy source files all start with  *Svc*  .</span></span> <span data-ttu-id="44202-276">例如，WCF 代理文件和 ASMX 代理文件中的 **Resource** 服务命名空间是 **SvcResource**。</span><span class="sxs-lookup"><span data-stu-id="44202-276">For example, the **Resource** service namespace in the WCF proxy file and in the ASMX proxy file is **SvcResource**.</span></span> <span data-ttu-id="44202-277">> 如果应用程序使用不同的命名空间名称，则可以将代理程序集重新编译为使用你的命名空间，或者更改应用程序中的 PSI 命名空间。</span><span class="sxs-lookup"><span data-stu-id="44202-277">> If your application uses different namespace names, you can either recompile the proxy assembly to use your namespaces, or change the PSI namespaces in your application.</span></span> <span data-ttu-id="44202-278">例如，你可以修改 CompileWCFProxyAssembly.cmd 脚本，并从 SDK 下载的代理源文件中重新编译 ProjectServerServices.dll。</span><span class="sxs-lookup"><span data-stu-id="44202-278">For example, you can modify the CompileWCFProxyAssembly.cmd script and recompile ProjectServerServices.dll from the proxy source files in the SDK download.</span></span> 
  
- <span data-ttu-id="44202-279">如果你从使用 PSI 的 ASMX 接口更改为使用 WCF 接口，则可以编程方式或通过使用 app.config 中的 WFC 终结点初始化客户端类。在必须快速切换到 Project Web App 的其他实例时，或在开发使用 PSI 的 Web 部件时使用编程初始化。</span><span class="sxs-lookup"><span data-stu-id="44202-279">If you change from using the ASMX interface of the PSI to the WCF interface, you can initialize the client classes either programmatically or by using WCF endpoints in app.config. Use programmatic initialization when you have to quickly switch to different instances of Project Web App, or when you are developing a web part that uses the PSI.</span></span>
    
- <span data-ttu-id="44202-280">Project Server 2013 的 PSI 服务中有几个新方法和数据集，并且某些 **DataRow** 类包含新属性。</span><span class="sxs-lookup"><span data-stu-id="44202-280">There are several new methods and datasets in the PSI services in Project Server 2013 and some **DataRow** classes contain new properties.</span></span> <span data-ttu-id="44202-281">例如，PSI 中的 [QueueUpdateProject2](https://docs.microsoft.com/previous-versions/office/project-class/jj236245(v=office.15)) 方法使用 Project Server 计划引擎来重新计划更新的项目，而无需在 Project Professional 2013 中打开该项目，它还允许在同一次调用中添加或删除项目实体。</span><span class="sxs-lookup"><span data-stu-id="44202-281">For example, the [QueueUpdateProject2](https://docs.microsoft.com/previous-versions/office/project-class/jj236245(v=office.15)) method in the PSI uses the Project Server scheduling engine to reschedule an updated project without you having to open the project in Project Professional 2013, and also allows adding or deleting project entities in the same call.</span></span> 
    
- <span data-ttu-id="44202-282">编译和测试解决方案。</span><span class="sxs-lookup"><span data-stu-id="44202-282">Compile and test the solution.</span></span>
    
## <a name="project-scheduling-on-the-server"></a><span data-ttu-id="44202-283">服务器上的项目计划</span><span class="sxs-lookup"><span data-stu-id="44202-283">Project scheduling on the server</span></span>
<span data-ttu-id="44202-284"><a name="pj15_Programmability_Scheduling"> </a></span><span class="sxs-lookup"><span data-stu-id="44202-284"><a name="pj15_Programmability_Scheduling"> </a></span></span>

<span data-ttu-id="44202-285">Project Server 2013 具有两个计划引擎。</span><span class="sxs-lookup"><span data-stu-id="44202-285">Project Server 2013 has two scheduling engines.</span></span> <span data-ttu-id="44202-286">新版计划引擎与 Project Professional 2013 中的计划引擎相同。</span><span class="sxs-lookup"><span data-stu-id="44202-286">The newer scheduling engine is the same as the scheduling engine in Project Professional 2013.</span></span> <span data-ttu-id="44202-287">通过使用 Project Web App 或项目网站中的计划 Web 部件（“项目详细信息”页面）或使用 CSOM 来更改计划和发布更改时，日期、成本、工期、剩余工时、基线以及与计划相关的其他更改的计算方式与使用 Project Professional 2013 更改和发布项目时采用的方式相同。</span><span class="sxs-lookup"><span data-stu-id="44202-287">When you make scheduling changes and publish the changes by using the Scheduling web part (Project Details page) in Project Web App or a project site, or by using the CSOM, the calculation of dates, costs, duration, remaining work, baselines, and other changes related to scheduling are the same as if you made the changes and published the project by using Project Professional 2013.</span></span> <span data-ttu-id="44202-288">但是，除了 [QueueUpdateProject2](https://docs.microsoft.com/previous-versions/office/project-class/jj236245(v=office.15)) 方法之外，PSI 方法可使用从 Project Server 2010 迁移的旧版计划引擎。</span><span class="sxs-lookup"><span data-stu-id="44202-288">However, except for the [QueueUpdateProject2](https://docs.microsoft.com/previous-versions/office/project-class/jj236245(v=office.15)) method, PSI methods use the older scheduling engine that was migrated from Project Server 2010.</span></span> <span data-ttu-id="44202-289">原因是确保旧版应用程序在 Project Server 2013 中的行为与以前相同。</span><span class="sxs-lookup"><span data-stu-id="44202-289">The reason is to ensure that legacy applications behave the same in Project Server 2013 as they previously did.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="44202-290">若要在 Project Server 2013 中使用更新的计划引擎，应用程序可使用 CSOM。</span><span class="sxs-lookup"><span data-stu-id="44202-290">To use the updated scheduling engine in Project Server 2013, applications can use the CSOM.</span></span> 
  
<span data-ttu-id="44202-291">旧版计划引擎和新版计划引擎都具有以下限制：</span><span class="sxs-lookup"><span data-stu-id="44202-291">Both the older and the newer scheduling engines have the following limitations:</span></span>
  
- <span data-ttu-id="44202-292">**仅限单个项目计划** 当使用 PSI、CSOM 或Project Web App 通过任务状态更新进行更改时，计划仅影响当前项目。</span><span class="sxs-lookup"><span data-stu-id="44202-292">**Single project scheduling only** Scheduling affects only the current project, when changes are made through task status updates with the PSI or the CSOM, or with Project Web App.</span></span> <span data-ttu-id="44202-293">如果当前项目具有指向其他项目、子项目或主项目的链接，则链接的项目不会发生更改。</span><span class="sxs-lookup"><span data-stu-id="44202-293">If the current project has links to other projects, subprojects, or master projects, the linked projects are not changed.</span></span> 
    
- <span data-ttu-id="44202-294">**摘要任务** 在 Project Server 上，摘要任务通常为只读。</span><span class="sxs-lookup"><span data-stu-id="44202-294">**Summary tasks** Summary tasks are generally read-only on Project Server.</span></span> <span data-ttu-id="44202-295">例如，无法创建摘要任务的分配，并且无法修改完成百分比。</span><span class="sxs-lookup"><span data-stu-id="44202-295">For example, assignments for summary tasks cannot be created, and percent completion cannot be modified.</span></span> <span data-ttu-id="44202-296">但是，Project Server 支持编辑手动计划的摘要任务的日期和工期。</span><span class="sxs-lookup"><span data-stu-id="44202-296">However, Project Server does support editing the dates and duration of manually scheduled summary tasks.</span></span> 
    
    <span data-ttu-id="44202-p148">Project Server 上的实际数据不会自动添加到摘要任务工作分配，因为这可能绕过 Project Server 中的审批流程。在 Project Professional 中，当您向子任务添加实际数据时，也会为摘要任务的工作分配添加这些实际值。用户可能会混淆行为上的差异。</span><span class="sxs-lookup"><span data-stu-id="44202-p148">Actuals on Project Server are not added automatically to a summary task assignment, because that would bypass the approval process in Project Server. In Project Professional, when you add actuals to a subtask, the actuals are also added for an assignment on the summary task. The difference in behavior can be confusing for a user.</span></span>
    
    <span data-ttu-id="44202-300">如果子任务工期缩短或完成日期发生更改，则 Project Server 会删除摘要任务工作分配的实际值。</span><span class="sxs-lookup"><span data-stu-id="44202-300">Project Server deletes actuals on a summary task assignment if the subtask duration shortens or the finish date is changed.</span></span>
    
    > [!CAUTION]
    > <span data-ttu-id="44202-301">虽然 Project Professional 可执行此操作，但建议您不要对摘要任务进行工作分配。</span><span class="sxs-lookup"><span data-stu-id="44202-301">Although Project Professional can do it, we recommend that you do not make assignments on summary tasks.</span></span> 
  
<span data-ttu-id="44202-302">以下是使用旧版 Project Server 计划引擎进行 PSI 编程的问题和限制：</span><span class="sxs-lookup"><span data-stu-id="44202-302">Following are issues and limitations of PSI programming with the older Project Server scheduling engine:</span></span>
  
- <span data-ttu-id="44202-303">**更改任务的活动状态** 当你使用 [QueueUpdateProject](https://docs.microsoft.com/previous-versions/office/ms471014(v=office.14)) 方法更改任务的活动状态时，如果 **ProjectDataSet** 对象的 _dataset_ 参数存在多项更改，则旧版 Project Server 计划引擎可能会显示不一致的开始或结束时间。</span><span class="sxs-lookup"><span data-stu-id="44202-303">**Changing the active status of a task** The older Project Server scheduling engine can show inconsistent start or finish times when you use the [QueueUpdateProject](https://docs.microsoft.com/previous-versions/office/ms471014(v=office.14)) method to change the active status of a task, if there are multiple changes in the **ProjectDataSet** object for the  _dataset_ parameter.</span></span> <span data-ttu-id="44202-304">如果在 **QueueUpdateProject** 的 _dataset_ 参数中，**TASK_IS_ACTIVE** 属性是唯一发生更改的属性，则你可以更新项目。</span><span class="sxs-lookup"><span data-stu-id="44202-304">If the **TASK_IS_ACTIVE** property is the only change in the  _dataset_ parameter of **QueueUpdateProject**, you can update the project.</span></span>
    
    <span data-ttu-id="44202-305">有关非活动任务和旧版计划引擎的详细信息，请参阅博客文章 [Project 2010 中的非活动任务简介](https://blogs.msdn.com/b/project/archive/2010/06/10/introducing-inactive-tasks-in-project-2010.aspx)和 [Project Server 2010：在 Web、PSI 和 Project Professional 上创建计划](https://blogs.msdn.com/b/brismith/archive/2010/09/10/project-server-2010-scheduling-on-the-web-the-psi-and-project-professional.aspx?wa=wsignin1.0)。</span><span class="sxs-lookup"><span data-stu-id="44202-305">For more information about inactive tasks and the older scheduling engine, see the blog articles [Introducing inactive tasks in Project 2010](https://blogs.msdn.com/b/project/archive/2010/06/10/introducing-inactive-tasks-in-project-2010.aspx) and [Project Server 2010: Scheduling on the web, the PSI and Project Professional](https://blogs.msdn.com/b/brismith/archive/2010/09/10/project-server-2010-scheduling-on-the-web-the-psi-and-project-professional.aspx?wa=wsignin1.0).</span></span> <span data-ttu-id="44202-306">有关 Project Professional 2010 中的计划与 Project Server 2010 中的 Project Web App 的比较，请参阅[基于 Web 的计划管理比较](https://blogs.msdn.microsoft.com/brismith/2010/09/10/project-server-2010-scheduling-on-the-web-the-psi-and-project-professional/)。</span><span class="sxs-lookup"><span data-stu-id="44202-306">For a comparison of scheduling in Project Professional 2010 and Project Web App in Project Server 2010, see [Web-based schedule management comparison](https://blogs.msdn.microsoft.com/brismith/2010/09/10/project-server-2010-scheduling-on-the-web-the-psi-and-project-professional/).</span></span>
    
- <span data-ttu-id="44202-307">**未计算的挣值** 旧版计划引擎不会计算以下挣值域：ACWP、BAC、BCWP、BCWS、CPI、CV、CV％、EAC、SPI、SV、SV％、TCPI、VAC、工期差异、开始时间差异、完成时间差异、成本差异和工时差异。</span><span class="sxs-lookup"><span data-stu-id="44202-307">**Earned value not calculated** The older scheduling engine does not calculate the earned value fields: ACWP, BAC, BCWP, BCWS, CPI, CV, CV%, EAC, SPI, SV, SV%, TCPI, VAC, Duration Variance, Start Variance, Finish Variance, Cost Variance, and Work Variance.</span></span> <span data-ttu-id="44202-308">如果项目具有这些域值，并且是使用 **QueueUpdateProject** 方法更新的，则域值不会发生更改。</span><span class="sxs-lookup"><span data-stu-id="44202-308">If a project has values for these fields and the project is updated by using the **QueueUpdateProject** method, the field values do not change.</span></span> <span data-ttu-id="44202-309">若要避免此问题，请使用 **QueueUpdateProject2** 方法。</span><span class="sxs-lookup"><span data-stu-id="44202-309">To avoid the problem, use the **QueueUpdateProject2** method.</span></span> 
    
<span data-ttu-id="44202-310">你可以通过以下方式处理 PSI 计划限制：</span><span class="sxs-lookup"><span data-stu-id="44202-310">You can handle the PSI scheduling limitations in the following ways:</span></span>
  
- <span data-ttu-id="44202-311">如果 CSOM 具有应用程序所需的方法，则使用 CSOM 而非 PSI。</span><span class="sxs-lookup"><span data-stu-id="44202-311">If the CSOM has the methods the application requires, use the CSOM instead of the PSI.</span></span>
    
- <span data-ttu-id="44202-312">在 Project Professional 中打开项目，并将这些项目保存回 Project Server。</span><span class="sxs-lookup"><span data-stu-id="44202-312">Open projects in Project Professional and save them back to Project Server.</span></span>
    
- <span data-ttu-id="44202-313">在报表中，不要包括 PSI 未更新的域。</span><span class="sxs-lookup"><span data-stu-id="44202-313">In reports, do not include fields that the PSI does not update.</span></span>
    
- <span data-ttu-id="44202-314">在报表中添加有关数据可能过时的说明。</span><span class="sxs-lookup"><span data-stu-id="44202-314">Add a note in reports about data that may be stale.</span></span>
    
<span data-ttu-id="44202-p152">报告表和多维数据集中存在可帮助您检测某些项目数据未更新的情况的标记。MSP_EpmProject 表和 MSP_EpmProject_UserView 中的报表数据包括以下域：</span><span class="sxs-lookup"><span data-stu-id="44202-p152">There are flags in the reporting tables and the cubes that help you detect when some project data is not updated. The reporting data in the MSP_EpmProject table and in MSP_EpmProject_UserView includes the following fields:</span></span> 
  
-  <span data-ttu-id="44202-317">_ProjectWbsIsStale_ &ndash; 指示工作分解结构（任务大纲层次结构）是否已过时。</span><span class="sxs-lookup"><span data-stu-id="44202-317">_ProjectWbsIsStale_ &ndash; Indicates whether the work breakdown structure (task outline hierarchy) is stale.</span></span> 
    
-  <span data-ttu-id="44202-318">_ProjectEarnedValueIsStale_ &ndash; 指示挣值域已过时。</span><span class="sxs-lookup"><span data-stu-id="44202-318">_ProjectEarnedValueIsStale_ &ndash; Indicates the earned value fields are stale.</span></span> 
    
-  <span data-ttu-id="44202-319">_ProjectRollupsAreStale_&ndash; 指示子项目已在草稿数据库中更新，但主项目未更新。</span><span class="sxs-lookup"><span data-stu-id="44202-319">_ProjectRollupsAreStale_ &ndash; Indicates that a subproject is updated in the draft database, but the master project is not updated.</span></span> <span data-ttu-id="44202-320">子项目中的汇总值已过时。</span><span class="sxs-lookup"><span data-stu-id="44202-320">The rolled-up values from the subproject are stale.</span></span> 
    
-  <span data-ttu-id="44202-321">_ProjectHierarchyNotSynchronized_ &ndash; 主项目与其子项目不同步。</span><span class="sxs-lookup"><span data-stu-id="44202-321">_ProjectHierarchyNotSynchronized_ &ndash; The master project is not synchronized with its children.</span></span> <span data-ttu-id="44202-322">当子项目显式发布而不是作为主项目的一部分进行发布时，会发生这种情况。</span><span class="sxs-lookup"><span data-stu-id="44202-322">This happens when the child projects are published explicitly, not as part of the master project publishing.</span></span> 
    
-  <span data-ttu-id="44202-323">_ProjectCalculationsAreStale_ &ndash; Project Professional 在没有计算计划的情况下保存项目（即在“**项目选项**”对话框的“**计划**”选项卡上将计算模式设置为“**手动**”）。</span><span class="sxs-lookup"><span data-stu-id="44202-323">_ProjectCalculationsAreStale_ &ndash; Project Professional saved a project without calculating the schedule (that is, the calculation mode is set to **Manual** on the **Schedule** tab in the **Project Options** dialog box).</span></span> 
    
-  <span data-ttu-id="44202-324">_ProjectGhostTaskAreStale_ &ndash; 与 _ProjectHierarchyNotSynchronized_ 类似，但会针对跨项目链接数据发出警告。</span><span class="sxs-lookup"><span data-stu-id="44202-324">_ProjectGhostTaskAreStale_ &ndash; Similar to  _ProjectHierarchyNotSynchronized_, but warns on cross-project link data.</span></span> <span data-ttu-id="44202-325">可以没有主项目，但链接一端的项目数据比另一端的项目数据更新。</span><span class="sxs-lookup"><span data-stu-id="44202-325">It is possible that no master project exists, but the project data on one side of the link is newer than on the other side.</span></span>
    
## <a name="about-accessing-the-project-server-database"></a><span data-ttu-id="44202-326">有关访问 Project Server 数据库</span><span class="sxs-lookup"><span data-stu-id="44202-326">About accessing the Project Server database</span></span>
<span data-ttu-id="44202-327"><a name="pj15_Programmability_Databases"> </a></span><span class="sxs-lookup"><span data-stu-id="44202-327"><a name="pj15_Programmability_Databases"> </a></span></span>

<span data-ttu-id="44202-328">如果你在 Microsoft SQL Server 中具有访问 Project Server 数据库的权限，则可以读取报告表和视图。</span><span class="sxs-lookup"><span data-stu-id="44202-328">If you have permissions in Microsoft SQL Server to access the Project Server database, you can read the reporting tables and views.</span></span> <span data-ttu-id="44202-329">如果你具有必要的 Project Server 权限，则还可以使用 OData 查询从报告表中读取数据。</span><span class="sxs-lookup"><span data-stu-id="44202-329">If you have the necessary Project Server permissions, you can also read data from the reporting tables by using OData queries.</span></span> <span data-ttu-id="44202-330">强烈建议开发人员不要通过 Project Server 数据库中的 SQL Server 查询直接访问草稿、已发布或存档的表格。</span><span class="sxs-lookup"><span data-stu-id="44202-330">Developers are strongly discouraged from directly accessing the draft, published, or archive tables through SQL Server queries in the Project Server database.</span></span> <span data-ttu-id="44202-331">在 Project Server 数据库的任何表格中直接进行更改可能会破坏引用的完整性，并通过 Project Server 队列服务干扰数据库访问。</span><span class="sxs-lookup"><span data-stu-id="44202-331">Making direct changes in any of the tables in the Project Server database can damage referential integrity and interfere with database access through the Project Server Queuing Service.</span></span>
  
> [!IMPORTANT]
> <span data-ttu-id="44202-p157">任何项目都不会主动阻止您使用直接编程数据库访问来更新数据。您应知道，Project Professional 缓存、已发布的表和报告表都依赖于可由直接数据编辑中断的缓存同步协议。在此警告您，如果您由于使用直接访问更改数据而破坏了 Project Server 数据库或损坏了 Project Professional 客户端缓存，产品支持将无法提供帮助！</span><span class="sxs-lookup"><span data-stu-id="44202-p157">There is nothing to actively prevent you from using direct programmatic database access to update data. You should be aware that the Project Professional cache, the published tables, and the reporting tables all rely on a cache synchronization protocol that can be disrupted by direct data editing. If you damage your Project Server database or corrupt Project Professional client-side caches by using direct access to change data, be warned that product support won't be able to help!</span></span> 
  
<span data-ttu-id="44202-335">直接访问草稿、已发布或存档表和视图的应用程序也依赖于数据库架构，它们可能会在 Project Server 2013 的服务包或更高版本中发生更改。</span><span class="sxs-lookup"><span data-stu-id="44202-335">Applications that directly access the draft, published, or archive tables and views are also dependent on the database schemas, which can change in service packs or later versions of Project Server 2013.</span></span> <span data-ttu-id="44202-336">直接访问数据库的应用程序还会失去 Project Server 内置安全性、常见业务逻辑、跟踪、审计、错误检查、报告、工作流和其他功能。</span><span class="sxs-lookup"><span data-stu-id="44202-336">Applications that directly access the databases also lose the built-in Project Server security, common business logic, tracking, audits, error checking, reporting, workflow, and other features.</span></span> <span data-ttu-id="44202-337">在 Project Server 2013 更新后，你可能需要重写此类应用程序。</span><span class="sxs-lookup"><span data-stu-id="44202-337">You would likely have to rewrite such an application after Project Server 2013 updates.</span></span> 
  
<span data-ttu-id="44202-338">出于上述所有原因，Project Professional 和 Project Web App 不会直接调用草稿、已发布或存档表；与 Project Server 集成的任何其他应用程序也不应这样做。</span><span class="sxs-lookup"><span data-stu-id="44202-338">For all of these reasons, Project Professional and Project Web App do not make direct calls to the draft, published, or archive tables; neither should any other application that integrates with Project Server.</span></span>
  
<span data-ttu-id="44202-339">草稿、已发布和存档表的架构未编档。</span><span class="sxs-lookup"><span data-stu-id="44202-339">The schemas for the draft, published, and archive tables are not documented.</span></span> <span data-ttu-id="44202-340">可以使用报告表来帮助生成报表，报告表和视图的架构将编档在 Project 2013 SDK 下载中。</span><span class="sxs-lookup"><span data-stu-id="44202-340">You can use the reporting tables to help generate reports, and the schema for the reporting tables and views is documented in the Project 2013 SDK download.</span></span> <span data-ttu-id="44202-341">有关报告数据的 OData 架构，请参阅 [ProjectData - Project OData 服务引用](https://docs.microsoft.com/previous-versions/office/project-odata/jj163015(v=office.15))。</span><span class="sxs-lookup"><span data-stu-id="44202-341">For the OData schema of the reporting data, see [ProjectData - Project OData service reference](https://docs.microsoft.com/previous-versions/office/project-odata/jj163015(v=office.15)).</span></span>
  
## <a name="see-also"></a><span data-ttu-id="44202-342">另请参阅</span><span class="sxs-lookup"><span data-stu-id="44202-342">See also</span></span>

- [<span data-ttu-id="44202-343">Project 2013 中面向开发人员的更新</span><span class="sxs-lookup"><span data-stu-id="44202-343">Updates for developers in Project 2013</span></span>](updates-for-developers-in-project-2013.md)    
- [<span data-ttu-id="44202-344">Project Server 2013 体系结构</span><span class="sxs-lookup"><span data-stu-id="44202-344">Project Server 2013 architecture</span></span>](project-server-2013-architecture.md)    
- [<span data-ttu-id="44202-345">PSI 执行和不执行的操作</span><span class="sxs-lookup"><span data-stu-id="44202-345">What the PSI does and does not do</span></span>](what-the-psi-does-and-does-not-do.md)   
- [<span data-ttu-id="44202-346">CSOM 执行和不执行的操作</span><span class="sxs-lookup"><span data-stu-id="44202-346">What the CSOM does and does not do</span></span>](what-the-csom-does-and-does-not-do.md)    
- [<span data-ttu-id="44202-347">Project 2013 的客户端对象模型 (CSOM)</span><span class="sxs-lookup"><span data-stu-id="44202-347">Client-side object model (CSOM) for Project 2013</span></span>](client-side-object-model-csom-for-project-2013.md)    
- [<span data-ttu-id="44202-348">开始开发 Project Server 工作流</span><span class="sxs-lookup"><span data-stu-id="44202-348">Getting started developing Project Server workflows</span></span>](getting-started-developing-project-server-workflows.md)    
- [<span data-ttu-id="44202-349">Project 2013 编程参考</span><span class="sxs-lookup"><span data-stu-id="44202-349">Project 2013 programming references</span></span>](project-2013-programming-references.md)    
- [<span data-ttu-id="44202-350">Project PSI 参考概述</span><span class="sxs-lookup"><span data-stu-id="44202-350">Project PSI reference overview</span></span>](project-psi-reference-overview.md)    
- [<span data-ttu-id="44202-351">创建自定义操作以部署 SharePoint 应用程序</span><span class="sxs-lookup"><span data-stu-id="44202-351">Create custom actions to deploy with apps for SharePoint</span></span>](https://docs.microsoft.com/sharepoint/dev/sp-add-ins/create-custom-actions-to-deploy-with-sharepoint-add-ins)    
- [<span data-ttu-id="44202-352">Project 2010 中的非活动任务简介</span><span class="sxs-lookup"><span data-stu-id="44202-352">Introducing Inactive Tasks in Project 2010</span></span>](https://blogs.msdn.com/b/project/archive/2010/06/10/introducing-inactive-tasks-in-project-2010.aspx)    
- [<span data-ttu-id="44202-353">Project Server 2010：在 Web、PSI 和 Project Professional 上创建计划</span><span class="sxs-lookup"><span data-stu-id="44202-353">Project Server 2010: Scheduling on the Web, the PSI and Project Professional</span></span>](https://blogs.msdn.microsoft.com/brismith/2010/09/10/project-server-2010-scheduling-on-the-web-the-psi-and-project-professional/)

