---
title: Project Server 体系结构
manager: soliver
ms.date: 05/17/2019
ms.audience: Developer
ms.assetid: 2cfa5a6e-2f5c-440c-b35a-bc7a34648f9c
description: Project Server 2013 在整个 SharePoint 场中集成项目管理功能，并支持结合使用 Project Online 与客户端对象模型 (CSOM) 和用于报告数据的 OData 接口。
localization_priority: Priority
ms.openlocfilehash: fd940c9ae74e04587cdfa83354b6ee71da21073c
ms.sourcegitcommit: e2cff03cb13d6c500942897b234db00476a72f18
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/16/2019
ms.locfileid: "34100893"
---
# <a name="project-server-architecture"></a><span data-ttu-id="1f80a-103">Project Server 体系结构</span><span class="sxs-lookup"><span data-stu-id="1f80a-103">Project Server architecture</span></span>

<span data-ttu-id="1f80a-104">Project Server 2013 在整个 SharePoint 场中集成项目管理功能，并支持结合使用 Project Online 与客户端对象模型 (CSOM) 和用于报告数据的 OData 接口。</span><span class="sxs-lookup"><span data-stu-id="1f80a-104">Project Server 2013 integrates project management functionality throughout a SharePoint farm and enables the use of Project Online with a client-side object model (CSOM) and an OData interface for the Reporting data.</span></span>
   
<span data-ttu-id="1f80a-105">作为多层次系统，Project Server 2013 扩展了 Office Project Server 2007 中引入的体系结构。</span><span class="sxs-lookup"><span data-stu-id="1f80a-105">Project Server 2013 is a multitiered system that extends the architecture introduced in Office Project Server 2007.</span></span> <span data-ttu-id="1f80a-106">体系结构更改包括关联 Project Application Service 与 SharePoint 网站集、添加了 Web 前端 (WFE) 上的一些业务对象、用于远程访问的客户端对象模型 (CSOM)、单个 Project 数据库、用于报告表格和视图的 OData 接口、在云中或本地服务器上通过 Workflow Manager Client 1.0 集成 Windows Workflow Foundation 版本 4 (WF4)，以及可供多个 Project Server 安装访问的远程事件接收器。</span><span class="sxs-lookup"><span data-stu-id="1f80a-106">Architectural changes include association of the Project Application Service with SharePoint site collections, the addition of some business objects on the web front-end (WFE), the client-side object model (CSOM) for remote access, a single Project database, an OData interface for the Reporting tables and views, integration of Windows Workflow Foundation version 4 (WF4) through Workflow Manager Client 1.0 in the cloud or on a local server, and remote event receivers that are accessible by multiple Project Server installations.</span></span> <span data-ttu-id="1f80a-107">除了本地自定义解决方案外，还可以创建包含远程事件接收器和访问 CSOM 和 OData 接口的组件的应用。</span><span class="sxs-lookup"><span data-stu-id="1f80a-107">In addition to on-premises custom solutions, you can create apps that include remote event receivers and components that access the CSOM and OData interfaces.</span></span>
  
<span data-ttu-id="1f80a-108">前端层包括 Project Professional 2013、Project Web App 和第三方应用。</span><span class="sxs-lookup"><span data-stu-id="1f80a-108">The front-end tier includes Project Professional 2013, Project Web App, and third-party apps.</span></span> <span data-ttu-id="1f80a-109">客户端应用通过 Project Server 接口 (PSI) 或 CSOM 终结点与中间层通信，进而与 PSI 和业务对象层通信。</span><span class="sxs-lookup"><span data-stu-id="1f80a-109">Client applications communicate with the middle tier through the Project Server Interface (PSI) or through the CSOM endpoints, which in turn communicate with the PSI and the business object layer.</span></span> <span data-ttu-id="1f80a-110">数据库访问集成在业务对象中。</span><span class="sxs-lookup"><span data-stu-id="1f80a-110">Database access is integrated in the business objects.</span></span> <span data-ttu-id="1f80a-111">Project Server 事件系统可以同时访问本地事件处理程序和远程事件接收器。</span><span class="sxs-lookup"><span data-stu-id="1f80a-111">The Project Server Eventing System can access both local event handlers and remote event receivers.</span></span> <span data-ttu-id="1f80a-112">Project Calculation Service 在 Project Server 中实现 Project Professional 日程安排引擎。</span><span class="sxs-lookup"><span data-stu-id="1f80a-112">The Project Calculation Service implements the Project Professional scheduling engine within Project Server.</span></span> <span data-ttu-id="1f80a-113">客户端应用不（或不得）直接访问 Project 数据库；Project Server 对客户端隐藏业务对象。</span><span class="sxs-lookup"><span data-stu-id="1f80a-113">Client applications do not (or should not) directly access the Project database; Project Server hides business objects from clients.</span></span>
  
> [!NOTE]
> <span data-ttu-id="1f80a-114">Project Server 是在 SharePoint 体系结构的基础之上构建而成。</span><span class="sxs-lookup"><span data-stu-id="1f80a-114">Project Server is built on the SharePoint architecture.</span></span> <span data-ttu-id="1f80a-115">若要了解 SharePoint Server 2013 体系结构和 SharePoint 应用模型，请参阅 Office 2013 开发人员文档中的 *SharePoint 开发入门*部分。</span><span class="sxs-lookup"><span data-stu-id="1f80a-115">For information about SharePoint Server 2013 architecture and the SharePoint app model, see the  *Getting started with SharePoint development*  section in the Office 2013 developer documentation.</span></span> 

<span data-ttu-id="1f80a-116"><a name="pj15_Architecture_SharePoint"> </a></span><span class="sxs-lookup"><span data-stu-id="1f80a-116"><a name="pj15_Architecture_SharePoint"> </a></span></span>

## <a name="integrating-with-sharepoint-site-collections"></a><span data-ttu-id="1f80a-117">与 SharePoint 网站集集成</span><span class="sxs-lookup"><span data-stu-id="1f80a-117">Integrating with SharePoint site collections</span></span>

<span data-ttu-id="1f80a-118">Project Server 2013 中的 Project Application Service 可以与 SharePoint 网站集关联，以用于 SharePoint 任务列表。Project Application Service 还可以将 SharePoint 任务列表导入为企业项目，以获取完全 Project Server 控制。</span><span class="sxs-lookup"><span data-stu-id="1f80a-118">The Project Application Service in Project Server 2013 can be associated with a SharePoint site collection for use with SharePoint tasks lists, The Project Application Service can also import a SharePoint tasks list as an enterprise project for full Project Server control.</span></span> <span data-ttu-id="1f80a-119">借助 SharePoint 任务列表，SharePoint 可以维护网站集中的项目网站；Project Professional 可以与任务列表同步，并更新任务列表。</span><span class="sxs-lookup"><span data-stu-id="1f80a-119">With a SharePoint tasks list, SharePoint maintains the project site in a site collection; Project Professional can synchronize with and update the tasks list.</span></span> <span data-ttu-id="1f80a-120">项目网站可以是独立的 SharePoint 任务列表，也可以是与 .mpp 文件同步的任务列表；.mpp 文件可以存储在本地，也可以存储在 SharePoint 库中。</span><span class="sxs-lookup"><span data-stu-id="1f80a-120">A project site can be an independent SharePoint tasks list or a tasks list that is synchronized with an .mpp file; the .mpp file can be stored locally or in a SharePoint library.</span></span> 
  
<span data-ttu-id="1f80a-121">Project Server 在可完全控制时维护项目；Project Professional 将数据直接保存到 Project Server 中。</span><span class="sxs-lookup"><span data-stu-id="1f80a-121">Project Server maintains the projects when it has full control; Project Professional saves data directly to Project Server.</span></span> <span data-ttu-id="1f80a-122">表 1 比较了任务列表、日程安排 Web 部件和其他功能在便于 SharePoint 控制任务列表时的行为与在 Project Server 可完全控制时针对已导入项目的行为。</span><span class="sxs-lookup"><span data-stu-id="1f80a-122">Table 1 compares the behavior of a tasks list, the Schedule web part, and other functionality for SharePoint control of tasks lists and for imported projects when Project Server has full control.</span></span> <span data-ttu-id="1f80a-123">日程安排 Web 部件在 Project Web App 页中有网格，可便于编辑项目日程安排。</span><span class="sxs-lookup"><span data-stu-id="1f80a-123">The Schedule web part contains the grid on the Project Web App page where you can edit a project schedule.</span></span> <span data-ttu-id="1f80a-124">在绑定模式中，可以同时为任务和时间表一次输入状态数据；在单一输入模式中，任务和时间表的状态数据是分开输入的。</span><span class="sxs-lookup"><span data-stu-id="1f80a-124">The tied mode is where statusing data is entered once for both tasks and timesheets; in single entry mode, task statusing data is entered separately from timesheets.</span></span>
  
<span data-ttu-id="1f80a-125">**表 1：比较 SharePoint 任务列表和完全控制**</span><span class="sxs-lookup"><span data-stu-id="1f80a-125">**Table 1. Comparison of SharePoint task lists and full control**</span></span>

| <span data-ttu-id="1f80a-126">功能</span><span class="sxs-lookup"><span data-stu-id="1f80a-126">Feature</span></span> | <span data-ttu-id="1f80a-127">任务列表</span><span class="sxs-lookup"><span data-stu-id="1f80a-127">Task list</span></span> | <span data-ttu-id="1f80a-128">完全控制</span><span class="sxs-lookup"><span data-stu-id="1f80a-128">Full-control</span></span> |
|:-----|:-----|:-----|
|<span data-ttu-id="1f80a-129">**SharePoint 中的任务列表**</span><span class="sxs-lookup"><span data-stu-id="1f80a-129">**Task list in SharePoint**</span></span> <br/> |<span data-ttu-id="1f80a-130">读/写</span><span class="sxs-lookup"><span data-stu-id="1f80a-130">Read/write</span></span>  <br/> |<span data-ttu-id="1f80a-131">只读</span><span class="sxs-lookup"><span data-stu-id="1f80a-131">Read-only</span></span>  <br/> |
|<span data-ttu-id="1f80a-132">**日程安排 Web 部件**</span><span class="sxs-lookup"><span data-stu-id="1f80a-132">**Schedule web part**</span></span> <br/> |<span data-ttu-id="1f80a-133">只读</span><span class="sxs-lookup"><span data-stu-id="1f80a-133">Read-only</span></span>  <br/> |<span data-ttu-id="1f80a-134">读/写</span><span class="sxs-lookup"><span data-stu-id="1f80a-134">Read/write</span></span>  <br/> |
|<span data-ttu-id="1f80a-135">**报告**</span><span class="sxs-lookup"><span data-stu-id="1f80a-135">**Reporting**</span></span> <br/> |<span data-ttu-id="1f80a-136">通过 Project Server 的丰富报告</span><span class="sxs-lookup"><span data-stu-id="1f80a-136">Rich reporting through Project Server</span></span>  <br/> |<span data-ttu-id="1f80a-137">通过 Project Server 的丰富报告</span><span class="sxs-lookup"><span data-stu-id="1f80a-137">Rich reporting through Project Server</span></span>  <br/> |
|<span data-ttu-id="1f80a-138">**其他 Project Server 功能**</span><span class="sxs-lookup"><span data-stu-id="1f80a-138">**Other Project Server functionality**</span></span> <br/> | <span data-ttu-id="1f80a-139">已屏蔽功能：</span><span class="sxs-lookup"><span data-stu-id="1f80a-139">Blocked functionality:</span></span>  <br/><span data-ttu-id="1f80a-140">- 服务器端项目编辑（使用 Project Web App 或自定义客户端应用）</span><span class="sxs-lookup"><span data-stu-id="1f80a-140">- Server-side project edits, with Project Web App or custom client applications</span></span>  <br/><span data-ttu-id="1f80a-141">- 状态</span><span class="sxs-lookup"><span data-stu-id="1f80a-141">- Statusing</span></span>  <br/><span data-ttu-id="1f80a-142">- 任务在绑定模式中不可见</span><span class="sxs-lookup"><span data-stu-id="1f80a-142">- Tasks are not visible in tied mode</span></span>  <br/> |<span data-ttu-id="1f80a-143">完整功能已启用</span><span class="sxs-lookup"><span data-stu-id="1f80a-143">Full functionality is enabled</span></span>  <br/> |
   
### <a name="managing-projects-as-sharepoint-task-lists"></a><span data-ttu-id="1f80a-144">将项目作为 SharePoint 任务列表进行管理</span><span class="sxs-lookup"><span data-stu-id="1f80a-144">Managing projects as SharePoint task lists</span></span>
<span data-ttu-id="1f80a-145"><a name="pj15_Architecture_VisibilityMode"> </a></span><span class="sxs-lookup"><span data-stu-id="1f80a-145"><a name="pj15_Architecture_VisibilityMode"> </a></span></span>

<span data-ttu-id="1f80a-146">如果 Project Server 已与 SharePoint 一直控制的 SharePoint 网站集关联，虽然文档库中的任务列表和 Project Professional 2013 (.mpp) 文件对 Project Application Service 可见，但 SharePoint 会维护主数据以供同步（见图 1）。</span><span class="sxs-lookup"><span data-stu-id="1f80a-146">When Project Server is associated with a SharePoint site collection where SharePoint maintains control, task lists and Project Professional 2013 (.mpp) files in document libraries are visible to the Project Application Service, but SharePoint maintains the master data for synchronization (see Figure 1).</span></span> <span data-ttu-id="1f80a-147">无法使用日程安排 Web 部件进行服务器端日程安排。</span><span class="sxs-lookup"><span data-stu-id="1f80a-147">Server-side scheduling with the Schedule web part cannot be done.</span></span> <span data-ttu-id="1f80a-148">可使用 Project Professional 与项目网站中的任务列表同步，并编辑任务列表。</span><span class="sxs-lookup"><span data-stu-id="1f80a-148">You can use Project Professional to synchronize with and edit the task list in a project site.</span></span> <span data-ttu-id="1f80a-149">从 SharePoint 任务列表入手，组织可以逐渐发展为使用 Project Server 的完整功能。</span><span class="sxs-lookup"><span data-stu-id="1f80a-149">By starting with SharePoint task lists, organizations can gradually evolve to use the full functionality of Project Server.</span></span>
  
<span data-ttu-id="1f80a-150">图 1 展示了以下在 SharePoint 任务列表中维护项目的过程：</span><span class="sxs-lookup"><span data-stu-id="1f80a-150">Figure 1 shows the following processes when projects are maintained in SharePoint task lists:</span></span> 
  
- <span data-ttu-id="1f80a-151">(A) Project Professional 可以与任务列表同步，并在与 Project Application Service 建立关联之前或之后在网站集中创建新的项目网站。</span><span class="sxs-lookup"><span data-stu-id="1f80a-151">(A) Project Professional can synchronize with task lists and create new project sites in the site collection either before or after association with the Project Application Service.</span></span>
    
- <span data-ttu-id="1f80a-152">(B) Project Server 将与项目网站数据同步以进行报告，而 SharePoint 将维护主数据；任务列表保持读/写。</span><span class="sxs-lookup"><span data-stu-id="1f80a-152">(B) Project Server synchronizes with project site data for reporting purposes, but SharePoint maintains the master data; task lists remain read/write.</span></span>
    
- <span data-ttu-id="1f80a-p107">(C) 在建立关联后，Project Professional 可创建新的项目，并将项目保存或发布到 Project Server。Project Professional 中的活动缓存将与 Project Server 保持数据同步。</span><span class="sxs-lookup"><span data-stu-id="1f80a-p107">(C) After association, Project Professional can create new projects and save or publish to Project Server. The Active Cache in Project Professional maintains data synchronization with Project Server.</span></span>
    
- <span data-ttu-id="1f80a-155">(D) 当新项目在 Project Professional 中发布后，用户可以视需要创建项目的项目网站。</span><span class="sxs-lookup"><span data-stu-id="1f80a-155">(D) When a new project is published in Project Professional, the user has the option of creating a project site for the project.</span></span> <span data-ttu-id="1f80a-156">也可以在 Project Web App 中创建 SharePoint 任务列表项目类型或完全控制企业项目类型 (EPT) 的项目。</span><span class="sxs-lookup"><span data-stu-id="1f80a-156">A project can also be created in Project Web App as a SharePoint task list project type or as a full-control enterprise project type (EPT).</span></span> <span data-ttu-id="1f80a-157">步骤 (D) 展示的是完全控制 EPT。</span><span class="sxs-lookup"><span data-stu-id="1f80a-157">Step (D) shows the full-control EPT.</span></span>
    
<span data-ttu-id="1f80a-158">**图 1：将项目网站用作 SharePoint 任务列表**</span><span class="sxs-lookup"><span data-stu-id="1f80a-158">**Figure 1. Using project sites as SharePoint task lists**</span></span>

<span data-ttu-id="1f80a-159">![在可见性模式中使用项目网站](media/pj15_Architecture_VisibilityMode.gif "在可见性模式中使用项目网站")</span><span class="sxs-lookup"><span data-stu-id="1f80a-159">![Using project sites in visibility mode](media/pj15_Architecture_VisibilityMode.gif "Using project sites in visibility mode")</span></span>

<br/>

### <a name="managing-projects-with-full-control"></a><span data-ttu-id="1f80a-160">在可完全控制时管理项目</span><span class="sxs-lookup"><span data-stu-id="1f80a-160">Managing projects with full control</span></span>
<span data-ttu-id="1f80a-161"><a name="pj15_Architecture_ManagedMode"> </a></span><span class="sxs-lookup"><span data-stu-id="1f80a-161"><a name="pj15_Architecture_ManagedMode"> </a></span></span>

<span data-ttu-id="1f80a-162">如果 Project Server 已与网站集关联且可完全控制，Project Server 既可以将 SharePoint 任务列表导入为企业项目，也可以删除任何相关的 .mpp 文件。</span><span class="sxs-lookup"><span data-stu-id="1f80a-162">When Project Server is associated with a site collection and has full control, Project Server imports SharePoint task lists as enterprise projects, and can delete any related .mpp files.</span></span> <span data-ttu-id="1f80a-163">Project Server 维护主数据，以执行任务列表同步；网站集中的任务列表变为只读（见图 2）。</span><span class="sxs-lookup"><span data-stu-id="1f80a-163">Project Server maintains the master data for task list synchronization; task lists in the site collection become read-only (see Figure 2).</span></span> <span data-ttu-id="1f80a-164">可使用 Project Professional 或 Project Web App 编辑已导入项目。</span><span class="sxs-lookup"><span data-stu-id="1f80a-164">Imported projects can be edited by using Project Professional or by using Project Web App.</span></span>
  
> [!NOTE]
> <span data-ttu-id="1f80a-p110">在 Project Server 导入一个项目后，用户可选择是从网站中删除该项目，还是在编辑项目前断开连接。可以在 Project Professional 中作出选择。</span><span class="sxs-lookup"><span data-stu-id="1f80a-p110">After Project Server imports a project, the user chooses whether to delete the project from the site or break the connection before editing the project. You can make the choice in Project Professional.</span></span> 
  
<span data-ttu-id="1f80a-167">图 2 显示了当 Project Server 使用完全控制权维护企业项目时的以下过程：</span><span class="sxs-lookup"><span data-stu-id="1f80a-167">Figure 2 shows the following processes when Project Server maintains enterprise projects with full control:</span></span>
  
- <span data-ttu-id="1f80a-p111">(A) 用户可以选择要导入的项目网站。Project Server 会导入这些项目网站，并（可选）删除关联的 .mpp 文件。导入的项目的 SharePoint 任务列表会变为只读。</span><span class="sxs-lookup"><span data-stu-id="1f80a-p111">(A) The user can choose which project sites to import. Project Server imports the project sites, and optionally deletes associated .mpp files. The SharePoint task list of an imported project becomes read-only.</span></span>
    
- <span data-ttu-id="1f80a-171">(B) 在建立关联后，Project Professional 新建项目，并将项目保存或发布到 Project Server 中。</span><span class="sxs-lookup"><span data-stu-id="1f80a-171">(B) After association, Project Professional creates new projects and saves or publishes to Project Server.</span></span> <span data-ttu-id="1f80a-172">Project Professional 中的活动缓存与 Project Server 保持数据同步。</span><span class="sxs-lookup"><span data-stu-id="1f80a-172">The Active Cache in Project Professional maintains data synchronization with Project Server.</span></span> <span data-ttu-id="1f80a-173">Project Web App 中的日程安排 Web 部件可以执行服务器端日程安排。</span><span class="sxs-lookup"><span data-stu-id="1f80a-173">The Schedule web part in Project Web App can do server-side scheduling.</span></span>
    
- <span data-ttu-id="1f80a-174">(C) 当新项目在 Project Professional 中发布后，用户可以视需要创建项目的项目网站。</span><span class="sxs-lookup"><span data-stu-id="1f80a-174">(C) When a new project is published in Project Professional, the user has the option of creating a project site for the project.</span></span> <span data-ttu-id="1f80a-175">也可以在 Project Web App 中创建类型为完全控制 EPT 的项目，并作为只读任务列表发布到网站集中的项目网站。</span><span class="sxs-lookup"><span data-stu-id="1f80a-175">A project can also be created in Project Web App with a full-control EPT and published with a read-only task list to a project site in the site collection.</span></span>
    
<span data-ttu-id="1f80a-176">**图 2：在可完全控制时使用项目网站**</span><span class="sxs-lookup"><span data-stu-id="1f80a-176">**Figure 2. Using project sites with full control**</span></span>

<span data-ttu-id="1f80a-177">![在托管模式中使用项目网站](media/pj15_Architecture_ManagedMode.gif "在托管模式中使用项目网站")</span><span class="sxs-lookup"><span data-stu-id="1f80a-177">![Using project sites in managed mode](media/pj15_Architecture_ManagedMode.gif "Using project sites in managed mode")</span></span>
  
## <a name="general-architecture"></a><span data-ttu-id="1f80a-178">常规体系结构</span><span class="sxs-lookup"><span data-stu-id="1f80a-178">General architecture</span></span>
<span data-ttu-id="1f80a-179"><a name="pj15_Architecture_General"> </a></span><span class="sxs-lookup"><span data-stu-id="1f80a-179"><a name="pj15_Architecture_General"> </a></span></span>

<span data-ttu-id="1f80a-180">图 3 展示了 Project Server 2013 体系结构的概括视图，包括 Project Service Application、WFE 上的一个 Project Web App 实例，以及其他几个客户端应用（包括 Project Professional 2013）。</span><span class="sxs-lookup"><span data-stu-id="1f80a-180">Figure 3 shows a generalized view of the Project Server 2013 architecture, including the Project Service Application, one Project Web App instance on a WFE, and several other client applications including Project Professional 2013.</span></span>
  
<span data-ttu-id="1f80a-181">可以有多个 Project Web App 实例与后端 Project Service Application 通信。</span><span class="sxs-lookup"><span data-stu-id="1f80a-181">There can be multiple Project Web App instances that communicate with the back-end Project Service Application.</span></span> <span data-ttu-id="1f80a-182">对于本地安装，WFE 可以位于 SharePoint 场的独立服务器上，也可以与 Project Service Application 位于同一个 SharePoint 服务器上。</span><span class="sxs-lookup"><span data-stu-id="1f80a-182">For an on-premises installation, the WFE can be on a separate server in a SharePoint farm, or it can be on the same SharePoint server with the Project Service Application.</span></span> <span data-ttu-id="1f80a-183">Project Online 包括 WFE、Project Service Application 和本地或远程 Workflow Manager Client 1.0 服务器。</span><span class="sxs-lookup"><span data-stu-id="1f80a-183">Project Online includes a WFE, the Project Service Application, and a local or remote Workflow Manager Client 1.0 server.</span></span> 
  
<span data-ttu-id="1f80a-184">**图 3：常规 Project Server 2013 体系结构**</span><span class="sxs-lookup"><span data-stu-id="1f80a-184">**Figure 3. General Project Server 2013 architecture**</span></span>

<span data-ttu-id="1f80a-185">![Project Server 体系结构](media/pj15_Architecture_ProjectServiceApp_WFE.gif "Project Server 体系结构")</span><span class="sxs-lookup"><span data-stu-id="1f80a-185">![Project Server architecture](media/pj15_Architecture_ProjectServiceApp_WFE.gif "Project Server architecture")</span></span>

<br/>

<span data-ttu-id="1f80a-186">下面是图 3 的一般性注释：</span><span class="sxs-lookup"><span data-stu-id="1f80a-186">The following general comments apply to Figure 3:</span></span>
  
- <span data-ttu-id="1f80a-p115">**Project Online：** 可以创建使用 CSOM、REST 和 OData 接口的应用。应用包还可以在本地服务器、Azure 服务器或 Microsoft Azure 上的自定义 Web 服务中安装远程事件接收器。 Project Online 不支持第三方本地解决方案、WCF 接口、ASMX 接口或本地事件处理程序。</span><span class="sxs-lookup"><span data-stu-id="1f80a-p115">**Project Online:** You can create apps that use the CSOM, REST, and OData interfaces. An app package can also install remote event receivers in a custom web service on a local server, on an Azure server, or on Microsoft Azure. Project Online does not support third-party on-premises solutions, the WCF interface, the ASMX interface, or local event handlers.</span></span> 
    
- <span data-ttu-id="1f80a-p116">**事件接收器：** 事件接收器也可以称为"事件处理程序"。Project Online 支持注册远程 Project Server 事件接收器，可供云中的 Project Web App 实例或本地 Project Server 安装使用。本地 Project Server 安装支持远程事件接收器和本地完全信任事件处理程序。</span><span class="sxs-lookup"><span data-stu-id="1f80a-p116">**Event receivers:** Event receivers can also be called event handlers. Project Online supports registration of remote Project Server event receivers, which can be used by a Project Web App instance in the cloud or by an on-premises Project Server installation. An on-premises Project Server installation supports remote event receivers and local full-trust event handlers.</span></span> 
    
- <span data-ttu-id="1f80a-193">**浏览器：** 查看一些 Project Web App 页时，没有跨浏览器限制，就像在 Project Server 2010 中一样。</span><span class="sxs-lookup"><span data-stu-id="1f80a-193">**Browsers:** There are no cross-browser limitations on viewing some Project Web App pages, as there are in Project Server 2010.</span></span> <span data-ttu-id="1f80a-194">支持充分结合使用以下浏览器和 Project Web App：</span><span class="sxs-lookup"><span data-stu-id="1f80a-194">The following browsers are supported for full use with Project Web App:</span></span> 
    
  - <span data-ttu-id="1f80a-195">Internet Explorer 8.x（在 Windows 7 和旧版 Microsoft Windows 上）、Internet Explorer 9.x 和 Internet Explorer 10.x</span><span class="sxs-lookup"><span data-stu-id="1f80a-195">Internet Explorer 8.x (on Windows 7 and earlier versions of Microsoft Windows), Internet Explorer 9.x, and Internet Explorer 10.x</span></span> 
  - <span data-ttu-id="1f80a-196">Firefox 4.x（在 Windows、Mac OS-X 和 Linux/Unix 上）</span><span class="sxs-lookup"><span data-stu-id="1f80a-196">Firefox 4.x (on Windows, Mac OS-X, and Linux/Unix)</span></span>
  - <span data-ttu-id="1f80a-197">Safari 5.x（在 Windows 和 Mac OS-X 上）</span><span class="sxs-lookup"><span data-stu-id="1f80a-197">Safari 5.x (on Windows and Mac OS-X)</span></span>
  - <span data-ttu-id="1f80a-198">Chrome</span><span class="sxs-lookup"><span data-stu-id="1f80a-198">Chrome</span></span>
    
- <span data-ttu-id="1f80a-199">**编程接口：** 对于第三方应用，Project Online 公开了 HTTP/HTTPS 接口（包括 REST）、CSOM 接口、用于 CSOM 的 OData 服务，以及用于报告的 OData 服务。</span><span class="sxs-lookup"><span data-stu-id="1f80a-199">**Programmatic interfaces:** For third-party apps, Project Online exposes the HTTP/HTTPS interface (including REST), the CSOM interface, an OData service for the CSOM, and an OData service for reporting.</span></span> <span data-ttu-id="1f80a-200">对于本地（在 Intranet 上）第三方客户端应用，可以将 WCF 接口用于 PSI，也可以通过 HTTP 使用 CSOM、OData 和 REST 接口。</span><span class="sxs-lookup"><span data-stu-id="1f80a-200">For third-party client applications that are on-premises (on the Intranet), you can use the WCF interface for the PSI, or you can use the CSOM, OData, and REST interfaces through HTTP.</span></span> <span data-ttu-id="1f80a-201">Project Web App 和 Project Professional 2013 客户端均使用 WCF 接口。</span><span class="sxs-lookup"><span data-stu-id="1f80a-201">The Project Web App and Project Professional 2013 clients both use the WCF interface.</span></span> <span data-ttu-id="1f80a-202">在单一服务器安装中，前端 ASMX Web 服务、CSOM 和 REST 内部调用后端 WCF 服务。</span><span class="sxs-lookup"><span data-stu-id="1f80a-202">In a single-server installation, the front-end ASMX web services, CSOM, and REST internally call the back-end WCF services.</span></span> 
    
    > [!NOTE]
    > <span data-ttu-id="1f80a-203">用于 PSI 中 Web 服务的基于 SOAP 的 ASMX 接口虽然在 Project Server 2013 中仍可用，但已遭弃用。</span><span class="sxs-lookup"><span data-stu-id="1f80a-203">The SOAP-based ASMX interface for web services in the PSI is still available in Project Server 2013, but is deprecated.</span></span> 
  
    <span data-ttu-id="1f80a-p119">用于报表的 OData 服务由内部 OData.svc WCF 服务实现。可以使用  `https://ServerName/ProjectServerName/_api/ProjectData/$metadata` 为报表数据获取服务元数据文档。</span><span class="sxs-lookup"><span data-stu-id="1f80a-p119">The OData service for reporting is implemented by the internal OData.svc WCF service. You can get the Service Metadata Document for the reporting data by using  `https://ServerName/ProjectServerName/_api/ProjectData/$metadata`.</span></span> 
    
    <span data-ttu-id="1f80a-206">用于 CSOM 的 OData 服务旨在用于 Windows RT、iOS 和 Android 等平台。在这些平台中，可以在 HTML 页中结合使用 REST 接口和 JavaScript。</span><span class="sxs-lookup"><span data-stu-id="1f80a-206">The OData service for the CSOM is intended for platforms such as Windows RT, iOS, and Android, where you can use the REST interface with JavaScript in HTML pages.</span></span> 
    
    > [!NOTE]
    > <span data-ttu-id="1f80a-207">尽管用于 **ProjectData** 报告服务的 `$metadata` 选项有效，但 Project Server 2013 发行版中已删除用于 CSOM **ProjectServer** 服务的 `$metadata` 选项。</span><span class="sxs-lookup"><span data-stu-id="1f80a-207">Although the  `$metadata` option for the **ProjectData** reporting service is valid, the  `$metadata` option for the **ProjectServer** service of the CSOM is removed in the released version of Project Server 2013.</span></span> <span data-ttu-id="1f80a-208">若要详细了解用于 CSOM 的 REST 查询，请参阅 [Project Server 客户端对象模型 (CSOM)](client-side-object-model-csom-for-project-2013.md)。</span><span class="sxs-lookup"><span data-stu-id="1f80a-208">For more information about REST queries for the CSOM, see [Client-side object model (CSOM) for Project Server](client-side-object-model-csom-for-project-2013.md).</span></span> 
  
- <span data-ttu-id="1f80a-209">**PSI 转发器：** 以编程方式访问单独 WFE 上的 PSI 是通过 PSI 转发器（包括 WCF 转发器和 Web 服务转发器）完成。</span><span class="sxs-lookup"><span data-stu-id="1f80a-209">**PSI Forwarder:** Programmatic access to the PSI on a separate WFE goes through the PSI Forwarder, which includes a WCF Forwarder and a Web Service Forwarder.</span></span> <span data-ttu-id="1f80a-210">使用 ASMX 接口的客户端通过 Web 服务转发器访问 PSI。</span><span class="sxs-lookup"><span data-stu-id="1f80a-210">Clients that use the ASMX interface access the PSI through the Web Service Forwarder.</span></span> <span data-ttu-id="1f80a-211">使用 WCF 接口的客户端通过 WCF 转发器访问 PSI。</span><span class="sxs-lookup"><span data-stu-id="1f80a-211">Clients that use the WCF interface access the PSI through the WCF Forwarder.</span></span> <span data-ttu-id="1f80a-212">通过 CSOM、OData 和 REST 的编程访问是通过 WCF 转发器进行管道传递。</span><span class="sxs-lookup"><span data-stu-id="1f80a-212">Programmatic access through the CSOM, OData, and REST is piped through the WCF Forwarder.</span></span> 
    
- <span data-ttu-id="1f80a-213">**工作流：** 声明性工作流（SharePoint Designer 2013 中定义的工作流）被转移到 Workflow Manager Client 1.0 中处理。</span><span class="sxs-lookup"><span data-stu-id="1f80a-213">**Workflows:** Declarative workflows (workflows that are defined in SharePoint Designer 2013) are offloaded to Workflow Manager Client 1.0 for processing.</span></span> <span data-ttu-id="1f80a-214">Workflow Manager Client 1.0 可以在 SharePoint 场的独立服务器上运行，也可以在云中的 Microsoft Azure 上运行，亦可以在一台 Project Server 计算机中运行以供测试或演示。</span><span class="sxs-lookup"><span data-stu-id="1f80a-214">Workflow Manager Client 1.0 can run on a separate server in the SharePoint farm, on Microsoft Azure in the cloud, or on a single Project Server computer for testing or demonstrations.</span></span> <span data-ttu-id="1f80a-215">使用 Visual Studio 2012 开发的已编码工作流在 SharePoint 内的工作流运行时中进行处理，就像在 Project Server 2010 中一样。</span><span class="sxs-lookup"><span data-stu-id="1f80a-215">Coded workflows that are developed with Visual Studio 2012 are processed in the workflow runtime within SharePoint, as in Project Server 2010.</span></span> <span data-ttu-id="1f80a-216">有关详细信息，请参阅[开始开发 Project Server 工作流](getting-started-developing-project-server-workflows.md)。</span><span class="sxs-lookup"><span data-stu-id="1f80a-216">For more information, see [Getting started developing Project Server workflows](getting-started-developing-project-server-workflows.md).</span></span>
    
- <span data-ttu-id="1f80a-217">**外围网络 (DMZ)：** 在图 3 中，无法看出本地 WFE 服务器可以被外围网络（亦称为“隔离区 (DMZ)”）中的其他防火墙隔离。</span><span class="sxs-lookup"><span data-stu-id="1f80a-217">**Perimeter network (DMZ):** Figure 3 does not show that an on-premises WFE server can be isolated by an additional firewall in a perimeter network (also known as a "demilitarized zone" or DMZ).</span></span> <span data-ttu-id="1f80a-218">外围网络可以允许 Internet 客户端跨防火墙访问 SharePoint 和 Project Server。</span><span class="sxs-lookup"><span data-stu-id="1f80a-218">A perimeter network can allow Internet clients to access SharePoint and Project Server across a firewall.</span></span> 
    
- <span data-ttu-id="1f80a-219">**SharePoint Web 服务：** 图 3 并未展示 SharePoint 基础结构，如属于 SharePoint Server 2013 的后端 SharePoint Web 服务应用。</span><span class="sxs-lookup"><span data-stu-id="1f80a-219">**SharePoint Web Services:** Figure 3 does not show the SharePoint infrastructure, such as the back-end SharePoint Web Services application, which is part of SharePoint Server 2013.</span></span> <span data-ttu-id="1f80a-220">在你安装 Project Server 后，Project Service Application 就会被添加到 SharePoint Web 服务中。</span><span class="sxs-lookup"><span data-stu-id="1f80a-220">When you install Project Server, the Project Service Application is added to the SharePoint Web Services.</span></span> 
    
<span data-ttu-id="1f80a-p125">前端层包括第三方应用程序、Project Professional 和 Project Web App。浏览器在 Project Web App 中显示 ASP.NET 4.0 页面（.aspx 页面）。Project Web App 页面使用与 PSI 通信的 Project Server Web 部件，并使用标准 SharePoint Web 部件。</span><span class="sxs-lookup"><span data-stu-id="1f80a-p125">The front-end tier includes third-party applications, Project Professional, and Project Web App. A browser displays ASP.NET 4.0 pages (.aspx pages) in Project Web App. The Project Web App pages use Project Server Web Parts that communicate with the PSI and also use standard SharePoint Web Parts.</span></span> 
  
<span data-ttu-id="1f80a-224">中间层包括 PSI 和业务对象层，其中包含表示 Project Server 业务实体的逻辑对象。</span><span class="sxs-lookup"><span data-stu-id="1f80a-224">The middle tier includes the PSI and the business object layer, which consists of logical objects that represent Project Server business entities.</span></span> <span data-ttu-id="1f80a-225">业务实体包括项目、任务、资源、作业等。</span><span class="sxs-lookup"><span data-stu-id="1f80a-225">Business entities include Project, Task, Resource, Assignment, and so on.</span></span> <span data-ttu-id="1f80a-226">PSI 和业务对象层紧密结合，且位于同一服务器上。</span><span class="sxs-lookup"><span data-stu-id="1f80a-226">The PSI and the business object tier are tightly coupled and are located on the same server.</span></span> <span data-ttu-id="1f80a-227">客户端应用通过可用接口之一调用 PSI，PSI 调用业务对象。</span><span class="sxs-lookup"><span data-stu-id="1f80a-227">A client application calls the PSI through one of the available interfaces, and the PSI invokes business objects.</span></span> <span data-ttu-id="1f80a-228">为了提升性能，Project Server 2013 的 WFE 包括一些业务对象，适用于不使用 Project Server 队列系统或不需要 Project Calculation Service 的请求。</span><span class="sxs-lookup"><span data-stu-id="1f80a-228">For improved performance, the WFE of Project Server 2013 includes some business objects for requests that do not use the Project Server Queuing System or require the Project Calculation Service.</span></span> <span data-ttu-id="1f80a-229">WFE 业务对象直接与 Project 数据库通信。</span><span class="sxs-lookup"><span data-stu-id="1f80a-229">The WFE business objects communicate directly with the Project database.</span></span>
  
<span data-ttu-id="1f80a-230">Project Server 的 Project Web App 组件使用 SharePoint 2013 配置数据库进行项目网站设置，并对项目网站内容（如任务列表、自定义页、工作流、管理设置、文档、问题列表、风险和承诺）使用内容数据库。</span><span class="sxs-lookup"><span data-stu-id="1f80a-230">The Project Web App components of Project Server use the SharePoint 2013 configuration database for project site setup and the content database for project site content such as task lists, custom pages, workflows, management settings, documents, and lists of issues, risks, and commitments.</span></span> <span data-ttu-id="1f80a-231">SharePoint 配置数据库和内容数据库支持其他项目管理功能，如项目模板和工作区、用于团队协作的自定义列表和报告。</span><span class="sxs-lookup"><span data-stu-id="1f80a-231">The SharePoint configuration and content databases support additional features for project management, such as project templates and workspaces, custom lists for team collaboration, and reports.</span></span>
  
### <a name="project-web-app-and-the-wfe"></a><span data-ttu-id="1f80a-232">Project Web App 和 WFE</span><span class="sxs-lookup"><span data-stu-id="1f80a-232">Project Web App and the WFE</span></span>
<span data-ttu-id="1f80a-233"><a name="pj15_Architecture_PWAServer"> </a></span><span class="sxs-lookup"><span data-stu-id="1f80a-233"><a name="pj15_Architecture_PWAServer"> </a></span></span>

<span data-ttu-id="1f80a-234">可以在 WFE 上和在企业 Intranet 内的多台 WFE 服务器上配置多个 Project Web App 实例，从而为 Intranet 客户端启用负载分布。</span><span class="sxs-lookup"><span data-stu-id="1f80a-234">You can configure multiple Project Web App instances on a WFE and multiple WFE servers within a corporate intranet to enable load distribution for intranet clients.</span></span> <span data-ttu-id="1f80a-235">如果客户端应用使用独立 WFE 服务器上的 Project Web App 实例，PSI 调用通过 PSI 转发器进行路由。</span><span class="sxs-lookup"><span data-stu-id="1f80a-235">When a client application uses a Project Web App instance on a separate WFE server, PSI calls are routed through the PSI Forwarder.</span></span> <span data-ttu-id="1f80a-236">PSI 转发器（WCF 转发器或 Web 服务转发器）的职能如下：</span><span class="sxs-lookup"><span data-stu-id="1f80a-236">The PSI Forwarder (either the WCF Forwarder or the Web Service Forwarder) performs the following functions:</span></span>
  
- <span data-ttu-id="1f80a-237">优化远程客户端对 PSI 的调用。</span><span class="sxs-lookup"><span data-stu-id="1f80a-237">Optimizes calls to the PSI from remote clients.</span></span>
    
- <span data-ttu-id="1f80a-p129">区分需要 Project Server 队列服务的 PSI 调用和不需要该服务的 PSI 调用。异步 PSI 方法名称以 Queue 开头，如 **QueueCreateProject**。</span><span class="sxs-lookup"><span data-stu-id="1f80a-p129">Distinguishes between PSI calls that require the Project Server Queue Service, and those that do not. Asynchronous PSI method names begin with Queue, such as **QueueCreateProject**.</span></span>
    
- <span data-ttu-id="1f80a-240">标识调用已注册本地事件处理程序的 PSI 调用。</span><span class="sxs-lookup"><span data-stu-id="1f80a-240">Identifies PSI calls that invoke registered local event handlers.</span></span>
    
- <span data-ttu-id="1f80a-241">标识需要 Project Calculation Service 的 PSI 调用。</span><span class="sxs-lookup"><span data-stu-id="1f80a-241">Identifies PSI calls that require the Project Calculation Service.</span></span>
    
- <span data-ttu-id="1f80a-242">使用与 Project Professional 中的客户端活动缓存配合使用的基于服务器的缓存，以减少对 Project Server 的往返调用。</span><span class="sxs-lookup"><span data-stu-id="1f80a-242">Uses a server-based cache that works with the client-side Active Cache in Project Professional to reduce roundtrip calls to Project Server.</span></span>
    
<span data-ttu-id="1f80a-243">在 SharePoint Server 验证 Project Server 用户身份后，PSI 转发器会以透明方式将使用后端服务的请求发送到运行 Project Server 的计算机上的 PSI 服务。</span><span class="sxs-lookup"><span data-stu-id="1f80a-243">After SharePoint Server authenticates a Project Server user, the PSI Forwarder transparently sends requests that use back-end services to the PSI services on the computer running Project Server.</span></span> <span data-ttu-id="1f80a-244">无需使用后端服务的请求会发送到本地 Project Web App 实例中的业务对象。</span><span class="sxs-lookup"><span data-stu-id="1f80a-244">Requests that do not require back-end services are sent to the business objects in the local Project Web App instance.</span></span> <span data-ttu-id="1f80a-245">PSI 转发器提高了可伸缩性、性能和可靠性，以便能够通过 LAN、WAN 和在 Project Online 中执行 Project Server 处理工作。</span><span class="sxs-lookup"><span data-stu-id="1f80a-245">The PSI Forwarder improves scalability, performance, and reliability for Project Server processing over the LAN, a WAN, and in Project Online.</span></span>
  
<span data-ttu-id="1f80a-246">Project Web App 是使用 ASP.NET 4.0 开发而成。</span><span class="sxs-lookup"><span data-stu-id="1f80a-246">Project Web App is developed with ASP.NET 4.0.</span></span> <span data-ttu-id="1f80a-247">.aspx 文件中的可视化元素（HTML、服务器控件和静态文本）独立于已编译程序集（.dll 文件）内代码隐藏类中的编程逻辑。</span><span class="sxs-lookup"><span data-stu-id="1f80a-247">The visual elements in .aspx files (HTML, server controls, and static text) are separate from the programming logic in code-behind classes that are in compiled assemblies (.dll files).</span></span> <span data-ttu-id="1f80a-248">可使用 Web 部件自定义 Project Web App 中的网页，如顶级页、项目中心和报告中心。</span><span class="sxs-lookup"><span data-stu-id="1f80a-248">Site pages in Project Web App, such as the top-level page, Project Center, and Report Center, can be customized by using Web Parts.</span></span> <span data-ttu-id="1f80a-249">无法编辑在“网站操作”\*\*\*\* 菜单中没有“编辑页”\*\*\*\* 选项的应用页，如“服务器设置”页和“审核时间表”页。</span><span class="sxs-lookup"><span data-stu-id="1f80a-249">Application pages that do not have an **Edit Page** option in the **Site Actions** menu cannot be edited, such as the Server Settings page and the Review Timesheet page.</span></span> 
  
### <a name="the-csom-and-the-project-server-interface"></a><span data-ttu-id="1f80a-250">CSOM 和 Project Server 接口</span><span class="sxs-lookup"><span data-stu-id="1f80a-250">The CSOM and the Project Server Interface</span></span>
<span data-ttu-id="1f80a-251"><a name="pj15_Architecture_PSI"> </a></span><span class="sxs-lookup"><span data-stu-id="1f80a-251"><a name="pj15_Architecture_PSI"> </a></span></span>

<span data-ttu-id="1f80a-252">PSI 分成 22 个公共服务，如**项目**、**资源**、**自定义字段**和**状态**。</span><span class="sxs-lookup"><span data-stu-id="1f80a-252">The PSI is factored into 22 public services, such as **Project**, **Resource**, **CustomField**, and **Statusing**.</span></span> <span data-ttu-id="1f80a-253">PSI 还包含 7 个专用服务，以供内部使用。</span><span class="sxs-lookup"><span data-stu-id="1f80a-253">The PSI also contains seven private services for internal use.</span></span> <span data-ttu-id="1f80a-254">PSI 是 Project Server 的基本 API；它向 CSOM 和外部应用公开了 Project Server 功能。</span><span class="sxs-lookup"><span data-stu-id="1f80a-254">The PSI is the fundamental API of Project Server; it exposes Project Server functionality to the CSOM and to external applications.</span></span> <span data-ttu-id="1f80a-255">CSOM 包括可访问最常用 PSI 类的类，以及用于第三方应用的成员。</span><span class="sxs-lookup"><span data-stu-id="1f80a-255">The CSOM includes classes that access the most commonly used PSI classes and members that are used for third-party applications.</span></span> <span data-ttu-id="1f80a-256">在 Project Server 2013 中，一些 Project Server 功能在 CSOM 中不可用，如**管理员**、**日历**、**项目组合之分析**和**安全**服务。</span><span class="sxs-lookup"><span data-stu-id="1f80a-256">In Project Server 2013, some Project Server functionality is not available in the CSOM, such as the **Admin**, **Calendar**, **PortfolioAnalyses**, and **Security** services.</span></span> 
  
<span data-ttu-id="1f80a-257">Project Professional 2013 和 Project Web App 使用 PSI 访问 Project 数据库的草稿、已发布、存档表格和视图中的 Project Server 数据。</span><span class="sxs-lookup"><span data-stu-id="1f80a-257">Project Professional 2013 and Project Web App use the PSI to access Project Server data in the draft, published, and archive tables and views of the Project database.</span></span> <span data-ttu-id="1f80a-258">可以通过代理文件或代理程序集访问 PSI 服务（WCF 服务或 ASMX Web 服务）。</span><span class="sxs-lookup"><span data-stu-id="1f80a-258">You can access a PSI service through a proxy file or a proxy assembly, for either the WCF services or the ASMX web services.</span></span>
  
> [!NOTE]
> <span data-ttu-id="1f80a-259">CSOM 是第三方 Project Server 开发人员的首选接口；它可用于同时访问本地 Project Server 安装和 Project Online 的应用。</span><span class="sxs-lookup"><span data-stu-id="1f80a-259">The CSOM is the preferred interface for third-party Project Server developers; it can be used for applications that access both an on-premises Project Server installation and Project Online.</span></span> <span data-ttu-id="1f80a-260">如果 CSOM 包括应用所需的功能，建议使用 CSOM 开发新应用。</span><span class="sxs-lookup"><span data-stu-id="1f80a-260">We recommend that you use the CSOM for developing new applications, if the CSOM includes the functionality that your application requires.</span></span> 
  
<span data-ttu-id="1f80a-261">一些业务线 (LOB) 应用以及为 Project Server 2010 开发的其他第三方应用要求，PSI 服务尚未在 CSOM 中表示。</span><span class="sxs-lookup"><span data-stu-id="1f80a-261">Some line-of-business (LOB) applications and other third-party applications that were developed for Project Server 2010 require PSI services that are not yet represented in the CSOM.</span></span> <span data-ttu-id="1f80a-262">如果它们仅定目标到 Project Server 的本地安装，应用可以继续使用 PSI 的 WCF 接口或 ASMX 接口。</span><span class="sxs-lookup"><span data-stu-id="1f80a-262">If they target only an on-premises installation of Project Server, applications can continue to use the WCF interface or the ASMX interface of the PSI.</span></span>
  
<span data-ttu-id="1f80a-263">客户端应用通过服务代理调用 PSI。</span><span class="sxs-lookup"><span data-stu-id="1f80a-263">Client applications call the PSI through service proxies.</span></span> <span data-ttu-id="1f80a-264">使用 WCF 接口的客户端通过 `https://ServerName/ProjectServerName/_vti_bin/psi/ProjectServer.svc` 访问所有 PSI 服务。</span><span class="sxs-lookup"><span data-stu-id="1f80a-264">Clients that use the WCF interface access all PSI services through  `https://ServerName/ProjectServerName/_vti_bin/psi/ProjectServer.svc`.</span></span> <span data-ttu-id="1f80a-265">使用 ASMX Web 服务接口的客户端使用特定服务的 Project Web App URL。</span><span class="sxs-lookup"><span data-stu-id="1f80a-265">Clients that use an ASMX web service interface use the Project Web App URL for the specific service.</span></span> <span data-ttu-id="1f80a-266">例如，**资源**服务位于 `https://ServerName/ProjectServerName/_vti_bin/psi/resource.asmx?wsdl`。</span><span class="sxs-lookup"><span data-stu-id="1f80a-266">For example, the **Resource** service is at  `https://ServerName/ProjectServerName/_vti_bin/psi/resource.asmx?wsdl`.</span></span> <span data-ttu-id="1f80a-267">如果应用无法通过 Intranet 访问 Project Server，可使用外围网络中的 Project Web App 服务器（图 3 中未显示）。</span><span class="sxs-lookup"><span data-stu-id="1f80a-267">If applications do not have intranet access to Project Server, they can use a Project Web App server in a perimeter network (not shown in Figure 3).</span></span>
  
<span data-ttu-id="1f80a-268">图 4 针对 SharePoint Server 2013 单一服务器安装、Project Server 2013 和用于 Workflow Manager Client 1.0 的本地工作流管理网站，展示了 **Internet Information Services (IIS) 管理器**中的“连接”\*\*\*\* 窗格。</span><span class="sxs-lookup"><span data-stu-id="1f80a-268">Figure 4 shows the **Connections** pane in **Internet Information Services (IIS) Manager** for a single-server installation of SharePoint Server 2013, Project Server 2013, and a local Workflow Management site for Workflow Manager Client 1.0.</span></span> <span data-ttu-id="1f80a-269">SharePoint 网站集 (A) 在 `_vti_bin\PSI` 虚拟子目录中包括前端 PSI 服务。</span><span class="sxs-lookup"><span data-stu-id="1f80a-269">The SharePoint site collection (A) includes the front-end PSI services in the  `_vti_bin\PSI` virtual subdirectory.</span></span> <span data-ttu-id="1f80a-270">SharePoint Web 服务应用 (B) 在 `508c23fb7dfd4c83a8919fae24bc68c5/PSI` 虚拟子目录中包括 Project Service Application 以及后端 PSI 服务。</span><span class="sxs-lookup"><span data-stu-id="1f80a-270">The SharePoint Web Services application (B) includes the Project Service Application, with the back-end PSI services in the  `508c23fb7dfd4c83a8919fae24bc68c5/PSI` virtual subdirectory.</span></span> <span data-ttu-id="1f80a-271">GUID 是相应 Project Server 安装的 Project Service Application 实例名称。</span><span class="sxs-lookup"><span data-stu-id="1f80a-271">The GUID is the name of the Project Service Application instance for that Project Server installation.</span></span> 
  
<span data-ttu-id="1f80a-272">**图 4：显示前端 PSI (A) 和后端 PSI (B) 的 IIS 管理器**</span><span class="sxs-lookup"><span data-stu-id="1f80a-272">**Figure 4. IIS Manager showing the front-end PSI (A), and the back-end PSI (B)**</span></span>

<span data-ttu-id="1f80a-273">![前端 PSI 和后端 PSI](media/pj15_Architecture_PSI_IIS.gif "前端 PSI 和后端 PSI")</span><span class="sxs-lookup"><span data-stu-id="1f80a-273">![The front-end PSI and the back-end PSI](media/pj15_Architecture_PSI_IIS.gif "The front-end PSI and the back-end PSI")</span></span>
  
<span data-ttu-id="1f80a-274">客户端应用无法直接在后端 Project Service Application 中访问 PSI 的 WCF 服务。</span><span class="sxs-lookup"><span data-stu-id="1f80a-274">Client applications cannot directly access the WCF services for the PSI in the back-end Project Service Application.</span></span> <span data-ttu-id="1f80a-275">如果它们不要求访问 Project Online，LOB 应用的客户端应用和组件对 PSI 使用代理。</span><span class="sxs-lookup"><span data-stu-id="1f80a-275">If they do not require access to Project Online, client applications and components of LOB applications use proxies for the PSI.</span></span> <span data-ttu-id="1f80a-276">在图 4 中，**资源**服务的 WCF 接口的后端 URL 是 `https://ServerName:32843/508c23fb7dfd4c83a8919fae24bc68c5/psi/resource.svc`。</span><span class="sxs-lookup"><span data-stu-id="1f80a-276">A back-end URL for the WCF interface of the **Resource** service in Figure 4, for example, would be  `https://ServerName:32843/508c23fb7dfd4c83a8919fae24bc68c5/psi/resource.svc`.</span></span> <span data-ttu-id="1f80a-277">端口 32843 是 SharePoint Web 服务应用的默认 HTTP 端口（32844 是 HTTPS 通信端口）。</span><span class="sxs-lookup"><span data-stu-id="1f80a-277">Port 32843 is the default HTTP port for the SharePoint Web Services application (32844 is the port for HTTPS communications).</span></span> <span data-ttu-id="1f80a-278">不过，Project Web App 的 web.config 文件会阻止对后端 PSI 服务的直接访问。</span><span class="sxs-lookup"><span data-stu-id="1f80a-278">However, the web.config file for Project Web App blocks direct access to back-end PSI services.</span></span>
  
> [!NOTE]
> <span data-ttu-id="1f80a-279">Project 2013 SDK 下载内容包括，用于 WCF 服务和 ASMX 服务的 PSI 代理文件，以及有关如何将它们编译为代理程序集的说明。</span><span class="sxs-lookup"><span data-stu-id="1f80a-279">The Project 2013 SDK download includes PSI proxy files for the WCF services and the ASMX services, and instructions for how to compile them into proxy assemblies.</span></span> <span data-ttu-id="1f80a-280">> 若要创建使用 WCF 接口的已更新 PSI 代理文件，必须直接在 Project Server 计算机上使用 svcutil.exe 实用工具或 Visual Studio。</span><span class="sxs-lookup"><span data-stu-id="1f80a-280">> To create updated PSI proxy files that use the WCF interface, you have to use the svcutil.exe utility or Visual Studio directly on the Project Server computer.</span></span> 
  
<span data-ttu-id="1f80a-281">PSI 服务的成员通常会生成类型为 **DataSet** 的对象，或使用它们与业务对象交换信息。</span><span class="sxs-lookup"><span data-stu-id="1f80a-281">Members of the PSI services typically produce or consume typed **DataSet** objects as the means to exchange information with the business objects.</span></span> <span data-ttu-id="1f80a-282">还有其他几个模型可用于 PSI 开发。</span><span class="sxs-lookup"><span data-stu-id="1f80a-282">There are also several different models for PSI development.</span></span> <span data-ttu-id="1f80a-283">例如，**资源**、**自定义字段**和**查阅表格** PSI 服务使用 XML 筛选器对象进行 **DataSet** 控制，而其他服务不使用；**状态**服务中的一些方法使用 _changeXml_ 参数，而其他方法和服务不使用。</span><span class="sxs-lookup"><span data-stu-id="1f80a-283">For example, the **Resource**, **CustomFields**, and **LookupTable** PSI services use XML filter objects for **DataSet** manipulation, and other services do not; some methods in the **Statusing** service use a  _changeXml_ parameter, while other methods and services do not.</span></span> <span data-ttu-id="1f80a-284">CSOM 不使用数据集。</span><span class="sxs-lookup"><span data-stu-id="1f80a-284">The CSOM does not use datasets.</span></span> <span data-ttu-id="1f80a-285">尽管 CSOM 的编程模型不同于 PSI，且可使用 .NET 程序集或 JavaScript，但使用 CSOM 开发通常比使用 PSI 开发更为简单和一致。</span><span class="sxs-lookup"><span data-stu-id="1f80a-285">Although the CSOM has a different programming model than the PSI, and you can use either .NET assemblies or JavaScript, development with the CSOM is generally simpler and more consistent than development with the PSI.</span></span> 
  
<span data-ttu-id="1f80a-286">若要详细了解 PSI，请参阅 [Project PSI 参考概述](project-psi-reference-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="1f80a-286">For more information about the PSI, see [Project PSI reference overview](project-psi-reference-overview.md).</span></span> <span data-ttu-id="1f80a-287">若要详细了解 CSOM，请参阅 [Project 2013 客户端对象模型 (CSOM)](client-side-object-model-csom-for-project-2013.md)。</span><span class="sxs-lookup"><span data-stu-id="1f80a-287">For more information about the CSOM, see [Client-side object model (CSOM) for Project 2013](client-side-object-model-csom-for-project-2013.md).</span></span>
  
### <a name="business-objects-in-the-wfe-and-the-project-service-application"></a><span data-ttu-id="1f80a-288">WFE 和 Project Service Application 中的业务对象</span><span class="sxs-lookup"><span data-stu-id="1f80a-288">Business objects in the WFE and the Project Service Application</span></span>
<span data-ttu-id="1f80a-289"><a name="pj15_Architecture_BusinessObjects"> </a></span><span class="sxs-lookup"><span data-stu-id="1f80a-289"><a name="pj15_Architecture_BusinessObjects"> </a></span></span>

<span data-ttu-id="1f80a-p142">Project Server 的内部对象模型包括业务对象，它们表示 Project 和 Resource 等逻辑实体。客户端应用程序仅通过 CSOM 或 PSI 访问业务对象。反过来，业务对象将访问 Project 数据库中的草稿、已发布和存档表和视图。</span><span class="sxs-lookup"><span data-stu-id="1f80a-p142">The internal object model of Project Server includes the business objects, which represent logical entities such as Project and Resource. Client applications access business objects only through the CSOM or the PSI. Business objects, in turn, access the draft, published, and archive tables and views in the Project database.</span></span>
  
<span data-ttu-id="1f80a-p143">不会向第三方开发人员公开业务对象。PSI 将处理 API 与业务对象的映射，而 CSOM 会将其 API 映射到 PSI。业务对象的逻辑实体可分为三类：</span><span class="sxs-lookup"><span data-stu-id="1f80a-p143">Business objects are not exposed to third-party developers. The PSI handles mapping of the API to business objects, and the CSOM maps its API to the PSI. The logical entities of business objects can be classified into three types:</span></span>
  
- <span data-ttu-id="1f80a-p144">**核心实体**为项目、任务、分配、资源和日历等对象。核心实体包括基本业务逻辑，如权限和命名规则。</span><span class="sxs-lookup"><span data-stu-id="1f80a-p144">**Core entities** are objects such as projects, tasks, assignments, resources, and calendars. The core entities include basic business logic such as permissions and naming rules.</span></span> 
    
- <span data-ttu-id="1f80a-p145">**业务实体**为时间表、项目组合和模型等对象。业务实体包括其他业务逻辑且通常是通过将核心实体组合在一起来构建的。</span><span class="sxs-lookup"><span data-stu-id="1f80a-p145">**Business entities** are objects such as timesheets, project portfolios, and models. Business entities include additional business logic and usually are built from a combination of the core entities.</span></span> 
    
- <span data-ttu-id="1f80a-300">**支持实体**是安全和验证等对象。</span><span class="sxs-lookup"><span data-stu-id="1f80a-300">**Support entities** are objects such as security and validation.</span></span> 
    
<span data-ttu-id="1f80a-301">在 Project Server 2010 中，所有业务对象都是在 Project Service Application 中实现。</span><span class="sxs-lookup"><span data-stu-id="1f80a-301">In Project Server 2010, all business objects are implemented in the Project Service Application.</span></span> <span data-ttu-id="1f80a-302">在 Project Server 2013 中，WFE 托管多个业务对象，这些对象处理同步方法，且不要求使用 Project Calculation Service。</span><span class="sxs-lookup"><span data-stu-id="1f80a-302">In Project Server 2013, the WFE hosts many of the business objects that process synchronous methods and do not require the Project Calculation Service.</span></span> <span data-ttu-id="1f80a-303">**DeleteProject** 和 **ReadAssignments** 等同步 PSI 方法不使用 Project Server 队列服务。</span><span class="sxs-lookup"><span data-stu-id="1f80a-303">Synchronous PSI methods such as **DeleteProject** and **ReadAssignments** do not use the Project Server Queue Service.</span></span> <span data-ttu-id="1f80a-304">PSI 中的异步方法的名称以 `Queue` 开头，如 **QueueCreateProject** 和 **QueueUpdateTimesheet**。</span><span class="sxs-lookup"><span data-stu-id="1f80a-304">Asynchronous methods in the PSI have names that start with  `Queue`, such as **QueueCreateProject** and **QueueUpdateTimesheet**.</span></span> <span data-ttu-id="1f80a-305">异步方法将消息发送到 Project Server 队列服务，此服务会在用户恢复控制权时安排处理方法。</span><span class="sxs-lookup"><span data-stu-id="1f80a-305">An asynchronous method sends a message to the Project Server Queue Service, which schedules processing of the method while control is returned to the user.</span></span>
  
<span data-ttu-id="1f80a-p147">PSI 转发器决定将哪些请求发送到 Project Service 应用程序以及哪些请求可由 WFE 中的业务对象处理。WFE 中的业务对象将绕过 Project Service 应用程序并可以直接访问 Project 数据库，这与 WFE 中的其他 SharePoint 过程直接访问配置数据库和内容数据库的方式类似。通过在 WFE 上运行多个业务对象，可以提高 Project Server 的效率、减少应用程序层的负载并使 Project Server 能够更好地向上扩展以适应增加的工作负载。</span><span class="sxs-lookup"><span data-stu-id="1f80a-p147">The PSI Forwarder determines which requests are sent to the Project Service Application and which can be processed by the business objects in the WFE. The business objects in the WFE bypass the Project Service Application and have direct access to the Project database, similar to the way other SharePoint processes in a WFE directly access the Configuration and Content databases. Running many of the business objects on the WFE improves the efficiency of Project Server, reduces the load on the application tier, and enables Project Server to better scale up for increased workloads.</span></span>
  
> [!NOTE]
> <span data-ttu-id="1f80a-309">在 Project Server 2013 中，必须将本地事件处理程序部署到 WFE 和后端 Project Server 计算机。</span><span class="sxs-lookup"><span data-stu-id="1f80a-309">In Project Server 2013, local event handlers must be deployed to the WFE and to the back-end Project Server computer.</span></span> 
  
### <a name="project-server-database"></a><span data-ttu-id="1f80a-310">Project Server 数据库</span><span class="sxs-lookup"><span data-stu-id="1f80a-310">Project Server database</span></span>
<span data-ttu-id="1f80a-311"><a name="pj15_Architecture_DAL"> </a></span><span class="sxs-lookup"><span data-stu-id="1f80a-311"><a name="pj15_Architecture_DAL"> </a></span></span>

<span data-ttu-id="1f80a-312">在 Project Server 2013 中，旧版的四个 Project Server 数据库合并为 SQL Server 的一个 Project 数据库。</span><span class="sxs-lookup"><span data-stu-id="1f80a-312">In Project Server 2013, the four Project Server databases of previous versions are combined into one Project database in SQL Server.</span></span> <span data-ttu-id="1f80a-313">默认 Project 数据库名称为 ProjectService。</span><span class="sxs-lookup"><span data-stu-id="1f80a-313">The default Project database name is ProjectService.</span></span> <span data-ttu-id="1f80a-314">报告表格和视图保留先前前缀为 `dbo` 的名称，如 dbo.MSP_EpmProject 和 dbo.MSP_EpmProject_UserView。</span><span class="sxs-lookup"><span data-stu-id="1f80a-314">The reporting tables and views retain their previous names with the  `dbo` prefix, such as dbo.MSP_EpmProject and dbo.MSP_EpmProject_UserView.</span></span> <span data-ttu-id="1f80a-315">先前位于草稿数据库中的表格和视图的前缀为 `draft`。</span><span class="sxs-lookup"><span data-stu-id="1f80a-315">Tables and views that were previously in the Draft database have the  `draft` prefix.</span></span> <span data-ttu-id="1f80a-316">先前位于已发布数据库中的表格和视图的前缀为 `pub`。</span><span class="sxs-lookup"><span data-stu-id="1f80a-316">Tables and views from the Published database have the  `pub` prefix.</span></span> <span data-ttu-id="1f80a-317">先前位于存档数据库中的表格和视图的前缀为 `ver`。</span><span class="sxs-lookup"><span data-stu-id="1f80a-317">Tables and views from the Archive database have the  `ver` prefix.</span></span> 
  
> [!IMPORTANT]
> <span data-ttu-id="1f80a-318">不支持直接访问草稿（前缀为 `draft`）、已发布（前缀为 `pub`）和存档（前缀为 `ver`）表格和视图。</span><span class="sxs-lookup"><span data-stu-id="1f80a-318">Direct access is not supported for the draft ( `draft` prefix), published (  `pub` prefix), and archive (  `ver` prefix) tables and views.</span></span> <span data-ttu-id="1f80a-319">报告应仅使用前缀为 `dbo` 的报告表格和视图。</span><span class="sxs-lookup"><span data-stu-id="1f80a-319">Reports should use only the reporting tables and views, which have the  `dbo` prefix.</span></span> 
  
<span data-ttu-id="1f80a-320">Project Server 数据在 Project 数据库中进行分区，如下所示：</span><span class="sxs-lookup"><span data-stu-id="1f80a-320">Project Server data is partitioned in the Project database as follows:</span></span>
  
- <span data-ttu-id="1f80a-321">草稿表格和视图包含由 Project Professional 和其他应用创建的未发布项目中的数据。</span><span class="sxs-lookup"><span data-stu-id="1f80a-321">The draft tables and views contain data from unpublished projects that were created by Project Professional and other applications.</span></span> <span data-ttu-id="1f80a-322">Project Web App 不显示草稿表格和视图中的项目数据。</span><span class="sxs-lookup"><span data-stu-id="1f80a-322">Project Web App does not display project data from the draft tables and views.</span></span>
    
- <span data-ttu-id="1f80a-323">已发布表格和视图包含所有已发布项目和企业资源、企业项目类型 (EPT) 的全局数据和其他项目模板。</span><span class="sxs-lookup"><span data-stu-id="1f80a-323">The published tables and views contain all of the published projects and enterprise resources, global data for enterprise project types (EPTs), and other project templates.</span></span> <span data-ttu-id="1f80a-324">已发布项目在 Project Web App 中可见。</span><span class="sxs-lookup"><span data-stu-id="1f80a-324">Published projects are visible in Project Web App.</span></span> <span data-ttu-id="1f80a-325">已发布数据还包括 Project Web App 专用表格（时间表、模型、视图等），以及全局数据表（自定义字段、查阅表格、Project Server 授权权限和元数据）。</span><span class="sxs-lookup"><span data-stu-id="1f80a-325">The published data also includes tables that are specific to Project Web App (timesheets, models, views, and so on), and global data tables (custom fields, lookup tables, Project Server authorization permissions, and metadata).</span></span>
    
- <span data-ttu-id="1f80a-326">存档数据保存项目、资源、自定义字段和其他数据的备份版本。</span><span class="sxs-lookup"><span data-stu-id="1f80a-326">The archive data saves backup versions of projects, resources, custom fields, and other data.</span></span>
    
- <span data-ttu-id="1f80a-327">报告数据可以用于在第三方应用中进行只读访问，也可以用于报告。</span><span class="sxs-lookup"><span data-stu-id="1f80a-327">The reporting data can be used for read-only access in third-party applications, and for reports.</span></span> <span data-ttu-id="1f80a-328">Project Server OLAP 多维数据集使用后缀为 `_OlapView` 的报告视图。</span><span class="sxs-lookup"><span data-stu-id="1f80a-328">Project Server OLAP cubes use the reporting views that have the  `_OlapView` suffix.</span></span> <span data-ttu-id="1f80a-329">OLAP 多维数据集在本地 Project Server 安装中可用，但在 Project Online 中不可用。</span><span class="sxs-lookup"><span data-stu-id="1f80a-329">OLAP cubes are available in an on-premises Project Server installation, but are not available in Project Online.</span></span> 
    
    <span data-ttu-id="1f80a-p153">报表数据非常全面，并且几乎是实时更新的。报告表和视图已针对只读报表生成进行优化；例如，报告表是非规范化的，旨在提供冗余数据和减少关系表的数目。</span><span class="sxs-lookup"><span data-stu-id="1f80a-p153">Reporting data is comprehensive and is updated nearly in real time. The reporting tables and views are optimized for read-only report generation; for example, the reporting tables are denormalized to provide redundant data and reduce the number of relational tables.</span></span>
    
<span data-ttu-id="1f80a-p154">逻辑实体（如 Resource 或 Project）可跨多个表，并且针对某个特殊实体的所有表都具有相同的主键。主键是单个列中的 GUID，用于唯一标识特殊实体的一个实例。</span><span class="sxs-lookup"><span data-stu-id="1f80a-p154">Logical entities such as Resource or Project can span multiple tables, and all tables for a particular entity have the same primary key. The primary key is a GUID in a single column that uniquely identifies one instance of a particular entity.</span></span>
  
<span data-ttu-id="1f80a-334">每个 Project Web App 实例的 Project Server 数据存储在名称不同的各个 Project 数据库中。</span><span class="sxs-lookup"><span data-stu-id="1f80a-334">Project Server data for each instance of Project Web App is stored in a separate Project database with a different name.</span></span> <span data-ttu-id="1f80a-335">有权直接访问 Project Server 的客户端应用可以直接读取报告表格和视图。</span><span class="sxs-lookup"><span data-stu-id="1f80a-335">Client applications that have direct access to Project Server can directly read the reporting tables and views.</span></span> <span data-ttu-id="1f80a-336">对于远程访问，客户端应用可以使用 OData 接口和 REST 接口来获取报告数据。</span><span class="sxs-lookup"><span data-stu-id="1f80a-336">For remote access, client applications can use the OData interface and the REST interface to get data for reports.</span></span> <span data-ttu-id="1f80a-337">客户端应仅使用 CSOM 或 PSI 来访问草稿、已发布和存档表格和视图。</span><span class="sxs-lookup"><span data-stu-id="1f80a-337">Clients should use only the CSOM or the PSI to access the draft, published, and archive tables and views.</span></span> <span data-ttu-id="1f80a-338">报告数据服务 (RDS)（图 3 中未显示）几乎实时地更新已发布数据中的报告数据。</span><span class="sxs-lookup"><span data-stu-id="1f80a-338">The Reporting Data Service (RDS, which is not shown in Figure 3) updates the reporting data from published data in nearly real time.</span></span> <span data-ttu-id="1f80a-339">Project 数据库可以位于独立服务器上。</span><span class="sxs-lookup"><span data-stu-id="1f80a-339">The Project database can be located on a separate server.</span></span>
  
<span data-ttu-id="1f80a-340">仅对报告表格和视图记录架构。</span><span class="sxs-lookup"><span data-stu-id="1f80a-340">Schemas are documented only for the reporting tables and views.</span></span> <span data-ttu-id="1f80a-341">对于本地 Project Server 安装，可以添加 Project 数据库架构中未定义的实体的报告表格和视图。</span><span class="sxs-lookup"><span data-stu-id="1f80a-341">For an on-premises Project Server installation, you can add reporting tables and views for entities that are not defined in the Project database schema.</span></span> <span data-ttu-id="1f80a-342">还可以为自定义本地应用创建独立数据库。</span><span class="sxs-lookup"><span data-stu-id="1f80a-342">You can also create separate databases for custom on-premises applications.</span></span> <span data-ttu-id="1f80a-343">不支持修改草稿、已发布和存档表格和视图。</span><span class="sxs-lookup"><span data-stu-id="1f80a-343">Modification is not supported for the draft, published, and archive tables and views.</span></span> <span data-ttu-id="1f80a-344">如果你的自定义应用程序或报表需要自定义 SQL 对象（例如表格和视图），我们建议你在自定义数据库中创建这些对象。</span><span class="sxs-lookup"><span data-stu-id="1f80a-344">If your custom application or report requires custom SQL objects (for example, tables and views), we recommend that you create these in a custom database.</span></span> <span data-ttu-id="1f80a-345">由于无法在 Project Online 中直接访问 Project 数据库，因此也就无法修改报告表格和视图。</span><span class="sxs-lookup"><span data-stu-id="1f80a-345">Because the Project database is not directly accessible in Project Online, reporting tables and views cannot be modified.</span></span> <span data-ttu-id="1f80a-346">不过，如果拥有 SQL Azure 帐户，可以创建独立数据库，以自定义用于 Project Online。</span><span class="sxs-lookup"><span data-stu-id="1f80a-346">However, if you have a SQL Azure account, you can create separate databases for custom use with Project Online.</span></span>
  
### <a name="event-receivers"></a><span data-ttu-id="1f80a-347">事件接收器</span><span class="sxs-lookup"><span data-stu-id="1f80a-347">Event receivers</span></span>
<span data-ttu-id="1f80a-348"><a name="pj15_Architecture_EventHandlers"> </a></span><span class="sxs-lookup"><span data-stu-id="1f80a-348"></span></span>

<span data-ttu-id="1f80a-349">Project Server 的本地事件处理程序和远程事件接收器启用第三方扩展性，以响应创建或发布项目等 Project Server 事件。</span><span class="sxs-lookup"><span data-stu-id="1f80a-349">Local event handlers and remote event receivers for Project Server enable third-party extensibility in response to Project Server events such as creating or publishing a project.</span></span> <span data-ttu-id="1f80a-350">在 Project Server 2010 中，所有事件处理程序都是使用完全信任代码编写的本地处理程序，它们直接部署到运行 Project Server 的计算机和 WFE，并且在 Project Server 事件系统内运行。</span><span class="sxs-lookup"><span data-stu-id="1f80a-350">In Project Server 2010, all event handlers are local and are written in full-trust code, deployed directly on the computer running Project Server and to the WFEs, and run inside the Project Server Eventing System.</span></span> <span data-ttu-id="1f80a-351">由于 Project Online 无法使用完全信任事件处理程序，因此 Project Server 2013 实现与 SharePoint Server 2013 中的远程事件接收器类似的远程事件接收器。</span><span class="sxs-lookup"><span data-stu-id="1f80a-351">Because Project Online cannot use full-trust event handlers, Project Server 2013 implements remote event receivers that are similar to the remote event receivers in SharePoint Server 2013.</span></span> <span data-ttu-id="1f80a-352">Project Server 2013 的本地安装可使用传统的完全信任事件处理程序和远程事件接收器。</span><span class="sxs-lookup"><span data-stu-id="1f80a-352">An on-premises installation of Project Server 2013 can use traditional full-trust event handlers and remote event receivers.</span></span>
  
<span data-ttu-id="1f80a-353">Project Server 远程事件接收器可以在具有 SOAP 终结点的自定义 Web 服务（在 Microsoft Azure 或支持 SOAP Web 服务的其他环境中运行）中实现。</span><span class="sxs-lookup"><span data-stu-id="1f80a-353">A Project Server remote event receiver can be implemented in a custom web service with a SOAP endpoint that runs in Microsoft Azure or other environments that support SOAP web services.</span></span> <span data-ttu-id="1f80a-354">Project Server 应用包可以包含与应用一起安装的远程事件接收器。</span><span class="sxs-lookup"><span data-stu-id="1f80a-354">A Project Server app package can include remote event receivers that are installed with the app.</span></span>
  
<span data-ttu-id="1f80a-355">远程事件接收器可以使用 CSOM 终结点回调 Project Server（图 3 中未显示）。</span><span class="sxs-lookup"><span data-stu-id="1f80a-355">Remote event receivers can call back into Project Server by using the CSOM endpoints (not shown in Figure 3).</span></span> <span data-ttu-id="1f80a-356">对远程事件接收器的调用包括，Project Server 事件系统中的信息，以及发出调用的 Project Web App 实例（或 Project Online 中的 Project Web App 租户）中的信息。</span><span class="sxs-lookup"><span data-stu-id="1f80a-356">The call to a remote event receiver includes information from the Project Server Event System and the Project Web App instance (or the Project Web App tenant in Project Online) that issues the call.</span></span> <span data-ttu-id="1f80a-357">通过远程事件接收器，可以创建并托管一个 Web 服务，可供多个 Project Server 安装使用。</span><span class="sxs-lookup"><span data-stu-id="1f80a-357">Remote event receivers enable you to create and host a single web service that can be used by multiple Project Server installations.</span></span> <span data-ttu-id="1f80a-358">相比之下，必须将本地完全信任事件处理程序部署到每个 Project Server 安装。</span><span class="sxs-lookup"><span data-stu-id="1f80a-358">By contrast, local full-trust event handlers must be deployed to each installation of Project Server.</span></span>
  
### <a name="publishing-and-server-side-scheduling"></a><span data-ttu-id="1f80a-359">发布和服务器端日程安排</span><span class="sxs-lookup"><span data-stu-id="1f80a-359">Publishing and server-side scheduling</span></span>
<span data-ttu-id="1f80a-360"><a name="pj15_Architecture_PublishingScheduling"> </a></span><span class="sxs-lookup"><span data-stu-id="1f80a-360"></span></span>

<span data-ttu-id="1f80a-361">Project Server 2013 支持手动和自动项目日程安排更新。</span><span class="sxs-lookup"><span data-stu-id="1f80a-361">Project Server 2013 supports both manual and automated project schedule updates.</span></span> <span data-ttu-id="1f80a-362">默认过程是手动日程安排更新。</span><span class="sxs-lookup"><span data-stu-id="1f80a-362">The default process is a manual schedule update.</span></span> <span data-ttu-id="1f80a-363">也就是说，项目经理先在 Project Professional 或 Project Web App 中签出并打开项目，并应用更改，再保存并发布项目，以让更改对所有人都生效。</span><span class="sxs-lookup"><span data-stu-id="1f80a-363">That is, the project manager checks out and opens a project in Project Professional or Project Web App, applies the changes, and then saves and publishes the project to make the changes available to everyone.</span></span> <span data-ttu-id="1f80a-364">Project Professional 有日程安排引擎，可用于先计算更改，再将更改保存到 Project Server。</span><span class="sxs-lookup"><span data-stu-id="1f80a-364">Project Professional has a scheduling engine that calculates changes and then saves the changes to Project Server.</span></span> <span data-ttu-id="1f80a-365">在 Project Server 2010 中，服务器端日程安排引擎的实现与 Project Professional 中的日程安排引擎不同。</span><span class="sxs-lookup"><span data-stu-id="1f80a-365">In Project Server 2010, the server-side scheduling engine is a different implementation from the scheduling engine in Project Professional.</span></span>
  
<span data-ttu-id="1f80a-366">在 Project Server 2013 中，Project Calculation Service 实现 Project Professional 2013 中的相同日程安排引擎。</span><span class="sxs-lookup"><span data-stu-id="1f80a-366">In Project Server 2013, the Project Calculation Service implements the same scheduling engine that is in Project Professional 2013.</span></span> <span data-ttu-id="1f80a-367">Project Calculation Service 在名为 **Microsoft Project Server Calculation Service** 的 Windows 服务中运行。</span><span class="sxs-lookup"><span data-stu-id="1f80a-367">The Project Calculation Service runs in a Windows service named **Microsoft Project Server Calculation Service**.</span></span> <span data-ttu-id="1f80a-368">如果在 Project Web App 中或通过使用 CSOM 的第三方应用编辑项目，生成的日程安排更改与 Project Professional 做出的日程安排更改完全相同。</span><span class="sxs-lookup"><span data-stu-id="1f80a-368">Editing a project schedule in Project Web App or with third-party applications that use the CSOM results in exactly the same schedule changes that Project Professional would make.</span></span>
  
> [!NOTE]
> <span data-ttu-id="1f80a-369">使用 PSI 的第三方应用显示的日程安排可能会与 Project Web App 计算的日程安排有一些差异。</span><span class="sxs-lookup"><span data-stu-id="1f80a-369">Third-party applications that use the PSI may show some scheduling differences from a schedule that Project Web App calculates.</span></span> <span data-ttu-id="1f80a-370">为了实现向后兼容性，执行服务器端日程安排的公共 PSI 方法仍使用 Project Server 2010 中引入的日程安排引擎。</span><span class="sxs-lookup"><span data-stu-id="1f80a-370">For backward-compatibility, the public PSI methods that do server-side scheduling still use the scheduling engine that was introduced in Project Server 2010.</span></span> <span data-ttu-id="1f80a-371">**QueueUpdateProject2** 是例外，它是 Project Server 2013 中新增的 PSI 方法。</span><span class="sxs-lookup"><span data-stu-id="1f80a-371">An exception is **QueueUpdateProject2**, which is a new PSI method in Project Server 2013.</span></span> <span data-ttu-id="1f80a-372">例如，旧版日程安排引擎不会安排子项目或指向其他项目的链接，也不会计算挣值字段。</span><span class="sxs-lookup"><span data-stu-id="1f80a-372">For example, the older scheduling engine does not schedule subprojects or links to other projects, and does not calculate earned value fields.</span></span> <span data-ttu-id="1f80a-373">为了避免第三方应用与 Project Professional 或 Project Web App 之间的潜在日程安排差异，应尽可能使用 CSOM 开发应用。</span><span class="sxs-lookup"><span data-stu-id="1f80a-373">To avoid potential scheduling differences between third-party applications and Project Professional or Project Web App, you should develop applications with the CSOM where possible.</span></span> 
  
<span data-ttu-id="1f80a-374">Project Server 允许在项目经理使用草稿版本时通过执行以下步骤来更新项目的已发布版本：</span><span class="sxs-lookup"><span data-stu-id="1f80a-374">Project Server allows the published version of a project to be updated while a project manager is using the draft version, by the following steps:</span></span>
  
1. <span data-ttu-id="1f80a-375">Project Server 应用更新并重新安排已发布版本。</span><span class="sxs-lookup"><span data-stu-id="1f80a-375">Project Server applies updates and reschedules the published version.</span></span>
    
2. <span data-ttu-id="1f80a-376">在发生以下任一事件时，Project Server 将保存更新以应用到草稿版本：</span><span class="sxs-lookup"><span data-stu-id="1f80a-376">Project Server saves the update to apply to the draft version when either of the following events occur:</span></span>
    
   - <span data-ttu-id="1f80a-377">Project Professional 将打开项目。</span><span class="sxs-lookup"><span data-stu-id="1f80a-377">Project Professional opens the project.</span></span>
    
   - <span data-ttu-id="1f80a-378">Project Professional 尝试发布项目。</span><span class="sxs-lookup"><span data-stu-id="1f80a-378">Project Professional tries to publish the project.</span></span>
    
3. <span data-ttu-id="1f80a-379">若有冲突，项目经理会收到通知，并且必须先解决冲突，然后才能发布草稿版本。</span><span class="sxs-lookup"><span data-stu-id="1f80a-379">If there is a conflict, the project manager is notified and must resolve the conflict before the draft version can be published.</span></span>
    
## <a name="see-also"></a><span data-ttu-id="1f80a-380">另请参阅</span><span class="sxs-lookup"><span data-stu-id="1f80a-380">See also</span></span>

- [<span data-ttu-id="1f80a-381">面向开发人员的 Project 2013 概述</span><span class="sxs-lookup"><span data-stu-id="1f80a-381">Project 2013 overview for developers</span></span>](https://msdn.microsoft.com/library/8da91ab0-af4f-429f-8241-490600e3f7bd%28Office.15%29.aspx)
- [<span data-ttu-id="1f80a-382">Project Server 可编程性</span><span class="sxs-lookup"><span data-stu-id="1f80a-382">Project Server programmability</span></span>](project-server-programmability.md)  
- [<span data-ttu-id="1f80a-383">Project 2013 客户端对象模型 (CSOM)</span><span class="sxs-lookup"><span data-stu-id="1f80a-383">Client-side object model (CSOM) for Project 2013</span></span>](client-side-object-model-csom-for-project-2013.md)  
- [<span data-ttu-id="1f80a-384">PSI 执行和不执行的操作</span><span class="sxs-lookup"><span data-stu-id="1f80a-384">What the PSI does and does not do</span></span>](what-the-psi-does-and-does-not-do.md)  
- [<span data-ttu-id="1f80a-385">开始开发 Project Server 工作流</span><span class="sxs-lookup"><span data-stu-id="1f80a-385">Getting started developing Project Server workflows</span></span>](getting-started-developing-project-server-workflows.md)   
- [<span data-ttu-id="1f80a-386">Project PSI 参考概述</span><span class="sxs-lookup"><span data-stu-id="1f80a-386">Project PSI reference overview</span></span>](project-psi-reference-overview.md)   
- [<span data-ttu-id="1f80a-387">Open Data Protocol</span><span class="sxs-lookup"><span data-stu-id="1f80a-387">Open Data Protocol</span></span>](https://www.odata.org/)
    

