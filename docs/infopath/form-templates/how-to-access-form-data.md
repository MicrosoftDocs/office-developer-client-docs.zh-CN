---
title: 访问表单数据
manager: soliver
ms.date: 12/07/2015
ms.audience: Developer
keywords:
- form data [infopath 2007],forms [InfoPath 2007], accessing properties,form templates [InfoPath 2007], accessing properties,opening forms [InfoPath 2007],printing forms [InfoPath 2007],forms [InfoPath 2007], printing,closing forms [InfoPath 2007],InfoPath 2007, accessing form data,forms [InfoPath 2007], accessing data source,forms [InfoPath 2007], closing,forms [InfoPath 2007], opening,printing [InfoPath 2007], forms,forms [InfoPath 2007], creating
localization_priority: Normal
ms.assetid: fd7374d3-a268-4e30-9872-7579cd681bd0
description: 如果要扩展 InfoPath 表单的功能，通常必须以编程方式访问有关表单的基础 XML 文档的信息，访问 XML 文档所包含的数据或对 XML 文档执行某操作。InfoPath 对象模型通过结合使用 XmlForm 类和 XmlFormCollection 类来支持对表单的基础 XML 文档的访问和操作。
ms.openlocfilehash: c8251afcd75391f102215811694515c06b9f3e7e
ms.sourcegitcommit: ef717c65d8dd41ababffb01eafc443c79950aed4
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 10/04/2018
ms.locfileid: "25386829"
---
# <a name="access-form-data"></a><span data-ttu-id="276b8-105">访问表单数据</span><span class="sxs-lookup"><span data-stu-id="276b8-105">Access Form Data</span></span>

<span data-ttu-id="276b8-p102">如果要扩展 InfoPath 表单的功能，通常必须以编程方式访问有关表单的基础 XML 文档的信息，访问 XML 文档所包含的数据或对 XML 文档执行某操作。InfoPath 对象模型通过结合使用 [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) 类和 [XmlFormCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCollection.aspx) 类来支持对表单的基础 XML 文档的访问和操作。</span><span class="sxs-lookup"><span data-stu-id="276b8-p102">When you want to extend the functionality of an InfoPath form, it is often necessary to programmatically access information about the form's underlying XML document, access the data that the XML document contains, or perform some action on the XML document. The InfoPath object model supports accessing and manipulating a form's underlying XML document through the use of the [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) class in association with the [XmlFormCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCollection.aspx) class.</span></span> 
  
<span data-ttu-id="276b8-108">[XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) 类是 InfoPath 对象模型中最有用的类型之一，因为它提供各种属性和方法，不仅能与表单的基础 XML 文档进行交互，而且能够执行可从 InfoPath 用户界面中执行的许多操作。</span><span class="sxs-lookup"><span data-stu-id="276b8-108">The [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) class is one of the most useful types in the InfoPath object model because it provides a variety of properties and methods that not only interact with a form's underlying XML document, but also perform many of the actions that are available in the InfoPath user interface.</span></span> 
  
## <a name="overview-of-the-xmlformcollection-class"></a><span data-ttu-id="276b8-109">XmlFormCollection 类概述</span><span class="sxs-lookup"><span data-stu-id="276b8-109">Overview of the XmlFormCollection Class</span></span>

<span data-ttu-id="276b8-110">[XmlFormCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCollection.aspx) 类提供下列方法和属性，表单开发人员可以使用它们管理集合所包含的 [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) 对象。</span><span class="sxs-lookup"><span data-stu-id="276b8-110">The [XmlFormCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCollection.aspx) class provides the following methods and properties that form developers can use to manage the [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) objects that the collection contains.</span></span> 
  
|<span data-ttu-id="276b8-111">**名称**</span><span class="sxs-lookup"><span data-stu-id="276b8-111">**Name**</span></span>|<span data-ttu-id="276b8-112">**说明**</span><span class="sxs-lookup"><span data-stu-id="276b8-112">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="276b8-113">[New(String)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCollection.New.aspx) 方法</span><span class="sxs-lookup"><span data-stu-id="276b8-113">[New(String)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCollection.New.aspx) method</span></span>  <br/> |<span data-ttu-id="276b8-114">基于指定的表单创建新表单。</span><span class="sxs-lookup"><span data-stu-id="276b8-114">Creates a new form based on the specified form.</span></span>  <br/> |
|<span data-ttu-id="276b8-115">[New(String, XmlFormOpenMode)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCollection.New.aspx) 方法（重载 1）</span><span class="sxs-lookup"><span data-stu-id="276b8-115">[New(String, XmlFormOpenMode)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCollection.New.aspx) method (overload 1)</span></span>  <br/> |<span data-ttu-id="276b8-116">使用指定的打开模式行为，基于指定的表单创建新表单。</span><span class="sxs-lookup"><span data-stu-id="276b8-116">Creates a new form based on the specified form using the specified open mode behavior.</span></span>  <br/> |
|<span data-ttu-id="276b8-117">[NewFromFormTemplate(String)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCollection.NewFromFormTemplate.aspx) 方法</span><span class="sxs-lookup"><span data-stu-id="276b8-117">[NewFromFormTemplate(String)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCollection.NewFromFormTemplate.aspx) method</span></span>  <br/> |<span data-ttu-id="276b8-118">基于指定的表单模板创建新表单。</span><span class="sxs-lookup"><span data-stu-id="276b8-118">Creates a new form based on the specified form template.</span></span>  <br/> |
|<span data-ttu-id="276b8-119">[NewFromFormTemplate(String, String)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCollection.NewFromFormTemplate.aspx) 方法（重载 1）</span><span class="sxs-lookup"><span data-stu-id="276b8-119">[NewFromFormTemplate(String, String)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCollection.NewFromFormTemplate.aspx) method (overload 1)</span></span>  <br/> |<span data-ttu-id="276b8-120">基于指定的表单模板和 XML 数据创建新表单。</span><span class="sxs-lookup"><span data-stu-id="276b8-120">Creates a new form based on the specified form template and XML data.</span></span>  <br/> |
|<span data-ttu-id="276b8-121">[NewFromFormTemplate(String, String, XmlFormOpenMode)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCollection.NewFromFormTemplate.aspx) 方法（重载 2）</span><span class="sxs-lookup"><span data-stu-id="276b8-121">[NewFromFormTemplate(String, String, XmlFormOpenMode)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCollection.NewFromFormTemplate.aspx) method (overload 2)</span></span>  <br/> |<span data-ttu-id="276b8-122">基于指定的表单模板以及由 [XPathNavigator](https://msdn.microsoft.com/library/system.xml.xpath.xpathnavigator%28v=vs.110%29.aspx) 对象指定的数据创建新表单。</span><span class="sxs-lookup"><span data-stu-id="276b8-122">Creates a new form based on the specified form template with data specified by an [XPathNavigator](https://msdn.microsoft.com/library/system.xml.xpath.xpathnavigator%28v=vs.110%29.aspx) object.</span></span>  <br/> |
|<span data-ttu-id="276b8-123">[NewFromFormTemplate(String, XPathNavigator)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCollection.NewFromFormTemplate.aspx) 方法（重载 3）</span><span class="sxs-lookup"><span data-stu-id="276b8-123">[NewFromFormTemplate(String, XPathNavigator)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCollection.NewFromFormTemplate.aspx) method (overload 3)</span></span>  <br/> |<span data-ttu-id="276b8-124">使用指定的打开模式行为，基于指定的表单模板以及由 **XPathNavigator** 对象指定的数据创建新表单。</span><span class="sxs-lookup"><span data-stu-id="276b8-124">Creates a new form based on the specified form template with data specified by an **XPathNavigator** object using the specified open mode behavior.</span></span>  <br/> |
|<span data-ttu-id="276b8-125">[Open(String)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCollection.Open.aspx) 方法</span><span class="sxs-lookup"><span data-stu-id="276b8-125">[Open(String)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCollection.Open.aspx) method</span></span>  <br/> |<span data-ttu-id="276b8-126">打开指定的表单。</span><span class="sxs-lookup"><span data-stu-id="276b8-126">Opens the specified form.</span></span>  <br/> |
|<span data-ttu-id="276b8-127">[Open(String, XmlFormOpenMode)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCollection.Open.aspx) 方法（重载 1）</span><span class="sxs-lookup"><span data-stu-id="276b8-127">[Open(String, XmlFormOpenMode)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCollection.Open.aspx) method (overload 1)</span></span>  <br/> |<span data-ttu-id="276b8-128">使用指定的打开模式行为打开指定表单。</span><span class="sxs-lookup"><span data-stu-id="276b8-128">Opens the specified form using the specified open mode behavior.</span></span>  <br/> |
|<span data-ttu-id="276b8-129">[Count](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCollection.Count.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="276b8-129">[Count](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCollection.Count.aspx) property</span></span>  <br/> |<span data-ttu-id="276b8-130">获取集合中包含的 **XmlForm** 对象的数目。</span><span class="sxs-lookup"><span data-stu-id="276b8-130">Gets a count of the number of **XmlForm** objects contained in the collection.</span></span>  <br/> |
|<span data-ttu-id="276b8-131">[Item](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCollection.Item.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="276b8-131">[Item](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCollection.Item.aspx) property</span></span>  <br/> |<span data-ttu-id="276b8-132">按照索引值获取一个对集合中指定 **XmlForm** 对象的引用。</span><span class="sxs-lookup"><span data-stu-id="276b8-132">Gets a reference to the specified **XmlForm** object from the collection by index value.</span></span>  <br/> |
   
## <a name="overview-of-the-xmlform-class"></a><span data-ttu-id="276b8-133">XmlForm 类概述</span><span class="sxs-lookup"><span data-stu-id="276b8-133">Overview of the XmlForm Class</span></span>

<span data-ttu-id="276b8-134">[XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) 类提供下列方法和属性，表单开发人员可以使用它们与表单的基础 XML 文档进行交互，并对该文档执行操作。</span><span class="sxs-lookup"><span data-stu-id="276b8-134">The [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) class provides the following methods and properties, which form developers can use to interact with and perform actions on a form's underlying XML document.</span></span> 
  
|<span data-ttu-id="276b8-135">**名称**</span><span class="sxs-lookup"><span data-stu-id="276b8-135">**Name**</span></span>|<span data-ttu-id="276b8-136">**说明**</span><span class="sxs-lookup"><span data-stu-id="276b8-136">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="276b8-137">[Close](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Close.aspx) 方法</span><span class="sxs-lookup"><span data-stu-id="276b8-137">[Close](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Close.aspx) method</span></span>  <br/> |<span data-ttu-id="276b8-138">关闭表单。</span><span class="sxs-lookup"><span data-stu-id="276b8-138">Closes the form.</span></span>  <br/> |
|<span data-ttu-id="276b8-139">[GetWorkflowTasks](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.GetWorkflowTasks.aspx) 方法</span><span class="sxs-lookup"><span data-stu-id="276b8-139">[GetWorkflowTasks](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.GetWorkflowTasks.aspx) method</span></span>  <br/> |<span data-ttu-id="276b8-140">获取一个对当前表单的 **Microsoft.Office.Core.WorkflowTasks** 集合的引用。</span><span class="sxs-lookup"><span data-stu-id="276b8-140">Gets a reference to a **Microsoft.Office.Core.WorkflowTasks** collection for the current form.</span></span>  <br/> |
|<span data-ttu-id="276b8-141">[GetWorkflowTemplates](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.GetWorkflowTemplates.aspx) 方法</span><span class="sxs-lookup"><span data-stu-id="276b8-141">[GetWorkflowTemplates](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.GetWorkflowTemplates.aspx) method</span></span>  <br/> |<span data-ttu-id="276b8-142">获取一个对当前表单的 **Microsoft.Office.Core.WorkflowTemplates** 集合的引用。</span><span class="sxs-lookup"><span data-stu-id="276b8-142">Gets a reference to a **Microsoft.Office.Core.WorkflowTemplates** collection for the current form.</span></span>  <br/> |
|<span data-ttu-id="276b8-143">[MergeForm(String)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.MergeForm.aspx) 方法</span><span class="sxs-lookup"><span data-stu-id="276b8-143">[MergeForm(String)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.MergeForm.aspx) method</span></span>  <br/> |<span data-ttu-id="276b8-144">将当前表单与通过路径或 URL 指定的表单合并。</span><span class="sxs-lookup"><span data-stu-id="276b8-144">Merges the current form with the form specified by path or URL.</span></span>  <br/> |
|<span data-ttu-id="276b8-145">[MergeForm(XPathNavigator)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.MergeForm.aspx) 方法（重载 1）</span><span class="sxs-lookup"><span data-stu-id="276b8-145">[MergeForm(XPathNavigator)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.MergeForm.aspx) method (overload 1)</span></span>  <br/> |<span data-ttu-id="276b8-146">将当前表单与传递到该方法的 **XPathNavigator** 所返回的节点中指定的目标表单进行合并。</span><span class="sxs-lookup"><span data-stu-id="276b8-146">Merges the current form with the target form specified in the node returned by the **XPathNavigator** passed to the method.</span></span>  <br/> |
|<span data-ttu-id="276b8-147">[NotifyHost](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.NotifyHost.aspx) 方法</span><span class="sxs-lookup"><span data-stu-id="276b8-147">[NotifyHost](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.NotifyHost.aspx) method</span></span>  <br/> |<span data-ttu-id="276b8-148">为宿主应用程序或 ASPX 页提供自定义值。</span><span class="sxs-lookup"><span data-stu-id="276b8-148">Provides a custom value to the hosting application or ASPX page.</span></span>  <br/> |
|<span data-ttu-id="276b8-149">[Print()](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Print.aspx) 方法</span><span class="sxs-lookup"><span data-stu-id="276b8-149">[Print()](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Print.aspx) method</span></span>  <br/> |<span data-ttu-id="276b8-150">按照表单内容在表单的活动视图中的显示效果打印表单内容。</span><span class="sxs-lookup"><span data-stu-id="276b8-150">Prints the form content as it is rendered in the form's active view.</span></span>  <br/> |
|<span data-ttu-id="276b8-151">[Print(Boolean)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Print.aspx) 方法（重载 1）</span><span class="sxs-lookup"><span data-stu-id="276b8-151">[Print(Boolean)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Print.aspx) method (overload 1)</span></span>  <br/> |<span data-ttu-id="276b8-152">通过显示“打印”\*\*\*\* 对话框打印在表单的活动视图中呈现的表单内容。</span><span class="sxs-lookup"><span data-stu-id="276b8-152">Prints the form content as it is rendered in the form's active view by displaying the **Print** dialog box.</span></span>  <br/> |
|<span data-ttu-id="276b8-153">[Save](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Save.aspx) 方法</span><span class="sxs-lookup"><span data-stu-id="276b8-153">[Save](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Save.aspx) method</span></span>  <br/> |<span data-ttu-id="276b8-154">将表单保存到当前关联的统一资源定位器 (URL)。</span><span class="sxs-lookup"><span data-stu-id="276b8-154">Saves the form to the Uniform Resource Locator (URL) that it is currently associated with.</span></span>  <br/> |
|<span data-ttu-id="276b8-155">[SaveAs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.SaveAs.aspx) 方法</span><span class="sxs-lookup"><span data-stu-id="276b8-155">[SaveAs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.SaveAs.aspx) method</span></span>  <br/> |<span data-ttu-id="276b8-156">将表单保存到指定的统一资源定位器 (URL)。</span><span class="sxs-lookup"><span data-stu-id="276b8-156">Saves the form to the specified Uniform Resource Locator (URL).</span></span>  <br/> |
|<span data-ttu-id="276b8-157">[SetSaveAsDialogFilename](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.SetSaveAsDialogFilename.aspx) 方法</span><span class="sxs-lookup"><span data-stu-id="276b8-157">[SetSaveAsDialogFilename](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.SetSaveAsDialogFilename.aspx) method</span></span>  <br/> |<span data-ttu-id="276b8-158">设置\*\*\*\*“另存为”对话框的默认文件名。</span><span class="sxs-lookup"><span data-stu-id="276b8-158">Sets the default filename for the **SaveAs** dialog box.</span></span>  <br/> |
|<span data-ttu-id="276b8-159">[SetSaveAsDialogLocation](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.SetSaveAsDialogLocation.aspx) 方法</span><span class="sxs-lookup"><span data-stu-id="276b8-159">[SetSaveAsDialogLocation](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.SetSaveAsDialogLocation.aspx) method</span></span>  <br/> |<span data-ttu-id="276b8-160">设置使用“另存为”\*\*\*\* 对话框保存表单的默认路径。</span><span class="sxs-lookup"><span data-stu-id="276b8-160">Sets the default path for saving the form using the **SaveAs** dialog box.</span></span>  <br/> |
|<span data-ttu-id="276b8-161">[Submit](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Submit.aspx) 方法</span><span class="sxs-lookup"><span data-stu-id="276b8-161">[Submit](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Submit.aspx) method</span></span>  <br/> |<span data-ttu-id="276b8-162">使用表单模板中定义的提交操作来提交表单。</span><span class="sxs-lookup"><span data-stu-id="276b8-162">Submits the form using the submit operation defined in the form template.</span></span>  <br/> |
|<span data-ttu-id="276b8-163">[CurrentView](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.CurrentView.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="276b8-163">[CurrentView](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.CurrentView.aspx) property</span></span>  <br/> |<span data-ttu-id="276b8-164">获取一个代表表单的当前视图的 [View](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.View.aspx) 对象。</span><span class="sxs-lookup"><span data-stu-id="276b8-164">Gets a [View](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.View.aspx) object that represents the current view of the form.</span></span>  <br/> |
|<span data-ttu-id="276b8-165">[DataConnections](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.DataConnections.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="276b8-165">[DataConnections](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.DataConnections.aspx) property</span></span>  <br/> |<span data-ttu-id="276b8-166">获取一个与表单关联的 [DataConnectionCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataConnectionCollection.aspx) 对象。</span><span class="sxs-lookup"><span data-stu-id="276b8-166">Gets a [DataConnectionCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataConnectionCollection.aspx) object associated with the form.</span></span>  <br/> |
|<span data-ttu-id="276b8-167">[DataSources](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.DataSources.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="276b8-167">[DataSources](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.DataSources.aspx) property</span></span>  <br/> |<span data-ttu-id="276b8-168">获取与表单关联的 [DataSourceCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.aspx) 对象。</span><span class="sxs-lookup"><span data-stu-id="276b8-168">Gets the [DataSourceCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.aspx) object associated with the form.</span></span>  <br/> |
|<span data-ttu-id="276b8-169">[Dirty](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Dirty.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="276b8-169">[Dirty](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Dirty.aspx) property</span></span>  <br/> |<span data-ttu-id="276b8-170">获取一个值，该值指示表单中的数据自上次保存之后是否被修改过。</span><span class="sxs-lookup"><span data-stu-id="276b8-170">Gets a value that indicates whether the data in a form has been modified since it was last saved.</span></span>  <br/> |
|<span data-ttu-id="276b8-171">[Errors](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Errors.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="276b8-171">[Errors](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Errors.aspx) property</span></span>  <br/> |<span data-ttu-id="276b8-172">获取一个对与表单关联的 [FormErrorCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.aspx) 的引用。</span><span class="sxs-lookup"><span data-stu-id="276b8-172">Gets a reference to the [FormErrorCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.aspx) that is associated with a form.</span></span>  <br/> |
|<span data-ttu-id="276b8-173">[Extension](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Extension.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="276b8-173">[Extension](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Extension.aspx) property</span></span>  <br/> |<span data-ttu-id="276b8-174">获取一个 [System.Object](https://msdn.microsoft.com/library/system.object%28v=vs.110%29.aspx)，用于使用 [System.Reflection](https://msdn.microsoft.com/library/system.reflection(v=vs.110).aspx) 访问表单的主要表单代码文件中包含的函数和全局变量。</span><span class="sxs-lookup"><span data-stu-id="276b8-174">Gets an [System.Object](https://msdn.microsoft.com/library/system.object%28v=vs.110%29.aspx) for accessing the functions and global variables contained in a form's primary form code file using [System.Reflection](https://msdn.microsoft.com/library/system.reflection(v=vs.110).aspx).</span></span>  <br/> |
|<span data-ttu-id="276b8-175">[FormState](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.FormState.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="276b8-175">[FormState](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.FormState.aspx) property</span></span>  <br/> |<span data-ttu-id="276b8-176">获取一个对 [System.Collections.IDictionary](https://msdn.microsoft.com/library/system.collections.idictionary%28v=vs.110%29.aspx) 类型的属性包的引用，启用浏览器功能的表单可以使用该属性包来维护服务器上各个会话的状态信息。</span><span class="sxs-lookup"><span data-stu-id="276b8-176">Gets a reference to a property bag of type [System.Collections.IDictionary](https://msdn.microsoft.com/library/system.collections.idictionary%28v=vs.110%29.aspx) that browser-enabled forms can use to maintain state information across sessions on the server.</span></span>  <br/> |
|<span data-ttu-id="276b8-177">[Host](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Host.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="276b8-177">[Host](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Host.aspx) property</span></span>  <br/> |<span data-ttu-id="276b8-178">获取一个 [System.Object](https://msdn.microsoft.com/library/system.object%28v=vs.110%29.aspx)，在 InfoPath 的宿主实例中运行的代码可以使用它访问宿主应用程序的对象模型。</span><span class="sxs-lookup"><span data-stu-id="276b8-178">Gets a [System.Object](https://msdn.microsoft.com/library/system.object%28v=vs.110%29.aspx) that code running in a hosted instance of InfoPath can use to access the object model of the host application.</span></span>  <br/> |
|<span data-ttu-id="276b8-179">[Hosted](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Hosted.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="276b8-179">[Hosted](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Hosted.aspx) property</span></span>  <br/> |<span data-ttu-id="276b8-180">获取一个值，指示 InfoPath 是否作为控件承载在另一个应用程序中。</span><span class="sxs-lookup"><span data-stu-id="276b8-180">Gets whether InfoPath is hosted as a control in another application.</span></span>  <br/> |
|<span data-ttu-id="276b8-181">[HostName](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.HostName.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="276b8-181">[HostName](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.HostName.aspx) property</span></span>  <br/> |<span data-ttu-id="276b8-182">获取将 InfoPath 作为控件承载的应用程序的名称。</span><span class="sxs-lookup"><span data-stu-id="276b8-182">Gets the name of the application hosting InfoPath as a control.</span></span>  <br/> |
|<span data-ttu-id="276b8-183">[MainDataSource](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.MainDataSource.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="276b8-183">[MainDataSource](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.MainDataSource.aspx) property</span></span>  <br/> |<span data-ttu-id="276b8-184">获取一个代表表单主数据源的 [DataSource](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.aspx) 对象。</span><span class="sxs-lookup"><span data-stu-id="276b8-184">Gets a [DataSource](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.aspx) object that represents the main data source of the form.</span></span>  <br/> |
|<span data-ttu-id="276b8-185">[NamespaceManager](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.NamespaceManager.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="276b8-185">[NamespaceManager](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.NamespaceManager.aspx) property</span></span>  <br/> |<span data-ttu-id="276b8-186">获取一个对 [XmlNamespaceManager](https://msdn.microsoft.com/library/System.Xml.XmlNamespaceManager.aspx) 对象的引用，该对象可用于解析、添加或删除表单中使用的命名空间。</span><span class="sxs-lookup"><span data-stu-id="276b8-186">Gets a reference to a [XmlNamespaceManager](https://msdn.microsoft.com/library/System.Xml.XmlNamespaceManager.aspx) object that can be used to resolve, add, or remove namespaces used in the form.</span></span>  <br/> |
|<span data-ttu-id="276b8-187">[New](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.New.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="276b8-187">[New](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.New.aspx) property</span></span>  <br/> |<span data-ttu-id="276b8-188">获取一个指定表单是否为新表单的值。</span><span class="sxs-lookup"><span data-stu-id="276b8-188">Gets a value that specifies whether a form is new.</span></span>  <br/> |
|<span data-ttu-id="276b8-189">[Permission](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Permission.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="276b8-189">[Permission](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Permission.aspx) property</span></span>  <br/> |<span data-ttu-id="276b8-190">获取一个对与表单关联的 [Permission](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.aspx) 对象的引用。</span><span class="sxs-lookup"><span data-stu-id="276b8-190">Gets a reference to a [Permission](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.aspx) object associated with the form.</span></span>  <br/> |
|<span data-ttu-id="276b8-191">[QueryDataConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.QueryDataConnection.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="276b8-191">[QueryDataConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.QueryDataConnection.aspx) property</span></span>  <br/> |<span data-ttu-id="276b8-192">获取一个对 [DataConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataConnection.aspx) 对象的引用，该对象代表与表单关联的数据连接。</span><span class="sxs-lookup"><span data-stu-id="276b8-192">Gets a reference to the [DataConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataConnection.aspx) object that represents the data connection that is associated with the form.</span></span>  <br/> |
|<span data-ttu-id="276b8-193">[ReadOnly](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.ReadOnly.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="276b8-193">[ReadOnly](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.ReadOnly.aspx) property</span></span>  <br/> |<span data-ttu-id="276b8-194">获取一个值，该值指示表单模板是否处于只读或锁定状态。</span><span class="sxs-lookup"><span data-stu-id="276b8-194">Gets a value that indicates whether a form template is read-only or locked.</span></span>  <br/> |
|<span data-ttu-id="276b8-195">[Recovered](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Recovered.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="276b8-195">[Recovered](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Recovered.aspx) property</span></span>  <br/> |<span data-ttu-id="276b8-196">获取一个值，该值指示表单上次是否是由自动恢复保存操作保存的。</span><span class="sxs-lookup"><span data-stu-id="276b8-196">Gets a value that indicates whether a form was last saved by an AutoRecover save operation.</span></span>  <br/> |
|<span data-ttu-id="276b8-197">[Signed](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Signed.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="276b8-197">[Signed](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Signed.aspx) property</span></span>  <br/> |<span data-ttu-id="276b8-198">获取一个值，该值指示是否已经对表单进行过数字签名。</span><span class="sxs-lookup"><span data-stu-id="276b8-198">Gets a value that indicates whether a form has been digitally signed using digital signatures.</span></span>  <br/> |
|<span data-ttu-id="276b8-199">[SignedDataBlocks](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.SignedDataBlocks.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="276b8-199">[SignedDataBlocks](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.SignedDataBlocks.aspx) property</span></span>  <br/> |<span data-ttu-id="276b8-200">获取一个对与表单关联的 [SignedDataBlockCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlockCollection.aspx) 集合的引用。</span><span class="sxs-lookup"><span data-stu-id="276b8-200">Gets a reference to the [SignedDataBlockCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlockCollection.aspx) collection that is associated with a form.</span></span>  <br/> |
|<span data-ttu-id="276b8-201">[TaskPanes](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.TaskPanes.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="276b8-201">[TaskPanes](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.TaskPanes.aspx) property</span></span>  <br/> |<span data-ttu-id="276b8-202">获取一个对与表单模板关联的 [TaskPaneCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.TaskPaneCollection.aspx) 的引用。</span><span class="sxs-lookup"><span data-stu-id="276b8-202">Gets a reference to the [TaskPaneCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.TaskPaneCollection.aspx) that is associated with a form template.</span></span>  <br/> |
|<span data-ttu-id="276b8-203">[Template](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Template.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="276b8-203">[Template](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Template.aspx) property</span></span>  <br/> |<span data-ttu-id="276b8-204">获取一个对 [FormTemplate](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormTemplate.aspx) 对象的引用，该对象代表与表单关联的表单模板的清单 (.xsf)。</span><span class="sxs-lookup"><span data-stu-id="276b8-204">Gets a reference to the [FormTemplate](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormTemplate.aspx) object that represents the manifest (.xsf) of the form template associated with the form.</span></span>  <br/> |
|<span data-ttu-id="276b8-205">[Uri](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Uri.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="276b8-205">[Uri](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Uri.aspx) property</span></span>  <br/> |<span data-ttu-id="276b8-206">获取表单的统一资源标识符 (URI)。</span><span class="sxs-lookup"><span data-stu-id="276b8-206">Gets the Uniform Resource Identifier (URI) of a form.</span></span>  <br/> |
|<span data-ttu-id="276b8-207">[UserRole](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.UserRole.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="276b8-207">[UserRole](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.UserRole.aspx) property</span></span>  <br/> |<span data-ttu-id="276b8-208">获取或设置表单角色名称的当前用户。</span><span class="sxs-lookup"><span data-stu-id="276b8-208">Gets or sets the current user of the form's role name.</span></span>  <br/> |
|<span data-ttu-id="276b8-209">[ViewInfos](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.ViewInfos.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="276b8-209">[ViewInfos](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.ViewInfos.aspx) property</span></span>  <br/> |<span data-ttu-id="276b8-210">获取一个对与表单模板关联的 [ViewInfoCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.ViewInfoCollection.aspx) 对象的引用</span><span class="sxs-lookup"><span data-stu-id="276b8-210">Gets a reference to the [ViewInfoCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.ViewInfoCollection.aspx) object associated with the form template.</span></span>  <br/> |
|<span data-ttu-id="276b8-211">[XmlLang](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.XmlLang.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="276b8-211">[XmlLang](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.XmlLang.aspx) property</span></span>  <br/> |<span data-ttu-id="276b8-212">获取表单的基础 XML 文档中 **xml:lang** 属性的值。</span><span class="sxs-lookup"><span data-stu-id="276b8-212">Gets the value of the **xml:lang** attribute in the underlying XML document of the form.</span></span>  <br/> |
   
## <a name="using-the-xmlformcollection-class"></a><span data-ttu-id="276b8-213">使用 XmlFormCollection 类</span><span class="sxs-lookup"><span data-stu-id="276b8-213">Using the XmlFormCollection Class</span></span>

<span data-ttu-id="276b8-p103">可以通过 **Application** 类的 [XmlForms](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Application.XmlForms.aspx) 属性访问 [XmlFormCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Application.aspx) 类。在使用 [Microsoft.Office.InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) 命名空间的成员提供的对象模型创建的托管代码表单模板中，可以在表单代码中使用 **this** (C#) 或 **Me** (Visual Basic) 关键字访问 **Application** 类及其成员。</span><span class="sxs-lookup"><span data-stu-id="276b8-p103">The **XmlFormCollection** class is accessed through the [XmlForms](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Application.XmlForms.aspx) property of the [Application](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Application.aspx) class. In a managed code form template created using the object model provided by the members of the [Microsoft.Office.InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) namespace, you can use the **this** (C#) or **Me** (Visual Basic) keyword in your form code to access the **Application** class and its members.</span></span> 
  
<span data-ttu-id="276b8-p104">下面的示例使用 **Application** 类的 **XmlForms** 属性创建一个名为 myForms 的对象变量，该对象变量引用当前运行的 InfoPath 实例的 **XDocumentsCollection** 对象。然后，此变量可用来显示已打开表单的数量。</span><span class="sxs-lookup"><span data-stu-id="276b8-p104">The following example uses the **XmlForms** property of the **Application** class to create an object variable named myForms that references the **XDocumentsCollection** object of the currently running instance of InfoPath. This variable is then used to display the count of forms that are open.</span></span> 
  
```cs
// Create variable for accessing the XmlFormCollection.
XmlFormCollection myForms = this.Application.XmlForms;
// Display the number of forms that are currently open.
MessageBox.Show("Forms open: " + myForms.Count);
```

```vb
// Create variable for accessing the XmlFormCollection.
Dim myForms As XmlFormCollection = Me.Application.XmlForms
' Display the number of forms that are currently open.
MessageBox.Show("Forms open: " + myForms.Count)
```

<span data-ttu-id="276b8-218">然后，还可以使用 myForms 变量创建新表单（使用 **New** 或 **NewFromTemplate** 方法之一），或者打开现有表单（使用 **Open** 方法之一）。</span><span class="sxs-lookup"><span data-stu-id="276b8-218">The myForms variable can then also be used to create new forms (using one of the **New** or **NewFromTemplate** methods) or open existing forms (using one of the **Open** methods).</span></span> 
  
## <a name="using-the-xmlform-class"></a><span data-ttu-id="276b8-219">使用 XmlForm 类</span><span class="sxs-lookup"><span data-stu-id="276b8-219">Using the XmlForm Class</span></span>

<span data-ttu-id="276b8-220">在使用 [Microsoft.Office.InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) 命名空间的成员提供的对象模型创建的托管代码表单模板中，可以在表单代码中使用 **this** (C#) 或 **Me** (Visual Basic) 关键字直接访问 [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) 类的成员（而无需对象变量建立对 [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) 类的引用）。</span><span class="sxs-lookup"><span data-stu-id="276b8-220">In a managed code form template created using the object model provided by the members of the [Microsoft.Office.InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) namespace, you can use the **this** (C#) or **Me** (Visual Basic) keyword in your form code to access the members of the [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) class directly (without requiring an object variable that establishes a reference to the [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) class).</span></span> 
  
### <a name="accessing-a-forms-property-values"></a><span data-ttu-id="276b8-221">访问表单的属性值</span><span class="sxs-lookup"><span data-stu-id="276b8-221">Accessing a Form's Property Values</span></span>

<span data-ttu-id="276b8-222">下面的示例使用 **this** 或 **Me** 关键字访问 **XmlForm** 类的 **New**、 **ReadOnly**、 **Signed** 和 **Uri** 属性，并在一个消息框中显示为当前表单返回的值。</span><span class="sxs-lookup"><span data-stu-id="276b8-222">The following example uses the **this** or **Me** keyword to access the **New**, **ReadOnly**, **Signed**, and **Uri** properties of the **XmlForm** class and display the values returned for the current form in a message box.</span></span> 
  
```cs
MessageBox.Show(
   "Is new: " + this.New + System.Environment.NewLine +
   "Is read-only: " + this.ReadOnly + System.Environment.NewLine +
   "Is signed: " + this.Signed + System.Environment.NewLine +
   "Form URI: " + this.Uri);
```

```vb
MessageBox.Show( _
   "Is new: " &amp; Me.New &amp; System.Environment.NewLine &amp; _
   "Is read-only: " &amp; Me.ReadOnly &amp; System.Environment.NewLine + _
   "Is signed: " &amp; Me.Signed &amp; System.Environment.NewLine &amp; _
   "Form URI: " &amp; this.Uri)
```

### <a name="accessing-a-forms-data-source"></a><span data-ttu-id="276b8-223">访问表单的数据源</span><span class="sxs-lookup"><span data-stu-id="276b8-223">Accessing a Form's Data Source</span></span>

<span data-ttu-id="276b8-p105">**XmlForm** 类与表单数据有关的一个关键属性是 **MainDataSource** 属性。此属性返回对 [DataSource](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.aspx) 对象的引用，该对象代表当前表单的基础 XML 数据，也称为表单的 主 数据源或 主要 数据源。 **DataSource** 类提供了 [CreateNavigator](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.CreateNavigator.aspx) 方法，该方法可创建一个位于表单基础 XML 文档根节点处的 [XPathNavigator](https://msdn.microsoft.com/library/system.xml.xpath.xpathnavigator%28v=vs.110%29.aspx) 对象。随后，可以使用 **XPathNavigator** 类的属性和方法来浏览和编辑表单的基础 XML 数据。</span><span class="sxs-lookup"><span data-stu-id="276b8-p105">A key property of the **XmlForm** class with respect to form data is the **MainDataSource** property. This property returns a reference to a [DataSource](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.aspx) object that represents the underlying XML data of the current form, which is also referred to as the form's main or primary data source. The **DataSource** class provides the [CreateNavigator](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.CreateNavigator.aspx) method, which creates a [XPathNavigator](https://msdn.microsoft.com/library/system.xml.xpath.xpathnavigator%28v=vs.110%29.aspx) object positioned at the root of the form's underlying XML document. The properties and methods of the **XPathNavigator** class can then be used to navigate and edit the form's underlying XML data.</span></span> 
  
<span data-ttu-id="276b8-p106">下面的示例使用 **XmlForm** 类的 **MainDataSource** 属性创建一个位于表单主数据源根节点处的 **XPathNavigator** 对象。然后，可以使用 **XPathNavigator** 类的 **OuterXml** 属性返回和显示表单的基础 XML 文档的全部内容。</span><span class="sxs-lookup"><span data-stu-id="276b8-p106">The following example uses the **MainDataSource** property of the **XmlForm** class to create an **XPathNavigator** object positioned at the root of the form's main data source. The **OuterXml** property of the **XPathNavigator** class is then used to return and display all of the contents of a form's underlying XML document.</span></span> 
  
```cs
// Get outer XML of the underlying XML document.
string myDoc = this.MainDataSource.CreateNavigator.OuterXml.ToString();
// Display XML.
MessageBox.Show(myDoc);
```

```vb
' Get outer XML of the underlying XML document.
Dim myDoc As String myDoc = _
   Me.MainDataSource.CreateNavigator.OuterXml.ToString()
' Display XML.
MessageBox.Show(myDoc)
```

> [!NOTE]
> <span data-ttu-id="276b8-230">由于在使用 **this** 或 **Me** 关键字访问时，InfoPath 将 **MainDataSource** 属性视为 **XmlForm** 对象的默认属性，因此可以在用于创建 **XPathNavigator** 对象的代码行中省略该属性。</span><span class="sxs-lookup"><span data-stu-id="276b8-230">Because InfoPath treats the **MainDataSource** property as a default property of the **XmlForm** object accessed when using the **this** or **Me** keywords, you can omit it from the line of code used to create the **XPathNavigator** object.</span></span> 
  
<span data-ttu-id="276b8-231">若要了解有关 InfoPath 表单模板业务逻辑中的 **XPathNavigator** 类的详细信息，请参阅[使用 XPathNavigator 和 XPathNodeIterator 类](how-to-work-with-the-xpathnavigator-and-xpathnodeiterator-classes.md)。</span><span class="sxs-lookup"><span data-stu-id="276b8-231">To learn more about the **XPathNavigator** class in an InfoPath form template's business logic, see [Work with the XPathNavigator and XPathNodeIterator Classes](how-to-work-with-the-xpathnavigator-and-xpathnodeiterator-classes.md).</span></span>
  
### <a name="accessing-data-about-a-forms-form-template-file"></a><span data-ttu-id="276b8-232">访问有关表单的表单模板文件的数据</span><span class="sxs-lookup"><span data-stu-id="276b8-232">Accessing Data About a Form's Form Template File</span></span>

<span data-ttu-id="276b8-p107">还可以使用 **XmlForm** 类访问有关与某个表单关联的表单模板的信息，包括表单定义文件 (.xsf ) 和表单所包含的源 XML 数据。使用 [Template](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Template.aspx) 属性可以访问这些信息，该属性返回对 [FormTemplate](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormTemplate.aspx) 对象的引用，而该对象代表与当前表单关联的表单模板。</span><span class="sxs-lookup"><span data-stu-id="276b8-p107">Information about the form template associated with a form, including the form definition file (.xsf ) and the source XML data that it contains, can also be accessed using the **XmlForm** class. This information is accessed using the [Template](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Template.aspx) property, which returns a reference to a [FormTemplate](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormTemplate.aspx) object that represents the form template associated with the current form.</span></span> 
  
<span data-ttu-id="276b8-p108">在下面的示例中，第一个消息框显示通过 **Template** 类提供的一些数据，例如，统一资源标识符 (URI) 位置（使用 [Uri](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormTemplate.Uri.aspx) 属性）、缓存标识符（使用 [CacheId](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormTemplate.CacheId.aspx) 属性）及其版本号（使用 [Version](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormTemplate.Version.aspx) 属性）。下一个消息框使用 [Template](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormTemplate.Manifest.aspx) 类的 **Manifest** 属性创建一个 **XPathNavigator** 对象，该对象用来显示表单定义文件 (.xsf) 的源 XML。</span><span class="sxs-lookup"><span data-stu-id="276b8-p108">In the following example, the first message box displays some of the data that is available through the **Template** class, such as its Uniform Resource Identifier (URI) location (using the [Uri](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormTemplate.Uri.aspx) property), the cache identifier (using the [CacheId](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormTemplate.CacheId.aspx) property) and its version number (using the [Version](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormTemplate.Version.aspx) property). The next message box uses the [Manifest](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormTemplate.Manifest.aspx) property of the **Template** class to create an **XPathNavigator** object that is used to display the source XML of the form definition file (.xsf).</span></span> 
  
```cs
// Display form template properties.
MessageBox.Show(
   "Cache ID: " + this.Template.CacheId + System.Environment.NewLine +
   "URI: " + this.ReadOnly + System.Environment.NewLine +
   "Version: " + this.Signed, "Form Template Properties");
// Display form definition file XML.
MessageBox.Show(this.Template.Manifest.OuterXml, 
   "Form Definition File XML");
```

```vb
' Display form template properties.
MessageBox.Show( _
   "Cache ID: " &amp; Me.Template.CacheId &amp; System.Environment.NewLine &amp;
   "URI: " &amp; Me.ReadOnly &amp; System.Environment.NewLine &amp;
   "Version: " &amp; Me.Signed, "Form Template Properties")
' Display form definition file XML.
MessageBox.Show(Me.Template.Manifest.OuterXml, _
   "Form Definition File XML")
```


