---
title: 使用信息权限管理设置
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
keywords:
- information rights management [infopath 2007],InfoPath 2007, Information Rights Management,IRM [InfoPath 2007]
localization_priority: Normal
ms.assetid: 4ad91898-b23e-4410-8839-a65259e53d37
description: Microsoft InfoPath 中提供了两种信息权限管理 (IRM) 设置：一种用于保护对 InfoPath 表单模板的访问，另一种用于控制对已填好表单中包含的表单数据的访问和操作。
ms.openlocfilehash: 4e6fdac6a0b2b5cd6a29de948cc9dbbd01a407d8
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/11/2018
ms.locfileid: "19774021"
---
# <a name="work-with-information-rights-management-settings"></a><span data-ttu-id="2fee1-104">使用信息权限管理设置</span><span class="sxs-lookup"><span data-stu-id="2fee1-104">Work with Information Rights Management Settings</span></span>

<span data-ttu-id="2fee1-105">Microsoft InfoPath 中提供了两种信息权限管理 (IRM) 设置：一种用于保护对 InfoPath 表单模板的访问，另一种用于控制对已填好表单中包含的表单数据的访问和操作。</span><span class="sxs-lookup"><span data-stu-id="2fee1-105">There are two types of Information Rights Management (IRM) settings available in Microsoft InfoPath: one for protecting access to InfoPath form templates, and one for controlling access to and actions on form data contained in completed forms.</span></span>
  
> [!NOTE]
> <span data-ttu-id="2fee1-p101">权限限制只能用于与 InfoPath 编辑器兼容的表单模板。与浏览器兼容的表单模板不支持 IRM。</span><span class="sxs-lookup"><span data-stu-id="2fee1-p101">Restricting permission is only available to form templates compatible with the InfoPath editor. Browser-compatible form templates do not support IRM.</span></span> 
  
## <a name="adding-the-manage-credentials-command-to-the-quick-access-toolbar"></a><span data-ttu-id="2fee1-108">将"管理凭据"命令添加到快速访问工具栏中</span><span class="sxs-lookup"><span data-stu-id="2fee1-108">Adding the Manage Credentials Command to the Quick Access Toolbar</span></span>

<span data-ttu-id="2fee1-109">用于设计表单模板时使用 IRM 设置的**管理凭据**命令不可用默认情况下。</span><span class="sxs-lookup"><span data-stu-id="2fee1-109">The **Manage Credentials** command used to work with IRM settings when designing a form template is not available by default.</span></span> <span data-ttu-id="2fee1-110">使用以下步骤将其添加到**快速访问工具栏**。</span><span class="sxs-lookup"><span data-stu-id="2fee1-110">Use the following steps to add it to the **Quick Access Toolbar**.</span></span>
  
### <a name="add-the-manage-credentials-command-to-the-quick-access-toolbar"></a><span data-ttu-id="2fee1-111">将"管理凭据"命令添加到快速访问工具栏中</span><span class="sxs-lookup"><span data-stu-id="2fee1-111">Add the Manage Credentials Command to the Quick Access Toolbar</span></span>

1.  <span data-ttu-id="2fee1-112">单击**快速访问工具栏****自定义快速访问工具栏**菜单中，向下拉右侧的箭头，然后单击**更多命令**。</span><span class="sxs-lookup"><span data-stu-id="2fee1-112">Click the arrow on the right end of the **Quick Access Toolbar** to pull down the **Customize Quick Access Toolbar** menu, and then click **More Commands**.</span></span>
    
2. <span data-ttu-id="2fee1-113">在**从下列位置选择命令**列表中，选择**所有命令**。</span><span class="sxs-lookup"><span data-stu-id="2fee1-113">In the **Choose commands from** list, select **All Commands**.</span></span>
    
3. <span data-ttu-id="2fee1-114">向下滚动到**管理凭据**，列表，然后单击**添加**。</span><span class="sxs-lookup"><span data-stu-id="2fee1-114">Scroll down the list to **Manage Credentials**, and then click **Add**.</span></span>
    
4. <span data-ttu-id="2fee1-115">单击“**确定**”。</span><span class="sxs-lookup"><span data-stu-id="2fee1-115">Click **OK**.</span></span>
    
<span data-ttu-id="2fee1-116">有关使用**管理凭据**命令和**权限**对话框中，请参阅 InfoPath 帮助中的"创建表单模板具有受限权限"主题。</span><span class="sxs-lookup"><span data-stu-id="2fee1-116">For more information about using **Manage Credentials** command and the **Permission** dialog box in InfoPath, see the "Create a Form Template with Restricted Permission" topic in InfoPath help.</span></span> 
  
## <a name="the-irm-object-model"></a><span data-ttu-id="2fee1-117">IRM 对象模型</span><span class="sxs-lookup"><span data-stu-id="2fee1-117">The IRM Object Model</span></span>

<span data-ttu-id="2fee1-p103">使用 [Permission](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.aspx) 类可访问 [UserPermissionCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.aspx) 和可应用于表单的 IRM 权限设置。要访问与表单模板关联的 **Permission** 对象，请使用 [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Permission.aspx) 类的 [Permission](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) 属性。返回的 **Permission** 对象提供对与表单模板以及用该模板创建的每个表单实例关联的 [UserPermission](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermission.aspx) 对象集合的访问。</span><span class="sxs-lookup"><span data-stu-id="2fee1-p103">Use the [Permission](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.aspx) class to access the [UserPermissionCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.aspx) and IRM permission settings that can be applied to a form. To access the **Permission** object associated with a form template, use the [Permission](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Permission.aspx) property of the [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) class. The returned **Permission** object provides access to the collection of [UserPermission](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermission.aspx) objects associated with the form template and each form instance created with that template.</span></span> 
  
<span data-ttu-id="2fee1-p104">不论权限是否仅限于活动的表单模板， **Permission** 对象及其属性和成员都可用。使用 [Enabled](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.Enabled.aspx) 属性可以确定表单是否具有受限的权限。</span><span class="sxs-lookup"><span data-stu-id="2fee1-p104">The **Permission** object and its properties and methods are available whether permissions are restricted on the active form template or not. Use the [Enabled](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.Enabled.aspx) property to determine whether a form has restricted permissions.</span></span> 
  
<span data-ttu-id="2fee1-123">通过使用 Permission 类的属性和方法按以下方式之一来启用表单的权限：</span><span class="sxs-lookup"><span data-stu-id="2fee1-123">Permissions on a form are enabled in one of the following ways by using properties and methods of the Permission class:</span></span>
  
<span data-ttu-id="2fee1-124">将 **Enabled** 属性设置为 **true**。</span><span class="sxs-lookup"><span data-stu-id="2fee1-124">The **Enabled** property is set to **true**.</span></span>
  
<span data-ttu-id="2fee1-125">设置 [DocumentAuthor](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.DocumentAuthor.aspx) 属性。</span><span class="sxs-lookup"><span data-stu-id="2fee1-125">The [DocumentAuthor](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.DocumentAuthor.aspx) property is set.</span></span> 
  
<span data-ttu-id="2fee1-126">设置 [RequestPermissionUrl](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.RequestPermissionUrl.aspx) 属性。</span><span class="sxs-lookup"><span data-stu-id="2fee1-126">The [RequestPermissionUrl](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.RequestPermissionUrl.aspx) property is set.</span></span> 
  
<span data-ttu-id="2fee1-127">将 [StoreLicenses](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.StoreLicenses.aspx) 属性设置为 **true** 或 **false**。</span><span class="sxs-lookup"><span data-stu-id="2fee1-127">The [StoreLicenses](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.StoreLicenses.aspx) property is set to **true** or **false**.</span></span>
  
<span data-ttu-id="2fee1-128">调用 [ApplyPolicy](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.ApplyPolicy.aspx) 方法。</span><span class="sxs-lookup"><span data-stu-id="2fee1-128">The [ApplyPolicy](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.ApplyPolicy.aspx) method is called.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="2fee1-129">如果用户计算机上未安装 Windows 权限管理客户端，则使用 **Permission** 类将引发异常。</span><span class="sxs-lookup"><span data-stu-id="2fee1-129">If the Windows Rights Management client is not installed on a user's computer, using the **Permission** class raises an exception.</span></span> 
  
<span data-ttu-id="2fee1-130">要以编程方式使用表单中各个用户的 IRM 设置，请使用 **UserPermissionCollection** 和 **UserPermission** 类。</span><span class="sxs-lookup"><span data-stu-id="2fee1-130">To work programmatically with IRM settings of individual users in forms, use the **UserPermissionCollection** and **UserPermission** classes.</span></span> 
  
<span data-ttu-id="2fee1-131">**UserPermission**对象将与单个用户和可选的到期日期关联一的组的当前表单的权限。</span><span class="sxs-lookup"><span data-stu-id="2fee1-131">A **UserPermission** object associates a set of permissions for the current form with a single user and an optional expiration date.</span></span> <span data-ttu-id="2fee1-132">使用**UserPermissionCollection**类的[Add](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.Add.aspx)方法添加并向用户授予一组对当前表单的权限。</span><span class="sxs-lookup"><span data-stu-id="2fee1-132">Use the [Add](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.Add.aspx) method of the **UserPermissionCollection** class to add and grant a user a set of permissions on the current form.</span></span> <span data-ttu-id="2fee1-133">使用**UserPermissionCollection**类的[Remove](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.Remove.aspx)方法删除用户和用户的权限。</span><span class="sxs-lookup"><span data-stu-id="2fee1-133">Use the [Remove](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.Remove.aspx) method of the **UserPermissionCollection** class to remove a user and the user's permissions.</span></span> <span data-ttu-id="2fee1-134">时某些通过用户界面中授予的权限应用于所有用户，例如打印和到期日期，您可以使用**UserPermission**和**UserPermissionCollection**类以便将它们分配每用户与基于每个用户到期日期。</span><span class="sxs-lookup"><span data-stu-id="2fee1-134">While some permissions granted through the user interface apply to all users, such as printing and expiration date, you can use the **UserPermission** and **UserPermissionCollection** classes to assign them on a per-user basis with per-user expiration dates.</span></span> <span data-ttu-id="2fee1-135">对象模型允许开发人员可以枚举窗体中的权限设置，并提供允许窗体用户添加到表单的权限，而无需使用**表单权限**的任务窗格或**权限**对话框的功能。</span><span class="sxs-lookup"><span data-stu-id="2fee1-135">The object model allows developers to enumerate permission settings in a form and to provide functionality that allows form users to add permissions to the form without having to use the **Form Permission** task pane or the **Permission** dialog box.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="2fee1-p106">在表单处于预览模式时，无法应用权限。因此，在预览表单时， **Permission** 类的所有属性都是只读的。在预览模式下， **Enabled** 属性将始终返回 **false**，如果代码尝试更改此设置，则会引发 **System.Runtime.InteropServices.COMException**，并返回"该属性/方法在预览模式下不可用"错误。同样，当在预览模式下使用时，与 **UserPermission** 和 **UserPermissionCollection** 类关联的方法也将返回此错误消息。</span><span class="sxs-lookup"><span data-stu-id="2fee1-p106">Permissions cannot be applied when a form is in preview mode. For this reason, all of the properties of the **Permission** class are read-only when a form is being previewed. In preview mode, the **Enabled** property will always return **false**, and if code attempts to change this setting, a **System.Runtime.InteropServices.COMException** is raised and the error "The property/method is not available in preview mode" is returned. Similarly, the methods associated with the **UserPermission** and **UserPermissionCollection** classes will also return this error message when used in preview mode.</span></span> 
  
### <a name="overview-of-the-permission-class"></a><span data-ttu-id="2fee1-140">Permission 类概述</span><span class="sxs-lookup"><span data-stu-id="2fee1-140">Overview of the Permission Class</span></span>

<span data-ttu-id="2fee1-141">**UserPermissionCollection** 类提供下列属性和一个方法。</span><span class="sxs-lookup"><span data-stu-id="2fee1-141">The **UserPermissionCollection** class provides the following properties and one method.</span></span> 
  
|<span data-ttu-id="2fee1-142">**名称**</span><span class="sxs-lookup"><span data-stu-id="2fee1-142">**Name**</span></span>|<span data-ttu-id="2fee1-143">**说明**</span><span class="sxs-lookup"><span data-stu-id="2fee1-143">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="2fee1-144">[ApplyPolicy](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.ApplyPolicy.aspx) 方法</span><span class="sxs-lookup"><span data-stu-id="2fee1-144">[ApplyPolicy](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.ApplyPolicy.aspx) method</span></span>  <br/> |<span data-ttu-id="2fee1-145">使用策略模板文件将策略应用于表单。</span><span class="sxs-lookup"><span data-stu-id="2fee1-145">Applies a policy to the form using a policy template file.</span></span>  <br/> |
|<span data-ttu-id="2fee1-146">[DocumentAuthor](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.DocumentAuthor.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="2fee1-146">[DocumentAuthor](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.DocumentAuthor.aspx) property</span></span>  <br/> |<span data-ttu-id="2fee1-147">获取或设置当前表单作者的电子邮件地址。</span><span class="sxs-lookup"><span data-stu-id="2fee1-147">Gets or sets the author of the current form as an email address.</span></span>  <br/> |
|<span data-ttu-id="2fee1-148">[Enabled](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.Enabled.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="2fee1-148">[Enabled](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.Enabled.aspx) property</span></span>  <br/> |<span data-ttu-id="2fee1-149">获取或设置一个值，指示是否对当前表单启用了 **Permission** 对象所代表的权限设置。</span><span class="sxs-lookup"><span data-stu-id="2fee1-149">Gets or sets whether the permission settings represented by the **Permission** object are enabled for the current form.</span></span>  <br/> |
|<span data-ttu-id="2fee1-150">[PermissionFromPolicy](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.PermissionFromPolicy.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="2fee1-150">[PermissionFromPolicy](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.PermissionFromPolicy.aspx) property</span></span>  <br/> |<span data-ttu-id="2fee1-151">获取或设置一个值，指示是否对当前表单应用了权限策略。</span><span class="sxs-lookup"><span data-stu-id="2fee1-151">Gets or sets whether a permission policy has been applied to the current form.</span></span>  <br/> |
|<span data-ttu-id="2fee1-152">[PolicyDescription](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.PolicyDescription.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="2fee1-152">[PolicyDescription](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.PolicyDescription.aspx) property</span></span>  <br/> |<span data-ttu-id="2fee1-153">获取应用于当前表单的策略的说明。</span><span class="sxs-lookup"><span data-stu-id="2fee1-153">Gets a description of the policy that was applied to the current form.</span></span>  <br/> |
|<span data-ttu-id="2fee1-154">[PolicyName](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.PolicyName.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="2fee1-154">[PolicyName](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.PolicyName.aspx) property</span></span>  <br/> |<span data-ttu-id="2fee1-155">获取应用于当前表单的策略的名称。</span><span class="sxs-lookup"><span data-stu-id="2fee1-155">Gets the name of the policy that was applied to the current form.</span></span>  <br/> |
|<span data-ttu-id="2fee1-156">[RequestPermissionUrl](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.RequestPermissionUrl.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="2fee1-156">[RequestPermissionUrl](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.RequestPermissionUrl.aspx) property</span></span>  <br/> |<span data-ttu-id="2fee1-157">获取或设置供需要当前表单的额外权限的用户联系文件、 URL 或电子邮件地址。</span><span class="sxs-lookup"><span data-stu-id="2fee1-157">Gets or sets the file, URL, or email address to contact for users who need additional permissions on the current form.</span></span>  <br/> |
|<span data-ttu-id="2fee1-158">[StoreLicenses](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.StoreLicenses.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="2fee1-158">[StoreLicenses](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.StoreLicenses.aspx) property</span></span>  <br/> |<span data-ttu-id="2fee1-159">获取或设置一个值，指示是否缓存用户查看当前表单的许可，以允许在用户无法连接到权限管理服务器时脱机查看。</span><span class="sxs-lookup"><span data-stu-id="2fee1-159">Gets or sets whether the user's license to view the current form should be cached to allow offline viewing when the user cannot connect to a rights management server.</span></span>  <br/> |
|<span data-ttu-id="2fee1-160">[UserPermissions](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.UserPermissions.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="2fee1-160">[UserPermissions](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.UserPermissions.aspx) property</span></span>  <br/> |<span data-ttu-id="2fee1-161">获取当前表单的 **UserPermissionCollection** 对象。</span><span class="sxs-lookup"><span data-stu-id="2fee1-161">Gets a **UserPermissionCollection** object for the current form.</span></span>  <br/> |
   
### <a name="overview-of-the-userpermissioncollection-class"></a><span data-ttu-id="2fee1-162">UserPermissionCollection 类概述</span><span class="sxs-lookup"><span data-stu-id="2fee1-162">Overview of the UserPermissionCollection Class</span></span>

<span data-ttu-id="2fee1-163">**UserPermissionCollection** 类提供下列属性和方法。</span><span class="sxs-lookup"><span data-stu-id="2fee1-163">The **UserPermissionCollection** class provides the following properties and methods.</span></span> 
  
|<span data-ttu-id="2fee1-164">**名称**</span><span class="sxs-lookup"><span data-stu-id="2fee1-164">**Name**</span></span>|<span data-ttu-id="2fee1-165">**说明**</span><span class="sxs-lookup"><span data-stu-id="2fee1-165">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="2fee1-166">[Add](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.Add.aspx) 方法（+3 重载）</span><span class="sxs-lookup"><span data-stu-id="2fee1-166">[Add](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.Add.aspx) method (+3 overloads)</span></span>  <br/> |<span data-ttu-id="2fee1-167">向当前表单添加一个新用户，可以选择指定权限和到期日期。</span><span class="sxs-lookup"><span data-stu-id="2fee1-167">Adds a new user to the current form, optionally specifying permissions and an expiration date.</span></span>  <br/> |
|<span data-ttu-id="2fee1-168">[Remove](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.Remove.aspx) 方法</span><span class="sxs-lookup"><span data-stu-id="2fee1-168">[Remove](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.Remove.aspx) method</span></span>  <br/> |<span data-ttu-id="2fee1-169">从集合中删除具有指定 **UserId** 的 **UserPermission** 对象。</span><span class="sxs-lookup"><span data-stu-id="2fee1-169">Removes the **UserPermission** object with the specified **UserId** from the collection.</span></span>  <br/> |
|<span data-ttu-id="2fee1-170">[RemoveAll](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.RemoveAll.aspx) 方法</span><span class="sxs-lookup"><span data-stu-id="2fee1-170">[RemoveAll](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.RemoveAll.aspx) method</span></span>  <br/> |<span data-ttu-id="2fee1-171">从集合中删除所有 **UserPermission** 对象。</span><span class="sxs-lookup"><span data-stu-id="2fee1-171">Removes all **UserPermission** objects from the collection.</span></span>  <br/> |
|<span data-ttu-id="2fee1-172">[Count](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.Count.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="2fee1-172">[Count](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.Count.aspx) property</span></span>  <br/> |<span data-ttu-id="2fee1-173">获取集合中 **UserPermission** 对象的数目。</span><span class="sxs-lookup"><span data-stu-id="2fee1-173">Gets the number of **UserPermission** objects in the collection.</span></span>  <br/> |
|<span data-ttu-id="2fee1-174">[Item](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.Item.aspx) 属性（+1 重载）</span><span class="sxs-lookup"><span data-stu-id="2fee1-174">[Item](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.Item.aspx) property (+1 overload)</span></span>  <br/> |<span data-ttu-id="2fee1-175">获取一个 **UserPermission** 对象。</span><span class="sxs-lookup"><span data-stu-id="2fee1-175">Gets a **UserPermission** object.</span></span>  <br/> |
   
### <a name="overview-of-the-userpermission-class"></a><span data-ttu-id="2fee1-176">UserPermission 类概述</span><span class="sxs-lookup"><span data-stu-id="2fee1-176">Overview of the UserPermission Class</span></span>

<span data-ttu-id="2fee1-177">**UserPermission** 类提供下列属性和一个方法。</span><span class="sxs-lookup"><span data-stu-id="2fee1-177">The **UserPermission** class provides the following properties and one method.</span></span> 
  
|<span data-ttu-id="2fee1-178">**名称**</span><span class="sxs-lookup"><span data-stu-id="2fee1-178">**Name**</span></span>|<span data-ttu-id="2fee1-179">**说明**</span><span class="sxs-lookup"><span data-stu-id="2fee1-179">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="2fee1-180">[Remove](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermission.Remove.aspx) 方法</span><span class="sxs-lookup"><span data-stu-id="2fee1-180">[Remove](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermission.Remove.aspx) method</span></span>  <br/> |<span data-ttu-id="2fee1-181">从表单的权限中删除当前的 **UserPermission** 对象。</span><span class="sxs-lookup"><span data-stu-id="2fee1-181">Removes the current **UserPermission** object from the form's permissions.</span></span>  <br/> |
|<span data-ttu-id="2fee1-182">[ExpirationDate](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermission.ExpirationDate.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="2fee1-182">[ExpirationDate](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermission.ExpirationDate.aspx) property</span></span>  <br/> |<span data-ttu-id="2fee1-183">获取或设置当前表单的权限的到期日期（可选），这些权限已分配给与 **UserPermission** 类的实例关联的用户。</span><span class="sxs-lookup"><span data-stu-id="2fee1-183">Gets or sets the optional expiration date for the permissions on the current form assigned to the user associated with an instance of the **UserPermission** class.</span></span>  <br/> |
|<span data-ttu-id="2fee1-184">[Permission](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermission.Permission.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="2fee1-184">[Permission](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermission.Permission.aspx) property</span></span>  <br/> |<span data-ttu-id="2fee1-185">获取或设置代表当前表单的权限的值，这些权限已分配给与 **UserPermission** 类的实例关联的用户。</span><span class="sxs-lookup"><span data-stu-id="2fee1-185">Gets or sets a value representing the permissions on the current form assigned to the user associated with an instance of the **UserPermission** class.</span></span>  <br/> |
|<span data-ttu-id="2fee1-186">[UserId](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermission.UserId.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="2fee1-186">[UserId](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermission.UserId.aspx) property</span></span>  <br/> |<span data-ttu-id="2fee1-187">获取当前表单权限由指定的**UserPermission**对象的用户的电子邮件地址。</span><span class="sxs-lookup"><span data-stu-id="2fee1-187">Gets the email address of the user whose permissions on the current form are determined by the specified **UserPermission** object.</span></span>  <br/> |
   
### <a name="the-permissiontype-enumeration"></a><span data-ttu-id="2fee1-188">PermissionType 枚举</span><span class="sxs-lookup"><span data-stu-id="2fee1-188">The PermissionType Enumeration</span></span>

<span data-ttu-id="2fee1-189">使用 [PermissionType](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.PermissionType.aspx) 枚举值来设置或读取用户权限。</span><span class="sxs-lookup"><span data-stu-id="2fee1-189">A user's permissions are set or read using [PermissionType](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.PermissionType.aspx) enumeration values.</span></span> 
  
|<span data-ttu-id="2fee1-190">**名称**</span><span class="sxs-lookup"><span data-stu-id="2fee1-190">**Name**</span></span>|<span data-ttu-id="2fee1-191">**说明**</span><span class="sxs-lookup"><span data-stu-id="2fee1-191">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="2fee1-192">**PermissionType.Change**</span><span class="sxs-lookup"><span data-stu-id="2fee1-192">**PermissionType.Change**</span></span> <br/> |<span data-ttu-id="2fee1-p107">允许用户查看、编辑、复制和保存表单，但不允许打印表单。效果与 **Read**、 **Edit**、 **Save** 和 **Extract** 权限组合相同。  </span><span class="sxs-lookup"><span data-stu-id="2fee1-p107">Allows users to view, edit, copy, and save, but not print a form. Equivalent to the **Read**, **Edit**, **Save**, and **Extract** permissions combined.  </span></span><br/> |
|<span data-ttu-id="2fee1-195">**PermissionType.Edit**</span><span class="sxs-lookup"><span data-stu-id="2fee1-195">**PermissionType.Edit**</span></span> <br/> |<span data-ttu-id="2fee1-196">允许用户编辑表单。</span><span class="sxs-lookup"><span data-stu-id="2fee1-196">Allows the user to edit the form.</span></span>  <br/> |
|<span data-ttu-id="2fee1-197">**PermissionType.Extract**</span><span class="sxs-lookup"><span data-stu-id="2fee1-197">**PermissionType.Extract**</span></span> <br/> |<span data-ttu-id="2fee1-198">允许具有 **Read** 权限的用户复制表单中的内容。</span><span class="sxs-lookup"><span data-stu-id="2fee1-198">Allows a user with the **Read** permission to copy content in the form.</span></span>  <br/> |
|<span data-ttu-id="2fee1-199">**PermissionType.FullControl**</span><span class="sxs-lookup"><span data-stu-id="2fee1-199">**PermissionType.FullControl**</span></span> <br/> |<span data-ttu-id="2fee1-200">允许用户添加、更改和删除表单的其他用户的权限。</span><span class="sxs-lookup"><span data-stu-id="2fee1-200">Allows the user to add, change, and remove permissions for other users of a form.</span></span>  <br/> |
|<span data-ttu-id="2fee1-201">**PermissionType.ObjectModel**</span><span class="sxs-lookup"><span data-stu-id="2fee1-201">**PermissionType.ObjectModel**</span></span> <br/> |<span data-ttu-id="2fee1-p108">允许用户通过表单文档的对象模型以编程方式访问表单文档。不具有 **ObjectModel** 权限的用户不能使用对象模型来确定他们自己的权限。  </span><span class="sxs-lookup"><span data-stu-id="2fee1-p108">Allows a user to access the form document programmatically through its object model. Users without the **ObjectModel** permission cannot use the object model to determine their own permissions.  </span></span><br/> |
|<span data-ttu-id="2fee1-204">**PermissionType.Print**</span><span class="sxs-lookup"><span data-stu-id="2fee1-204">**PermissionType.Print**</span></span> <br/> |<span data-ttu-id="2fee1-205">允许用户打印表单。</span><span class="sxs-lookup"><span data-stu-id="2fee1-205">Allows the user to print the form.</span></span>  <br/> |
|<span data-ttu-id="2fee1-206">**PermissionType.Read**</span><span class="sxs-lookup"><span data-stu-id="2fee1-206">**PermissionType.Read**</span></span> <br/> |<span data-ttu-id="2fee1-p109">允许用户读取（查看）表单。（ **Read** 权限与 **View** 权限等效。）  </span><span class="sxs-lookup"><span data-stu-id="2fee1-p109">Allows the user to read (view) the form. (The **Read** and **View** permissions are equivalent.)  </span></span><br/> |
|<span data-ttu-id="2fee1-209">**PermissionType.Save**</span><span class="sxs-lookup"><span data-stu-id="2fee1-209">**PermissionType.Save**</span></span> <br/> |<span data-ttu-id="2fee1-210">允许用户保存表单。</span><span class="sxs-lookup"><span data-stu-id="2fee1-210">Allows the user to save the form.</span></span>  <br/> |
|<span data-ttu-id="2fee1-211">**PermissionType.View**</span><span class="sxs-lookup"><span data-stu-id="2fee1-211">**PermissionType.View**</span></span> <br/> |<span data-ttu-id="2fee1-p110">允许用户查看（读取）表单。（ **Read** 权限与 **View** 权限等效。）  </span><span class="sxs-lookup"><span data-stu-id="2fee1-p110">Allows the user to view (read) the form. (The **Read** and **View** permissions are equivalent.)  </span></span><br/> |
   
### <a name="example"></a><span data-ttu-id="2fee1-214">示例</span><span class="sxs-lookup"><span data-stu-id="2fee1-214">Example</span></span>

<span data-ttu-id="2fee1-215">在以下示例中，单击**按钮**控件获取当前表单的**UserPermissionsCollection** ，并将用户分配给更改访问级别，并添加设置两天的到期日期从当前日期。</span><span class="sxs-lookup"><span data-stu-id="2fee1-215">In the following example, clicking the **Button** control gets the **UserPermissionsCollection** for the current form, adds and assigns a user to the Change access level, and sets an expiration date of two days from the current date.</span></span> 
  
```cs
public void CTRL1_Clicked(object sender, ClickedEventArgs e)
{
   string strExpirationDate = DateTime.Today.AddDays(2).ToString();
   DateTime dtExpirationDate = DateTime.Parse(strExpirationDate);
   this.Permission.UserPermissions.Add("someone@example.com", 
      PermissionType.Change, dtExpirationDate);
}
```

```vb
Public Sub CTRL1_Clicked(ByVal sender As Object, _
   ByVal e As ClickedEventArgs)
   Dim strExpirationDate As String = _
      DateTime.Today.AddDays(2).ToString()
   dtExpirationDate As DateTime = DateTime.Parse(strExpirationDate)
   Me.Permission.UserPermissions.Add("someone@example.com", _
      PermissionType.Change, dtExpirationDate)
End Sub
```


