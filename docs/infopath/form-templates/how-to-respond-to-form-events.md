---
title: 响应表单事件
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
keywords:
- order of events [infopath 207],events [InfoPath 2007], responding,events [InfoPath 2007], order,InfoPath 2007, reponding to events,EventArgs classes [InfoPath 2007]
localization_priority: Normal
ms.assetid: 754db64b-179f-4385-8dd9-c20c9407b186
description: 可以编写代码来响应用户在填写表单时可能发生的各种事件。若要在 InfoPath 中处理事件，则应在设计模式下使用表单模板时添加事件处理程序。
ms.openlocfilehash: 7968837fe0ed524104111bc3f2960860af51c75a
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/11/2018
ms.locfileid: "19774024"
---
# <a name="respond-to-form-events"></a><span data-ttu-id="57b35-105">响应表单事件</span><span class="sxs-lookup"><span data-stu-id="57b35-105">Respond to Form Events</span></span>

<span data-ttu-id="57b35-p102">可以编写代码来响应用户在填写表单时可能发生的各种事件。若要在 InfoPath 中处理事件，则应在设计模式下使用表单模板时添加事件处理程序。</span><span class="sxs-lookup"><span data-stu-id="57b35-p102">You can write code to respond to various events that can occur as a user fills out a form. To work with events in InfoPath, you add event handlers while working with a form template in design mode.</span></span>
  
<span data-ttu-id="57b35-p103">应始终在设计模式下创建 InfoPath 事件处理程序，因为 InfoPath 会自动将用于接收事件的正确声明添加到 **InternalStartup** 方法中并将事件处理程序的代码框架插入到表单的代码文件（FormCode.cs 或 FormCode.vb）中。创建了事件处理程序后，则不应在表单的代码文件中改变其声明。</span><span class="sxs-lookup"><span data-stu-id="57b35-p103">InfoPath event handlers should always be created in design mode because InfoPath automatically adds the correct declaration for sinking the event to the **InternalStartup** method and inserts the event handler's code skeleton into a form's code file (FormCode.cs or FormCode.vb). After you have created an event handler, you should not alter its declaration in the form's code file.</span></span> 
  
<span data-ttu-id="57b35-110">有关创建 InfoPath 事件处理程序的信息，请参阅[添加事件处理程序](how-to-add-an-event-handler.md)。</span><span class="sxs-lookup"><span data-stu-id="57b35-110">For information about creating the InfoPath event handlers, see [Add an Event Handler](how-to-add-an-event-handler.md).</span></span>
  
## <a name="overview-of-the-event-classes"></a><span data-ttu-id="57b35-111">事件类概述</span><span class="sxs-lookup"><span data-stu-id="57b35-111">Overview of the Event Classes</span></span>

<span data-ttu-id="57b35-p104">[Microsoft.Office.InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) 命名空间提供的 InfoPath 模型可实现三个类，这些类又实现可由表单模板业务逻辑引发并处理的 12 个事件。下表列出了每个 InfoPath 事件对象及其关联的事件，并对它们提供的功能进行了说明。</span><span class="sxs-lookup"><span data-stu-id="57b35-p104">The InfoPath model provided by the [Microsoft.Office.InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) namespace implements three classes that implement the 12 events that can be raised and handled by form template business logic. The following table lists each of the InfoPath event objects, the events they are associated with, and a description of the functionality they provide.</span></span> 
  
|<span data-ttu-id="57b35-114">**名称**</span><span class="sxs-lookup"><span data-stu-id="57b35-114">**Name**</span></span>|<span data-ttu-id="57b35-115">**事件**</span><span class="sxs-lookup"><span data-stu-id="57b35-115">**Events**</span></span>|<span data-ttu-id="57b35-116">**说明**</span><span class="sxs-lookup"><span data-stu-id="57b35-116">**Description**</span></span>|
|:-----|:-----|:-----|
|[<span data-ttu-id="57b35-117">ButtonEvent</span><span class="sxs-lookup"><span data-stu-id="57b35-117">ButtonEvent</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.ButtonEvent.aspx) <br/> |[<span data-ttu-id="57b35-118">Clicked</span><span class="sxs-lookup"><span data-stu-id="57b35-118">Clicked</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.ButtonEvent.Clicked.aspx) <br/> |<span data-ttu-id="57b35-119">**ButtonEvent**类实现单击窗体上**按钮**控件时引发的**Clicked**事件。</span><span class="sxs-lookup"><span data-stu-id="57b35-119">The **ButtonEvent** class implements the **Clicked** event that is raised when a **Button** control is clicked on a form.</span></span>  <br/> |
|[<span data-ttu-id="57b35-120">FormEvents</span><span class="sxs-lookup"><span data-stu-id="57b35-120">FormEvents</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormEvents.aspx) <br/> |[<span data-ttu-id="57b35-121">ContextChanged</span><span class="sxs-lookup"><span data-stu-id="57b35-121">ContextChanged</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormEvents.ContextChanged.aspx) <br/> [<span data-ttu-id="57b35-122">Loading</span><span class="sxs-lookup"><span data-stu-id="57b35-122">Loading</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormEvents.Loading.aspx) <br/> [<span data-ttu-id="57b35-123">Merge</span><span class="sxs-lookup"><span data-stu-id="57b35-123">Merge</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormEvents.Merge.aspx) <br/> [<span data-ttu-id="57b35-124">Save</span><span class="sxs-lookup"><span data-stu-id="57b35-124">Save</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormEvents.Save.aspx) <br/> [<span data-ttu-id="57b35-125">Sign</span><span class="sxs-lookup"><span data-stu-id="57b35-125">Sign</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormEvents.Sign.aspx) <br/> [<span data-ttu-id="57b35-126">Submit</span><span class="sxs-lookup"><span data-stu-id="57b35-126">Submit</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormEvents.Submit.aspx) <br/> [<span data-ttu-id="57b35-127">VersionUpgrade</span><span class="sxs-lookup"><span data-stu-id="57b35-127">VersionUpgrade</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormEvents.VersionUpgrade.aspx) <br/> [<span data-ttu-id="57b35-128">ViewSwitched</span><span class="sxs-lookup"><span data-stu-id="57b35-128">ViewSwitched</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormEvents.ViewSwitched.aspx) <br/> |<span data-ttu-id="57b35-129">**FormEvents** 类实现特定于 InfoPath 表单模板本身的事件：</span><span class="sxs-lookup"><span data-stu-id="57b35-129">The **FormEvents** class implements the events that are specific to an InfoPath form template itself:</span></span>  <br/> <span data-ttu-id="57b35-130">**ContextChanged**</span><span class="sxs-lookup"><span data-stu-id="57b35-130">**ContextChanged**</span></span> <br/> <span data-ttu-id="57b35-131">在上下文节点更改之后发生。</span><span class="sxs-lookup"><span data-stu-id="57b35-131">Occurs after the context node changes.</span></span>  <br/> <span data-ttu-id="57b35-132">**Loading**</span><span class="sxs-lookup"><span data-stu-id="57b35-132">**Loading**</span></span> <br/> <span data-ttu-id="57b35-133">在加载了表单模板之后、初始化任何视图之前发生。</span><span class="sxs-lookup"><span data-stu-id="57b35-133">Occurs when the form template has been loaded, but before any views have been initialized.</span></span>  <br/> <span data-ttu-id="57b35-134">**Merge**</span><span class="sxs-lookup"><span data-stu-id="57b35-134">**Merge**</span></span> <br/> <span data-ttu-id="57b35-135">**合并表单**命令调用从用户界面，或使用启动 InfoPath 时发生`/aggregate`命令行开关。</span><span class="sxs-lookup"><span data-stu-id="57b35-135">Occurs when the **Merge Forms** command is invoked from the user interface, or InfoPath is started with the  `/aggregate` command-line switch.</span></span>  <br/> <span data-ttu-id="57b35-136">**Save**</span><span class="sxs-lookup"><span data-stu-id="57b35-136">**Save**</span></span> <br/> <span data-ttu-id="57b35-137">从用户界面中，使用**保存**或**另存为**命令时，或使用[保存](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Save.aspx)和[XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx)类的[SaveAs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.SaveAs.aspx)方法时，发生此事件。</span><span class="sxs-lookup"><span data-stu-id="57b35-137">Occurs when the **Save** or **Save As** commands are used from the user interface, or when the [Save](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Save.aspx) and [SaveAs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.SaveAs.aspx) methods of the [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) class are used.</span></span>  <br/> <span data-ttu-id="57b35-138">**Sign**</span><span class="sxs-lookup"><span data-stu-id="57b35-138">**Sign**</span></span> <br/> <span data-ttu-id="57b35-139">选定的一组签名数据进行签名通过**数字签名**对话框后，发生此事件。</span><span class="sxs-lookup"><span data-stu-id="57b35-139">Occurs after a set of signed data has been selected to sign through the **Digital Signatures** dialog box.</span></span>  <br/> <span data-ttu-id="57b35-140">**Submit**</span><span class="sxs-lookup"><span data-stu-id="57b35-140">**Submit**</span></span> <br/> <span data-ttu-id="57b35-141">**提交**命令使用从用户界面，或使用**XmlForm**类的[Submit](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Submit.aspx)方法时发生。</span><span class="sxs-lookup"><span data-stu-id="57b35-141">Occurs when the **Submit** command is used from the user interface, or the [Submit](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Submit.aspx) method of the **XmlForm** class is used.</span></span>  <br/> <span data-ttu-id="57b35-142">**VersionUpgrade**</span><span class="sxs-lookup"><span data-stu-id="57b35-142">**VersionUpgrade**</span></span> <br/> <span data-ttu-id="57b35-143">在当前打开的表单的版本号小于该表单所基于的表单模板的版本号时发生。</span><span class="sxs-lookup"><span data-stu-id="57b35-143">Occurs when the version number of the form being opened is older than the version number of the form template on which it is based.</span></span>  <br/> <span data-ttu-id="57b35-144">**ViewSwitched**</span><span class="sxs-lookup"><span data-stu-id="57b35-144">**ViewSwitched**</span></span> <br/> <span data-ttu-id="57b35-145">在成功切换了表单视图之后发生。</span><span class="sxs-lookup"><span data-stu-id="57b35-145">Occurs after a view of a form has been successfully switched.</span></span>  <br/> |
|[<span data-ttu-id="57b35-146">XmlEvent</span><span class="sxs-lookup"><span data-stu-id="57b35-146">XmlEvent</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlEvent.aspx) <br/> |[<span data-ttu-id="57b35-147">Changed</span><span class="sxs-lookup"><span data-stu-id="57b35-147">Changed</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlEvent.Changed.aspx) <br/> [<span data-ttu-id="57b35-148">Changing</span><span class="sxs-lookup"><span data-stu-id="57b35-148">Changing</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlEvent.Changing.aspx) <br/> [<span data-ttu-id="57b35-149">Validating</span><span class="sxs-lookup"><span data-stu-id="57b35-149">Validating</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlEvent.Validating.aspx) <br/> |<span data-ttu-id="57b35-150">实现由表单实例的基础 XML 文档中的数据更改所引发的事件：</span><span class="sxs-lookup"><span data-stu-id="57b35-150">Implements the events raised by changes to the data in the underlying XML document of a form instance:</span></span>  <br/> <span data-ttu-id="57b35-151">**Changed**</span><span class="sxs-lookup"><span data-stu-id="57b35-151">**Changed**</span></span> <br/> <span data-ttu-id="57b35-152">在对表单的基础 XML 文档的更改已被接受以及 **Validating** 事件发生后发生。</span><span class="sxs-lookup"><span data-stu-id="57b35-152">Occurs after changes to a form's underlying XML document have been accepted and after the **Validating** event has occurred.</span></span>  <br/> <span data-ttu-id="57b35-153">**Changing**</span><span class="sxs-lookup"><span data-stu-id="57b35-153">**Changing**</span></span> <br/> <span data-ttu-id="57b35-154">在对表单的基础 XML 文档进行更改之后、更改被接受之前发生。</span><span class="sxs-lookup"><span data-stu-id="57b35-154">Occurs after changes to a form's underlying XML document have been made but before the changes have been accepted.</span></span>  <br/> <span data-ttu-id="57b35-155">**Validating**</span><span class="sxs-lookup"><span data-stu-id="57b35-155">**Validating**</span></span> <br/> <span data-ttu-id="57b35-156">在对表单的基础 XML 文档的更改被接受之后、 **Changed** 事件发生之前发生。</span><span class="sxs-lookup"><span data-stu-id="57b35-156">Occurs after changes to a form's underlying XML document have been accepted but before the **Changed** event has occurred.</span></span>  <br/> <span data-ttu-id="57b35-157">**XmlEvent** 类还实现 [RaiseUndoRedoForChanged](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlEvent.RaiseUndoRedoForChanged.aspx) 属性，该属性获取或设置一个值，指示当撤消或恢复操作发生时是否将引发 **Changed** 事件。</span><span class="sxs-lookup"><span data-stu-id="57b35-157">The **XmlEvent** class also implements the [RaiseUndoRedoForChanged](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlEvent.RaiseUndoRedoForChanged.aspx) property, which gets or sets whether the **Changed** event will be raised when an undo or redo operation occurs.</span></span>  <br/> |
   
> [!NOTE]
>  <span data-ttu-id="57b35-158">[!注释] 当在表单的非空字段中进行更改时， **Changed** 和 **Changing** 事件仅激发一次，而在对非空字段进行更改时 InfoPath 2003 以及由 [Microsoft.Office.Interop.InfoPath.SemiTrust](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.aspx) 命名空间提供的 InfoPath 2003 兼容对象模型中的相应事件（ [OnBeforeChange](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._DataDOMEventSink_Event.OnBeforeChange.aspx) 和 [OnAfterChange](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._DataDOMEventSink_Event.OnAfterChange.aspx) ）将激发两次：一次在删除旧值时激发，一次在插入新值时激发。</span><span class="sxs-lookup"><span data-stu-id="57b35-158">The **Changed** and **Changing** events fire only once when a change is made in a non-blank field in the form, whereas the comparable events in InfoPath 2003 and the InfoPath 2003-compatible object model provided by the [Microsoft.Office.Interop.InfoPath.SemiTrust](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.aspx) namespace ( [OnBeforeChange](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._DataDOMEventSink_Event.OnBeforeChange.aspx) and [OnAfterChange](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._DataDOMEventSink_Event.OnAfterChange.aspx) ) fire twice on changes to a non-blank field: once when the old value is deleted, and again when the new value is inserted.</span></span> 
  
## <a name="overview-of-the-eventargs-classes"></a><span data-ttu-id="57b35-159">EventArgs 类概述</span><span class="sxs-lookup"><span data-stu-id="57b35-159">Overview of the EventArgs Classes</span></span>

<span data-ttu-id="57b35-p105">对于上述 12 个事件的每一个事件，都有一个与之关联的 **EventArgs** 对象，该对象传递给该事件的事件处理程序，以便提供可在事件处理程序代码中使用的状态信息和其他功能。下表列出了 InfoPath 事件、与这些事件关联的 **EventArgs** 对象以及对该对象的属性和方法所提供的功能的简短说明。有关该对象的特定属性和方法的详细信息，请在表中单击 **EventArgs** 对象的名称，然后单击该主题中的"成员"链接。</span><span class="sxs-lookup"><span data-stu-id="57b35-p105">Each of the 12 events have an **EventArgs** object associated with the event that are passed to the event handler for the event to provide state information and other functionality that can be used in the event handler code. The following table lists the InfoPath events with their associated **EventArgs** objects and a brief description of the functionality provided by the properties and methods of the object. For details on the specific properties and methods of the object, click the name of the **EventArgs** object in the table, and then click on the Members link in the topic.</span></span> 
  
|<span data-ttu-id="57b35-163">**事件**</span><span class="sxs-lookup"><span data-stu-id="57b35-163">**Event**</span></span>|<span data-ttu-id="57b35-164">**EventsArgs 类**</span><span class="sxs-lookup"><span data-stu-id="57b35-164">**EventsArgs Class**</span></span>|<span data-ttu-id="57b35-165">**说明**</span><span class="sxs-lookup"><span data-stu-id="57b35-165">**Description**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="57b35-166">**Clicked**</span><span class="sxs-lookup"><span data-stu-id="57b35-166">**Clicked**</span></span> <br/> |[<span data-ttu-id="57b35-167">ClickedEventArgs</span><span class="sxs-lookup"><span data-stu-id="57b35-167">ClickedEventArgs</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.ClickedEventArgs.aspx) <br/> |<span data-ttu-id="57b35-168">获取控件 ID。</span><span class="sxs-lookup"><span data-stu-id="57b35-168">Gets the control ID.</span></span>  <br/> <span data-ttu-id="57b35-169">获取位于包含**按钮**控件的窗体的基础 XML 文档的最里层 XML 节点处的**XPathNavigator**对象。</span><span class="sxs-lookup"><span data-stu-id="57b35-169">Get an **XPathNavigator** object positioned at the innermost XML node of the form's underlying XML document that contains the **Button** control.</span></span>  <br/> |
|<span data-ttu-id="57b35-170">**ContextChanged**</span><span class="sxs-lookup"><span data-stu-id="57b35-170">**ContextChanged**</span></span> <br/> |[<span data-ttu-id="57b35-171">ContextChangedEventArgs</span><span class="sxs-lookup"><span data-stu-id="57b35-171">ContextChangedEventArgs</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.ContextChangedEventArgs.aspx) <br/> |<span data-ttu-id="57b35-172">获取在事件发生时执行的上下文更改的类型。</span><span class="sxs-lookup"><span data-stu-id="57b35-172">Gets the type of context change that was performed when the event occurred.</span></span>  <br/> <span data-ttu-id="57b35-173">获取一个值，该值指示是否随着撤消或恢复某个操作而发生了上下文更改事件。</span><span class="sxs-lookup"><span data-stu-id="57b35-173">Gets a value indicating whether the context change event occurred in response to undoing or redoing an operation.</span></span>  <br/> <span data-ttu-id="57b35-174">获取一个对 **XPathNavigator** 的引用，它位于引发该事件的上下文节点处。</span><span class="sxs-lookup"><span data-stu-id="57b35-174">Gets a reference to an **XPathNavigator** positioned at the context node that raised the event.</span></span>  <br/> |
|<span data-ttu-id="57b35-175">**Loading**</span><span class="sxs-lookup"><span data-stu-id="57b35-175">**Loading**</span></span> <br/> |[<span data-ttu-id="57b35-176">LoadingEventArgs</span><span class="sxs-lookup"><span data-stu-id="57b35-176">LoadingEventArgs</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.LoadingEventArgs.aspx) <br/> |<span data-ttu-id="57b35-177">指定加载后要在其中打开表单的视图。</span><span class="sxs-lookup"><span data-stu-id="57b35-177">Specifies the view in which to open the form after loading.</span></span>  <br/> <span data-ttu-id="57b35-178">获取一个对 **XmlFormCancelEventArgs** 对象的引用。</span><span class="sxs-lookup"><span data-stu-id="57b35-178">Gets a reference to the **XmlFormCancelEventArgs** object.</span></span>  <br/> <span data-ttu-id="57b35-179">获取一个 **IDictionary**，它包含使用  `/InputParameters` 命令行选项指定或使用用于打开表单的 URL 中的查询参数指定的所有输入参数。</span><span class="sxs-lookup"><span data-stu-id="57b35-179">Gets an **IDictionary** containing any input parameters specified using the  `/InputParameters` command-line option, or specified using query parameters in a URL to open the form.</span></span>  <br/> |
|<span data-ttu-id="57b35-180">**Merge**</span><span class="sxs-lookup"><span data-stu-id="57b35-180">**Merge**</span></span> <br/> |[<span data-ttu-id="57b35-181">MergeEventArgs</span><span class="sxs-lookup"><span data-stu-id="57b35-181">MergeEventArgs</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.MergeEventArgs.aspx) <br/> |<span data-ttu-id="57b35-182">获取一个对 **XmlFormCancelEventArgs** 对象的引用。</span><span class="sxs-lookup"><span data-stu-id="57b35-182">Gets a reference to the **XmlFormCancelEventArgs** object.</span></span>  <br/> <span data-ttu-id="57b35-183">获取合并操作中被合并的表单的数目。</span><span class="sxs-lookup"><span data-stu-id="57b35-183">Gets the count of the number of forms being merged in a merging operation.</span></span>  <br/> <span data-ttu-id="57b35-184">获取当前要合并的表单的索引（从 0 开始）。</span><span class="sxs-lookup"><span data-stu-id="57b35-184">Gets the zero-based index of the form that is currently being merged.</span></span>  <br/> <span data-ttu-id="57b35-185">获取或设置与 **Cancel** 属性一起使用的值，该值决定了是仅取消当前表单，还是取消整个合并操作。</span><span class="sxs-lookup"><span data-stu-id="57b35-185">Gets or sets a value that is used with the **Cancel** property to determine whether to cancel only the current form or the entire merging operation.</span></span>  <br/> <span data-ttu-id="57b35-186">获取一个 **XPathNavigator** 对象，该对象位于当前要合并的表单的基础 XML 文档的根节点处。</span><span class="sxs-lookup"><span data-stu-id="57b35-186">Gets an **XPathNavigator** object positioned at the root node of the underlying XML document of the form that is currently being merged.</span></span>  <br/> |
|<span data-ttu-id="57b35-187">**Save**</span><span class="sxs-lookup"><span data-stu-id="57b35-187">**Save**</span></span> <br/> |[<span data-ttu-id="57b35-188">使用 SaveEventArgs</span><span class="sxs-lookup"><span data-stu-id="57b35-188">SaveEventArgs</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SaveEventArgs.aspx) <br/> |<span data-ttu-id="57b35-189">执行用户请求的保存操作。</span><span class="sxs-lookup"><span data-stu-id="57b35-189">Performs the save operation requested by the user.</span></span>  <br/> <span data-ttu-id="57b35-190">获取一个对可用来取消事件的 **SaveCancelEventArgs** 对象的引用。</span><span class="sxs-lookup"><span data-stu-id="57b35-190">Gets a reference to the **SaveCancelEventArgs** object that can be used to cancel the event.</span></span>  <br/> <span data-ttu-id="57b35-191">获取要在事件的事件处理程序中使用的文件名。</span><span class="sxs-lookup"><span data-stu-id="57b35-191">Gets the file name to be used in the event handler for the event.</span></span>  <br/> <span data-ttu-id="57b35-192">获取一个值，该值指示是将保存操作作为"保存"操作还是"另存为"操作来执行。</span><span class="sxs-lookup"><span data-stu-id="57b35-192">Gets whether the save operation will be performed as a "save" operation or as a "save as" operation.</span></span>  <br/> |
|<span data-ttu-id="57b35-193">**Sign**</span><span class="sxs-lookup"><span data-stu-id="57b35-193">**Sign**</span></span> <br/> |[<span data-ttu-id="57b35-194">SignEventArgs</span><span class="sxs-lookup"><span data-stu-id="57b35-194">SignEventArgs</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignEventArgs.aspx) <br/> |<span data-ttu-id="57b35-195">获取或设置是否显示**数字签名**对话框。</span><span class="sxs-lookup"><span data-stu-id="57b35-195">Gets or sets whether to display the **Digital Signatures** dialog box.</span></span>  <br/> <span data-ttu-id="57b35-196">获取引发事件的可签名数据组。</span><span class="sxs-lookup"><span data-stu-id="57b35-196">Gets the set of signable data that raised the event.</span></span>  <br/> |
|<span data-ttu-id="57b35-197">**Submit**</span><span class="sxs-lookup"><span data-stu-id="57b35-197">**Submit**</span></span> <br/> |[<span data-ttu-id="57b35-198">SubmitEventArgs</span><span class="sxs-lookup"><span data-stu-id="57b35-198">SubmitEventArgs</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SubmitEventArgs.aspx) <br/> |<span data-ttu-id="57b35-199">获取一个对用来取消事件的 **XmlFormCancelEventArgs** 对象的引用。</span><span class="sxs-lookup"><span data-stu-id="57b35-199">Gets a reference to the **XmlFormCancelEventArgs** object for cancelling the event.</span></span>  <br/> |
|<span data-ttu-id="57b35-200">**VersionUpgrade**</span><span class="sxs-lookup"><span data-stu-id="57b35-200">**VersionUpgrade**</span></span> <br/> |[<span data-ttu-id="57b35-201">VersionUpgradeEventArgs</span><span class="sxs-lookup"><span data-stu-id="57b35-201">VersionUpgradeEventArgs</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.VersionUpgradeEventArgs.aspx) <br/> |<span data-ttu-id="57b35-202">获取一个对用来取消事件的 **XmlFormCancelEventArgs** 对象的引用。</span><span class="sxs-lookup"><span data-stu-id="57b35-202">Gets a reference to the **XmlFormCancelEventArgs** object for cancelling the event.</span></span>  <br/> <span data-ttu-id="57b35-203">获取正在升级的表单文档的版本号。</span><span class="sxs-lookup"><span data-stu-id="57b35-203">Gets the version number of the form document being upgraded.</span></span>  <br/> <span data-ttu-id="57b35-204">获取与正在升级的表单关联的表单模板的版本号。</span><span class="sxs-lookup"><span data-stu-id="57b35-204">Gets the version number of the form template associated with the form being upgraded.</span></span>  <br/> |
|<span data-ttu-id="57b35-205">**ViewSwitched**</span><span class="sxs-lookup"><span data-stu-id="57b35-205">**ViewSwitched**</span></span> <br/> |[<span data-ttu-id="57b35-206">ViewSwitchedEventArgs</span><span class="sxs-lookup"><span data-stu-id="57b35-206">ViewSwitchedEventArgs</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.ViewSwitchedEventArgs.aspx) <br/> |<span data-ttu-id="57b35-207">**ViewSwitchedEventArgs** 类不为从 **System.Object** 继承的事件之外的事件提供任何属性和方法。</span><span class="sxs-lookup"><span data-stu-id="57b35-207">The **ViewSwitchedEventArgs** class does not provide any properties and methods for the event other than those inherited from **System.Object**.</span></span>  <br/> |
|<span data-ttu-id="57b35-208">**Changed**</span><span class="sxs-lookup"><span data-stu-id="57b35-208">**Changed**</span></span> <br/> |[<span data-ttu-id="57b35-209">XmlEventArgs</span><span class="sxs-lookup"><span data-stu-id="57b35-209">XmlEventArgs</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlEventArgs.aspx) <br/> |<span data-ttu-id="57b35-210">获取一个 **XPathExpression** 对象，该对象包含返回当前正在更改的节点的 XPath 表达式。</span><span class="sxs-lookup"><span data-stu-id="57b35-210">Gets an **XPathExpression** object which contains an XPath expression that returns the node that is currently being changed.</span></span>  <br/> <span data-ttu-id="57b35-211">获取正在更改的节点的新值。</span><span class="sxs-lookup"><span data-stu-id="57b35-211">Gets the new value for the node being changed.</span></span>  <br/> <span data-ttu-id="57b35-212">获取一个 **XPathNavigator** 对象，该对象指向正在删除的节点的父节点。</span><span class="sxs-lookup"><span data-stu-id="57b35-212">Gets an **XPathNavigator** object pointing to the node which is the parent of the node being deleted.</span></span>  <br/> <span data-ttu-id="57b35-213">获取正在更改的节点的原始值。</span><span class="sxs-lookup"><span data-stu-id="57b35-213">Gets the original value of the node that is being changed.</span></span>  <br/> <span data-ttu-id="57b35-214">获取一个 [XmlOperation](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlOperation.aspx) 枚举，该枚举指示更改节点后发生的操作的类型。</span><span class="sxs-lookup"><span data-stu-id="57b35-214">Gets an [XmlOperation](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlOperation.aspx) enumeration that indicates the type of operation that occurred when the node was changed.</span></span>  <br/> <span data-ttu-id="57b35-215">获取一个 **XPathNavigator** 对象，该对象指向正在更改的节点。</span><span class="sxs-lookup"><span data-stu-id="57b35-215">Gets an **XPathNavigator** object pointing at the node that is being changed.</span></span>  <br/> <span data-ttu-id="57b35-216">获取一个值，该值指示正在更改的节点是否是撤消操作或恢复操作的一部分。</span><span class="sxs-lookup"><span data-stu-id="57b35-216">Gets a value that indicates whether the node being changed is part of an undo or redo operation.</span></span>  <br/> |
|<span data-ttu-id="57b35-217">**Changing**</span><span class="sxs-lookup"><span data-stu-id="57b35-217">**Changing**</span></span> <br/> |[<span data-ttu-id="57b35-218">XmlChangingEventArgs</span><span class="sxs-lookup"><span data-stu-id="57b35-218">XmlChangingEventArgs</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlChangingEventArgs.aspx) <br/> |<span data-ttu-id="57b35-219">获取一个与该事件关联的 **XmlFormCancelEventArgs** 对象。</span><span class="sxs-lookup"><span data-stu-id="57b35-219">Gets an **XmlFormCancelEventArgs** object associated with the event.</span></span>  <br/> <span data-ttu-id="57b35-220">继承上面列出的 **XmlEventArgs** 对象的所有功能。</span><span class="sxs-lookup"><span data-stu-id="57b35-220">Inherits all of the functionality listed above for the **XmlEventArgs** object.</span></span>  <br/> |
|<span data-ttu-id="57b35-221">**Validating**</span><span class="sxs-lookup"><span data-stu-id="57b35-221">**Validating**</span></span> <br/> |[<span data-ttu-id="57b35-222">XmlValidatingEventArgs</span><span class="sxs-lookup"><span data-stu-id="57b35-222">XmlValidatingEventArgs</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlValidatingEventArgs.aspx) <br/> |<span data-ttu-id="57b35-223">创建一个包含自定义错误信息及指定值的 [FormError](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormError.aspx) 对象，并将该对象添加到表单的 [FormErrorCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.aspx) 对象。</span><span class="sxs-lookup"><span data-stu-id="57b35-223">Creates a [FormError](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormError.aspx) object that contains custom error information with the specified values and adds it to the [FormErrorCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.aspx) object of the form.</span></span>  <br/> <span data-ttu-id="57b35-224">继承上面列出的 **XmlEventArgs** 对象的所有功能。</span><span class="sxs-lookup"><span data-stu-id="57b35-224">Inherits all of the functionality listed above for the **XmlEventArgs** object.</span></span>  <br/> |
   
## <a name="using-the-eventargs-objects"></a><span data-ttu-id="57b35-225">使用 EventArgs 对象</span><span class="sxs-lookup"><span data-stu-id="57b35-225">Using the EventArgs Objects</span></span>

<span data-ttu-id="57b35-p106">创建事件处理程序时，InfoPath 将在项目的表单代码中创建事件处理程序的声明。在事件处理程序的声明中，InfoPath 使用 **e** 作为传递给事件处理程序的参数的名称。此参数包含与事件处理程序关联的 **EventArgs** 对象，以便在事件发生时提供状态信息和其他功能。</span><span class="sxs-lookup"><span data-stu-id="57b35-p106">When you create an event handler, InfoPath creates the event handler's declaration in the project's form code. In the declaration of the event handler, InfoPath uses **e** as the name of the parameter that is passed to the event handler. This parameter contains the **EventArgs** object that is associated with the event handler for providing state information and other functionality when the event occurs.</span></span> 
  
<span data-ttu-id="57b35-229">例如，在事件处理程序**Loading**事件在设计模式下创建 （通过单击**开发人员**选项卡上的**Loading 事件**菜单） 时，InfoPath 将添加的事件处理程序接收[LoadingEventArgs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.LoadingEventArgs.aspx)的声明表单代码文件，对象，然后打开代码编辑器，以便您可以将您的代码添加到下面的事件处理程序声明。</span><span class="sxs-lookup"><span data-stu-id="57b35-229">For example, when you create an event handler for the **Loading** event in design mode (by clicking **Loading Event** menu on the **Developer** tab), InfoPath adds the declaration for the event handler that receives the [LoadingEventArgs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.LoadingEventArgs.aspx) object to the form code file, and then opens the code editor so that you can add your code to the following event handler declaration.</span></span> 
  
```cs
public void FormEvents_Loading(object sender, LoadingEventArgs e)
{
   // Write your code here.
}
```

```vb
Public Sub FormEvents_Loading(ByVal sender As Object, _
   ByVal e As LoadingEventArgs)
   ' Write your code here.
End Sub
```

<span data-ttu-id="57b35-p107">为事件处理程序编写代码时，可以使用通过 **e** 参数传递的 **EventArgs** 对象所实现的属性和方法。例如，在以下 **Changing** 事件处理程序中， [XmlChangingEventArgs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlEventArgs.NewValue.aspx) 对象（从 [XmlEventArgs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlChangingEventArgs.aspx) 类继承）的 [NewValue](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlEventArgs.aspx) 属性用于检查刚刚更改的字段的值。如果用户更改字段并将其保留为空，则会使用 [XmlChangingEventArgs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCancelEventArgs.Message.aspx) 对象的 [CancelableArgs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCancelEventArgs.aspx) 属性来访问 [XmlFormCancelEventArgs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlChangingEventArgs.CancelableArgs.aspx) 类的 **Message** 属性以向用户显示错误，同时还会将 **XmlFormCancelEventArgs.Cancel** 属性设置为 **true** 以取消事件并回滚用户所做的更改。</span><span class="sxs-lookup"><span data-stu-id="57b35-p107">When writing code for an event handler, you can use the properties and methods implemented by the **EventArgs** object that is passed through the **e** parameter. For example, in the following **Changing** event handler, the [NewValue](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlEventArgs.NewValue.aspx) property of the [XmlChangingEventArgs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlChangingEventArgs.aspx) object (which is inherited from the [XmlEventArgs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlEventArgs.aspx) class) is used to check the value of the field that was just changed. If the user changed the field and left it blank, the [Message](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCancelEventArgs.Message.aspx) property of the [XmlFormCancelEventArgs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCancelEventArgs.aspx) class is accessed using the [CancelableArgs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlChangingEventArgs.CancelableArgs.aspx) property of the **XmlChangingEventArgs** object to display an error to the user, and the **XmlFormCancelEventArgs.Cancel** property is set to **true**, to cancel the event and roll back the changes the user made.</span></span>
  
```cs
public void field1_Changing(object sender, LoadingEventArgs e)
{
   // Determine whether there is a new value.
   if (e.NewValue == "")
   {
      // The value is blank, so display an error message
      // and roll back the changes.
      e.CancelableArgs.Message = 
         "You must supply a value for this field.";
      e.CancelableArgs.Cancel = true;
      return;
   }
}
```

```vb
Public Sub field1_Changing(ByVal sender As Object, _
   ByVal e As LoadingEventArgs)
   ' Determine whether there is a new value.
   If (e.NewValue = "") Then
      ' The value is blank, so display an error message 
      ' and roll back the changes.
      e.CancelableArgs.Message = _
         "You must supply a value for this field."
      e.CancelableArgs.Cancel = True
      Return
   End If
End Sub
```


