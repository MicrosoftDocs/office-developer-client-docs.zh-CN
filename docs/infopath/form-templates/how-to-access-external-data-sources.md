---
title: 访问外部数据源
manager: soliver
ms.date: 12/07/2015
ms.audience: Developer
keywords:
- data connection classes [infopath 2007],secondary data sources [InfoPath 2007],data [InfoPath 2007], secondary,DataSource class [InfoPath 2007],accessing external data sources [InfoPath 2007],DataSourceCollection class [InfoPath 2007],DataConnectionCollection class [InfoPath 2007],DataConnection class [InfoPath 2007],InfoPath 2007, accessing external data,data [InfoPath 2007], external sources
localization_priority: Normal
ms.assetid: db7c2521-a1ad-4802-b398-79575d3d310a
description: 使用 InfoPath 表单模板时，可以编写代码以访问表单的辅助数据源和操作这些数据源所包含的数据。
ms.openlocfilehash: f6957c561231eef0e3e4df6deb09ae89f85afcc5
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/23/2019
ms.locfileid: "32300194"
---
# <a name="access-external-data-sources"></a><span data-ttu-id="d5f16-104">访问外部数据源</span><span class="sxs-lookup"><span data-stu-id="d5f16-104">Access External Data Sources</span></span>

<span data-ttu-id="d5f16-105">使用 InfoPath 表单模板时，可以编写代码以访问表单的"辅助数据源"和操作这些数据源所包含的数据。</span><span class="sxs-lookup"><span data-stu-id="d5f16-105">When working with an InfoPath form template, you can write code to access the form's secondary data sources and manipulate the data that they contain.</span></span> 
  
<span data-ttu-id="d5f16-p101">每个辅助数据源均由使用 [DataSource](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.aspx) 类实例化的对象代表，并且与从一些外部数据源（例如，数据库或 Web 服务查询）获得的存储数据相对应。这些数据源之所以被称为辅助数据源，是因为当用户保存 InfoPath 表单时，用户只保存主数据源中的数据，而不保存辅助数据源中的数据。与数据源的连接由使用"数据连接"类之一（例如 [WebServiceConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.WebServiceConnection.aspx) 类，该类代表与 XML Web 服务的数据连接）实例化的对象代表。</span><span class="sxs-lookup"><span data-stu-id="d5f16-p101">Each secondary data source is represented by an object instantiated using the [DataSource](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.aspx) class, and corresponds to stored data, obtained from some external source of data, such as a database or a Web Service query. These data sources are referred to as secondary because when the user saves an InfoPath form, the user is saving the data only in the main (or primary) data source, not the data in the secondary data sources. The connection to a data source is represented by an object instantiated using one of the "data connection" classes, such as the [WebServiceConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.WebServiceConnection.aspx) class, which represents a data connection to an XML Web Service.</span></span> 
  
<span data-ttu-id="d5f16-109">已实例化的 [DataSource](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.aspx) 对象代表通过数据连接（从数据库或 Web 服务查询中）返回的 XML 数据的存储位置，并且“数据连接”类代表数据连接自身（使用“数据”\*\*\*\* 选项卡上的“数据连接”\*\*\*\* 命令来定义和命名）。</span><span class="sxs-lookup"><span data-stu-id="d5f16-109">The instantiated [DataSource](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.aspx) object represents the storage of XML data returned by a data connection (from a database or Web Service query), and the "data connection" class represents the data connection itself (as defined and named using the **Data Connections** command on the **Data** tab).</span></span> 
  
<span data-ttu-id="d5f16-110">通过结合使用 [DataSource](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.aspx) 类和 [DataSourceCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.aspx) 类，InfoPath 对象模型可支持对表单的辅助数据源进行访问。</span><span class="sxs-lookup"><span data-stu-id="d5f16-110">The InfoPath object model supports access to a form's secondary data sources through the use of the [DataSource](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.aspx) class in association with the [DataSourceCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.aspx) class.</span></span> 
  
<span data-ttu-id="d5f16-111">InfoPath 对象模型还提供了一组数据连接类，这些类包含有关表单所使用的数据连接的信息。</span><span class="sxs-lookup"><span data-stu-id="d5f16-111">The InfoPath object model also provides a set of data connection classes, containing information about the data connections used by the form.</span></span>
  
> [!NOTE]
> <span data-ttu-id="d5f16-112">在 Microsoft InfoPath 2003 中，数据连接称为"数据适配器"。</span><span class="sxs-lookup"><span data-stu-id="d5f16-112">In Microsoft InfoPath 2003, a data connection is referred to as a data adapter.</span></span> 
  
<span data-ttu-id="d5f16-p102">数据连接有两种："查询连接"用于获取存储在辅助数据源中的数据。"提交连接"用于提交数据，例如，将数据提交到数据库或 Web 服务。提交的数据是从主数据源或辅助数据源中复制的。</span><span class="sxs-lookup"><span data-stu-id="d5f16-p102">Data connections are of two kinds: Query connections are used to obtain the data that is then stored in a secondary data source. Submit connections are used to submit data, to a database or Web service, for example. The submitted data is copied from the main or secondary data sources.</span></span> 
  
## <a name="overview-of-the-datasourcecollection-class"></a><span data-ttu-id="d5f16-116">DataSourceCollection 类概述</span><span class="sxs-lookup"><span data-stu-id="d5f16-116">Overview of the DataSourceCollection Class</span></span>

<span data-ttu-id="d5f16-117">[DataSourceCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.aspx) 类提供了下列属性和方法，表单开发人员可以使用它们管理该表单包含的 [DataSourceCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.aspx) 对象实例。</span><span class="sxs-lookup"><span data-stu-id="d5f16-117">The [DataSourceCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.aspx) class provides the following properties and methods, which form developers can use to manage the [DataSourceCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.aspx) object instances that the form contains.</span></span> 
  
|<span data-ttu-id="d5f16-118">**名称**</span><span class="sxs-lookup"><span data-stu-id="d5f16-118">**Name**</span></span>|<span data-ttu-id="d5f16-119">**说明**</span><span class="sxs-lookup"><span data-stu-id="d5f16-119">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="d5f16-120">[Count](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.Count.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="d5f16-120">[Count](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.Count.aspx) property</span></span>  <br/> |<span data-ttu-id="d5f16-121">返回集合中包含的 **DataSource** 对象实例的数目。</span><span class="sxs-lookup"><span data-stu-id="d5f16-121">Returns a count of the number of **DataSource** object instances contained in the collection.</span></span>  <br/> |
|<span data-ttu-id="d5f16-122">[GetEnumerator](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.GetEnumerator.aspx) 方法</span><span class="sxs-lookup"><span data-stu-id="d5f16-122">[GetEnumerator](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.GetEnumerator.aspx) method</span></span>  <br/> |<span data-ttu-id="d5f16-123">返回可用于在集合中进行循环访问的 **IEnumerator**。</span><span class="sxs-lookup"><span data-stu-id="d5f16-123">Returns an **IEnumerator** that can be used to iterate through the collection.</span></span>  <br/> |
|<span data-ttu-id="d5f16-124">[Item[Int32]](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.Item.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="d5f16-124">[Item[Int32]](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.Item.aspx) property</span></span>  <br/> |<span data-ttu-id="d5f16-125">按照索引值返回一个对指定 **DataSource** 对象的引用。</span><span class="sxs-lookup"><span data-stu-id="d5f16-125">Returns a reference to the specified **DataSource** object by index value.</span></span>  <br/> |
|<span data-ttu-id="d5f16-126">[Item[String]](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.Item.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="d5f16-126">[Item[String]](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.Item.aspx) property</span></span>  <br/> |<span data-ttu-id="d5f16-127">按照名称返回一个对指定 **DataSource** 对象的引用。</span><span class="sxs-lookup"><span data-stu-id="d5f16-127">Returns a reference to the specified **DataSource** object by name.</span></span>  <br/> |
   
## <a name="overview-of-the-datasource-class"></a><span data-ttu-id="d5f16-128">DataSource 类概述</span><span class="sxs-lookup"><span data-stu-id="d5f16-128">Overview of the DataSource Class</span></span>

<span data-ttu-id="d5f16-129">[DataSourceCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.aspx) 类提供了下列方法和属性，表单开发人员可以使用它们与 InfoPath 辅助数据源进行交互。</span><span class="sxs-lookup"><span data-stu-id="d5f16-129">The [DataSourceCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.aspx) class provides the following method and properties, which form developers can use to interact with an InfoPath secondary data source.</span></span> 
  
|<span data-ttu-id="d5f16-130">**名称**</span><span class="sxs-lookup"><span data-stu-id="d5f16-130">**Name**</span></span>|<span data-ttu-id="d5f16-131">**说明**</span><span class="sxs-lookup"><span data-stu-id="d5f16-131">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="d5f16-132">[CreateNavigator](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.CreateNavigator.aspx) 方法</span><span class="sxs-lookup"><span data-stu-id="d5f16-132">[CreateNavigator](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.CreateNavigator.aspx) method</span></span>  <br/> |<span data-ttu-id="d5f16-133">返回用于访问和编辑数据源的 [XPathNavigator](https://msdn.microsoft.com/library/system.xml.xpath.xpathnavigator%28v=vs.110%29.aspx) 对象</span><span class="sxs-lookup"><span data-stu-id="d5f16-133">Returns an [XPathNavigator](https://msdn.microsoft.com/library/system.xml.xpath.xpathnavigator%28v=vs.110%29.aspx) object for accessing and editing the data source</span></span>  <br/> |
|<span data-ttu-id="d5f16-134">[QueryConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.QueryConnection.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="d5f16-134">[QueryConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.QueryConnection.aspx) property</span></span>  <br/> |<span data-ttu-id="d5f16-135">获取一个对关联数据连接对象的引用。</span><span class="sxs-lookup"><span data-stu-id="d5f16-135">Gets a reference to the associated data connection object.</span></span>  <br/> <span data-ttu-id="d5f16-136">要对数据连接执行查询，并将返回的数据作为 XML 插入到与 **DataSource** 对象关联的 XML 节点中，请使用关联数据连接对象的 [Execute](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataConnection.Execute.aspx) 方法。</span><span class="sxs-lookup"><span data-stu-id="d5f16-136">To execute the query on the data connection and insert the returned data as XML into the XML node associated with the **DataSource** object, use the [Execute](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataConnection.Execute.aspx) method of the associated data connection object.</span></span>  <br/> |
|<span data-ttu-id="d5f16-137">[Name](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.Name.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="d5f16-137">[Name](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.Name.aspx) property</span></span>  <br/> |<span data-ttu-id="d5f16-138">获取 **DataSource** 对象的名称。</span><span class="sxs-lookup"><span data-stu-id="d5f16-138">Gets the name of the **DataSource** object.</span></span>  <br/> |
|<span data-ttu-id="d5f16-139">[ReadOnly](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.ReadOnly.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="d5f16-139">[ReadOnly](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.ReadOnly.aspx) property</span></span>  <br/> |<span data-ttu-id="d5f16-140">获取一个值，指示数据源是否处于只读状态。</span><span class="sxs-lookup"><span data-stu-id="d5f16-140">Gets a value that indicates whether the data source is in a read-only state</span></span>  <br/> |
|<span data-ttu-id="d5f16-141">[GetNamedNodeProperty](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.GetNamedNodeProperty.aspx) 方法</span><span class="sxs-lookup"><span data-stu-id="d5f16-141">[GetNamedNodeProperty](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.GetNamedNodeProperty.aspx) method</span></span>  <br/> |<span data-ttu-id="d5f16-142">获取指定 XML 节点的命名属性的值，该节点必须是主数据源中的 **nonattribute** 节点。</span><span class="sxs-lookup"><span data-stu-id="d5f16-142">Gets the value of a named property for the specified XML node, which must be a **nonattribute** node in the main data source.</span></span>  <br/> |
|<span data-ttu-id="d5f16-143">[SetNamedNodeProperty](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.SetNamedNodeProperty.aspx) 方法</span><span class="sxs-lookup"><span data-stu-id="d5f16-143">[SetNamedNodeProperty](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.SetNamedNodeProperty.aspx) method</span></span>  <br/> |<span data-ttu-id="d5f16-144">设置指定 XML 节点的命名属性的值，该节点必须是主数据源中的 **nonattribute** 节点。</span><span class="sxs-lookup"><span data-stu-id="d5f16-144">Sets the value of a named property for the specified XML node, which must be a **nonattribute** node in the main data source.</span></span>  <br/> |
   
## <a name="overview-of-the-data-connection-classes"></a><span data-ttu-id="d5f16-145">数据连接类概述</span><span class="sxs-lookup"><span data-stu-id="d5f16-145">Overview of the Data Connection Classes</span></span>

<span data-ttu-id="d5f16-p103">用于访问数据连接的类提供了通过连接到外部数据源检索和提交数据的不同属性和方法；与 **DataSource** 对象关联的数据连接取决于外部数据连接的类型。InfoPath 实现下列用于访问数据连接的类。</span><span class="sxs-lookup"><span data-stu-id="d5f16-p103">The classes for accessing data connections provide different properties and methods that retrieve and submit data through connections to external data sources; the data connection that is associated with a **DataSource** object is dependent on the type of external data connection. InfoPath implements the following classes for accessing data connections.</span></span> 
  
|<span data-ttu-id="d5f16-148">**名称**</span><span class="sxs-lookup"><span data-stu-id="d5f16-148">**Name**</span></span>|<span data-ttu-id="d5f16-149">**说明**</span><span class="sxs-lookup"><span data-stu-id="d5f16-149">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="d5f16-150">[AdoQueryConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.AdoQueryConnection.aspx) 类</span><span class="sxs-lookup"><span data-stu-id="d5f16-150">[AdoQueryConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.AdoQueryConnection.aspx) class</span></span>  <br/> |<span data-ttu-id="d5f16-151">查询 ADO/OLEDB 数据源；限于 Microsoft Access 和 Microsoft SQL Server。</span><span class="sxs-lookup"><span data-stu-id="d5f16-151">Queries an ADO/OLEDB data source; limited to Microsoft Access and Microsoft SQL Server.</span></span>  <br/> |
|<span data-ttu-id="d5f16-152">[AdoSubmitConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.AdoSubmitConnection.aspx) 类</span><span class="sxs-lookup"><span data-stu-id="d5f16-152">[AdoSubmitConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.AdoSubmitConnection.aspx) class</span></span>  <br/> |<span data-ttu-id="d5f16-153">提交到 ADO/OLEDB 数据源；限于 Microsoft Access 和 Microsoft SQL Server。</span><span class="sxs-lookup"><span data-stu-id="d5f16-153">Submits to an ADO/OLEDB data source; limited to Microsoft Access and Microsoft SQL Server.</span></span>  <br/> |
|<span data-ttu-id="d5f16-154">[SharePointListRWQueryConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SharePointListRWQueryConnection.aspx) 类</span><span class="sxs-lookup"><span data-stu-id="d5f16-154">[SharePointListRWQueryConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SharePointListRWQueryConnection.aspx) class</span></span>  <br/> |<span data-ttu-id="d5f16-155">查询 SharePoint 列表或文档库。</span><span class="sxs-lookup"><span data-stu-id="d5f16-155">Queries a SharePoint list or document library.</span></span>  <br/> |
|[<span data-ttu-id="d5f16-156">SharePointListRWSubmitConnection</span><span class="sxs-lookup"><span data-stu-id="d5f16-156">SharePointListRWSubmitConnection</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SharePointListRWSubmitConnection.aspx) <br/> |<span data-ttu-id="d5f16-157">提交到 SharePoint 列表或文档库。</span><span class="sxs-lookup"><span data-stu-id="d5f16-157">Submits to a SharePoint list or document library.</span></span>  <br/> |
|<span data-ttu-id="d5f16-158">[WebServiceConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.WebServiceConnection.aspx) 类</span><span class="sxs-lookup"><span data-stu-id="d5f16-158">[WebServiceConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.WebServiceConnection.aspx) class</span></span>  <br/> |<span data-ttu-id="d5f16-159">连接到 XML Web 服务。</span><span class="sxs-lookup"><span data-stu-id="d5f16-159">Connects to an XML Web service.</span></span>  <br/> |
|<span data-ttu-id="d5f16-160">[FileQueryConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FileQueryConnection.aspx) 类</span><span class="sxs-lookup"><span data-stu-id="d5f16-160">[FileQueryConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FileQueryConnection.aspx) class</span></span>  <br/> |<span data-ttu-id="d5f16-161">查询 XML 文件。</span><span class="sxs-lookup"><span data-stu-id="d5f16-161">Queries an XML file.</span></span>  <br/> |
|<span data-ttu-id="d5f16-162">[FileSubmitConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FileSubmitConnection.aspx) 类</span><span class="sxs-lookup"><span data-stu-id="d5f16-162">[FileSubmitConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FileSubmitConnection.aspx) class</span></span>  <br/> |<span data-ttu-id="d5f16-163">提交到 XML 文件。</span><span class="sxs-lookup"><span data-stu-id="d5f16-163">Submits to an XML file.</span></span>  <br/> |
|<span data-ttu-id="d5f16-164">[EmailSubmitConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.EmailSubmitConnection.aspx) 类</span><span class="sxs-lookup"><span data-stu-id="d5f16-164">[EmailSubmitConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.EmailSubmitConnection.aspx) class</span></span>  <br/> |<span data-ttu-id="d5f16-165">将表单作为电子邮件的附件提交。</span><span class="sxs-lookup"><span data-stu-id="d5f16-165">Submits a form as an attachment in email.</span></span>  <br/> |
|<span data-ttu-id="d5f16-166">[BdcQueryConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.BdcQueryConnection.aspx) 类</span><span class="sxs-lookup"><span data-stu-id="d5f16-166">[BdcQueryConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.BdcQueryConnection.aspx) class</span></span>  <br/> |<span data-ttu-id="d5f16-167">在运行 SharePoint Foundation 2010 或 SharePoint Server 2010 的服务器上查询外部列表。</span><span class="sxs-lookup"><span data-stu-id="d5f16-167">Queries an external list on a server running SharePoint Foundation 2010 or SharePoint Server 2010.</span></span>  <br/> |
|<span data-ttu-id="d5f16-168">[BdcSubmitConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.BdcSubmitConnection.aspx) 类</span><span class="sxs-lookup"><span data-stu-id="d5f16-168">[BdcSubmitConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.BdcSubmitConnection.aspx) class</span></span>  <br/> |<span data-ttu-id="d5f16-169">提交到运行 SharePoint Foundation 2010 或 SharePoint Server 2010 的服务器上的外部列表。</span><span class="sxs-lookup"><span data-stu-id="d5f16-169">Submits to an external list on a server running SharePoint Foundation 2010 or SharePoint Server 2010.</span></span>  <br/> |
   
## <a name="using-the-datasourcecollection-and-the-datasource-classes"></a><span data-ttu-id="d5f16-170">使用 DataSourceCollection 和 DataSource 类</span><span class="sxs-lookup"><span data-stu-id="d5f16-170">Using the DataSourceCollection and the DataSource Classes</span></span>

<span data-ttu-id="d5f16-p104">**DataSourceCollection** 对象代表与一个表单模板关联的数据源的集合，可以通过 [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.DataSources.aspx) 类的 [DataSources](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) 属性来访问该对象。例如，如果创建一个从 Northwind 数据库的 Employees 表中检索数据的名为 Employees 的辅助数据源，可以使用 **DataSource** 对象设置一个对代表检索到的数据的 **DataSourceCollection** 对象的引用。</span><span class="sxs-lookup"><span data-stu-id="d5f16-p104">The **DataSourceCollection** object that represents the collection of data sources associated with a form template is accessed through the [DataSources](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.DataSources.aspx) property of the [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) class. For example, if you create a secondary data source named Employees that retrieves data from the Employees table in the Northwind database, you can use the **DataSourceCollection** object to set a reference to a **DataSource** object that represents the retrieved data.</span></span> 
  
<span data-ttu-id="d5f16-p105">在下面的代码示例中，辅助数据源的名称传递到 **DataSourceCollection** 类的 accessor 属性，该属性将返回一个对代表检索的 Employees 表数据的 **DataSource** 对象的引用。通过使用 **DataSource** 类的 **CreateNavigator** 方法访问 **XPathNavigator** 类的 **InnerXml** 属性，存储从辅助数据源中检索的数据的 XML 节点显示在一个消息框中。</span><span class="sxs-lookup"><span data-stu-id="d5f16-p105">In the following code sample, the name of the secondary data source is passed to the accessor property of the **DataSourceCollection** class, which returns a reference to the **DataSource** object that represents the retrieved Employees table data. The XML node that stores the retrieved data from the secondary data source is displayed in a message box using the **CreateNavigator** method of the **DataSource** class to access the **InnerXml** property of the **XPathNavigator** class.</span></span> 
  
```cs
// Instantiate a variable to access the specified data source
// from the DataSourceCollection of the form.
DataSource myDataSource = 
   this.DataSources["Employees"];
// Display the XML data from the secondary data source.
MessageBox.Show("Data source data: " +
   myDataSource.CreateNavigator().InnerXml.ToString());
```

```vb
' Instantiate a variable to access the specified data source
' from the DataSourceCollection of the form.
Dim myDataSource As DataSource = _
   Me.DataSources("Employees")
' Display the XML data from the secondary data source.
MessageBox.Show("Data source data: " &amp; _
   myDataSource.CreateNavigator().InnerXml.ToString())
```

<span data-ttu-id="d5f16-175">要操作辅助数据源中包含的数据，请使用 **DataSource** 类的 **CreateNavigator** 方法，返回对位于存储辅助数据的节点处的 **XPathNavigator** 对象的引用。</span><span class="sxs-lookup"><span data-stu-id="d5f16-175">To manipulate the data that is contained in a secondary data source, use the **CreateNavigator** method of the **DataSource** class to return a reference to an **XPathNavigator** object positioned at the node where the secondary data is stored.</span></span> <span data-ttu-id="d5f16-176">可以使用 **XPathNavigator** 类的属性或方法来操作数据。</span><span class="sxs-lookup"><span data-stu-id="d5f16-176">You can use the properties or methods of the **XPathNavigator** class to manipulate the data.</span></span> <span data-ttu-id="d5f16-177">有关详细信息，请参阅[使用 XPathNavigator 和 XPathNodeIterator 类](how-to-work-with-the-xpathnavigator-and-xpathnodeiterator-classes.md)。</span><span class="sxs-lookup"><span data-stu-id="d5f16-177">For more information, see [Work with the XPathNavigator and XPathNodeIterator Classes](how-to-work-with-the-xpathnavigator-and-xpathnodeiterator-classes.md).</span></span>
  
## <a name="using-the-dataconnectioncollection-and-the-dataconnection-classes"></a><span data-ttu-id="d5f16-178">使用 DataConnectionCollection 和 DataConnection 类</span><span class="sxs-lookup"><span data-stu-id="d5f16-178">Using the DataConnectionCollection and the DataConnection Classes</span></span>

<span data-ttu-id="d5f16-p107">[DataConnectionCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataConnectionCollection.aspx) 对象代表与一个表单模板关联的数据连接的集合，可以通过 [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.DataConnections.aspx) 类的 **DataConnections** 属性来访问该对象。例如，如果创建一个从 Northwind 数据库的 Employees 表中检索数据的名为 Employees 的辅助数据源，可以使用与该表单模板关联的 **DataConnectionCollection** 对象来设置对 **DataConnection** 的引用，后者代表到数据库的连接。</span><span class="sxs-lookup"><span data-stu-id="d5f16-p107">The [DataConnectionCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataConnectionCollection.aspx) object that represents the collection of data connections associated with a form template is accessed through the [DataConnections](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.DataConnections.aspx) property of the **XmlForm** class. For example, if you create a secondary data source named Employees that retrieves data from the Employees table in the Northwind database, you can use the **DataConnectionCollection** object associated with the form template to set a reference to the **DataConnection** that represents the connection to the database.</span></span> 
  
<span data-ttu-id="d5f16-p108">在下面的代码示例中，辅助数据源的名称传递到 **DataConnectionCollection** 类的 accessor 属性，在本例中，该属性会返回一个对代表到 Northwind 数据库的连接的 **ADOQueryConnection** 对象的引用。要使此引用正常工作，必须将返回的对象显式转换为 **ADOQueryConnection** 类型。 [ADOAdapterObject](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.AdoQueryConnection.Connection.aspx) 接口的 **Connection** 属性用于在消息框中显示 ADO 连接字符串。</span><span class="sxs-lookup"><span data-stu-id="d5f16-p108">In the following code sample, the name of the secondary data source is passed to the accessor property of the **DataConnectionCollection** class, which, in this case, returns a reference to the **ADOQueryConnection** object that represents the connection to the Northwind database. For this to work properly, you must explicitly cast the object being returned to the **ADOQueryConnection** type. The [Connection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.AdoQueryConnection.Connection.aspx) property of the **ADOAdapterObject** interface is used to display the ADO connection string in a message box.</span></span> 
  
```cs
// Instantiate a variable to access the specified data connection
// from the DataConnectionCollection of the form. 
// You must cast to the specific data connection type
// (ADOQueryConnection) before you can access the data connection.
ADOQueryConnection myADOConnection = 
   (ADOQueryConnection)this.DataConnections["Employees"];
// Display the connection information for the data connection.
MessageBox.Show("Connection string: " + myADOConnection.Connection);
```

```vb
' Instantiate a variable to access the specified data connection
' from the DataConnectionCollection of the form. 
' You must cast to the specific data connection type
' (ADOQueryConnection) before you can access the data connection.
Dim myADOConnection As ADOQueryConnection = _
   DirectCast(Me.DataConnections("Employees"), ADOQueryConnection)
' Display the connection information for the data connection.
MessageBox.Show("Connection string: " &amp; myADOConnection.Connection)
```

## <a name="see-also"></a><span data-ttu-id="d5f16-184">另请参阅</span><span class="sxs-lookup"><span data-stu-id="d5f16-184">See also</span></span>



[<span data-ttu-id="d5f16-185">创建使用 InfoPath Forms Services 的 InfoPath 表单模板</span><span class="sxs-lookup"><span data-stu-id="d5f16-185">Creating InfoPath Form Templates That Work With InfoPath Forms Services</span></span>](creating-infopath-form-templates-that-work-with-infopath-forms-services.md)

