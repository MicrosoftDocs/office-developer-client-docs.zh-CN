---
title: 关于 InfoPath 对 XML 技术的支持
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
ms.assetid: 074181a2-3a75-824c-049d-549aabff0f9f
description: Microsoft InfoPath 是一种混合式工具，它结合了传统文档编辑体验（例如字处理器或电子邮件应用程序）的优点，以及表单数据包精确的数据捕获功能。 本文描述了 InfoPath 可解决的问题，并介绍了用于解决这些问题的设计原则和 XML 行业标准。
ms.openlocfilehash: 20831635fba8d76b9d6b45f42a5308ab7236db20
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/28/2019
ms.locfileid: "33407226"
---
# <a name="about-infopath-support-for-xml-technologies"></a><span data-ttu-id="671e4-104">关于 InfoPath 对 XML 技术的支持</span><span class="sxs-lookup"><span data-stu-id="671e4-104">About InfoPath Support for XML Technologies</span></span>

<span data-ttu-id="671e4-105">Microsoft InfoPath 是一种混合式工具，它结合了传统文档编辑体验（例如字处理器或电子邮件应用程序）的优点，以及表单数据包精确的数据捕获功能。</span><span class="sxs-lookup"><span data-stu-id="671e4-105">Microsoft InfoPath is a hybrid tool that combines the best of a traditional document editing experience, such as a word processor or email application, with the rigorous data-capture capabilities of a forms package.</span></span> <span data-ttu-id="671e4-106">本文描述了 InfoPath 可解决的问题，并介绍了用于解决这些问题的设计原则和 XML 行业标准。</span><span class="sxs-lookup"><span data-stu-id="671e4-106">This article describes the problems InfoPath is designed to address and explains the design principles and XML industry standards used to solve these problems.</span></span>
  
## <a name="introduction"></a><span data-ttu-id="671e4-107">简介</span><span class="sxs-lookup"><span data-stu-id="671e4-107">Introduction</span></span>

<span data-ttu-id="671e4-p103">InfoPath 是一种高级 XML 创作工具，利用该工具，普通的最终用户将能创建符合自定义 XML 架构的 XML 文档。当用户编辑 XML 文档时，XML 架构将控制对文档所做的修改。</span><span class="sxs-lookup"><span data-stu-id="671e4-p103">InfoPath is a high-level XML authoring tool that enables ordinary end-users to create XML documents that belong to a custom-defined XML schema. When the user edits an XML document, modifications to the document are controlled by the XML schema.</span></span>
  
<span data-ttu-id="671e4-p104">用户通过一个内容丰富的带格式视图与 XML 文档交互，通过将 XSLT 样式表应用于文档，将会显示该视图。XML 文档中的叶节点或属性值显示为域（例如文本框或复选框），而节点层次结构呈现为域组。</span><span class="sxs-lookup"><span data-stu-id="671e4-p104">The user interacts with the XML document through a rich, formatted view that is displayed by applying an XSLT style sheet to the document. A leaf node or attribute value from the XML document is displayed as a field, such as a text box or check box, whereas a hierarchy of nodes is rendered as a group of fields.</span></span>
  
<span data-ttu-id="671e4-p105">利用 InfoPath，可通过显示对于当前选定域或域组有效的编辑操作，实现经过验证的、结构化的 XML 数据编辑。这种结构化的编辑使用户能够通过使用内容丰富的动态视图中显示的域组，在看不到元素和属性的情况下添加和移除有效的 XML 元素和属性。</span><span class="sxs-lookup"><span data-stu-id="671e4-p105">InfoPath enables validated, structured editing of XML data by showing the editing actions that are valid for the field or field group that is currently selected. This structured editing enables the user to add and remove valid XML elements and attributes by working with groups of fields displayed in rich dynamic views, without seeing the elements and attributes.</span></span>
  
<span data-ttu-id="671e4-p106">InfoPath 通过提供可随着添加使用 XML 分层数据模型的域组而增大的表单，解决了数据收集领域中的一个问题，这一问题在 XML 出现之前无法得到解决。InfoPath 将字处理器文档的灵活性和表单应用程序精确的验证功能结合到了一起。复杂的 XSLT 转换是此解决方案密不可分的一部分，它提供了易于使用的动态 XML 数据视图。</span><span class="sxs-lookup"><span data-stu-id="671e4-p106">InfoPath solves a problem in the area of data gathering that could not be solved before the advent of XML: by providing forms that can grow by adding groups of fields that use the hierarchical data model of XML, InfoPath adds the flexibility of word processor documents to the rigorous validation features of a forms application. Complex XSLT transformations are an integral part of this solution that provides dynamic, easy-to-use views of the XML data.</span></span>
  
## <a name="limitations-of-traditional-forms-and-documents-for-gathering-data"></a><span data-ttu-id="671e4-116">用于收集数据的传统表单和文档的限制</span><span class="sxs-lookup"><span data-stu-id="671e4-116">Limitations of Traditional Forms and Documents for Gathering Data</span></span>

<span data-ttu-id="671e4-117">在收集公司数据时，用户通常需要比静态表单更高的灵活性，而需要比字处理器文档更有条理的编辑和验证。</span><span class="sxs-lookup"><span data-stu-id="671e4-117">When gathering corporate data, users often want more flexibility than static forms provide, but more structured editing and validation than word processor documents provide.</span></span>
  
<span data-ttu-id="671e4-p107">传统的表单是静态的，并且长度受限。它们的重复行数目是固定的，并且在填写表单时无法扩展。传统的表单难于使用，原因是它们没有丰富的编辑功能。通常，用户必须在一个轮次中提供所有信息。</span><span class="sxs-lookup"><span data-stu-id="671e4-p107">Traditional forms are static and limited in length. They have a fixed number of repeating rows, and cannot be extended when the form is being filled out. Traditional forms are difficult to use because they do not have rich editing features. Often, the user must provide all the information in one pass.</span></span>
  
<span data-ttu-id="671e4-p108">另一方面，使用字处理器创建的传统文档允许用户自由地添加和移除内容，但几乎没有提供有关如何输入完整、结构化并且有效的信息的指导；在文档中定义的任何域都只会对数据值和数据类型进行最小限度的验证，或者不会进行验证。域中数据的标记方式不适当，无法实现轻松的引用和自动重用。数据形式松散，而并非结构化；您无法将信息分组，例如将"地址"标签应用于"街道"、"城市"和"省/市/自治区"域组。</span><span class="sxs-lookup"><span data-stu-id="671e4-p108">On the other hand, traditional documents created by using a word processor enable the user to freely add and remove content, but provide little guidance about how to enter complete, structured, and valid information; any fields that are defined in the document have minimal or no validation of data values and data types. Data in the fields is not properly labeled to enable easy referencing and automatic reuse. The data is free-form rather than structured; you cannot group information, such as applying an "Address" label to a group of "Street", "City", and "State" fields.</span></span>
  
<span data-ttu-id="671e4-p109">因此，就需要这样一种灵活而结构化的编辑功能，但是，由于在 XML 出现之前没有这种技术，因此开发人员不得不创建自定义应用程序，而这样需要大量的编码。自定义应用程序成本昂贵，难于修改，并且需要进行自定义编码才能实现验证。自定义应用程序通常需要最终用户培训，并且很难重用其他业务流程生成的数据。</span><span class="sxs-lookup"><span data-stu-id="671e4-p109">Thus there is a need for such flexible yet structured editing, but because this kind of technology was not available before the advent of XML, developers have had to create custom applications, which require extensive coding. Custom applications are expensive and difficult to modify, and require custom coding for validation. Custom applications often require end-user training, and it is difficult to reuse the resulting data for other business processes.</span></span>
  
## <a name="providing-structured-editing-by-displaying-xml-data-as-field-groups"></a><span data-ttu-id="671e4-127">通过将 XML 数据显示为域组，从而提供结构化的编辑</span><span class="sxs-lookup"><span data-stu-id="671e4-127">Providing Structured Editing by Displaying XML Data as Field Groups</span></span>

<span data-ttu-id="671e4-p110">一个必须要解决的重要技术设计问题是：如何提供一个易于使用的用户界面，用于在不显示元素和属性的情况下添加和移除 XML 元素和属性，但要使 DOM 树依照自定义 XML 架构保持有效。该用户界面需要提供一种自然的方式来编辑 DOM 树，包括插入可选的子树、替换子树选项，以及扩展现有子树。</span><span class="sxs-lookup"><span data-stu-id="671e4-p110">An important technical design problem that had to be solved was how to provide an easy user interface for adding and removing XML elements and attributes, without showing the elements and attributes, but keeping the DOM tree valid according to the custom-defined XML schema. The user interface needed to provide a natural way to edit the DOM tree that includes inserting optional subtrees, replacing choices of subtrees, and extending existing subtrees.</span></span>
  
<span data-ttu-id="671e4-p111">To provide this easy user interface, a DOM subtree is displayed as a field group, or section. A field group is a group of UI controls, such as text boxes and drop-down lists, and serves as an easy user interface that enables the user to visualize and edit hierarchical XML data. A field group can contain other field groups and can be optional or repeating, just as a DOM subtree can contain other subtrees and can be optional or repeating. A subtree is added to the DOM tree when the user rests the mouse pointer over a field group, clicks the drop-down menu that appears on the field group, and then selects **Insert \<field group name\>**.</span><span class="sxs-lookup"><span data-stu-id="671e4-p111">To provide this easy user interface, a DOM subtree is displayed as a field group, or section. A field group is a group of UI controls, such as text boxes and drop-down lists, and serves as an easy user interface that enables the user to visualize and edit hierarchical XML data. A field group can contain other field groups and can be optional or repeating, just as a DOM subtree can contain other subtrees and can be optional or repeating. A subtree is added to the DOM tree when the user rests the mouse pointer over a field group, clicks the drop-down menu that appears on the field group, and then selects **Insert \<field group name\>**.</span></span>
  
<span data-ttu-id="671e4-p112">InfoPath provides this structured editing of XML data by using the specified XML schema to constrain and guide editing. The schema controls whether the **Insert** and **Remove** commands appear on the drop-down menu for a field group. The schema is also used for validation. To enable editing of an XML document for which there is no XML schema, InfoPath can generate a schema from the XML document.</span><span class="sxs-lookup"><span data-stu-id="671e4-p112">InfoPath provides this structured editing of XML data by using the specified XML schema to constrain and guide editing. The schema controls whether the **Insert** and **Remove** commands appear on the drop-down menu for a field group. The schema is also used for validation. To enable editing of an XML document for which there is no XML schema, InfoPath can generate a schema from the XML document.</span></span> 
  
## <a name="providing-easy-to-use-views-of-xml-data-by-using-xslt-transformations"></a><span data-ttu-id="671e4-138">通过使用 XSLT 转换提供易于使用的 XML 数据视图</span><span class="sxs-lookup"><span data-stu-id="671e4-138">Providing Easy-to-Use Views of XML Data by Using XSLT Transformations</span></span>

<span data-ttu-id="671e4-p113">另一个需要解决的技术设计难题是：如何能够采用与 XML 数据结构截然不同的方式来组织 UI 视图的内容。为了采用对用户最有意义并使用户能够轻松阅读和编辑数据的方式来呈现数据，设计器必须能够按与 DOM 数据树中不同的顺序来显示数据、从视图中省略某些数据、将邻近的数据树节点重新组织为单独的视图，以及将不同数据树部分中的数据收集到一个视图中。</span><span class="sxs-lookup"><span data-stu-id="671e4-p113">Another technical design challenge that needed to be solved was how to enable the content of the UI views to be organized very differently than the structure of the XML data. To present the data in a way that makes the most sense for the user and enables the user to easily read and edit the data, the designer must be able to display data in a different sequence than in the DOM data tree, omit some data from a view, reorganize adjacent data tree nodes into separate views, and collect data from different parts of the data tree into a single view.</span></span>
  
<span data-ttu-id="671e4-p114">因此，视图内容的顺序和结构必须独立于 DOM 树节点的顺序和结构。呈现和数据的这种结构上的独立性要求在视图的分组域和 DOM 树的节点之间进行复杂、动态的绑定或映射。</span><span class="sxs-lookup"><span data-stu-id="671e4-p114">The order and structure of the content of the views must therefore be independent of the order and structure of the DOM tree nodes. This structural independence of presentation and data requires a complex, dynamic binding or mapping between the grouped fields in the views and the nodes in the DOM tree.</span></span>
  
<span data-ttu-id="671e4-p115">为了在视图和数据之间提供这种复杂的映射，InfoPath 广泛地使用了 XSL 转换 (XSLT)。XSLT 是一种功能强大的样式表语言，它支持复杂的 XSLT 转换，以及能够动态、灵活地呈现内容的丰富视图。将为每个视图使用一个 XSLT 文件。在 SGML 和 XML 创作工具中，使用样式表是一种已被广泛接受的常见设计方法，并且 XSLT 是用于这种复杂转换的样式表的 W3C 标准。</span><span class="sxs-lookup"><span data-stu-id="671e4-p115">To provide this complex mapping between views and data, InfoPath uses XSL Transformations (XSLT) extensively. XSLT is a powerful style sheet language that supports complex XSLT transformations and supports rich views with dynamic, flexible presentation of content. One XSLT file is used for each view. By using a style sheet is a common, well-established design approach in SGML and XML authoring tools, and XSLT is the W3C standard for stylesheets that are used for this kind of complex transformation.</span></span>
  
<span data-ttu-id="671e4-p116">为了避免在用户每次修改 DOM 中子树的结构时运行整个 XSLT 转换，将使用算法来确定视图的哪个部分必须刷新。然后，将仅应用 XSLT 样式表的相关部分，并刷新受影响的视图部分。</span><span class="sxs-lookup"><span data-stu-id="671e4-p116">To avoid running the whole XSLT transformation every time that the user modifies the structure of a subtree in the DOM, algorithms are used to determine which part of the view must be refreshed. Then only the relevant part of the XSLT style sheet is applied, and the affected part of the view is refreshed.</span></span>
  
## <a name="how-xml-standards-are-used-when-editing-a-form"></a><span data-ttu-id="671e4-149">在编辑表单时如何使用 XML 标准</span><span class="sxs-lookup"><span data-stu-id="671e4-149">How XML Standards Are Used When Editing a Form</span></span>

<span data-ttu-id="671e4-150">InfoPath 完全是依据 XML 标准构建的，这些标准包括：</span><span class="sxs-lookup"><span data-stu-id="671e4-150">InfoPath is built from the ground up on XML standards that includes the following:</span></span>
  
- <span data-ttu-id="671e4-151">可扩展标记语言 (XML) 1.0 第二版</span><span class="sxs-lookup"><span data-stu-id="671e4-151">Extensible Markup Language (XML) 1.0 Second Edition</span></span>
    
- <span data-ttu-id="671e4-152">XML 中的命名空间</span><span class="sxs-lookup"><span data-stu-id="671e4-152">Namespaces in XML</span></span>
    
- <span data-ttu-id="671e4-153">XML Path 语言 (XPath) 1.0</span><span class="sxs-lookup"><span data-stu-id="671e4-153">XML Path Language (XPath) 1.0</span></span>
    
- <span data-ttu-id="671e4-154">XML 架构 (XSD) 1.0 第一部分：结构，及第二部分：数据类型</span><span class="sxs-lookup"><span data-stu-id="671e4-154">XML Schema (XSD) 1.0 Part 1: Structures, and Part 2: Datatypes</span></span>
    
- <span data-ttu-id="671e4-155">可扩展样式表语言转换 (XSLT) 1.0</span><span class="sxs-lookup"><span data-stu-id="671e4-155">Extensible Stylesheet Language Transformations (XSLT) 1.0</span></span>
    
- <span data-ttu-id="671e4-156">可扩展超文本标记语言 (XHTML) 1.0</span><span class="sxs-lookup"><span data-stu-id="671e4-156">Extensible Hypertext Markup Language (XHTML) 1.0</span></span>
    
- <span data-ttu-id="671e4-157">级联样式表 (CSS)</span><span class="sxs-lookup"><span data-stu-id="671e4-157">Cascading Style Sheets (CSS)</span></span>
    
- <span data-ttu-id="671e4-158">文档对象模型 (DOM) 1.0</span><span class="sxs-lookup"><span data-stu-id="671e4-158">Document Object Model (DOM) 1.0</span></span>
    
- <span data-ttu-id="671e4-159">XML 数字签名 (XML DSig)</span><span class="sxs-lookup"><span data-stu-id="671e4-159">XML Digital Signatures (XML DSig)</span></span>
    
- <span data-ttu-id="671e4-160">简单对象访问协议 (SOAP) 1.1</span><span class="sxs-lookup"><span data-stu-id="671e4-160">Simple Object Access Protocol (SOAP) 1.1</span></span>
    
- <span data-ttu-id="671e4-161">Web Services 描述语言 (WSDL) 1.1</span><span class="sxs-lookup"><span data-stu-id="671e4-161">Web Services Description Language (WSDL) 1.1</span></span>
    
- <span data-ttu-id="671e4-162">通用描述、发现和集成 (UDDI) 1.0</span><span class="sxs-lookup"><span data-stu-id="671e4-162">Universal Description, Discovery, and Integration (UDDI) 1.0</span></span>
    
<span data-ttu-id="671e4-p117">例如，InfoPath 使用并生成可在各种业务流程中重用的标准 XML、XSLT 和 XSD 文件。InfoPath 使用 MSXML、SOAP 工具包和 .NET System.XML 命名空间来支持这些标准，并提供对 XML Web 服务的完整集成支持。</span><span class="sxs-lookup"><span data-stu-id="671e4-p117">For example, InfoPath uses and generates standard XML, XSLT, and XSD files that can be reused in various business processes. InfoPath uses MSXML, the SOAP Toolkit, and the .NET System.XML namespace to support these standards, and provides full integrated support for XML Web services.</span></span>
  
<span data-ttu-id="671e4-p118">Figure 1 shows the context-sensitive drop-down menu for a **customer** field group, which enables the user to add another **customer** field group, remove this **customer** field group, insert an **item** row in the table of purchase items in this field group, or insert an optional **actions** field group within this field group. The **Click here** link provides another way to insert the **actions** field group. A shorter drop-down menu appears on each purchase-item row.</span><span class="sxs-lookup"><span data-stu-id="671e4-p118">Figure 1 shows the context-sensitive drop-down menu for a **customer** field group, which enables the user to add another **customer** field group, remove this **customer** field group, insert an **item** row in the table of purchase items in this field group, or insert an optional **actions** field group within this field group. The **Click here** link provides another way to insert the **actions** field group. A shorter drop-down menu appears on each purchase-item row.</span></span> 
  
1. <span data-ttu-id="671e4-p119">在 InfoPath 中，用户基于 InfoPath 表单模板创建新 XML 文档，或打开基于表单模板的现有 XML 文档。XML 文档是一个 XML 数据文件，其中包含对表单模板的引用，并可使用 XML 命名空间。</span><span class="sxs-lookup"><span data-stu-id="671e4-p119">In InfoPath, the user creates a new XML document based on an InfoPath form template, or opens an existing XML document that is based on a form template. The XML document is an XML data file that contains a reference to the form template and can use XML namespaces.</span></span> 
    
    <span data-ttu-id="671e4-p120">表单模板是一组文件，利用这些文件可对符合特定自定义 XML 架构的 XML 文档进行结构化编辑。可以将组成表单模板的文件打包为普通文件夹中的单独文件，或打包为位于压缩文件夹中的文件。不论哪种情况，文件都是标准 XML 文件和可选的支持文件（例如托管代码程序集）。</span><span class="sxs-lookup"><span data-stu-id="671e4-p120">A form template is the set of files that provide structured editing of XML documents that comply with a particular custom-defined XML schema. The files that make up the form template may be packaged as individual files inside a ordinary folder or as files residing in a cabinet folder. In either case, the files are standard XML files and optional supporting files such as managed code assemblies.</span></span>
    
2. <span data-ttu-id="671e4-173">如果使用 XML 签名通过数字方式对 XML 文档进行了签名，则 InfoPath 将在打开 XML 文件之前确认该文件是一致的。</span><span class="sxs-lookup"><span data-stu-id="671e4-173">If the XML document is digitally signed using XML Signature, InfoPath confirms that the XML file is consistent before it opens it.</span></span>
    
3. <span data-ttu-id="671e4-174">InfoPath 将创建内存中 XML 文档的 DOM 数据树。</span><span class="sxs-lookup"><span data-stu-id="671e4-174">InfoPath creates a DOM data tree of the XML document in-memory.</span></span>
    
4. <span data-ttu-id="671e4-p121">XSLT 转换将应用于 DOM 树，从而生成以适当方式向用户呈现文档的视图。XML 文档开头的元素可显示在视图的底部，也可以按不同的排列形式显示在另一个视图中。视图由诸如节等 UI 容器组成，其中包含文本和控件，例如文本框、格式文本框、日期选取器和下拉列表。容器也可以包含其他容器。</span><span class="sxs-lookup"><span data-stu-id="671e4-p121">XSLT transformations are applied to the DOM tree, producing views that show an appropriate presentation of the document to the user. Elements at the beginning of the XML document could be displayed at the bottom of the view and also in a different arrangement in another view. The views consist of UI containers such as sections that contain text and controls, such as text boxes, rich text boxes, date pickers, and drop-down lists. Containers can also contain other containers.</span></span>
    
5. <span data-ttu-id="671e4-179">XSLT 转换生成 XHTML 作为输出，然后使用 CSS 来控制 XHTML 的呈现。</span><span class="sxs-lookup"><span data-stu-id="671e4-179">The XSLT transformation produces XHTML as output, and then a CSS is used to control the presentation of the XHTML.</span></span>
    
6. <span data-ttu-id="671e4-p122">如果 XML 架构允许向数据树的某个节点中添加节点，则映射到该节点的域或域组具有下拉菜单，用户可使用该下拉菜单来添加或移除域组。用户通过添加重复或可选的域组、输入值、选择选项或输入格式文本来编辑文档。如果 XML 架构节点与 XHTML 的架构关联，则 InfoPath 将呈现一个用于创建格式文本的 UI。当用户输入格式文本时，将创建 XHTML 内容作为 DOM 中的子树。</span><span class="sxs-lookup"><span data-stu-id="671e4-p122">If the XML schema allows adding nodes to a node of the data tree, the field or field group that is mapped to the node has a drop-down menu that enables the user to add or remove field groups. The user edits the document by adding a repeating or optional field group, entering a value, selecting an option, or entering rich text. If an XML schema node is associated with the schema for XHTML, InfoPath presents a UI for creating rich text. When the user enters rich text, XHTML content is created as a subtree in the DOM.</span></span>
    
7. <span data-ttu-id="671e4-p123">DOM 树始终保持有效。在用户编辑 XML 文档时，将依据关联的 XML 架构对所做编辑进行验证。将依据 XML 架构来验证尝试对 DOM 结构和叶节点值所做的更改，以确保其数据类型和值有效。如果尝试进行的更改无效，则会打开一个验证对话框，并且更改将不会应用于 DOM 树。如果更改有效，则更新 DOM 树。</span><span class="sxs-lookup"><span data-stu-id="671e4-p123">The DOM tree is always kept valid. As the user edits the XML document, the edits are validated against the associated XML schema. The attempted changes to the DOM structure and leaf node values are validated against the XML schema to ensure that their data types and values are valid. If the attempted changes are invalid, a validation dialog box opens, and the changes are not applied to the DOM tree. If the changes are valid, the DOM tree is updated.</span></span>
    
8. <span data-ttu-id="671e4-189">通过仅将所需的 XSLT 样式表部分应用于 DOM 树，刷新视图的已更改部分。</span><span class="sxs-lookup"><span data-stu-id="671e4-189">The changed part of the view is refreshed, by applying only the required parts of the XSLT style sheet to the DOM tree.</span></span>
    
9. <span data-ttu-id="671e4-p124">用户可以保存 XML 文档，或通过使用简单的 HTTP 或 SOAP 提交 XML 文档。除非依照 XML 架构文档是有效的，否则将不允许用户提交文档。</span><span class="sxs-lookup"><span data-stu-id="671e4-p124">The user can save the XML document or submit the XML document by using plain HTTP or SOAP. The user is not allowed to submit the document unless it is valid according to the XML schema.</span></span>
    
## <a name="how-xml-standards-are-used-when-designing-a-form"></a><span data-ttu-id="671e4-192">如何在设计表单时使用 XML 标准</span><span class="sxs-lookup"><span data-stu-id="671e4-192">How XML Standards Are Used When Designing a Form</span></span>

<span data-ttu-id="671e4-p125">您可以通过以下方式设计表单：从现有 XML 架构开始、连接到 XML Web Services 或数据库并获取其 XML 架构，或者依据新表单或 XML 数据文件自动生成架构。下面的过程中描述了这些方案。图 3 显示了用于设计表单模板的基本用户界面。</span><span class="sxs-lookup"><span data-stu-id="671e4-p125">You can design a form by starting with an existing XML schema, by connecting to an XML Web service or database and obtaining its XML schema, or by automatically generating a schema from a new form or from an XML data file. These scenarios are described in the following procedures. Figure 3 shows the basic user interface for designing a form template.</span></span>
  
1. <span data-ttu-id="671e4-p126">Create a new form in the InfoPath Designer by selecting the **XML or Schema** form template, and then select an existing XML schema file as the data source. The XML schema is loaded into the task pane and shown as a tree control.</span><span class="sxs-lookup"><span data-stu-id="671e4-p126">Create a new form in the InfoPath Designer by selecting the **XML or Schema** form template, and then select an existing XML schema file as the data source. The XML schema is loaded into the task pane and shown as a tree control.</span></span> 
    
2. <span data-ttu-id="671e4-p127">使用设计布局工具在一个或多个视图中安排 UI 控件的布局，例如行和背景设计。此操作将生成某些 XSLT 元素。XSLT 视图和 XML 架构将自动与表单模板关联。</span><span class="sxs-lookup"><span data-stu-id="671e4-p127">Use the design layout tools to lay out the UI controls, such as rows and the background design, in one or more views. This generates some of the XSLT elements. The XSLT views and the XML schema are automatically associated with the form template.</span></span>
    
3. <span data-ttu-id="671e4-p128">通过使用拖放将 XML 架构元素映射到视图中的 UI 控件。InfoPath 将帮助您基于架构元素的种类为 XML 架构元素选择适当的控件。例如，如果 XML 数据类型为日期，则 InfoPath 建议使用日期选取器控件。InfoPath 可基于 XML 架构中的选择来插入可选域组或重复域组。通过将 XML 架构元素映射到 UI 控件，将生成 XSLT 结构。</span><span class="sxs-lookup"><span data-stu-id="671e4-p128">Map the XML schema elements to the UI controls in the views by using drag-and-drop. InfoPath helps you choose appropriate controls for the XML schema elements, based on the kind of the schema elements. For example, if the XML data type is date, InfoPath suggests a date picker control. Based on choices in the XML schema, InfoPath can insert groups of optional or repeating fields. Mapping the XML schema elements to the UI controls generates the XSLT structure.</span></span>
    
4. <span data-ttu-id="671e4-p129">保存表单模板。您可以将组成表单模板的文件保存为常规文件夹中的单独文件，或保存为压缩文件夹内的文件。不论哪种情况，文件都是标准 XML 文件。表单模板现在即可供用户使用。</span><span class="sxs-lookup"><span data-stu-id="671e4-p129">Save the form template. You can save the files that make up the form template as individual files in a regular folder or as files inside a cabinet folder. In either case, the files are standard XML files. The form template is now ready for the user to use.</span></span>
    
<span data-ttu-id="671e4-p130">表单模板包含在 InfoPath 中打开表单时提供结构化编辑所需的所有语义信息。表单模板包括清单文件、定义视图的 XSLT 文件、验证数据所需的信息，以及 XML Web Services 的可选资源标识符。</span><span class="sxs-lookup"><span data-stu-id="671e4-p130">A form template contains all the semantic information that is needed to provide structured editing when a form is opened in InfoPath. A form template includes a manifest file, the XSLT files that define the views, the information that is needed to validate data, and an optional resource identifier for an XML Web service.</span></span>
  
<span data-ttu-id="671e4-p131">清单（或表单定义文件）是表单模板需要的所有文件的公共中心和入口点。清单包含对表单模板中其他文件的引用，并包含验证数据和提供结构化编辑所需的信息。将针对生成的用户界面自定义 XML 架构验证信息，并将该信息添加到清单文件。例如，如果架构允许在特定子树中插入多个可选元素，则可以设计 UI 以便在用户执行单一 UI 操作时添加多个可选元素。若要为普通用户提供出色的用户体验，这种自定义非常重要。</span><span class="sxs-lookup"><span data-stu-id="671e4-p131">The manifest, or form definition file , is the common hub and entry point for all of the files that are required by the form template. The manifest contains references to the other files in the form template, and contains the information that is needed to validate data and provide structured editing. The XML schema validation information is customized for the resulting user interface and added to the manifest file. For example, if the schema allows inserting multiple optional elements in a specific subtree, you can design the UI so that multiple optional elements are added when the user performs a single UI operation. This customization is important for providing a great user experience for the ordinary user.</span></span> 
  
<span data-ttu-id="671e4-p132">也可以通过使用现有 XML Web Services 来提供 XML 架构，从而设计表单。为此，请执行以下操作：</span><span class="sxs-lookup"><span data-stu-id="671e4-p132">You can also design a form by using an existing XML Web service to provide the XML schema. To do this:</span></span>
  
1. <span data-ttu-id="671e4-219">使用 UDDI 找到相关 Web 服务。</span><span class="sxs-lookup"><span data-stu-id="671e4-219">Use UDDI to locate relevant Web services.</span></span>
    
2. <span data-ttu-id="671e4-p133">选择要使用的 Web 服务。InfoPath 将读取与 Web 服务关联的 WSDL 文件，并确定要使用的 XML 架构。</span><span class="sxs-lookup"><span data-stu-id="671e4-p133">Select the Web service to use. InfoPath reads the WSDL file associated with the Web service and identifies the XML schema to be used.</span></span>
    
3. <span data-ttu-id="671e4-222">打开 XML 架构以将其加载。</span><span class="sxs-lookup"><span data-stu-id="671e4-222">Open the XML schema to load it.</span></span>
    
4. <span data-ttu-id="671e4-223">安排 UI 控件的布局，并将它们与 XML 架构元素和属性关联。</span><span class="sxs-lookup"><span data-stu-id="671e4-223">Lay out the UI controls and associate them with XML schema elements and attributes.</span></span>
    
5. <span data-ttu-id="671e4-224">定义如何将 XML 文档提交到使用 SOAP 的 Web 服务。</span><span class="sxs-lookup"><span data-stu-id="671e4-224">Define how to submit the XML document to the Web service that uses SOAP.</span></span>
    
<span data-ttu-id="671e4-225">如果要从头开始设计表单并自动生成 XML 架构：</span><span class="sxs-lookup"><span data-stu-id="671e4-225">If you want to design a form from scratch and automatically generate the XML schema:</span></span>
  
1. <span data-ttu-id="671e4-226">On the **File** tab, select either the **Blank Form** or **Blank Form (InfoPath Filler)** form template, and then click **Design Form**.</span><span class="sxs-lookup"><span data-stu-id="671e4-226">On the **File** tab, select either the **Blank Form** or **Blank Form (InfoPath Filler)** form template, and then click **Design Form**.</span></span>
    
2. <span data-ttu-id="671e4-p134">On the **Home** tab, click the arrow in the lower-right corner of the **Controls** group to display the **Controls** task pane, and then make sure that the **Automatically create the data source** check box is selected. (By default, this check box is selected.)</span><span class="sxs-lookup"><span data-stu-id="671e4-p134">On the **Home** tab, click the arrow in the lower-right corner of the **Controls** group to display the **Controls** task pane, and then make sure that the **Automatically create the data source** check box is selected. (By default, this check box is selected.)</span></span> 
    
3. <span data-ttu-id="671e4-p135">安排 UI 控件的布局。当您安排这些控件的布局时，InfoPath 将自动创建 XML 架构并将其元素和属性映射到 UI 控件。</span><span class="sxs-lookup"><span data-stu-id="671e4-p135">Lay out the UI controls. As you lay them out, InfoPath automatically creates the XML schema and maps its elements and attributes to the UI controls.</span></span>
    
<span data-ttu-id="671e4-231">若要从任何格式标准的 XML 数据文件开始设计表单：</span><span class="sxs-lookup"><span data-stu-id="671e4-231">To design a form by starting with any well-formed XML data file:</span></span>
  
1. <span data-ttu-id="671e4-232">On the **File** tab, select the **XML or Schema** form template, and then click **Design Form**.</span><span class="sxs-lookup"><span data-stu-id="671e4-232">On the **File** tab, select the **XML or Schema** form template, and then click **Design Form**.</span></span>
    
2. <span data-ttu-id="671e4-p136">In the **Data Source Wizard**, select the XML file that you want to use as the data source. An XML schema is automatically created, based on the XML data file.</span><span class="sxs-lookup"><span data-stu-id="671e4-p136">In the **Data Source Wizard**, select the XML file that you want to use as the data source. An XML schema is automatically created, based on the XML data file.</span></span>
    
3. <span data-ttu-id="671e4-235">按本节中前面所述的方式安排 UI 控件的布局。</span><span class="sxs-lookup"><span data-stu-id="671e4-235">Lay out the UI controls as described earlier in this section.</span></span>
    
## <a name="designed-as-an-ideal-client-for-web-services"></a><span data-ttu-id="671e4-236">设计为 Web 服务的理想客户端</span><span class="sxs-lookup"><span data-stu-id="671e4-236">Designed as an Ideal Client for Web Services</span></span>

<span data-ttu-id="671e4-p137">Web 服务正在获得广泛的业界支持。许多后端系统和中间层系统都可配置为使用诸如 SOAP、UDDI 和 WSDL 等 Web 服务标准进行通信。这些启用 Web 服务的系统包括数据库、工作流系统、企业资源计划 (ERP)、客户关系管理 (CRM) 和其他系统。现在，InfoPath 提供了一个理想的 UI 来查看和编辑通过 Web 服务发送的 XML 数据。图 4 显示了集成的 XML Web 服务支持。</span><span class="sxs-lookup"><span data-stu-id="671e4-p137">Broad industry-wide support for Web services is becoming available. Many back-end and middle-tier systems can be configured to communicate by using Web services standards such as SOAP, UDDI, and WSDL. These Web services-enabled systems include databases, workflow systems, enterprise resource planning (ERP), customer relationship management (CRM), and other systems. Now, InfoPath provides an ideal UI to view and edit the XML data that is being sent through Web services. Figure 4 shows the integrated support for XML Web services.</span></span>
  
<span data-ttu-id="671e4-p138">InfoPath 非常适合于 Web 服务的松散耦合模型，在这种模型中，将以完整 XML 文档的形式在计算机之间发送数据。这种粗粒度的通信模型非常适合于 Web 的异步特性。作为一种 XML 文档高级创作工具，InfoPath 支持文档/文本 SOAP 编码，而不是远程过程调用 (RPC) SOAP 编码。InfoPath 是 Web 服务的理想客户端，因为它能够以本地方式读取 SOAP 消息中指定的 XML 架构，然后基于该架构创建 UI，从而使用户能够轻松地查看和编辑对应 Web 服务生成或收到的 XML 文档。InfoPath 还支持包括修订的 ADO.NET 数据集。</span><span class="sxs-lookup"><span data-stu-id="671e4-p138">InfoPath fits well with the loosely coupled model of Web services, in which data is sent between computers as complete XML documents. This coarse-grained communication model fits well with the asynchronous nature of the Web. As a high-level authoring tool for XML documents, InfoPath supports the document/literal SOAP encoding instead of Remote Procedure Call (RPC) SOAP encoding. InfoPath is an ideal client for Web services, because it can natively read the XML schema specified in a SOAP message and then create a UI based on the schema, which enables users to easily view and edit XML documents that are generated or received by the corresponding Web service. InfoPath also provides support for ADO.NET DataSets that includes change-tracking.</span></span>
  
## <a name="terminology"></a><span data-ttu-id="671e4-247">术语</span><span class="sxs-lookup"><span data-stu-id="671e4-247">Terminology</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="671e4-248">**域组：**</span><span class="sxs-lookup"><span data-stu-id="671e4-248">**field group:**</span></span> <br/> |<span data-ttu-id="671e4-p139">一个节、重复节、可选节或重复表。节和重复表是表单上的控件，这些控件包含其他控件并根据需要重复。用户在填写表单时可插入多个节或行。</span><span class="sxs-lookup"><span data-stu-id="671e4-p139">A section, repeating section, optional section, or repeating table. Sections and repeating tables are controls on a form that contain other controls and that repeat as needed. Users can insert multiple sections or rows when filling out the form.</span></span>  <br/> |
|<span data-ttu-id="671e4-252">**DOM 树：**</span><span class="sxs-lookup"><span data-stu-id="671e4-252">**DOM tree:**</span></span> <br/> |<span data-ttu-id="671e4-p140">表单的数据源的结构。特别是，为 InfoPath 表单定义和存储数据的域和组的集合。</span><span class="sxs-lookup"><span data-stu-id="671e4-p140">The structure of the data source of the form. In particular, the collection of fields and groups that define and store the data for an InfoPath form.</span></span>  <br/> |
   
## <a name="conclusion"></a><span data-ttu-id="671e4-255">结论</span><span class="sxs-lookup"><span data-stu-id="671e4-255">Conclusion</span></span>

<span data-ttu-id="671e4-p141">InfoPath 使用开放 XML 标准向用户提供灵活而结构化的 XML 编辑用于数据收集。为了提供用于可视化和编辑分层 XML 数据的易于使用的用户界面，包含 UI 控件的嵌套域组将映射到 DOM 树。利用 XSLT 转换，可以按与 XML 数据的结构不同的方式组织 UI 视图的内容。</span><span class="sxs-lookup"><span data-stu-id="671e4-p141">InfoPath uses open XML standards to provide users with flexible yet structured XML editing for data gathering. To provide an easy user interface for visualizing and editing hierarchical XML data, nested field groups that contains UI controls are mapped to the DOM tree. XSLT transformations enable the content of the UI views to be organized differently than the structure of the XML data.</span></span>
  
<span data-ttu-id="671e4-p142">InfoPath 提供了比静态表单更高的灵活性，以及比字处理器文档更有条理的编辑和验证。两者结合在一起，就组成一个集传统文档编辑体验的优点和表单数据包精确的数据捕获功能于一身的混合式工具，从而使普通用户能够创建符合自定义 XML 架构的有效 XML 文档。利用对 Web 服务的集成支持，可以轻松地定义一些视图，用于编辑符合 Web 服务架构的 XML 文档。</span><span class="sxs-lookup"><span data-stu-id="671e4-p142">InfoPath provides more flexibility than static forms, with more structured editing and validation than word processor documents. The result is a hybrid tool that combines the best of a traditional document editing experience with the rigorous data-capture capabilities of a forms package, which enables ordinary users to create valid XML documents that belong to a custom-defined XML schema. Integrated support for Web services enables easily defining views for editing XML documents that comply with a Web services schema.</span></span>
  

