---
title: 将 InfoPath 表单与 Microsoft Access 数据库集成
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
ms.assetid: 5ec9a9c0-b348-4a31-b377-e95db2f92455
description: Microsoft InfoPath 支持将 Microsoft Access 2010 数据库用作表单的主要数据源，或者用作表单或控件的辅助数据源。本文介绍如何使用 Access 2010 数据库作为数据源。
ms.openlocfilehash: 30aea15a5e9a8d19f64b3f089b71e859cff93e0e
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/11/2018
ms.locfileid: "19774035"
---
# <a name="integrate-an-infopath-form-with-a-microsoft-access-database"></a>将 InfoPath 表单与 Microsoft Access 数据库集成

Microsoft InfoPath 支持将 Microsoft Access 2010 数据库用作表单的主要数据源，或者用作表单或控件的辅助数据源。本文介绍如何使用 Access 2010 数据库作为数据源。
  
## <a name="using-a-microsoft-access-database-as-a-data-source"></a>使用 Microsoft Access 数据库作为数据源

### <a name="setting-up-a-microsoft-access-database-as-a-forms-primary-data-source"></a>将 Microsoft Access 数据库设置为表单的主要数据源

在 InfoPath 中使用“数据连接向导”**** 建立数据库连接。 在 Microsoft Office Backstage 的“新建”**** 选项卡上的“高级表单模板”**** 部分中选择“数据库”****，然后单击“设计此表单”****，由此可打开此向导。
  
通过单击“选择数据库”****，可以选择现有数据源或直接连接到特定数据库文件。
  
选择数据库后，向导会提示你从数据库中选择一个表来用作表单的数据源。 添加表时，它们相互之间的关系随之建立，向导会在“数据源结构”**** 列表中显示表及其分层关系。 如果选中“显示表列”**** 复选框，向导会在数据源结构列表中显示每个表的字段名称。可以使用每个字段名称旁边的复选框指定字段是否包含在向导构造的 SQL 语句中。 
  
> [!NOTE]
> 每个表中的主键字段会始终被选中，并且无法删除。 
  
使用“数据连接向导”**** 指定表、关系和字段后，可以单击“编辑 SQL”**** 查看将用于为表单建立数据源的 SQL 语句。 在“编辑 SQL”**** 对话框中，可以单击“测试 SQL 语句”**** 以验证 InfoPath 是否能够根据提供的信息创建数据源。 你还可以使用“编辑 SQL”**** 对话框修改 SQL 语句以创建更复杂的查询。 
  
> [!NOTE]
> InfoPath 使用的 SQL 语句是数据构形查询。数据构形查询允许在查询中的两个或多个逻辑实体之间建立层次关系。可以使用 SQL JOIN 语句，但不建议这么做，因为这样做将会禁用表单提交。有关数据构形查询的详细信息，请参阅 Microsoft Developer Network (MSDN) 上的文档。 
  
“数据连接向导”**** 的最后一页显示有关数据源的摘要信息，其中包括数据源的名称和文件位置、主父表的名称、所用表的数量以及提交状态。 提交状态会提示生成的 SQL 语句是否允许将数据成功提交到数据源。 
  
### <a name="setting-up-a-microsoft-access-database-as-a-secondary-data-source"></a>设置 Microsoft Access 数据库作为辅助数据源

辅助数据源可用来为列表框或下拉列表框提供条目，也可以编写代码将辅助数据源中的数据添加到表单中。 若要在表单中使用辅助数据源，请在设计表单时单击“数据”**** 选项卡上的“数据连接”****。 
  
当启动“数据连接向导”**** 时，系统会提示是选择接收要在表单中使用的数据，还是选择在表单中提交数据。 选择“接收数据”****，然后单击“下一步”****。 若要从数据库创建辅助数据源，请选择“数据库(仅限 Microsoft SQL Server 或 Microsoft Office Access)”****。 在向导的下一页上，单击“选择数据库”**** 以选择现有数据源或直接连接到特定数据库文件。 
  
选择数据库后，向导会提示你从数据中选择一个表或查询来用作表单的数据源。 必须首先选择一个表或查询，但如果要包含其他表，可以稍后进行选择。 选择表或查询后，向导会允许你选择要在“数据源结构”**** 列表中使用的字段。 默认情况下，表的所有字段处于选中状态，但是如果你的表单不需要这些字段，可以将其删除。 你还可以控制从表中返回的记录的排序方式，以及是否允许多个记录。 为此，请单击“修改表”****，然后在“排序顺序”**** 对话框中最多选择三个排序条件。 如果满意此配置，则单击“完成”****。
  
> [!NOTE]
> 每个表中的主键字段会始终被选中，并且无法删除。 
  
InfoPath 还允许你从多个表或查询中同时检索数据。 从多个表或查询中检索数据时，必须能够在与“数据连接向导”**** 中选择的原始表或查询相关的所有表或查询之间建立关系。 例如，如果要从 Northwind 数据库的 Customers 表中检索数据，则可以添加 Orders 表以检索有关该客户的所有订单的数据，并且可以添加 Order Details 表以检索每个订单的详细信息。
  
若要将其他表添加到数据源，请在“数据源结构”**** 列表中选择要添加子表的表，然后单击“添加表”****。 选择要添加的表或查询，然后单击“下一步”****。 InfoPath 会提示你选择要使用的关系。 如果两个表中的字段具有相同的名称，InfoPath 会自动将这些字段添加为关系，但如果不具有相同的名称，或者如果想要使用自定义关系，则可以单击“添加关系”**** 以指定父表中的哪些字段与子表中的字段相对应。 此外还可以通过单击“编辑关系”**** 对话框中的“删除关系”**** 删除现有关系。 
  
如果对关系感到满意，请单击“完成”****。 与主表一样，可以指定从子表返回哪些字段。 但是无法使用“修改表”**** 按钮编辑返回记录的顺序。 
  
指定表、关系和字段后，可以单击“编辑 SQL”**** 以查看将用于为表单建立数据源的 SQL 查询语句。 在“编辑 SQL”**** 对话框中，可以单击“测试 SQL 语句”**** 以验证 InfoPath 是否能够根据提供的信息创建数据源。 你还可以使用“编辑 SQL”**** 对话框修改 SQL 语句以创建更复杂的查询。 
  
> [!NOTE]
> InfoPath 使用的 SQL 语句是数据构形查询。数据构形查询允许在查询中的两个或多个逻辑实体之间建立层次关系。可以使用 SQL JOIN 语句，但不建议这么做，因为这样做将会禁用表单提交。有关数据构形查询的详细信息，请参阅 Microsoft Developer Network (MSDN) 上的文档。 
  
## <a name="enabling-form-submission"></a>启用表单提交

除了从 Access 数据库接收数据外，InfoPath 还可以将新数据或更改过的数据提交回数据库。 当使用“主页”**** 选项卡或 Microsoft Office Backstage 上的“提交”**** 命令将更改提交到数据库时，InfoPath 使用 ActiveX 数据对象 (ADO) 更新数据库中的记录。 当满足以下所有条件时启用表单提交： 
  
- 表单查询中使用的每个列必须都有一个基础列。
    
- 在整个查询中，一个表列不能多次出现。
    
- 在表单查询所使用的 SELECT 子句中，每个表的主键、唯一约束或唯一索引必须可用。
    
- 表单查询中不能多次包含同一个表。
    
- 父表与子表之间的关系必须包括父表中的所有主键列。
    
- 在表单查询所使用的 SELECT 子句中，所有列只有一个基表。
    
在某些情况下，InfoPath 无法将表单更改提交到数据库。 例如，如果创建的表单是从查询而不是表中提取数据，或者如果自定义的 SQL 语句被 InfoPath 用来包含 JOIN 语句，则 InfoPath 将无法提交更改。 另一种阻止 InfoPath 提交更改的情况是，你要将表添加到与其父表具有多对一关系的表单中。 在 InfoPath 无法将更改提交到数据库的情况下，“数据连接向导”**** 最后一页上的“提交状态”**** 字段将显示限制提交的原因。 
  

