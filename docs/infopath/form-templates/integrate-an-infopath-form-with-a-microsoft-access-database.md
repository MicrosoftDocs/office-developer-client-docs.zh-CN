---
title: 将 InfoPath 表单与 Microsoft Access 数据库集成
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
ms.assetid: 5ec9a9c0-b348-4a31-b377-e95db2f92455
description: Microsoft InfoPath 支持将 Microsoft Access 2010 数据库用作表单的主要数据源，或者用作表单或控件的辅助数据源。本文介绍如何使用 Access 2010 数据库作为数据源。
ms.openlocfilehash: 30aea15a5e9a8d19f64b3f089b71e859cff93e0e
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/11/2018
ms.locfileid: "19774035"
---
# <a name="integrate-an-infopath-form-with-a-microsoft-access-database"></a><span data-ttu-id="86e85-104">将 InfoPath 表单与 Microsoft Access 数据库集成</span><span class="sxs-lookup"><span data-stu-id="86e85-104">Integrate an InfoPath Form with a Microsoft Access Database</span></span>

<span data-ttu-id="86e85-p102">Microsoft InfoPath 支持将 Microsoft Access 2010 数据库用作表单的主要数据源，或者用作表单或控件的辅助数据源。本文介绍如何使用 Access 2010 数据库作为数据源。</span><span class="sxs-lookup"><span data-stu-id="86e85-p102">Microsoft InfoPath supports using a Microsoft Access 2010 database as the primary data source for a form, or as a secondary data source for a form or control. This article explains how to use an Access 2010 database as a data source.</span></span>
  
## <a name="using-a-microsoft-access-database-as-a-data-source"></a><span data-ttu-id="86e85-107">使用 Microsoft Access 数据库作为数据源</span><span class="sxs-lookup"><span data-stu-id="86e85-107">Using a Microsoft Access Database as a Data Source</span></span>

### <a name="setting-up-a-microsoft-access-database-as-a-forms-primary-data-source"></a><span data-ttu-id="86e85-108">将 Microsoft Access 数据库设置为表单的主要数据源</span><span class="sxs-lookup"><span data-stu-id="86e85-108">Setting Up a Microsoft Access Database as a Form's Primary Data Source</span></span>

<span data-ttu-id="86e85-109">在 InfoPath 中使用“数据连接向导”**** 建立数据库连接。</span><span class="sxs-lookup"><span data-stu-id="86e85-109">Database connections are established in InfoPath by using the **Data Connection Wizard**.</span></span> <span data-ttu-id="86e85-110">在 Microsoft Office Backstage 的“新建”**** 选项卡上的“高级表单模板”**** 部分中选择“数据库”****，然后单击“设计此表单”****，由此可打开此向导。</span><span class="sxs-lookup"><span data-stu-id="86e85-110">Database connections are established in InfoPath by using the Data Connection Wizard. This wizard is opened by selecting Database in the Advanced Form Templates section on the New tab of the outspace14, and then clicking pressing Design This Form.</span></span>
  
<span data-ttu-id="86e85-111">通过单击“选择数据库”****，可以选择现有数据源或直接连接到特定数据库文件。</span><span class="sxs-lookup"><span data-stu-id="86e85-111">By clicking **Select Database**, you can choose an existing data source or connect directly to a specific database file.</span></span>
  
<span data-ttu-id="86e85-112">选择数据库后，向导会提示你从数据库中选择一个表来用作表单的数据源。</span><span class="sxs-lookup"><span data-stu-id="86e85-112">After you select a database, the wizard prompts you to select a table from the database to use as the data source for the form.</span></span> <span data-ttu-id="86e85-113">添加表时，它们相互之间的关系随之建立，向导会在“数据源结构”**** 列表中显示表及其分层关系。</span><span class="sxs-lookup"><span data-stu-id="86e85-113">As you add tables, their relationships to each other are established, and the wizard displays the tables and their hierarchical relationships in the **Data source structure** list.</span></span> <span data-ttu-id="86e85-114">如果选中“显示表列”**** 复选框，向导会在数据源结构列表中显示每个表的字段名称。可以使用每个字段名称旁边的复选框指定字段是否包含在向导构造的 SQL 语句中。</span><span class="sxs-lookup"><span data-stu-id="86e85-114">After you select a database, the wizard prompts you to select a table from the database to use as the data source for the form. As you add tables, their relationships to each other are established, and the wizard displays the tables and their hierarchical relationships in the **Data source structure** list. If you select the Show table columns check box, the wizard displays the field names of each table in the Data source structure list; you use the check boxes next to each field name to specify whether a field is included in the SQL statement that the wizard constructs.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="86e85-115">每个表中的主键字段会始终被选中，并且无法删除。</span><span class="sxs-lookup"><span data-stu-id="86e85-115">Primary key fields from each table are always selected and cannot be removed.</span></span> 
  
<span data-ttu-id="86e85-116">使用“数据连接向导”**** 指定表、关系和字段后，可以单击“编辑 SQL”**** 查看将用于为表单建立数据源的 SQL 语句。</span><span class="sxs-lookup"><span data-stu-id="86e85-116">When the tables, relationships, and fields have been specified using the **Data Connection Wizard**, you can click **Edit SQL** to view the SQL statement that will be used to establish the data source for the form. In the Edit SQL dialog box, you can click Test SQL Statement to verify that InfoPath will be able to create the data source from the information provided. You can also use the Edit SQL dialog box to modify the SQL statement to create more complex queries.</span></span> <span data-ttu-id="86e85-117">在“编辑 SQL”**** 对话框中，可以单击“测试 SQL 语句”**** 以验证 InfoPath 是否能够根据提供的信息创建数据源。</span><span class="sxs-lookup"><span data-stu-id="86e85-117">In the **Edit SQL** dialog box, you can click **Test SQL Statement** to verify that InfoPath will be able to create the data source from the information provided.</span></span> <span data-ttu-id="86e85-118">你还可以使用“编辑 SQL”**** 对话框修改 SQL 语句以创建更复杂的查询。</span><span class="sxs-lookup"><span data-stu-id="86e85-118">You can also use the **Edit SQL** dialog box to modify the SQL statement to create more complex queries.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="86e85-p106">InfoPath 使用的 SQL 语句是数据构形查询。数据构形查询允许在查询中的两个或多个逻辑实体之间建立层次关系。可以使用 SQL JOIN 语句，但不建议这么做，因为这样做将会禁用表单提交。有关数据构形查询的详细信息，请参阅 Microsoft Developer Network (MSDN) 上的文档。</span><span class="sxs-lookup"><span data-stu-id="86e85-p106">The SQL statements used by InfoPath are data shaping queries. Data shaping queries allow the building of hierarchical relationships between two or more logical entities in a query. It is possible to use SQL JOIN statements, but this is not recommended, because doing so will disable form submission. For more information on data shaping queries, see the documentation on the Microsoft Developer Network (MSDN).</span></span> 
  
<span data-ttu-id="86e85-123">“数据连接向导”**** 的最后一页显示有关数据源的摘要信息，其中包括数据源的名称和文件位置、主父表的名称、所用表的数量以及提交状态。</span><span class="sxs-lookup"><span data-stu-id="86e85-123">The last page of the **Data Connection Wizard** displays summary information about the data source, including the name and file location of the data source, the name of the primary parent table, the number of tables used, and the submit status. The submit status tells you whether the generated SQL statement will allow for successful submission of data to the data source.</span></span> <span data-ttu-id="86e85-124">提交状态会提示生成的 SQL 语句是否允许将数据成功提交到数据源。</span><span class="sxs-lookup"><span data-stu-id="86e85-124">The submit status tells you whether the generated SQL statement will allow for successful submission of data to the data source.</span></span> 
  
### <a name="setting-up-a-microsoft-access-database-as-a-secondary-data-source"></a><span data-ttu-id="86e85-125">设置 Microsoft Access 数据库作为辅助数据源</span><span class="sxs-lookup"><span data-stu-id="86e85-125">Setting up a Microsoft Access Database as a Secondary Data Source</span></span>

<span data-ttu-id="86e85-126">辅助数据源可用来为列表框或下拉列表框提供条目，也可以编写代码将辅助数据源中的数据添加到表单中。</span><span class="sxs-lookup"><span data-stu-id="86e85-126">Secondary data sources can be used to provide the entries for a list box or drop-down list box, or you can write code to add data from a secondary data source to your form. To work with secondary data sources in your form, click Data Connections on the Data tab when designing a form.</span></span> <span data-ttu-id="86e85-127">若要在表单中使用辅助数据源，请在设计表单时单击“数据”**** 选项卡上的“数据连接”****。</span><span class="sxs-lookup"><span data-stu-id="86e85-127">To work with secondary data sources in your form, click **Data Connections** on the **Data** tab when designing a form.</span></span> 
  
<span data-ttu-id="86e85-128">当启动“数据连接向导”**** 时，系统会提示是选择接收要在表单中使用的数据，还是选择在表单中提交数据。</span><span class="sxs-lookup"><span data-stu-id="86e85-128">When you start the **Data Connection Wizard**, you are prompted to select whether to receive data to use in the form, or to submit data in the form.</span></span> <span data-ttu-id="86e85-129">选择“接收数据”****，然后单击“下一步”****。</span><span class="sxs-lookup"><span data-stu-id="86e85-129">Choose **Receive data**, and then click **Next**.</span></span> <span data-ttu-id="86e85-130">若要从数据库创建辅助数据源，请选择“数据库(仅限 Microsoft SQL Server 或 Microsoft Office Access)”****。</span><span class="sxs-lookup"><span data-stu-id="86e85-130">To create a secondary data source from a database, select **Database (Microsoft SQL Server or Microsoft Office Access only)**.</span></span> <span data-ttu-id="86e85-131">在向导的下一页上，单击“选择数据库”**** 以选择现有数据源或直接连接到特定数据库文件。</span><span class="sxs-lookup"><span data-stu-id="86e85-131">On the next page of the wizard, click **Select Database** to choose an existing data source or connect directly to a specific database file.</span></span> 
  
<span data-ttu-id="86e85-132">选择数据库后，向导会提示你从数据中选择一个表或查询来用作表单的数据源。</span><span class="sxs-lookup"><span data-stu-id="86e85-132">After you select a database, the wizard prompts you to select a table or query from the database to use as the data source for the form.</span></span> <span data-ttu-id="86e85-133">必须首先选择一个表或查询，但如果要包含其他表，可以稍后进行选择。</span><span class="sxs-lookup"><span data-stu-id="86e85-133">You must select one table or query to begin with, but you can select additional tables later if you want to include them.</span></span> <span data-ttu-id="86e85-134">选择表或查询后，向导会允许你选择要在“数据源结构”**** 列表中使用的字段。</span><span class="sxs-lookup"><span data-stu-id="86e85-134">After you've selected a table or query, the wizard allows you to select the fields you want to use in the **Data source structure** list.</span></span> <span data-ttu-id="86e85-135">默认情况下，表的所有字段处于选中状态，但是如果你的表单不需要这些字段，可以将其删除。</span><span class="sxs-lookup"><span data-stu-id="86e85-135">By default, all the fields of the table are selected, but you can remove fields if they aren't necessary for your form.</span></span> <span data-ttu-id="86e85-136">你还可以控制从表中返回的记录的排序方式，以及是否允许多个记录。</span><span class="sxs-lookup"><span data-stu-id="86e85-136">You can also control how the records returned from the table are sorted, and whether multiple records are allowed.</span></span> <span data-ttu-id="86e85-137">为此，请单击“修改表”****，然后在“排序顺序”**** 对话框中最多选择三个排序条件。</span><span class="sxs-lookup"><span data-stu-id="86e85-137">To do so, click **Modify Table**, and then select up to three sorting criteria in the **Sort Order** dialog box.</span></span> <span data-ttu-id="86e85-138">如果满意此配置，则单击“完成”****。</span><span class="sxs-lookup"><span data-stu-id="86e85-138">When you're satisfied, click **Finish**.</span></span>
  
> [!NOTE]
> <span data-ttu-id="86e85-139">每个表中的主键字段会始终被选中，并且无法删除。</span><span class="sxs-lookup"><span data-stu-id="86e85-139">Primary key fields from each table are always selected and cannot be removed.</span></span> 
  
<span data-ttu-id="86e85-140">InfoPath 还允许你从多个表或查询中同时检索数据。</span><span class="sxs-lookup"><span data-stu-id="86e85-140">InfoPath also enables you to retrieve data from multiple tables or queries at the same time.</span></span> <span data-ttu-id="86e85-141">从多个表或查询中检索数据时，必须能够在与“数据连接向导”**** 中选择的原始表或查询相关的所有表或查询之间建立关系。</span><span class="sxs-lookup"><span data-stu-id="86e85-141">When you retrieve data from multiple tables or queries, you must be able to establish a relationship between all of the tables or queries involved with the original table or query you selected in the **Data Connection Wizard**.</span></span> <span data-ttu-id="86e85-142">例如，如果要从 Northwind 数据库的 Customers 表中检索数据，则可以添加 Orders 表以检索有关该客户的所有订单的数据，并且可以添加 Order Details 表以检索每个订单的详细信息。</span><span class="sxs-lookup"><span data-stu-id="86e85-142">InfoPath also enables you to retrieve data from multiple tables or queries at the same time. When you retrieve data from multiple tables or queries, you must be able to establish a relationship between all of the tables or queries involved with the original table or query you selected in the Data Connection Wizard. For example, if you were retrieving data from the Customers table of the Northwind database, you could add the Orders table to retrieve data about all the orders for that customer, and you could add the Order Details table to retrieve the details of each order.</span></span>
  
<span data-ttu-id="86e85-143">若要将其他表添加到数据源，请在“数据源结构”**** 列表中选择要添加子表的表，然后单击“添加表”****。</span><span class="sxs-lookup"><span data-stu-id="86e85-143">To add an additional table to the data source, select the table you want to add a child table to in the **Data source structure** list, and then click **Add Table**.</span></span> <span data-ttu-id="86e85-144">选择要添加的表或查询，然后单击“下一步”****。</span><span class="sxs-lookup"><span data-stu-id="86e85-144">Select the table or query you want to add, and then click **Next**.</span></span> <span data-ttu-id="86e85-145">InfoPath 会提示你选择要使用的关系。</span><span class="sxs-lookup"><span data-stu-id="86e85-145">InfoPath prompts you to select the relationship or relationships you want to use.</span></span> <span data-ttu-id="86e85-146">如果两个表中的字段具有相同的名称，InfoPath 会自动将这些字段添加为关系，但如果不具有相同的名称，或者如果想要使用自定义关系，则可以单击“添加关系”**** 以指定父表中的哪些字段与子表中的字段相对应。</span><span class="sxs-lookup"><span data-stu-id="86e85-146">If fields in the two tables have the same name, InfoPath automatically adds those fields as a relationship, but if not, or if you want to use a custom relationship, you can click **Add Relationship** to specify which fields in the parent table correspond to fields in the child table.</span></span> <span data-ttu-id="86e85-147">此外还可以通过单击“编辑关系”**** 对话框中的“删除关系”**** 删除现有关系。</span><span class="sxs-lookup"><span data-stu-id="86e85-147">You can also remove existing relationships by clicking **Remove Relationship** in the **Edit Relationship** dialog box.</span></span> 
  
<span data-ttu-id="86e85-148">如果对关系感到满意，请单击“完成”****。</span><span class="sxs-lookup"><span data-stu-id="86e85-148">When you're satisfied with the relationships, click **Finish**.</span></span> <span data-ttu-id="86e85-149">与主表一样，可以指定从子表返回哪些字段。</span><span class="sxs-lookup"><span data-stu-id="86e85-149">As with the main table, you can specify which fields are returned from the child table.</span></span> <span data-ttu-id="86e85-150">但是无法使用“修改表”**** 按钮编辑返回记录的顺序。</span><span class="sxs-lookup"><span data-stu-id="86e85-150">When you're satisfied with the relationships, click **Finish**. As with the main table, you can specify which fields are returned from the child table. You cannot, however, use the Modify Table button to edit the order in which the records are returned.</span></span> 
  
<span data-ttu-id="86e85-151">指定表、关系和字段后，可以单击“编辑 SQL”**** 以查看将用于为表单建立数据源的 SQL 查询语句。</span><span class="sxs-lookup"><span data-stu-id="86e85-151">When the tables, relationships, and fields have been specified, you can click **Edit SQL** to view the SQL query statement that will be used to establish the data source for the form.</span></span> <span data-ttu-id="86e85-152">在“编辑 SQL”**** 对话框中，可以单击“测试 SQL 语句”**** 以验证 InfoPath 是否能够根据提供的信息创建数据源。</span><span class="sxs-lookup"><span data-stu-id="86e85-152">In the **Edit SQL** dialog box, you can click **Test SQL Statement** to verify that InfoPath will be able to create the data source from the information provided.</span></span> <span data-ttu-id="86e85-153">你还可以使用“编辑 SQL”**** 对话框修改 SQL 语句以创建更复杂的查询。</span><span class="sxs-lookup"><span data-stu-id="86e85-153">You can also use the **Edit SQL** dialog box to modify the SQL statement to create more complex queries.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="86e85-p115">InfoPath 使用的 SQL 语句是数据构形查询。数据构形查询允许在查询中的两个或多个逻辑实体之间建立层次关系。可以使用 SQL JOIN 语句，但不建议这么做，因为这样做将会禁用表单提交。有关数据构形查询的详细信息，请参阅 Microsoft Developer Network (MSDN) 上的文档。</span><span class="sxs-lookup"><span data-stu-id="86e85-p115">The SQL statements used by InfoPath are data shaping queries. Data shaping queries allow the building of hierarchical relationships between two or more logical entities in a query. It is possible to use SQL JOIN statements, but this is not recommended, because doing so will disable form submission. For more information on data shaping queries, see the documentation on the Microsoft Developer Network (MSDN).</span></span> 
  
## <a name="enabling-form-submission"></a><span data-ttu-id="86e85-158">启用表单提交</span><span class="sxs-lookup"><span data-stu-id="86e85-158">Enabling Form Submission</span></span>

<span data-ttu-id="86e85-159">除了从 Access 数据库接收数据外，InfoPath 还可以将新数据或更改过的数据提交回数据库。</span><span class="sxs-lookup"><span data-stu-id="86e85-159">In addition to receiving data from an Access database, InfoPath can submit new or changed data back to the database.</span></span> <span data-ttu-id="86e85-160">当使用“主页”**** 选项卡或 Microsoft Office Backstage 上的“提交”**** 命令将更改提交到数据库时，InfoPath 使用 ActiveX 数据对象 (ADO) 更新数据库中的记录。</span><span class="sxs-lookup"><span data-stu-id="86e85-160">In addition to receiving data from an Access database, InfoPath can submit new or changed data back to the database. When you use the Submit command on the Home tab or the outspace14 to submit changes to the database, InfoPath uses ActiveX Data Objects (ADO) to update the records in the database. Form submission is enabled when all of the following conditions are met:</span></span> <span data-ttu-id="86e85-161">当满足以下所有条件时启用表单提交：</span><span class="sxs-lookup"><span data-stu-id="86e85-161">Form submission is enabled when all of the following conditions are met:</span></span> 
  
- <span data-ttu-id="86e85-162">表单查询中使用的每个列必须都有一个基础列。</span><span class="sxs-lookup"><span data-stu-id="86e85-162">There must be a base column for every column that is used in the form's query.</span></span>
    
- <span data-ttu-id="86e85-163">在整个查询中，一个表列不能多次出现。</span><span class="sxs-lookup"><span data-stu-id="86e85-163">A table column may not appear multiple times in the entire query.</span></span>
    
- <span data-ttu-id="86e85-164">在表单查询所使用的 SELECT 子句中，每个表的主键、唯一约束或唯一索引必须可用。</span><span class="sxs-lookup"><span data-stu-id="86e85-164">A primary key, unique constraint, or unique index must be available for every table in a SELECT clause that is used in the form's query.</span></span>
    
- <span data-ttu-id="86e85-165">表单查询中不能多次包含同一个表。</span><span class="sxs-lookup"><span data-stu-id="86e85-165">A table cannot be included multiple times in the form's query.</span></span>
    
- <span data-ttu-id="86e85-166">父表与子表之间的关系必须包括父表中的所有主键列。</span><span class="sxs-lookup"><span data-stu-id="86e85-166">Relationships between parent and child tables must include all primary key columns from the parent table.</span></span>
    
- <span data-ttu-id="86e85-167">在表单查询所使用的 SELECT 子句中，所有列只有一个基表。</span><span class="sxs-lookup"><span data-stu-id="86e85-167">There can only be one base table for all columns in a SELECT clause that is used in the form's query.</span></span>
    
<span data-ttu-id="86e85-168">在某些情况下，InfoPath 无法将表单更改提交到数据库。</span><span class="sxs-lookup"><span data-stu-id="86e85-168">There are some circumstances under which InfoPath cannot submit form changes to a database.</span></span> <span data-ttu-id="86e85-169">例如，如果创建的表单是从查询而不是表中提取数据，或者如果自定义的 SQL 语句被 InfoPath 用来包含 JOIN 语句，则 InfoPath 将无法提交更改。</span><span class="sxs-lookup"><span data-stu-id="86e85-169">For example, if you create a form that draws data from a query instead of a table, or if you customize the SQL statement that is used by InfoPath to include a JOIN statement, InfoPath will be unable to submit changes.</span></span> <span data-ttu-id="86e85-170">另一种阻止 InfoPath 提交更改的情况是，你要将表添加到与其父表具有多对一关系的表单中。</span><span class="sxs-lookup"><span data-stu-id="86e85-170">Another circumstance that would prevent InfoPath from submitting changes is if you were to add tables to the form that have a many-to-one relationship with their parent table.</span></span> <span data-ttu-id="86e85-171">在 InfoPath 无法将更改提交到数据库的情况下，“数据连接向导”**** 最后一页上的“提交状态”**** 字段将显示限制提交的原因。</span><span class="sxs-lookup"><span data-stu-id="86e85-171">In situations where InfoPath will be unable to submit changes to the database, the **Submit status** field on the last page of the **Data Connection Wizard** will display the reason for the limitation.</span></span> 
  

