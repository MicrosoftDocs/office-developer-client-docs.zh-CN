---
title: 使用 InfoPath 2003 对象模型处理表单窗口
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
keywords:
- infopath 2003-compatible form templates, form windows,form windows [InfoPath 2007], InfoPath 2003-compatible form templates
localization_priority: Normal
ms.assetid: fbcf3a04-ee0f-40a6-8edd-583ae203e2e1
description: 以编程方式处理 InfoPath 表单时，您可以编写代码来访问该表单的窗口，然后自定义窗口中包含的某些项目。通过结合使用 WindowObject 接口和 WindowsCollection 接口，InfoPath 2003 兼容对象模型支持对表单的窗口进行访问。
ms.openlocfilehash: f8939fc562cf16c1bce0f6f88bba659e895254f3
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/28/2019
ms.locfileid: "33427575"
---
# <a name="work-with-form-windows-using-the-infopath-2003-object-model"></a><span data-ttu-id="8ee6e-105">使用 InfoPath 2003 对象模型处理表单窗口</span><span class="sxs-lookup"><span data-stu-id="8ee6e-105">Work with Form Windows Using the InfoPath 2003 Object Model</span></span>

<span data-ttu-id="8ee6e-p102">以编程方式处理 InfoPath 表单时，您可以编写代码来访问该表单的窗口，然后自定义窗口中包含的某些项目。通过结合使用 [WindowObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.WindowObject.aspx) 接口和 [WindowsCollection](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.WindowsCollection.aspx) 接口，InfoPath 2003 兼容对象模型支持对表单的窗口进行访问。</span><span class="sxs-lookup"><span data-stu-id="8ee6e-p102">When working programmatically with an InfoPath form, you can write code to access the form's windows, and then customize some of the items that they contain. The InfoPath 2003-compatible object model supports access to a form's windows through the use of the [WindowObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.WindowObject.aspx) interface in association with the [WindowsCollection](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.WindowsCollection.aspx) interface.</span></span> 
  
<span data-ttu-id="8ee6e-108">InfoPath 中有两类窗口：</span><span class="sxs-lookup"><span data-stu-id="8ee6e-108">There are two types of windows in InfoPath:</span></span>
  
- <span data-ttu-id="8ee6e-109">用户在填写表单时使用的编辑窗口。</span><span class="sxs-lookup"><span data-stu-id="8ee6e-109">The editing window, which is used when a user fills out a form.</span></span>
    
- <span data-ttu-id="8ee6e-110">用户在设计表单模板时使用的设计窗口。</span><span class="sxs-lookup"><span data-stu-id="8ee6e-110">The designing window, which is used when a user designs a form template.</span></span>
    
<span data-ttu-id="8ee6e-111">在表单模板中编写代码时，编辑窗口提供了最有用的功能，因为您可以使用引用该窗口的 **WindowObject** 实例来访问可用来自定义表单编辑体验的各种属性和方法。</span><span class="sxs-lookup"><span data-stu-id="8ee6e-111">When writing code in a form template, it is the editing window that provides the most useful functionality, because you can use a **WindowObject** instance that references it to access a variety of properties and methods that can be used to customize the form editing experience.</span></span> 
  
## <a name="overview-of-the-windowscollection-interface"></a><span data-ttu-id="8ee6e-112">WindowsCollection 接口概述</span><span class="sxs-lookup"><span data-stu-id="8ee6e-112">Overview of the WindowsCollection Interface</span></span>

<span data-ttu-id="8ee6e-113">**WindowsCollection** 接口提供了下列属性，表单模板开发人员可将其用于管理该表单包含的 **WindowObject** 实例。</span><span class="sxs-lookup"><span data-stu-id="8ee6e-113">The **WindowsCollection** interface provides the following properties, which form template developers can use to manage the **WindowObject** instances that it contains.</span></span> 
  
|<span data-ttu-id="8ee6e-114">**名称**</span><span class="sxs-lookup"><span data-stu-id="8ee6e-114">**Name**</span></span>|<span data-ttu-id="8ee6e-115">**说明**</span><span class="sxs-lookup"><span data-stu-id="8ee6e-115">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="8ee6e-116">[Count](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Windows.Count.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="8ee6e-116">[Count](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Windows.Count.aspx) property</span></span>  <br/> |<span data-ttu-id="8ee6e-117">返回集合中包含的 **Window** 对象的数目。</span><span class="sxs-lookup"><span data-stu-id="8ee6e-117">Returns a count of the number of **Window** objects contained in the collection.</span></span>  <br/> |
|<span data-ttu-id="8ee6e-118">[Item](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Windows.Item.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="8ee6e-118">[Item](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Windows.Item.aspx) property</span></span>  <br/> |<span data-ttu-id="8ee6e-119">返回对指定的 **Window** 对象的引用。</span><span class="sxs-lookup"><span data-stu-id="8ee6e-119">Returns a reference to the specified **Window** object.</span></span>  <br/> <span data-ttu-id="8ee6e-120">**注意**：Visual C# 使用索引器而不是通过调用 **Item** 属性来访问集合。</span><span class="sxs-lookup"><span data-stu-id="8ee6e-120">**NOTE**: Visual C# accesses collections using an indexer instead of calling the **Item** property.</span></span> <span data-ttu-id="8ee6e-121">例如，`thisApplication.Windows[0].Caption`。</span><span class="sxs-lookup"><span data-stu-id="8ee6e-121">For example,  `thisApplication.Windows[0].Caption`.</span></span>           |
   
## <a name="overview-of-the-window-object"></a><span data-ttu-id="8ee6e-122">Window 对象概述</span><span class="sxs-lookup"><span data-stu-id="8ee6e-122">Overview of the Window Object</span></span>

<span data-ttu-id="8ee6e-123">**WindowObject** 接口提供了下列方法和属性，表单开发人员可以使用这些属性和方法与 InfoPath 窗口进行交互。</span><span class="sxs-lookup"><span data-stu-id="8ee6e-123">The **WindowObject** interface provides the following methods and properties, which form developers can use to interact with an InfoPath window.</span></span> <span data-ttu-id="8ee6e-124">根据所使用的窗口类型 ([XdWindowType](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.XdWindowType.aspx)) 的不同，对这些方法和属性的支持也不同。</span><span class="sxs-lookup"><span data-stu-id="8ee6e-124">Support for these methods and properties differ depending on the type of window ( [XdWindowType](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.XdWindowType.aspx) ) you are working with.</span></span> <span data-ttu-id="8ee6e-125">有些方法和属性只适用于编辑器窗口类型 (**XdWindowType.xdEditorWindow**)。</span><span class="sxs-lookup"><span data-stu-id="8ee6e-125">Some methods and properties work only with the editor window type (**XdWindowType.xdEditorWindow**).</span></span> <span data-ttu-id="8ee6e-126">有些方法和属性既适用于编辑器窗口类型，也适用于设计器窗口类型 (**XdWindowType.xdDesignerWindow**)。</span><span class="sxs-lookup"><span data-stu-id="8ee6e-126">The remaining methods and properties work with both the editor window type and the designer window type (**XdWindowType.xdDesignerWindow**).</span></span> <span data-ttu-id="8ee6e-127">此外，与所有 InfoPath 对象模型成员一样，当从表单模板调用时，根据安全级别和表单部署方式的不同，对方法和属性的支持也有所不同。</span><span class="sxs-lookup"><span data-stu-id="8ee6e-127">Additionally, like all InfoPath object model members, when called from a form template, support for methods and properties can vary depending on the security level and how the form is deployed.</span></span>
  
|<span data-ttu-id="8ee6e-128">**名称**</span><span class="sxs-lookup"><span data-stu-id="8ee6e-128">**Name**</span></span>|<span data-ttu-id="8ee6e-129">**说明**</span><span class="sxs-lookup"><span data-stu-id="8ee6e-129">**Description**</span></span>|<span data-ttu-id="8ee6e-130">**窗口类型支持**</span><span class="sxs-lookup"><span data-stu-id="8ee6e-130">**Window Type Support**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="8ee6e-131">[Activate](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Window2.Activate.aspx) 方法</span><span class="sxs-lookup"><span data-stu-id="8ee6e-131">[Activate](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Window2.Activate.aspx) method</span></span>  <br/> |<span data-ttu-id="8ee6e-132">指定该窗口为当前的活动窗口。</span><span class="sxs-lookup"><span data-stu-id="8ee6e-132">Designates the window as the currently active window.</span></span>  <br/> |<span data-ttu-id="8ee6e-133">**xdDesignWindow** 和 **xdEditorWindow** 类型</span><span class="sxs-lookup"><span data-stu-id="8ee6e-133">Both the **xdDesignWindow** and **xdEditorWindow** types</span></span>  <br/> |
|<span data-ttu-id="8ee6e-134">[Active](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Window2.Active.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="8ee6e-134">[Active](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Window2.Active.aspx) property</span></span>  <br/> |<span data-ttu-id="8ee6e-135">返回一个 **Boolean** 值，指示窗口是否是当前的活动窗口。</span><span class="sxs-lookup"><span data-stu-id="8ee6e-135">Returns a **Boolean** value indicating whether the window is the currently active window.</span></span>  <br/> |<span data-ttu-id="8ee6e-136">**xdDesignWindow** 和 **xdEditorWindow** 类型</span><span class="sxs-lookup"><span data-stu-id="8ee6e-136">Both the **xdDesignWindow** and **xdEditorWindow** types</span></span>  <br/> |
|<span data-ttu-id="8ee6e-137">[Caption](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Window2.Caption.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="8ee6e-137">[Caption](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Window2.Caption.aspx) property</span></span>  <br/> |<span data-ttu-id="8ee6e-138">读/写属性，用于返回或设置 **Window** 对象所代表的窗口的标题文本。</span><span class="sxs-lookup"><span data-stu-id="8ee6e-138">A read/write property that returns or sets the caption text for the window represented by the **Window** object.</span></span>  <br/> |<span data-ttu-id="8ee6e-139">仅限于 **xdEditorWindow** 类型</span><span class="sxs-lookup"><span data-stu-id="8ee6e-139">Only the **xdEditorWindow** type</span></span>  <br/> |
|<span data-ttu-id="8ee6e-140">[Close](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Window2.Close.aspx) 方法</span><span class="sxs-lookup"><span data-stu-id="8ee6e-140">[Close](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Window2.Close.aspx) method</span></span>  <br/> |<span data-ttu-id="8ee6e-141">关闭窗口。</span><span class="sxs-lookup"><span data-stu-id="8ee6e-141">Closes a window.</span></span>  <br/> |<span data-ttu-id="8ee6e-142">仅限于 **xdEditorWindow** 类型</span><span class="sxs-lookup"><span data-stu-id="8ee6e-142">Only the **xdEditorWindow** type</span></span>  <br/> |
|<span data-ttu-id="8ee6e-143">[CommandBars](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Window2.CommandBars.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="8ee6e-143">[CommandBars](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Window2.CommandBars.aspx) property</span></span>  <br/> |<span data-ttu-id="8ee6e-144">返回一个对 Microsoft Office **CommandBars** 对象的引用。</span><span class="sxs-lookup"><span data-stu-id="8ee6e-144">Returns a reference to the Microsoft Office **CommandBars** object.</span></span>  <br/> |<span data-ttu-id="8ee6e-145">**xdDesignWindow** 和 **xdEditorWindow** 类型</span><span class="sxs-lookup"><span data-stu-id="8ee6e-145">Both the **xdDesignWindow** and **xdEditorWindow** types</span></span>  <br/> |
|<span data-ttu-id="8ee6e-146">[Height](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Window2.Height.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="8ee6e-146">[Height](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Window2.Height.aspx) property</span></span>  <br/> |<span data-ttu-id="8ee6e-147">长整型的读/写属性，用于指定 **Window** 对象所代表的窗口的高度（以磅为单位）。</span><span class="sxs-lookup"><span data-stu-id="8ee6e-147">A read/write property of type long integer that specifies the height of the window represented by the **Window** object, measured in points.</span></span>  <br/> |<span data-ttu-id="8ee6e-148">**xdDesignWindow** 和 **xdEditorWindow** 类型</span><span class="sxs-lookup"><span data-stu-id="8ee6e-148">Both the **xdDesignWindow** and **xdEditorWindow** types</span></span>  <br/> |
|<span data-ttu-id="8ee6e-149">[Left](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Window2.Left.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="8ee6e-149">[Left](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Window2.Left.aspx) property</span></span>  <br/> |<span data-ttu-id="8ee6e-150">长整型的读/写属性，用于指定 **Window** 对象所代表的窗口的水平位置（以磅为单位）。</span><span class="sxs-lookup"><span data-stu-id="8ee6e-150">A read/write property of type long integer that specifies the horizontal position of the window represented by the **Window** object, measured in points.</span></span>  <br/> |<span data-ttu-id="8ee6e-151">**xdDesignWindow** 和 **xdEditorWindow** 类型</span><span class="sxs-lookup"><span data-stu-id="8ee6e-151">Both the **xdDesignWindow** and **xdEditorWindow** types</span></span>  <br/> |
|<span data-ttu-id="8ee6e-152">[MailEnvelope](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Window2.MailEnvelope.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="8ee6e-152">[MailEnvelope](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Window2.MailEnvelope.aspx) property</span></span>  <br/> |<span data-ttu-id="8ee6e-153">返回对 [MailEnvelopeObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.MailEnvelopeObject.aspx) 对象的引用。</span><span class="sxs-lookup"><span data-stu-id="8ee6e-153">Returns a reference to the [MailEnvelopeObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.MailEnvelopeObject.aspx) object.</span></span>  <br/> |<span data-ttu-id="8ee6e-154">仅限于 **xdEditorWindow** 类型</span><span class="sxs-lookup"><span data-stu-id="8ee6e-154">Only the **xdEditorWindow** type</span></span>  <br/> |
|<span data-ttu-id="8ee6e-155">[TaskPanes](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Window2.TaskPanes.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="8ee6e-155">[TaskPanes](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Window2.TaskPanes.aspx) property</span></span>  <br/> |<span data-ttu-id="8ee6e-156">返回对 [TaskPanesCollection](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.TaskPanesCollection.aspx) 集合的引用。</span><span class="sxs-lookup"><span data-stu-id="8ee6e-156">Returns a reference to the [TaskPanesCollection](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.TaskPanesCollection.aspx) collection.</span></span>  <br/> |<span data-ttu-id="8ee6e-157">**xdDesignWindow** 和 **xdEditorWindow** 类型</span><span class="sxs-lookup"><span data-stu-id="8ee6e-157">Both the **xdDesignWindow** and **xdEditorWindow** types</span></span>  <br/> |
|<span data-ttu-id="8ee6e-158">[Top](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Window2.Top.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="8ee6e-158">[Top](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Window2.Top.aspx) property</span></span>  <br/> |<span data-ttu-id="8ee6e-159">长整型的读/写属性，用于指定 **Window** 对象所代表的窗口的垂直位置（以磅为单位）。</span><span class="sxs-lookup"><span data-stu-id="8ee6e-159">A read/write property of type long integer that specifies the vertical position of the window represented by the **Window** object, measured in points.</span></span>  <br/> |<span data-ttu-id="8ee6e-160">**xdDesignWindow** 和 **xdEditorWindow** 类型</span><span class="sxs-lookup"><span data-stu-id="8ee6e-160">Both the **xdDesignWindow** and **xdEditorWindow** types</span></span>  <br/> |
|<span data-ttu-id="8ee6e-161">[WindowType](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Window2.WindowType.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="8ee6e-161">[WindowType](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Window2.WindowType.aspx) property</span></span>  <br/> |<span data-ttu-id="8ee6e-162">返回一个数字，基于 [XdWindowType](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.XdWindowType.aspx) 枚举，表示窗口的类型。</span><span class="sxs-lookup"><span data-stu-id="8ee6e-162">Returns a number indicating the type of the window, based on the [XdWindowType](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.XdWindowType.aspx) enumeration.</span></span>  <br/> |<span data-ttu-id="8ee6e-163">**xdDesignWindow** 和 **xdEditorWindow** 类型</span><span class="sxs-lookup"><span data-stu-id="8ee6e-163">Both the **xdDesignWindow** and **xdEditorWindow** types</span></span>  <br/> |
|<span data-ttu-id="8ee6e-164">[Width](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Window2.Width.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="8ee6e-164">[Width](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Window2.Width.aspx) property</span></span>  <br/> |<span data-ttu-id="8ee6e-165">长整型的读/写属性，用于指定 **Window** 对象所代表的窗口的宽度（以磅为单位）。</span><span class="sxs-lookup"><span data-stu-id="8ee6e-165">A read/write property of type long integer that specifies the width of the window represented by the **Window** object, measured in points.</span></span>  <br/> |<span data-ttu-id="8ee6e-166">**xdDesignWindow** 和 **xdEditorWindow** 类型</span><span class="sxs-lookup"><span data-stu-id="8ee6e-166">Both the **xdDesignWindow** and **xdEditorWindow** types</span></span>  <br/> |
|<span data-ttu-id="8ee6e-167">[WindowState](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Window2.WindowState.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="8ee6e-167">[WindowState](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Window2.WindowState.aspx) property</span></span>  <br/> |<span data-ttu-id="8ee6e-168">[XdWindowState](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.XdWindowState.aspx) 类型的读/写属性，用于返回或设置 **Window** 对象所表示的窗口的状态。</span><span class="sxs-lookup"><span data-stu-id="8ee6e-168">A read/write property of type [XdWindowState](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.XdWindowState.aspx) that returns or sets the state of the window represented by the **Window** object.</span></span>  <br/> |<span data-ttu-id="8ee6e-169">**xdDesignWindow** 和 **xdEditorWindow** 类型</span><span class="sxs-lookup"><span data-stu-id="8ee6e-169">Both the **xdDesignWindow** and **xdEditorWindow** types</span></span>  <br/> |
|<span data-ttu-id="8ee6e-170">[XDocument](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Window2.XDocument.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="8ee6e-170">[XDocument](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Window2.XDocument.aspx) property</span></span>  <br/> |<span data-ttu-id="8ee6e-171">返回对与窗口关联的 [_XDocument](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocument.aspx) 对象的引用。</span><span class="sxs-lookup"><span data-stu-id="8ee6e-171">Returns a reference to the [_XDocument](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocument.aspx) object associated with the window.</span></span>  <br/> |<span data-ttu-id="8ee6e-172">仅限于 **xdEditorWindow** 类型</span><span class="sxs-lookup"><span data-stu-id="8ee6e-172">Only the **xdEditorWindow** type</span></span>  <br/> |
   
## <a name="using-the-windowscollection-and-window-interfaces"></a><span data-ttu-id="8ee6e-173">使用 WindowsCollection 和 Window 接口</span><span class="sxs-lookup"><span data-stu-id="8ee6e-173">Using the WindowsCollection and Window Interfaces</span></span>

<span data-ttu-id="8ee6e-p105">通过 **Application** 接口的 [Windows](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._Application2.Windows.aspx) 属性可以访问 [WindowsCollection](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Application.aspx) 接口。使用 **WindowsCollection** 接口访问表单的窗口时，将使用索引器（对于 Visual C#）或将一个长整型值传递给 **Item** 属性（对于 Visual Basic）以返回对 **WindowObject** 接口实例的引用。例如，如下代码设置对包含在 **WindowsCollection** 集合中的第一个 **WindowObject** 对象的引用。</span><span class="sxs-lookup"><span data-stu-id="8ee6e-p105">The **WindowsCollection** interface can be accessed through the [Windows](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._Application2.Windows.aspx) property of the [Application](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Application.aspx) interface. When using the **WindowsCollection** interface to access a form's windows, you use an indexer (for Visual C#) or pass a long integer to the **Item** property (for Visual Basic) to return a reference to a **WindowObject** interface instance. For example, the following code sets a reference to the first **WindowObject** contained in the **WindowsCollection**.</span></span>
  
```cs
WindowObject objWindow = thisApplication.Windows[0];
```

```vb
Dim objWindow As WindowObject = thisApplication.Windows(0)
```

<span data-ttu-id="8ee6e-177">但是，可以使用 [Application](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._Application2.ActiveWindow.aspx) 接口的 **ActiveWindow** 属性直接访问当前打开的窗口，而无需通过 \*\* WindowsCollection \*\*，如下面的代码所演示。</span><span class="sxs-lookup"><span data-stu-id="8ee6e-177">However, you can access the currently open window directly by using the [ActiveWindow](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._Application2.ActiveWindow.aspx) property of the **Application** interface, without going through the \*\* WindowsCollection \*\*, as the following code demonstrates.</span></span>
  
```cs
WindowObject objWindow = thisApplication.ActiveWindow;
```

```vb
Dim objWindow As WindowObject = thisApplication.ActiveWindow
```

> [!NOTE]
> <span data-ttu-id="8ee6e-178">调试 InfoPath 托管代码项目时， **ActiveWindow** 属性总是返回 **null**，因为调试窗口是活动的。</span><span class="sxs-lookup"><span data-stu-id="8ee6e-178">When debugging an InfoPath managed-code project, the **ActiveWindow** property will always return **null** because the debugging window is active.</span></span> 
  
<span data-ttu-id="8ee6e-p106">还可以使用与表单的基础 XML 文档关联的 **View** 接口的 [Window](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.View.Window.aspx) 属性来访问 [WindowObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.View.aspx)。 **XDocument** 接口的 **View** 属性用来访问 **View** 对象。例如，下面的代码设置对与表单的基础 XML 文档的视图相关联的 **WindowObject** 对象的引用。</span><span class="sxs-lookup"><span data-stu-id="8ee6e-p106">A **WindowObject** can also be accessed by using the [Window](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.View.Window.aspx) property of the [View](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.View.aspx) interface, which is associated with the form's underlying XML document. The **View** property of the **XDocument** interface is used to access the **View** object. For example, the following code sets a reference to the **WindowObject** that is associated with the view of a form's underlying XML document.</span></span> 
  
```cs
WindowObject objWindow = thisXDocument.View.Window;
```

```vb
Dim objWindow As WindowObject = thisXDocument.View.Window
```

> [!NOTE]
> <span data-ttu-id="8ee6e-p107">**Window** 对象的某些属性和方法只用于编辑窗口类型；如果用于设计窗口类型，它们将返回错误。本主题前面所显示的表中列出了每个窗口类型所支持的属性和方法。您可以在代码中使用 **WindowType** 属性来确定所使用的窗口的类型。</span><span class="sxs-lookup"><span data-stu-id="8ee6e-p107">Some of the properties and methods of the **Window** object are only for the editing window type; if used with the designing window type, they will return an error. The properties and methods that are supported for each window type are listed in the table shown earlier in this topic. You can use the **WindowType** property in your code to determine which type of window you are working with.</span></span> 
  

