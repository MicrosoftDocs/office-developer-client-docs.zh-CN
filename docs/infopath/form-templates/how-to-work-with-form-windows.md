---
title: 使用表单窗口
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
keywords:
- windowscollection [infopath 2007],form windows [InfoPath 2007],Window class [InfoPath 2007]
localization_priority: Normal
ms.assetid: 32ae2427-882b-45f8-8754-0e8c27fc23ba
description: 以编程方式处理 InfoPath 表单时，您可以编写代码来访问该表单的窗口，然后自定义窗口中包含的某些项目。由 Microsoft.Office.InfoPath 命名空间提供的 InfoPath 对象模型通过结合使用 Window 类和 WindowCollection 类来支持对表单窗口进行访问。
ms.openlocfilehash: 5b24798e92849a2d79bf836e12dd91845ee58942
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/11/2018
ms.locfileid: "19774010"
---
# <a name="work-with-form-windows"></a><span data-ttu-id="1630b-105">使用表单窗口</span><span class="sxs-lookup"><span data-stu-id="1630b-105">Work with Form Windows?</span></span>

<span data-ttu-id="1630b-p102">以编程方式处理 InfoPath 表单时，您可以编写代码来访问该表单的窗口，然后自定义窗口中包含的某些项目。由 [Microsoft.Office.InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) 命名空间提供的 InfoPath 对象模型通过结合使用 [Window](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Window.aspx) 类和 [WindowCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.WindowCollection.aspx) 类来支持对表单窗口进行访问。</span><span class="sxs-lookup"><span data-stu-id="1630b-p102">When working programmatically with an InfoPath form, you can write code to access the form's windows, and then customize some of the items that they contain. The InfoPath object model provided by the [Microsoft.Office.InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) namespace supports access to a form's windows through the use of the [Window](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Window.aspx) class in association with the [WindowCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.WindowCollection.aspx) class.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="1630b-108">仅当使用“InfoPath 编辑器表单”**** 时，用于使用表单窗口的类才可用。</span><span class="sxs-lookup"><span data-stu-id="1630b-108">The classes for working with a form's windows are available only when working with an InfoPath Editor Form. If a form template's Compatibility setting is Web Browser Form, these classes are not available.</span></span> <span data-ttu-id="1630b-109">如果表单模板的****“兼容性”设置是****“Web 浏览器表单”，则这些类不可用。</span><span class="sxs-lookup"><span data-stu-id="1630b-109">The classes for working with a form's windows are available only when working with an **InfoPath Editor Form**. If a form template's **Compatibility** setting is Web Browser Form, these classes are not available.</span></span> 
  
<span data-ttu-id="1630b-110">InfoPath 中有两类窗口：</span><span class="sxs-lookup"><span data-stu-id="1630b-110">There are two types of windows in InfoPath:</span></span> 
  
- <span data-ttu-id="1630b-111">用户填写表单时所使用的编辑窗口。</span><span class="sxs-lookup"><span data-stu-id="1630b-111">The editing window that is used when a user fills out a form.</span></span>
    
- <span data-ttu-id="1630b-112">用户设计表单模板时所使用的设计窗口。</span><span class="sxs-lookup"><span data-stu-id="1630b-112">The designing window that is used when a user designs a form template.</span></span>
    
<span data-ttu-id="1630b-113">编写表单模板中的代码时，编辑窗口提供了最有用的功能，因为您可以使用表示当前窗口的 [Window](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Window.aspx) 对象来访问可以用来自定义表单编辑过程的各个属性和方法。</span><span class="sxs-lookup"><span data-stu-id="1630b-113">When writing code in a form template, it is the editing window that provides the most useful functionality, because you can use a [Window](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Window.aspx) object that represents the current window to access a variety of properties and methods that can be used to customize the form editing experience.</span></span> 
  
## <a name="overview-of-the-windowscollection-class"></a><span data-ttu-id="1630b-114">WindowsCollection 类概述</span><span class="sxs-lookup"><span data-stu-id="1630b-114">Overview of the WindowsCollection Class</span></span>

<span data-ttu-id="1630b-115">[WindowCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.WindowCollection.aspx) 类提供了下列属性，表单模板开发人员可以使用这些属性来管理表单模板所包含的 [Window](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Window.aspx) 对象。</span><span class="sxs-lookup"><span data-stu-id="1630b-115">The [WindowCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.WindowCollection.aspx) class provides the following properties, which form template developers can use to manage the [Window](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Window.aspx) objects that it contains.</span></span> 
  
|<span data-ttu-id="1630b-116">**名称**</span><span class="sxs-lookup"><span data-stu-id="1630b-116">**Name**</span></span>|<span data-ttu-id="1630b-117">**说明**</span><span class="sxs-lookup"><span data-stu-id="1630b-117">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="1630b-118">[Count](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.WindowCollection.Count.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="1630b-118">[Count](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.WindowCollection.Count.aspx) property</span></span>  <br/> |<span data-ttu-id="1630b-119">获取集合中包含的 [Window](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Window.aspx) 对象的数目。</span><span class="sxs-lookup"><span data-stu-id="1630b-119">Gets a count of the number of [Window](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Window.aspx) objects contained in the collection.</span></span>  <br/> |
|<span data-ttu-id="1630b-120">[Item](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.WindowCollection.Item.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="1630b-120">[Item](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.WindowCollection.Item.aspx) property</span></span>  <br/> |<span data-ttu-id="1630b-121">获取对指定的 [Window](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Window.aspx) 对象的引用。</span><span class="sxs-lookup"><span data-stu-id="1630b-121">Gets a reference to the specified [Window](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Window.aspx) object.</span></span>  <br/> |
   
## <a name="overview-of-the-window-class"></a><span data-ttu-id="1630b-122">Window 类概述</span><span class="sxs-lookup"><span data-stu-id="1630b-122">Overview of the Window Class</span></span>

<span data-ttu-id="1630b-123">[Window](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Window.aspx) 类提供下列方法和属性，表单开发人员可利用这些方法和属性与 InfoPath 窗口进行交互。</span><span class="sxs-lookup"><span data-stu-id="1630b-123">The [Window](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Window.aspx) class provides the following methods and properties, which form developers can use to interact with an InfoPath window.</span></span> <span data-ttu-id="1630b-124">根据所使用的窗口类型 ([WindowType](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.WindowType.aspx)) 的不同，对这些方法和属性的支持也不同。</span><span class="sxs-lookup"><span data-stu-id="1630b-124">Support for these methods and properties differ depending on the type of window ( [WindowType](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.WindowType.aspx) ) you are working with.</span></span> <span data-ttu-id="1630b-125">有些方法和属性只适用于编辑器窗口类型 (**WindowType.Editor**)。</span><span class="sxs-lookup"><span data-stu-id="1630b-125">Some methods and properties work only with the editor window type ( **WindowType.Editor**).</span></span> <span data-ttu-id="1630b-126">有些方法和属性既适用于编辑器窗口类型，也适用于设计器窗口类型 (**WindowType.Designer**)。</span><span class="sxs-lookup"><span data-stu-id="1630b-126">The remaining methods and properties work with both the editor window type and the designer window type ( **WindowType.Designer**).</span></span> <span data-ttu-id="1630b-127">此外，与所有 InfoPath 对象模型成员一样，当从表单模板调用时，根据安全级别和表单部署方式的不同，对方法和属性的支持也有所不同。</span><span class="sxs-lookup"><span data-stu-id="1630b-127">Additionally, like all InfoPath object model members, when called from a form template, support for methods and properties can vary depending on the security level and how the form is deployed.</span></span>
  
|<span data-ttu-id="1630b-128">**名称**</span><span class="sxs-lookup"><span data-stu-id="1630b-128">**Name**</span></span>|<span data-ttu-id="1630b-129">**说明**</span><span class="sxs-lookup"><span data-stu-id="1630b-129">**Description**</span></span>|<span data-ttu-id="1630b-130">**窗口类型支持**</span><span class="sxs-lookup"><span data-stu-id="1630b-130">**Window Type Support**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="1630b-131">[Activate](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Window.Activate.aspx) 方法</span><span class="sxs-lookup"><span data-stu-id="1630b-131">[Activate](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Window.Activate.aspx) method</span></span>  <br/> |<span data-ttu-id="1630b-132">激活窗口（将焦点移到该窗口）。</span><span class="sxs-lookup"><span data-stu-id="1630b-132">Activates (gives focus to) the window.</span></span>  <br/> |<span data-ttu-id="1630b-133">**Designer** 和 **Editor** 类型</span><span class="sxs-lookup"><span data-stu-id="1630b-133">Both **Designer** and **Editor** type</span></span>  <br/> |
|<span data-ttu-id="1630b-134">[Active](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Window.Active.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="1630b-134">[Active](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Window.Active.aspx) property</span></span>  <br/> |<span data-ttu-id="1630b-135">获取 **Boolean** 值，指示窗口是否是当前的活动窗口。</span><span class="sxs-lookup"><span data-stu-id="1630b-135">Gets a **Boolean** value indicating whether the window is the currently active window.</span></span>  <br/> |<span data-ttu-id="1630b-136">**Designer** 和 **Editor** 类型</span><span class="sxs-lookup"><span data-stu-id="1630b-136">Both **Designer** and **Editor** type</span></span>  <br/> |
|<span data-ttu-id="1630b-137">[Caption](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Window.Caption.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="1630b-137">[Caption](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Window.Caption.aspx) property</span></span>  <br/> |<span data-ttu-id="1630b-138">获取或设置由 [Window](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Window.aspx) 对象表示的窗口的标题文本。</span><span class="sxs-lookup"><span data-stu-id="1630b-138">Gets or sets the caption text for the window represented by the [Window](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Window.aspx) object.</span></span>  <br/> |<span data-ttu-id="1630b-139">仅限于 **Editor** 类型</span><span class="sxs-lookup"><span data-stu-id="1630b-139">Only **Editor** type</span></span>  <br/> |
|<span data-ttu-id="1630b-140">[Close()](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Window.Close.aspx) 方法</span><span class="sxs-lookup"><span data-stu-id="1630b-140">[Close()](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Window.Close.aspx) method</span></span>  <br/> |<span data-ttu-id="1630b-141">关闭窗口并提示保存对任何未保存表单所做的更改，或保存包含未保存更改的表单。</span><span class="sxs-lookup"><span data-stu-id="1630b-141">Closes the window prompting to save changes to any unsaved form, or form with changes that have not been saved.</span></span>  <br/> |<span data-ttu-id="1630b-142">仅限于 **Editor** 类型</span><span class="sxs-lookup"><span data-stu-id="1630b-142">Only **Editor** type</span></span>  <br/> |
|<span data-ttu-id="1630b-143">[Close(Boolean)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Window.Close.aspx) 方法</span><span class="sxs-lookup"><span data-stu-id="1630b-143">[Close(Boolean)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Window.Close.aspx) method</span></span>  <br/> |<span data-ttu-id="1630b-144">关闭窗口并可以选择强制关闭未保存的表单或包含未保存的更改的表单，而不提示保存表单。</span><span class="sxs-lookup"><span data-stu-id="1630b-144">Closes the window and optionally forces an unsaved form or form with unsaved changes to be closed without saving.</span></span>  <br/> |<span data-ttu-id="1630b-145">仅限于 **Editor** 类型</span><span class="sxs-lookup"><span data-stu-id="1630b-145">Only **Editor** type</span></span>  <br/> |
|<span data-ttu-id="1630b-146">[CommandBars](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Window.CommandBars.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="1630b-146">[CommandBars](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Window.CommandBars.aspx) property</span></span>  <br/> |<span data-ttu-id="1630b-147">获取对与窗口关联的 Microsoft Office **CommandBars** 集合的引用。</span><span class="sxs-lookup"><span data-stu-id="1630b-147">Gets a reference to the Microsoft Office **CommandBars** collection that is associated with the window.</span></span>  <br/> |<span data-ttu-id="1630b-148">**Designer** 和 **Editor** 类型</span><span class="sxs-lookup"><span data-stu-id="1630b-148">Both **Designer** and **Editor** type</span></span>  <br/> |
|<span data-ttu-id="1630b-149">[Height](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Window.Height.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="1630b-149">[Height](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Window.Height.aspx) property</span></span>  <br/> |<span data-ttu-id="1630b-150">获取或设置窗口的高度（以磅为单位）。</span><span class="sxs-lookup"><span data-stu-id="1630b-150">Gets or sets the height of the window, measured in points.</span></span>  <br/> |<span data-ttu-id="1630b-151">**Designer** 和 **Editor** 类型</span><span class="sxs-lookup"><span data-stu-id="1630b-151">Both **Designer** and **Editor** type</span></span>  <br/> |
|<span data-ttu-id="1630b-152">[Left](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Window.Left.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="1630b-152">[Left](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Window.Left.aspx) property</span></span>  <br/> |<span data-ttu-id="1630b-153">获取或设置窗口的水平位置，以磅为单位。</span><span class="sxs-lookup"><span data-stu-id="1630b-153">Gets or sets the horizontal position of the window, measured in points.</span></span>  <br/> |<span data-ttu-id="1630b-154">**Designer** 和 **Editor** 类型</span><span class="sxs-lookup"><span data-stu-id="1630b-154">Both **Designer** and **Editor** type</span></span>  <br/> |
|<span data-ttu-id="1630b-155">[MailEnvelope](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Window.MailEnvelope.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="1630b-155">[MailEnvelope](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Window.MailEnvelope.aspx) property</span></span>  <br/> |<span data-ttu-id="1630b-156">获取对 [MailEnvelope](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.MailEnvelope.aspx) 类的引用。</span><span class="sxs-lookup"><span data-stu-id="1630b-156">Gets a reference to the [MailEnvelope](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.MailEnvelope.aspx) class.</span></span>  <br/> |<span data-ttu-id="1630b-157">仅限于 **Editor** 类型</span><span class="sxs-lookup"><span data-stu-id="1630b-157">Only **Editor** type</span></span>  <br/> |
|<span data-ttu-id="1630b-158">[TaskPanes](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Window.TaskPanes.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="1630b-158">[TaskPanes](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Window.TaskPanes.aspx) property</span></span>  <br/> |<span data-ttu-id="1630b-159">获取对 [TaskPaneCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.TaskPaneCollection.aspx) 集合的引用。</span><span class="sxs-lookup"><span data-stu-id="1630b-159">Gets a reference to the [TaskPaneCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.TaskPaneCollection.aspx) collection.</span></span>  <br/> |<span data-ttu-id="1630b-160">**Designer** 和 **Editor** 类型</span><span class="sxs-lookup"><span data-stu-id="1630b-160">Both **Designer** and **Editor** type</span></span>  <br/> |
|<span data-ttu-id="1630b-161">[Top](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Window.Top.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="1630b-161">[Top](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Window.Top.aspx) property</span></span>  <br/> |<span data-ttu-id="1630b-162">获取或设置窗口的垂直位置，以磅为单位。</span><span class="sxs-lookup"><span data-stu-id="1630b-162">Gets or sets the vertical position of the window, measured in points.</span></span>  <br/> |<span data-ttu-id="1630b-163">**Designer** 和 **Editor** 类型</span><span class="sxs-lookup"><span data-stu-id="1630b-163">Both **Designer** and **Editor** type</span></span>  <br/> |
|<span data-ttu-id="1630b-164">[Width](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Window.Width.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="1630b-164">[Width](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Window.Width.aspx) property</span></span>  <br/> |<span data-ttu-id="1630b-165">获取或设置窗口的宽度，以磅为单位。</span><span class="sxs-lookup"><span data-stu-id="1630b-165">Gets or set the width of the window, measured in points.</span></span>  <br/> |<span data-ttu-id="1630b-166">**Designer** 和 **Editor** 类型</span><span class="sxs-lookup"><span data-stu-id="1630b-166">Both **Designer** and **Editor** type</span></span>  <br/> |
|<span data-ttu-id="1630b-167">[WindowState](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Window.WindowState.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="1630b-167">[WindowState](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Window.WindowState.aspx) property</span></span>  <br/> |<span data-ttu-id="1630b-168">获取窗口的状态或将窗口的状态设为 [WindowState](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.WindowState.aspx) 值。</span><span class="sxs-lookup"><span data-stu-id="1630b-168">Gets or sets the state of the window as a [WindowState](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.WindowState.aspx) value.</span></span>  <br/> |<span data-ttu-id="1630b-169">**Designer** 和 **Editor** 类型</span><span class="sxs-lookup"><span data-stu-id="1630b-169">Both **Designer** and **Editor** type</span></span>  <br/> |
|<span data-ttu-id="1630b-170">[WindowType](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Window.WindowType.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="1630b-170">[WindowType](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Window.WindowType.aspx) property</span></span>  <br/> |<span data-ttu-id="1630b-171">获取窗口的类型并将它作为一个 [WindowType](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.WindowType.aspx) 枚举值。</span><span class="sxs-lookup"><span data-stu-id="1630b-171">Gets the type of the window as an [WindowType](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.WindowType.aspx) enumeration value.</span></span>  <br/> |<span data-ttu-id="1630b-172">**Designer** 和 **Editor** 类型</span><span class="sxs-lookup"><span data-stu-id="1630b-172">Both **Designer** and **Editor** type</span></span>  <br/> |
|<span data-ttu-id="1630b-173">[XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Window.XmlForm.aspx) 属性</span><span class="sxs-lookup"><span data-stu-id="1630b-173">[XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Window.XmlForm.aspx) property</span></span>  <br/> |<span data-ttu-id="1630b-174">返回对与窗口关联的 [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) 对象的引用。</span><span class="sxs-lookup"><span data-stu-id="1630b-174">Returns a reference to the [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) object associated with the window.</span></span>  <br/> |<span data-ttu-id="1630b-175">仅限于 **Editor** 类型</span><span class="sxs-lookup"><span data-stu-id="1630b-175">Only **Editor** type</span></span>  <br/> |
   
## <a name="using-the-windowscollection-and-window-classes"></a><span data-ttu-id="1630b-176">使用 WindowsCollection 和 Window 类</span><span class="sxs-lookup"><span data-stu-id="1630b-176">Using the WindowsCollection and Window Classes</span></span>

<span data-ttu-id="1630b-p105">通过 [Application](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.WindowCollection.aspx) 类的 [Windows](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Application.Windows.aspx) 属性可以访问 [WindowCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Application.aspx) 类。使用 [WindowCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.WindowCollection.aspx) 类访问表单的窗口时，应使用索引器（对于 Visual C#）或将一个长整型值传递给 **Item** 属性（对于 Visual Basic）来返回对 [Window](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Window.aspx) 对象实例的引用。例如，以下代码设置对包含在当前 InfoPath 会话的 [WindowCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Window.aspx) 中的第一个 [Window](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.WindowCollection.aspx) 对象的引用。</span><span class="sxs-lookup"><span data-stu-id="1630b-p105">The [WindowCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.WindowCollection.aspx) class can be accessed through the [Windows](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Application.Windows.aspx) property of the [Application](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Application.aspx) class. When using the [WindowCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.WindowCollection.aspx) class to access a form's windows, you use an indexer (for Visual C#) or pass a long integer to the **Item** property (for Visual Basic) to return a reference to a [Window](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Window.aspx) object instance. For example, the following code sets a reference to the first [Window](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Window.aspx) object contained in the [WindowCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.WindowCollection.aspx) for the current InfoPath session.</span></span> 
  
```cs
Window myWindow = this.Application.Windows[0];
```

```vb
Dim myWindow As Window = Me.Application.Windows(0)
```

<span data-ttu-id="1630b-180">您可以直接使用 [Application](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Application.ActiveWindow.aspx) 类的 [ActiveWindow](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Application.aspx) 属性访问当前打开的窗口，而无需逐个访问 [WindowCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.WindowCollection.aspx) ，如以下代码行所示。</span><span class="sxs-lookup"><span data-stu-id="1630b-180">You can access the currently open window directly using the [ActiveWindow](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Application.ActiveWindow.aspx) property of the [Application](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Application.aspx) class, without going through the [WindowCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.WindowCollection.aspx) , as shown in the following line of code.</span></span> 
  
```cs
Window myWindow = this.Application.ActiveWindow;
```

```vb
Dim myWindow As Window = Me.Application.ActiveWindow
```

<span data-ttu-id="1630b-p106">还可以通过使用 [View](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Window.aspx) 类（表示正用于处理表单的基础 XML 文档的当前视图）的 [Window](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.View.Window.aspx) 属性来访问 [Window](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.View.aspx) 对象。 [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.CurrentView.aspx) 类的 [CurrentView](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) 属性用于访问表示当前视图的 [View](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.View.aspx) 对象。例如，以下代码可设置对与当前视图关联的 [Window](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Window.aspx) 的引用。</span><span class="sxs-lookup"><span data-stu-id="1630b-p106">A [Window](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Window.aspx) object can also be accessed by using the [Window](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.View.Window.aspx) property of the [View](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.View.aspx) class, which represents the current view that is being used to work with the form's underlying XML document. The [CurrentView](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.CurrentView.aspx) property of the [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) class is used to access a [View](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.View.aspx) object that represents the current view. For example, the following code sets a reference to the [Window](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Window.aspx) that is associated with the current view.</span></span> 
  
```cs
Window myWindow = this.CurrentView.Window;
```

```vb
Dim myWindow As Window = Me.CurrentView.Window
```

> [!NOTE]
> <span data-ttu-id="1630b-p107">[Window](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Window.aspx) 类的某些属性和方法只适用于编辑窗口类型；如果用于设计窗口类型，它们将返回错误。本主题前面的表中列出了每种窗口类型所支持的属性和方法。您可以在代码中使用 [Window](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Window.aspx) 属性来确定所使用的窗口的类型。</span><span class="sxs-lookup"><span data-stu-id="1630b-p107">Some of the properties and methods of the [Window](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Window.aspx) class are only for the editing window type; if used with the designing window type, they will return an error. Which properties and methods are supported for each window type are listed in the table earlier in this topic. You can use the [Window](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Window.aspx) property in your code to determine which type of window you are working with.</span></span> 
  

